var D1=Object.defineProperty;var Qp=r=>{throw TypeError(r)};var C1=(r,e,t)=>e in r?D1(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var k=(r,e,t)=>C1(r,typeof e!="symbol"?e+"":e,t),ch=(r,e,t)=>e.has(r)||Qp("Cannot "+t);var y=(r,e,t)=>(ch(r,e,"read from private field"),t?t.call(r):e.get(r)),F=(r,e,t)=>e.has(r)?Qp("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),D=(r,e,t,n)=>(ch(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),q=(r,e,t)=>(ch(r,e,"access private method"),t);var $a=(r,e,t,n)=>({set _(s){D(r,e,s,t)},get _(){return y(r,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const _1="modulepreload",N1=function(r){return"/walletconnect-dapp/"+r},Wp={},cb=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(c=>{if(c=N1(c),c in Wp)return;Wp[c]=!0;const u=c.endsWith(".css"),l=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${l}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":_1,u||(h.as="script"),h.crossOrigin="",h.href=c,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,d)=>{h.addEventListener("load",f),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};var tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function T1(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var lu={exports:{}},Jp;function R1(){if(Jp)return lu.exports;Jp=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(O,b,x){return Function.prototype.apply.call(O,b,x)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(O){return Object.getOwnPropertyNames(O).concat(Object.getOwnPropertySymbols(O))}:t=function(O){return Object.getOwnPropertyNames(O)};function n(P){console&&console.warn&&console.warn(P)}var s=Number.isNaN||function(O){return O!==O};function i(){i.init.call(this)}lu.exports=i,lu.exports.once=E,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(P){if(typeof P!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof P)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(P){if(typeof P!="number"||P<0||s(P))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+P+".");o=P}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(O){if(typeof O!="number"||O<0||s(O))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+O+".");return this._maxListeners=O,this};function c(P){return P._maxListeners===void 0?i.defaultMaxListeners:P._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(O){for(var b=[],x=1;x<arguments.length;x++)b.push(arguments[x]);var S=O==="error",C=this._events;if(C!==void 0)S=S&&C.error===void 0;else if(!S)return!1;if(S){var R;if(b.length>0&&(R=b[0]),R instanceof Error)throw R;var L=new Error("Unhandled error."+(R?" ("+R.message+")":""));throw L.context=R,L}var M=C[O];if(M===void 0)return!1;if(typeof M=="function")e(M,this,b);else for(var V=M.length,$=g(M,V),x=0;x<V;++x)e($[x],this,b);return!0};function u(P,O,b,x){var S,C,R;if(a(b),C=P._events,C===void 0?(C=P._events=Object.create(null),P._eventsCount=0):(C.newListener!==void 0&&(P.emit("newListener",O,b.listener?b.listener:b),C=P._events),R=C[O]),R===void 0)R=C[O]=b,++P._eventsCount;else if(typeof R=="function"?R=C[O]=x?[b,R]:[R,b]:x?R.unshift(b):R.push(b),S=c(P),S>0&&R.length>S&&!R.warned){R.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+R.length+" "+String(O)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=P,L.type=O,L.count=R.length,n(L)}return P}i.prototype.addListener=function(O,b){return u(this,O,b,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(O,b){return u(this,O,b,!0)};function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(P,O,b){var x={fired:!1,wrapFn:void 0,target:P,type:O,listener:b},S=l.bind(x);return S.listener=b,x.wrapFn=S,S}i.prototype.once=function(O,b){return a(b),this.on(O,h(this,O,b)),this},i.prototype.prependOnceListener=function(O,b){return a(b),this.prependListener(O,h(this,O,b)),this},i.prototype.removeListener=function(O,b){var x,S,C,R,L;if(a(b),S=this._events,S===void 0)return this;if(x=S[O],x===void 0)return this;if(x===b||x.listener===b)--this._eventsCount===0?this._events=Object.create(null):(delete S[O],S.removeListener&&this.emit("removeListener",O,x.listener||b));else if(typeof x!="function"){for(C=-1,R=x.length-1;R>=0;R--)if(x[R]===b||x[R].listener===b){L=x[R].listener,C=R;break}if(C<0)return this;C===0?x.shift():p(x,C),x.length===1&&(S[O]=x[0]),S.removeListener!==void 0&&this.emit("removeListener",O,L||b)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(O){var b,x,S;if(x=this._events,x===void 0)return this;if(x.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):x[O]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete x[O]),this;if(arguments.length===0){var C=Object.keys(x),R;for(S=0;S<C.length;++S)R=C[S],R!=="removeListener"&&this.removeAllListeners(R);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(b=x[O],typeof b=="function")this.removeListener(O,b);else if(b!==void 0)for(S=b.length-1;S>=0;S--)this.removeListener(O,b[S]);return this};function f(P,O,b){var x=P._events;if(x===void 0)return[];var S=x[O];return S===void 0?[]:typeof S=="function"?b?[S.listener||S]:[S]:b?w(S):g(S,S.length)}i.prototype.listeners=function(O){return f(this,O,!0)},i.prototype.rawListeners=function(O){return f(this,O,!1)},i.listenerCount=function(P,O){return typeof P.listenerCount=="function"?P.listenerCount(O):d.call(P,O)},i.prototype.listenerCount=d;function d(P){var O=this._events;if(O!==void 0){var b=O[P];if(typeof b=="function")return 1;if(b!==void 0)return b.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function g(P,O){for(var b=new Array(O),x=0;x<O;++x)b[x]=P[x];return b}function p(P,O){for(;O+1<P.length;O++)P[O]=P[O+1];P.pop()}function w(P){for(var O=new Array(P.length),b=0;b<O.length;++b)O[b]=P[b].listener||P[b];return O}function E(P,O){return new Promise(function(b,x){function S(R){P.removeListener(O,C),x(R)}function C(){typeof P.removeListener=="function"&&P.removeListener("error",S),b([].slice.call(arguments))}I(P,O,C,{once:!0}),O!=="error"&&A(P,S,{once:!0})})}function A(P,O,b){typeof P.on=="function"&&I(P,"error",O,b)}function I(P,O,b,x){if(typeof P.on=="function")x.once?P.once(O,b):P.on(O,b);else if(typeof P.addEventListener=="function")P.addEventListener(O,function S(C){x.once&&P.removeEventListener(O,S),b(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof P)}return lu.exports}var nr=R1();const Gd=Vd(nr);var Yp=function(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))},B1=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),$1=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),k1=function(){function r(e,t,n,s){this.name=e,this.version=t,this.os=n,this.bot=s,this.type="bot-device"}return r}(),U1=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),L1=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),F1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,M1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Zp=3,j1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",F1]],Xp=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function H1(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new L1:typeof navigator<"u"?z1(navigator.userAgent):G1()}function q1(r){return r!==""&&j1.reduce(function(e,t){var n=t[0],s=t[1];if(e)return e;var i=s.exec(r);return!!i&&[n,i]},!1)}function z1(r){var e=q1(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new U1;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<Zp&&(s=Yp(Yp([],s,!0),K1(Zp-s.length),!0)):s=[];var i=s.join("."),o=V1(r),a=M1.exec(r);return a&&a[1]?new k1(t,i,o,a[1]):new B1(t,i,o)}function V1(r){for(var e=0,t=Xp.length;e<t;e++){var n=Xp[e],s=n[0],i=n[1],o=i.exec(r);if(o)return s}return null}function G1(){var r=typeof process<"u"&&process.version;return r?new $1(process.version.slice(1)):null}function K1(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var uh={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wf=function(r,e){return wf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},wf(r,e)};function Q1(r,e){wf(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var bf=function(){return bf=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},bf.apply(this,arguments)};function W1(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function J1(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function Y1(r,e){return function(t,n){e(t,n,r)}}function Z1(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function X1(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})}function eA(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,s=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){t.label=u[1];break}if(u[0]===6&&t.label<i[1]){t.label=i[1],i=u;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(u);break}i[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(l){u=[6,l],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function tA(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function rA(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function vf(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ub(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function nA(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(ub(arguments[e]));return r}function sA(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function dc(r){return this instanceof dc?(this.v=r,this):new dc(r)}function iA(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){n[f]&&(s[f]=function(d){return new Promise(function(g,p){i.push([f,d,g,p])>1||a(f,d)})})}function a(f,d){try{c(n[f](d))}catch(g){h(i[0][3],g)}}function c(f){f.value instanceof dc?Promise.resolve(f.value.v).then(u,l):h(i[0][2],f)}function u(f){a("next",f)}function l(f){a("throw",f)}function h(f,d){f(d),i.shift(),i.length&&a(i[0][0],i[0][1])}}function oA(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:dc(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function aA(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof vf=="function"?vf(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function cA(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function uA(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function lA(r){return r&&r.__esModule?r:{default:r}}function hA(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function fA(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const dA=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return bf},__asyncDelegator:oA,__asyncGenerator:iA,__asyncValues:aA,__await:dc,__awaiter:X1,__classPrivateFieldGet:hA,__classPrivateFieldSet:fA,__createBinding:tA,__decorate:J1,__exportStar:rA,__extends:Q1,__generator:eA,__importDefault:lA,__importStar:uA,__makeTemplateObject:cA,__metadata:Z1,__param:Y1,__read:ub,__rest:W1,__spread:nA,__spreadArrays:sA,__values:vf},Symbol.toStringTag,{value:"Module"})),qc=T1(dA);var lh={},ka={},eg;function pA(){if(eg)return ka;eg=1,Object.defineProperty(ka,"__esModule",{value:!0}),ka.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ka.delay=r,ka}var Cs={},hh={},_s={},tg;function gA(){return tg||(tg=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.ONE_THOUSAND=_s.ONE_HUNDRED=void 0,_s.ONE_HUNDRED=100,_s.ONE_THOUSAND=1e3),_s}var fh={},rg;function yA(){return rg||(rg=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(fh)),fh}var ng;function lb(){return ng||(ng=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=qc;e.__exportStar(gA(),r),e.__exportStar(yA(),r)}(hh)),hh}var sg;function mA(){if(sg)return Cs;sg=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.fromMiliseconds=Cs.toMiliseconds=void 0;const r=lb();function e(n){return n*r.ONE_THOUSAND}Cs.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return Cs.fromMiliseconds=t,Cs}var ig;function wA(){return ig||(ig=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=qc;e.__exportStar(pA(),r),e.__exportStar(mA(),r)}(lh)),lh}var Li={},og;function bA(){if(og)return Li;og=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:s})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Li.Watch=r,Li.default=r,Li}var dh={},Ua={},ag;function vA(){if(ag)return Ua;ag=1,Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.IWatch=void 0;class r{}return Ua.IWatch=r,Ua}var cg;function EA(){return cg||(cg=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),qc.__exportStar(vA(),r)}(dh)),dh}var ug;function AA(){return ug||(ug=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=qc;e.__exportStar(wA(),r),e.__exportStar(bA(),r),e.__exportStar(EA(),r),e.__exportStar(lb(),r)}(uh)),uh}var Q=AA(),Ie={},lg;function hb(){if(lg)return Ie;lg=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=Ie.getLocation=Ie.getLocationOrThrow=Ie.getNavigator=Ie.getNavigatorOrThrow=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function r(f){let d;return typeof window<"u"&&typeof window[f]<"u"&&(d=window[f]),d}Ie.getFromWindow=r;function e(f){const d=r(f);if(!d)throw new Error(`${f} is not defined in Window`);return d}Ie.getFromWindowOrThrow=e;function t(){return e("document")}Ie.getDocumentOrThrow=t;function n(){return r("document")}Ie.getDocument=n;function s(){return e("navigator")}Ie.getNavigatorOrThrow=s;function i(){return r("navigator")}Ie.getNavigator=i;function o(){return e("location")}Ie.getLocationOrThrow=o;function a(){return r("location")}Ie.getLocation=a;function c(){return e("crypto")}Ie.getCryptoOrThrow=c;function u(){return r("crypto")}Ie.getCrypto=u;function l(){return e("localStorage")}Ie.getLocalStorageOrThrow=l;function h(){return r("localStorage")}return Ie.getLocalStorage=h,Ie}var vi=hb(),La={},hg;function IA(){if(hg)return La;hg=1,Object.defineProperty(La,"__esModule",{value:!0}),La.getWindowMetadata=void 0;const r=hb();function e(){let t,n;try{t=r.getDocumentOrThrow(),n=r.getLocationOrThrow()}catch{return null}function s(){const d=t.getElementsByTagName("link"),g=[];for(let p=0;p<d.length;p++){const w=d[p],E=w.getAttribute("rel");if(E&&E.toLowerCase().indexOf("icon")>-1){const A=w.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let I=n.protocol+"//"+n.host;if(A.indexOf("/")===0)I+=A;else{const P=n.pathname.split("/");P.pop();const O=P.join("/");I+=O+"/"+A}g.push(I)}else if(A.indexOf("//")===0){const I=n.protocol+A;g.push(I)}else g.push(A)}}return g}function i(...d){const g=t.getElementsByTagName("meta");for(let p=0;p<g.length;p++){const w=g[p],E=["itemprop","property","name"].map(A=>w.getAttribute(A)).filter(A=>A?d.includes(A):!1);if(E.length&&E){const A=w.getAttribute("content");if(A)return A}}return""}function o(){let d=i("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),u=a(),l=n.origin,h=s();return{description:u,url:l,icons:h,name:c}}return La.getWindowMetadata=e,La}var PA=IA();function pc(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function fg(r){return pc(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const fb="2.23.2";let Fa={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${fb}`};class Ei extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof Ei?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof Ei&&t.cause.docsPath||t.docsPath,i=(a=Fa.getDocsUrl)==null?void 0:a.call(Fa,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...Fa.version?[`Version: ${Fa.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=fb}walk(e){return db(this,e)}}function db(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?db(r.cause,e):e?null:r}class pb extends Ei{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function Sa(r,{dir:e,size:t=32}={}){return typeof r=="string"?xA(r,{dir:e,size:t}):OA(r,{dir:e,size:t})}function xA(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new pb({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function OA(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new pb({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}class SA extends Ei{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class DA extends Ei{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Da(r,{size:e}){if(fg(r)>e)throw new DA({givenSize:fg(r),maxSize:e})}function Ef(r,e={}){const{signed:t}=e;e.size&&Da(r,{size:e.size});const n=BigInt(r);if(!t)return n;const s=(r.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function CA(r,e={}){return Number(Ef(r,e))}const _A=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Af(r,e={}){return typeof r=="number"||typeof r=="bigint"?yb(r,e):typeof r=="string"?RA(r,e):typeof r=="boolean"?NA(r,e):gb(r,e)}function NA(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(Da(t,{size:e.size}),Sa(t,{size:e.size})):t}function gb(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=_A[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(Da(n,{size:e.size}),Sa(n,{dir:"right",size:e.size})):n}function yb(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new SA({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?Sa(a,{size:n}):a}const TA=new TextEncoder;function RA(r,e={}){const t=TA.encode(r);return gb(t,e)}const BA=new TextEncoder;function $A(r,e={}){return typeof r=="number"||typeof r=="bigint"?UA(r,e):typeof r=="boolean"?kA(r,e):pc(r)?mb(r,e):wb(r,e)}function kA(r,e={}){const t=new Uint8Array(1);return t[0]=Number(r),typeof e.size=="number"?(Da(t,{size:e.size}),Sa(t,{size:e.size})):t}const ln={zero:48,nine:57,A:65,F:70,a:97,f:102};function dg(r){if(r>=ln.zero&&r<=ln.nine)return r-ln.zero;if(r>=ln.A&&r<=ln.F)return r-(ln.A-10);if(r>=ln.a&&r<=ln.f)return r-(ln.a-10)}function mb(r,e={}){let t=r;e.size&&(Da(t,{size:e.size}),t=Sa(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=dg(n.charCodeAt(a++)),u=dg(n.charCodeAt(a++));if(c===void 0||u===void 0)throw new Ei(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+u}return i}function UA(r,e){const t=yb(r,e);return mb(t)}function wb(r,e={}){const t=BA.encode(r);return typeof e.size=="number"?(Da(t,{size:e.size}),Sa(t,{dir:"right",size:e.size})):t}function el(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function LA(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function _l(r,...e){if(!LA(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function gF(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");el(r.outputLen),el(r.blockLen)}function pg(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function FA(r,e){_l(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const hu=BigInt(2**32-1),gg=BigInt(32);function MA(r,e=!1){return e?{h:Number(r&hu),l:Number(r>>gg&hu)}:{h:Number(r>>gg&hu)|0,l:Number(r&hu)|0}}function jA(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=MA(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const HA=(r,e,t)=>r<<t|e>>>32-t,qA=(r,e,t)=>e<<t|r>>>32-t,zA=(r,e,t)=>e<<t-32|r>>>64-t,VA=(r,e,t)=>r<<t-32|e>>>64-t,Fi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function GA(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function yF(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function mF(r,e){return r<<32-e|r>>>e}const yg=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function KA(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function mg(r){for(let e=0;e<r.length;e++)r[e]=KA(r[e])}function QA(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function bb(r){return typeof r=="string"&&(r=QA(r)),_l(r),r}function wF(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];_l(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let WA=class{clone(){return this._cloneInto()}};function JA(r){const e=n=>r().update(bb(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function vF(r=32){if(Fi&&typeof Fi.getRandomValues=="function")return Fi.getRandomValues(new Uint8Array(r));if(Fi&&typeof Fi.randomBytes=="function")return Fi.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const vb=[],Eb=[],Ab=[],YA=BigInt(0),Ma=BigInt(1),ZA=BigInt(2),XA=BigInt(7),e2=BigInt(256),t2=BigInt(113);for(let r=0,e=Ma,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],vb.push(2*(5*n+t)),Eb.push((r+1)*(r+2)/2%64);let s=YA;for(let i=0;i<7;i++)e=(e<<Ma^(e>>XA)*t2)%e2,e&ZA&&(s^=Ma<<(Ma<<BigInt(i))-Ma);Ab.push(s)}const[r2,n2]=jA(Ab,!0),wg=(r,e,t)=>t>32?zA(r,e,t):HA(r,e,t),bg=(r,e,t)=>t>32?VA(r,e,t):qA(r,e,t);function s2(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=t[c],l=t[c+1],h=wg(u,l,1)^t[a],f=bg(u,l,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=Eb[o],c=wg(s,i,a),u=bg(s,i,a),l=vb[o];s=r[l],i=r[l+1],r[l]=c,r[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=r2[n],r[1]^=n2[n]}t.fill(0)}let i2=class Ib extends WA{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,el(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=GA(this.state)}keccak(){yg||mg(this.state32),s2(this.state32,this.rounds),yg||mg(this.state32),this.posOut=0,this.pos=0}update(e){pg(this);const{blockLen:t,state:n}=this;e=bb(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){pg(this,!1),_l(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return el(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(FA(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Ib(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const o2=(r,e,t)=>JA(()=>new i2(e,r,t)),a2=o2(1,136,256/8);function Pb(r,e){const t=e||"hex",n=a2(pc(r,{strict:!1})?$A(r):r);return t==="bytes"?n:Af(n)}class c2 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const ph=new c2(8192);function u2(r,e){if(ph.has(`${r}.${e}`))return ph.get(`${r}.${e}`);const t=r.substring(2).toLowerCase(),n=Pb(wb(t),"bytes"),s=t.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return ph.set(`${r}.${e}`,i),i}function l2(r){const e=Pb(`0x${r.substring(4)}`).substring(26);return u2(`0x${e}`)}async function h2({hash:r,signature:e}){const t=pc(r)?r:Af(r),{secp256k1:n}=await cb(async()=>{const{secp256k1:o}=await import("./secp256k1-CK8UqlP7.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:l,v:h,yParity:f}=e,d=Number(f??h),g=vg(d);return new n.Signature(Ef(u),Ef(l)).addRecoveryBit(g)}const o=pc(e)?e:Af(e),a=CA(`0x${o.slice(130)}`),c=vg(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function vg(r){if(r===0||r===1)return r;if(r===27)return 0;if(r===28)return 1;throw new Error("Invalid yParityOrV value")}async function f2({hash:r,signature:e}){return l2(await h2({hash:r,signature:e}))}function d2(r){if(r.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let u=0;u<e.length;u++)e[u]=255;for(let u=0;u<r.length;u++){const l=r.charAt(u),h=l.charCodeAt(0);if(e[h]!==255)throw new TypeError(l+" is ambiguous");e[h]=u}const t=r.length,n=r.charAt(0),s=Math.log(t)/Math.log(256),i=Math.log(256)/Math.log(t);function o(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";let l=0,h=0,f=0;const d=u.length;for(;f!==d&&u[f]===0;)f++,l++;const g=(d-f)*i+1>>>0,p=new Uint8Array(g);for(;f!==d;){let A=u[f],I=0;for(let P=g-1;(A!==0||I<h)&&P!==-1;P--,I++)A+=256*p[P]>>>0,p[P]=A%t>>>0,A=A/t>>>0;if(A!==0)throw new Error("Non-zero carry");h=I,f++}let w=g-h;for(;w!==g&&p[w]===0;)w++;let E=n.repeat(l);for(;w<g;++w)E+=r.charAt(p[w]);return E}function a(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;let l=0,h=0,f=0;for(;u[l]===n;)h++,l++;const d=(u.length-l)*s+1>>>0,g=new Uint8Array(d);for(;l<u.length;){const A=u.charCodeAt(l);if(A>255)return;let I=e[A];if(I===255)return;let P=0;for(let O=d-1;(I!==0||P<f)&&O!==-1;O--,P++)I+=t*g[O]>>>0,g[O]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");f=P,l++}let p=d-f;for(;p!==d&&g[p]===0;)p++;const w=new Uint8Array(h+(d-p));let E=h;for(;p!==d;)w[E++]=g[p++];return w}function c(u){const l=a(u);if(l)return l;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var p2="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const g2=d2(p2),y2=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),m2=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Ai(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return m2(r)}catch{return r}}function Hn(r){return typeof r=="string"?r:y2(r)||""}function w2(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function xb(r,...e){if(!w2(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Eg(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function b2(r,e){xb(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Mi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const gh=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function v2(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Ob(r){return typeof r=="string"&&(r=v2(r)),xb(r),r}let E2=class{clone(){return this._cloneInto()}};function A2(r){const e=n=>r().update(Ob(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Sb(r=32){if(Mi&&typeof Mi.getRandomValues=="function")return Mi.getRandomValues(new Uint8Array(r));if(Mi&&typeof Mi.randomBytes=="function")return Mi.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function I2(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,u=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+u,a,n)}let P2=class extends E2{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=gh(this.buffer)}update(e){Eg(this);const{view:t,buffer:n,blockLen:s}=this;e=Ob(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=gh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Eg(this),b2(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;I2(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=gh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,l[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const fu=BigInt(2**32-1),If=BigInt(32);function Db(r,e=!1){return e?{h:Number(r&fu),l:Number(r>>If&fu)}:{h:Number(r>>If&fu)|0,l:Number(r&fu)|0}}function x2(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=Db(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const O2=(r,e)=>BigInt(r>>>0)<<If|BigInt(e>>>0),S2=(r,e,t)=>r>>>t,D2=(r,e,t)=>r<<32-t|e>>>t,C2=(r,e,t)=>r>>>t|e<<32-t,_2=(r,e,t)=>r<<32-t|e>>>t,N2=(r,e,t)=>r<<64-t|e>>>t-32,T2=(r,e,t)=>r>>>t-32|e<<64-t,R2=(r,e)=>e,B2=(r,e)=>r,$2=(r,e,t)=>r<<t|e>>>32-t,k2=(r,e,t)=>e<<t|r>>>32-t,U2=(r,e,t)=>e<<t-32|r>>>64-t,L2=(r,e,t)=>r<<t-32|e>>>64-t;function F2(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const M2=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),j2=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,H2=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),q2=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,z2=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),V2=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,se={fromBig:Db,split:x2,toBig:O2,shrSH:S2,shrSL:D2,rotrSH:C2,rotrSL:_2,rotrBH:N2,rotrBL:T2,rotr32H:R2,rotr32L:B2,rotlSH:$2,rotlSL:k2,rotlBH:U2,rotlBL:L2,add:F2,add3L:M2,add3H:j2,add4L:H2,add4H:q2,add5H:V2,add5L:z2},[G2,K2]=se.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Vn=new Uint32Array(80),Gn=new Uint32Array(80);let Q2=class extends P2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:h,Fl:f,Gh:d,Gl:g,Hh:p,Hl:w}=this;return[e,t,n,s,i,o,a,c,u,l,h,f,d,g,p,w]}set(e,t,n,s,i,o,a,c,u,l,h,f,d,g,p,w){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=h|0,this.Fl=f|0,this.Gh=d|0,this.Gl=g|0,this.Hh=p|0,this.Hl=w|0}process(e,t){for(let I=0;I<16;I++,t+=4)Vn[I]=e.getUint32(t),Gn[I]=e.getUint32(t+=4);for(let I=16;I<80;I++){const P=Vn[I-15]|0,O=Gn[I-15]|0,b=se.rotrSH(P,O,1)^se.rotrSH(P,O,8)^se.shrSH(P,O,7),x=se.rotrSL(P,O,1)^se.rotrSL(P,O,8)^se.shrSL(P,O,7),S=Vn[I-2]|0,C=Gn[I-2]|0,R=se.rotrSH(S,C,19)^se.rotrBH(S,C,61)^se.shrSH(S,C,6),L=se.rotrSL(S,C,19)^se.rotrBL(S,C,61)^se.shrSL(S,C,6),M=se.add4L(x,L,Gn[I-7],Gn[I-16]),V=se.add4H(M,b,R,Vn[I-7],Vn[I-16]);Vn[I]=V|0,Gn[I]=M|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:h,El:f,Fh:d,Fl:g,Gh:p,Gl:w,Hh:E,Hl:A}=this;for(let I=0;I<80;I++){const P=se.rotrSH(h,f,14)^se.rotrSH(h,f,18)^se.rotrBH(h,f,41),O=se.rotrSL(h,f,14)^se.rotrSL(h,f,18)^se.rotrBL(h,f,41),b=h&d^~h&p,x=f&g^~f&w,S=se.add5L(A,O,x,K2[I],Gn[I]),C=se.add5H(S,E,P,b,G2[I],Vn[I]),R=S|0,L=se.rotrSH(n,s,28)^se.rotrBH(n,s,34)^se.rotrBH(n,s,39),M=se.rotrSL(n,s,28)^se.rotrBL(n,s,34)^se.rotrBL(n,s,39),V=n&i^n&a^i&a,$=s&o^s&c^o&c;E=p|0,A=w|0,p=d|0,w=g|0,d=h|0,g=f|0,{h,l:f}=se.add(u|0,l|0,C|0,R|0),u=a|0,l=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const m=se.add3L(R,M,$);n=se.add3H(m,C,L,V),s=m|0}({h:n,l:s}=se.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=se.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=se.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=se.add(this.Dh|0,this.Dl|0,u|0,l|0),{h,l:f}=se.add(this.Eh|0,this.El|0,h|0,f|0),{h:d,l:g}=se.add(this.Fh|0,this.Fl|0,d|0,g|0),{h:p,l:w}=se.add(this.Gh|0,this.Gl|0,p|0,w|0),{h:E,l:A}=se.add(this.Hh|0,this.Hl|0,E|0,A|0),this.set(n,s,i,o,a,c,u,l,h,f,d,g,p,w,E,A)}roundClean(){Vn.fill(0),Gn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const W2=A2(()=>new Q2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Kd=BigInt(0),Cb=BigInt(1),J2=BigInt(2);function Qd(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Wd(r){if(!Qd(r))throw new Error("Uint8Array expected")}function yh(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const Y2=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Jd(r){Wd(r);let e="";for(let t=0;t<r.length;t++)e+=Y2[r[t]];return e}function _b(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Kd:BigInt("0x"+r)}const hn={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ag(r){if(r>=hn._0&&r<=hn._9)return r-hn._0;if(r>=hn.A&&r<=hn.F)return r-(hn.A-10);if(r>=hn.a&&r<=hn.f)return r-(hn.a-10)}function Nb(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=Ag(r.charCodeAt(i)),a=Ag(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Z2(r){return _b(Jd(r))}function ku(r){return Wd(r),_b(Jd(Uint8Array.from(r).reverse()))}function Tb(r,e){return Nb(r.toString(16).padStart(e*2,"0"))}function Pf(r,e){return Tb(r,e).reverse()}function fn(r,e,t){let n;if(typeof e=="string")try{n=Nb(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Qd(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Ig(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Wd(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const mh=r=>typeof r=="bigint"&&Kd<=r;function X2(r,e,t){return mh(r)&&mh(e)&&mh(t)&&e<=r&&r<t}function ja(r,e,t,n){if(!X2(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function eI(r){let e;for(e=0;r>Kd;r>>=Cb,e+=1);return e}const tI=r=>(J2<<BigInt(r-1))-Cb,rI={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Qd(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Yd(r,e,t={}){const n=(s,i,o)=>{const a=rI[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function Pg(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const rt=BigInt(0),Ue=BigInt(1),Us=BigInt(2),nI=BigInt(3),xf=BigInt(4),xg=BigInt(5),Og=BigInt(8);function Qe(r,e){const t=r%e;return t>=rt?t:e+t}function sI(r,e,t){if(e<rt)throw new Error("invalid exponent, negatives unsupported");if(t<=rt)throw new Error("invalid modulus");if(t===Ue)return rt;let n=Ue;for(;e>rt;)e&Ue&&(n=n*r%t),r=r*r%t,e>>=Ue;return n}function Fr(r,e,t){let n=r;for(;e-- >rt;)n*=n,n%=t;return n}function Sg(r,e){if(r===rt)throw new Error("invert: expected non-zero number");if(e<=rt)throw new Error("invert: expected positive modulus, got "+e);let t=Qe(r,e),n=e,s=rt,i=Ue;for(;t!==rt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==Ue)throw new Error("invert: does not exist");return Qe(s,e)}function iI(r){const e=(r-Ue)/Us;let t,n,s;for(t=r-Ue,n=0;t%Us===rt;t/=Us,n++);for(s=Us;s<r&&sI(s,e,r)!==r-Ue;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+Ue)/xf;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(t+Ue)/Us;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,s),t),l=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let f=1;for(let g=o.sqr(h);f<c&&!o.eql(g,o.ONE);f++)g=o.sqr(g);const d=o.pow(u,Ue<<BigInt(c-f-1));u=o.sqr(d),l=o.mul(l,d),h=o.mul(h,u),c=f}return l}}function oI(r){if(r%xf===nI){const e=(r+Ue)/xf;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%Og===xg){const e=(r-xg)/Og;return function(t,n){const s=t.mul(n,Us),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,Us),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return iI(r)}const aI=(r,e)=>(Qe(r,e)&Ue)===Ue,cI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function uI(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=cI.reduce((n,s)=>(n[s]="function",n),e);return Yd(r,t)}function lI(r,e,t){if(t<rt)throw new Error("invalid exponent, negatives unsupported");if(t===rt)return r.ONE;if(t===Ue)return e;let n=r.ONE,s=e;for(;t>rt;)t&Ue&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Ue;return n}function hI(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function Rb(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Bb(r,e,t=!1,n={}){if(r<=rt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=Rb(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:tI(s),ZERO:rt,ONE:Ue,create:c=>Qe(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return rt<=c&&c<r},is0:c=>c===rt,isOdd:c=>(c&Ue)===Ue,neg:c=>Qe(-c,r),eql:(c,u)=>c===u,sqr:c=>Qe(c*c,r),add:(c,u)=>Qe(c+u,r),sub:(c,u)=>Qe(c-u,r),mul:(c,u)=>Qe(c*u,r),pow:(c,u)=>lI(a,c,u),div:(c,u)=>Qe(c*Sg(u,r),r),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Sg(c,r),sqrt:n.sqrt||(c=>(o||(o=oI(r)),o(a,c))),invertBatch:c=>hI(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>t?Pf(c,i):Tb(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?ku(c):Z2(c)}});return Object.freeze(a)}const Dg=BigInt(0),du=BigInt(1);function wh(r,e){const t=e.negate();return r?t:e}function $b(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function bh(r,e){$b(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function fI(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function dI(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const vh=new WeakMap,kb=new WeakMap;function Eh(r){return kb.get(r)||1}function pI(r,e){return{constTimeNegate:wh,hasPrecomputes(t){return Eh(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>Dg;)n&du&&(s=s.add(i)),i=i.double(),n>>=du;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=bh(n,e),o=[];let a=t,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=bh(t,e);let a=r.ZERO,c=r.BASE;const u=BigInt(2**t-1),l=2**t,h=BigInt(t);for(let f=0;f<i;f++){const d=f*o;let g=Number(s&u);s>>=h,g>o&&(g-=l,s+=du);const p=d,w=d+Math.abs(g)-1,E=f%2!==0,A=g<0;g===0?c=c.add(wh(E,n[p])):a=a.add(wh(A,n[w]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=bh(t,e),c=BigInt(2**t-1),u=2**t,l=BigInt(t);for(let h=0;h<o;h++){const f=h*a;if(s===Dg)break;let d=Number(s&c);if(s>>=l,d>a&&(d-=u,s+=du),d===0)continue;let g=n[f+Math.abs(d)-1];d<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(t,n,s){let i=vh.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&vh.set(n,s(i))),i},wNAFCached(t,n,s){const i=Eh(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Eh(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){$b(n,e),kb.set(t,n),vh.delete(t)}}}function gI(r,e,t,n){if(fI(t,r),dI(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=eI(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let h=u;h>=0;h-=o){c.fill(s);for(let d=0;d<n.length;d++){const g=n[d],p=Number(g>>BigInt(h)&BigInt(a));c[p]=c[p].add(t[d])}let f=s;for(let d=c.length-1,g=s;d>0;d--)g=g.add(c[d]),f=f.add(g);if(l=l.add(f),h!==0)for(let d=0;d<o;d++)l=l.double()}return l}function yI(r){return uI(r.Fp),Yd(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Rb(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const br=BigInt(0),Tt=BigInt(1),pu=BigInt(2),mI=BigInt(8),wI={zip215:!0};function bI(r){const e=yI(r);return Yd(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function vI(r){const e=bI(r),{Fp:t,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,u=pu<<BigInt(a*8)-Tt,l=t.create,h=Bb(e.n,e.nBitLength),f=e.uvRatio||((m,v)=>{try{return{isValid:!0,value:t.sqrt(m*t.inv(v))}}catch{return{isValid:!1,value:br}}}),d=e.adjustScalarBytes||(m=>m),g=e.domain||((m,v,_)=>{if(yh("phflag",_),v.length||_)throw new Error("Contexts/pre-hash are not supported");return m});function p(m,v){ja("coordinate "+m,v,br,u)}function w(m){if(!(m instanceof I))throw new Error("ExtendedPoint expected")}const E=Pg((m,v)=>{const{ex:_,ey:B,ez:T}=m,U=m.is0();v==null&&(v=U?mI:t.inv(T));const z=l(_*v),G=l(B*v),J=l(T*v);if(U)return{x:br,y:Tt};if(J!==Tt)throw new Error("invZ was invalid");return{x:z,y:G}}),A=Pg(m=>{const{a:v,d:_}=e;if(m.is0())throw new Error("bad point: ZERO");const{ex:B,ey:T,ez:U,et:z}=m,G=l(B*B),J=l(T*T),K=l(U*U),ee=l(K*K),re=l(G*v),ce=l(K*l(re+J)),de=l(ee+l(_*l(G*J)));if(ce!==de)throw new Error("bad point: equation left != right (1)");const ne=l(B*T),Ne=l(U*z);if(ne!==Ne)throw new Error("bad point: equation left != right (2)");return!0});class I{constructor(v,_,B,T){this.ex=v,this.ey=_,this.ez=B,this.et=T,p("x",v),p("y",_),p("z",B),p("t",T),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof I)throw new Error("extended point not allowed");const{x:_,y:B}=v||{};return p("x",_),p("y",B),new I(_,B,Tt,l(_*B))}static normalizeZ(v){const _=t.invertBatch(v.map(B=>B.ez));return v.map((B,T)=>B.toAffine(_[T])).map(I.fromAffine)}static msm(v,_){return gI(I,h,v,_)}_setWindowSize(v){b.setWindowSize(this,v)}assertValidity(){A(this)}equals(v){w(v);const{ex:_,ey:B,ez:T}=this,{ex:U,ey:z,ez:G}=v,J=l(_*G),K=l(U*T),ee=l(B*G),re=l(z*T);return J===K&&ee===re}is0(){return this.equals(I.ZERO)}negate(){return new I(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:v}=e,{ex:_,ey:B,ez:T}=this,U=l(_*_),z=l(B*B),G=l(pu*l(T*T)),J=l(v*U),K=_+B,ee=l(l(K*K)-U-z),re=J+z,ce=re-G,de=J-z,ne=l(ee*ce),Ne=l(re*de),He=l(ee*de),Re=l(ce*re);return new I(ne,Ne,Re,He)}add(v){w(v);const{a:_,d:B}=e,{ex:T,ey:U,ez:z,et:G}=this,{ex:J,ey:K,ez:ee,et:re}=v;if(_===BigInt(-1)){const jp=l((U-T)*(K+J)),Hp=l((U+T)*(K-J)),ah=l(Hp-jp);if(ah===br)return this.double();const qp=l(z*pu*re),zp=l(G*pu*ee),Vp=zp+qp,Gp=Hp+jp,Kp=zp-qp,P1=l(Vp*ah),x1=l(Gp*Kp),O1=l(Vp*Kp),S1=l(ah*Gp);return new I(P1,x1,S1,O1)}const ce=l(T*J),de=l(U*K),ne=l(G*B*re),Ne=l(z*ee),He=l((T+U)*(J+K)-ce-de),Re=Ne-ne,_e=Ne+ne,Ge=l(de-_*ce),un=l(He*Re),uu=l(_e*Ge),A1=l(He*Ge),I1=l(Re*_e);return new I(un,uu,I1,A1)}subtract(v){return this.add(v.negate())}wNAF(v){return b.wNAFCached(this,v,I.normalizeZ)}multiply(v){const _=v;ja("scalar",_,Tt,n);const{p:B,f:T}=this.wNAF(_);return I.normalizeZ([B,T])[0]}multiplyUnsafe(v,_=I.ZERO){const B=v;return ja("scalar",B,br,n),B===br?O:this.is0()||B===Tt?this:b.wNAFCachedUnsafe(this,B,I.normalizeZ,_)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return b.unsafeLadder(this,n).is0()}toAffine(v){return E(this,v)}clearCofactor(){const{h:v}=e;return v===Tt?this:this.multiplyUnsafe(v)}static fromHex(v,_=!1){const{d:B,a:T}=e,U=t.BYTES;v=fn("pointHex",v,U),yh("zip215",_);const z=v.slice(),G=v[U-1];z[U-1]=G&-129;const J=ku(z),K=_?u:t.ORDER;ja("pointHex.y",J,br,K);const ee=l(J*J),re=l(ee-Tt),ce=l(B*ee-T);let{isValid:de,value:ne}=f(re,ce);if(!de)throw new Error("Point.fromHex: invalid y coordinate");const Ne=(ne&Tt)===Tt,He=(G&128)!==0;if(!_&&ne===br&&He)throw new Error("Point.fromHex: x=0 and x_0=1");return He!==Ne&&(ne=l(-ne)),I.fromAffine({x:ne,y:J})}static fromPrivateKey(v){return C(v).point}toRawBytes(){const{x:v,y:_}=this.toAffine(),B=Pf(_,t.BYTES);return B[B.length-1]|=v&Tt?128:0,B}toHex(){return Jd(this.toRawBytes())}}I.BASE=new I(e.Gx,e.Gy,Tt,l(e.Gx*e.Gy)),I.ZERO=new I(br,Tt,Tt,br);const{BASE:P,ZERO:O}=I,b=pI(I,a*8);function x(m){return Qe(m,n)}function S(m){return x(ku(m))}function C(m){const v=t.BYTES;m=fn("private key",m,v);const _=fn("hashed private key",i(m),2*v),B=d(_.slice(0,v)),T=_.slice(v,2*v),U=S(B),z=P.multiply(U),G=z.toRawBytes();return{head:B,prefix:T,scalar:U,point:z,pointBytes:G}}function R(m){return C(m).pointBytes}function L(m=new Uint8Array,...v){const _=Ig(...v);return S(i(g(_,fn("context",m),!!s)))}function M(m,v,_={}){m=fn("message",m),s&&(m=s(m));const{prefix:B,scalar:T,pointBytes:U}=C(v),z=L(_.context,B,m),G=P.multiply(z).toRawBytes(),J=L(_.context,G,U,m),K=x(z+J*T);ja("signature.s",K,br,n);const ee=Ig(G,Pf(K,t.BYTES));return fn("result",ee,t.BYTES*2)}const V=wI;function $(m,v,_,B=V){const{context:T,zip215:U}=B,z=t.BYTES;m=fn("signature",m,2*z),v=fn("message",v),_=fn("publicKey",_,z),U!==void 0&&yh("zip215",U),s&&(v=s(v));const G=ku(m.slice(z,2*z));let J,K,ee;try{J=I.fromHex(_,U),K=I.fromHex(m.slice(0,z),U),ee=P.multiplyUnsafe(G)}catch{return!1}if(!U&&J.isSmallOrder())return!1;const re=L(T,K.toRawBytes(),J.toRawBytes(),v);return K.add(J.multiplyUnsafe(re)).subtract(ee).clearCofactor().equals(I.ZERO)}return P._setWindowSize(8),{CURVE:e,getPublicKey:R,sign:M,verify:$,ExtendedPoint:I,utils:{getExtendedPublicKey:C,randomPrivateKey:()=>o(t.BYTES),precompute(m=8,v=I.BASE){return v._setWindowSize(m),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const Zd=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Cg=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const EI=BigInt(1),_g=BigInt(2);BigInt(3);const AI=BigInt(5),II=BigInt(8);function PI(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=Zd,o=r*r%i*r%i,a=Fr(o,_g,i)*o%i,c=Fr(a,EI,i)*r%i,u=Fr(c,AI,i)*c%i,l=Fr(u,e,i)*u%i,h=Fr(l,t,i)*l%i,f=Fr(h,n,i)*h%i,d=Fr(f,s,i)*f%i,g=Fr(d,s,i)*f%i,p=Fr(g,e,i)*u%i;return{pow_p_5_8:Fr(p,_g,i)*r%i,b2:o}}function xI(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function OI(r,e){const t=Zd,n=Qe(e*e*e,t),s=Qe(n*n*e,t),i=PI(r*s).pow_p_5_8;let o=Qe(r*n*i,t);const a=Qe(e*o*o,t),c=o,u=Qe(o*Cg,t),l=a===r,h=a===Qe(-r,t),f=a===Qe(-r*Cg,t);return l&&(o=c),(h||f)&&(o=u),aI(o,t)&&(o=Qe(-o,t)),{isValid:l||h,value:o}}const SI=Bb(Zd,void 0,!0),DI={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:SI,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:II,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:W2,randomBytes:Sb,adjustScalarBytes:xI,uvRatio:OI},Ub=vI(DI),CI="EdDSA",_I="JWT",tl=".",Nl="base64url",Lb="utf8",Fb="utf8",NI=":",TI="did",RI="key",Ng="base58btc",BI="z",$I="K36",kI=32;function Xd(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Mb(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Xd(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function jb(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=Mb(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return Xd(t)}function UI(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,w=0,E=0,A=g.length;E!==A&&g[E]===0;)E++,p++;for(var I=(A-E)*l+1>>>0,P=new Uint8Array(I);E!==A;){for(var O=g[E],b=0,x=I-1;(O!==0||b<w)&&x!==-1;x--,b++)O+=256*P[x]>>>0,P[x]=O%a>>>0,O=O/a>>>0;if(O!==0)throw new Error("Non-zero carry");w=b,E++}for(var S=I-w;S!==I&&P[S]===0;)S++;for(var C=c.repeat(p);S<I;++S)C+=r.charAt(P[S]);return C}function f(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var w=0,E=0;g[p]===c;)w++,p++;for(var A=(g.length-p)*u+1>>>0,I=new Uint8Array(A);g[p];){var P=t[g.charCodeAt(p)];if(P===255)return;for(var O=0,b=A-1;(P!==0||O<E)&&b!==-1;b--,O++)P+=a*I[b]>>>0,I[b]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");E=O,p++}if(g[p]!==" "){for(var x=A-E;x!==A&&I[x]===0;)x++;for(var S=new Uint8Array(w+(A-x)),C=w;x!==A;)S[C++]=I[x++];return S}}}function d(g){var p=f(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var LI=UI,FI=LI;const Hb=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},MI=r=>new TextEncoder().encode(r),jI=r=>new TextDecoder().decode(r);let HI=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},qI=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return qb(this,e)}},zI=class{constructor(e){this.decoders=e}or(e){return qb(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const qb=(r,e)=>new zI({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let VI=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new HI(e,t,n),this.decoder=new qI(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Tl=({name:r,prefix:e,encode:t,decode:n})=>new VI(r,e,t,n),zc=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=FI(t,e);return Tl({prefix:r,name:e,encode:n,decode:i=>Hb(s(i))})},GI=(r,e,t,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const h=s[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},KI=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},dt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Tl({prefix:e,name:r,encode(s){return KI(s,n,t)},decode(s){return GI(s,n,t,r)}}),QI=Tl({prefix:"\0",name:"identity",encode:r=>jI(r),decode:r=>MI(r)});var WI=Object.freeze({__proto__:null,identity:QI});const JI=dt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var YI=Object.freeze({__proto__:null,base2:JI});const ZI=dt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var XI=Object.freeze({__proto__:null,base8:ZI});const eP=zc({prefix:"9",name:"base10",alphabet:"0123456789"});var tP=Object.freeze({__proto__:null,base10:eP});const rP=dt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),nP=dt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sP=Object.freeze({__proto__:null,base16:rP,base16upper:nP});const iP=dt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),oP=dt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),aP=dt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),cP=dt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),uP=dt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),lP=dt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),hP=dt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fP=dt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),dP=dt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var pP=Object.freeze({__proto__:null,base32:iP,base32upper:oP,base32pad:aP,base32padupper:cP,base32hex:uP,base32hexupper:lP,base32hexpad:hP,base32hexpadupper:fP,base32z:dP});const gP=zc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yP=zc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var mP=Object.freeze({__proto__:null,base36:gP,base36upper:yP});const wP=zc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),bP=zc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var vP=Object.freeze({__proto__:null,base58btc:wP,base58flickr:bP});const EP=dt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),AP=dt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),IP=dt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),PP=dt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var xP=Object.freeze({__proto__:null,base64:EP,base64pad:AP,base64url:IP,base64urlpad:PP});const zb=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),OP=zb.reduce((r,e,t)=>(r[t]=e,r),[]),SP=zb.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function DP(r){return r.reduce((e,t)=>(e+=OP[t],e),"")}function CP(r){const e=[];for(const t of r){const n=SP[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const _P=Tl({prefix:"🚀",name:"base256emoji",encode:DP,decode:CP});var NP=Object.freeze({__proto__:null,base256emoji:_P}),TP=Vb,Tg=128,RP=-128,BP=Math.pow(2,31);function Vb(r,e,t){e=e||[],t=t||0;for(var n=t;r>=BP;)e[t++]=r&255|Tg,r/=128;for(;r&RP;)e[t++]=r&255|Tg,r>>>=7;return e[t]=r|0,Vb.bytes=t-n+1,e}var $P=Of,kP=128,Rg=127;function Of(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw Of.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&Rg)<<s:(o&Rg)*Math.pow(2,s),s+=7}while(o>=kP);return Of.bytes=i-n,t}var UP=Math.pow(2,7),LP=Math.pow(2,14),FP=Math.pow(2,21),MP=Math.pow(2,28),jP=Math.pow(2,35),HP=Math.pow(2,42),qP=Math.pow(2,49),zP=Math.pow(2,56),VP=Math.pow(2,63),GP=function(r){return r<UP?1:r<LP?2:r<FP?3:r<MP?4:r<jP?5:r<HP?6:r<qP?7:r<zP?8:r<VP?9:10},KP={encode:TP,decode:$P,encodingLength:GP},Gb=KP;const Bg=(r,e,t=0)=>(Gb.encode(r,e,t),e),$g=r=>Gb.encodingLength(r),Sf=(r,e)=>{const t=e.byteLength,n=$g(r),s=n+$g(t),i=new Uint8Array(s+t);return Bg(r,i,0),Bg(t,i,n),i.set(e,s),new QP(r,t,e,i)};let QP=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};const Kb=({name:r,code:e,encode:t})=>new WP(r,e,t);let WP=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Sf(this.code,t):t.then(n=>Sf(this.code,n))}else throw Error("Unknown type, must be binary type")}};const Qb=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),JP=Kb({name:"sha2-256",code:18,encode:Qb("SHA-256")}),YP=Kb({name:"sha2-512",code:19,encode:Qb("SHA-512")});var ZP=Object.freeze({__proto__:null,sha256:JP,sha512:YP});const Wb=0,XP="identity",Jb=Hb,ex=r=>Sf(Wb,Jb(r)),tx={code:Wb,name:XP,encode:Jb,digest:ex};var rx=Object.freeze({__proto__:null,identity:tx});new TextEncoder,new TextDecoder;const kg={...WI,...YI,...XI,...tP,...sP,...pP,...mP,...vP,...xP,...NP};({...ZP,...rx});function Yb(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const Ug=Yb("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ah=Yb("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Mb(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Zb={utf8:Ug,"utf-8":Ug,hex:kg.base16,latin1:Ah,ascii:Ah,binary:Ah,...kg};function Rl(r,e="utf8"){const t=Zb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function Ca(r,e="utf8"){const t=Zb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Xd(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function Lg(r){return Ai(Rl(Ca(r,Nl),Lb))}function rl(r){return Rl(Ca(Hn(r),Lb),Nl)}function Xb(r){const e=Ca($I,Ng),t=BI+Rl(jb([e,r]),Ng);return[TI,RI,t].join(NI)}function nx(r){return Rl(r,Nl)}function sx(r){return Ca(r,Nl)}function ix(r){return Ca([rl(r.header),rl(r.payload)].join(tl),Fb)}function ox(r){return[rl(r.header),rl(r.payload),nx(r.signature)].join(tl)}function Df(r){const e=r.split(tl),t=Lg(e[0]),n=Lg(e[1]),s=sx(e[2]),i=Ca(e.slice(0,2).join(tl),Fb);return{header:t,payload:n,signature:s,data:i}}function Fg(r=Sb(kI)){const e=Ub.getPublicKey(r);return{secretKey:jb([r,e]),publicKey:e}}async function ax(r,e,t,n,s=Q.fromMiliseconds(Date.now())){const i={alg:CI,typ:_I},o=Xb(n.publicKey),a=s+t,c={iss:o,sub:r,aud:e,iat:s,exp:a},u=ix({header:i,payload:c}),l=Ub.sign(u,n.secretKey.slice(0,32));return ox({header:i,payload:c,signature:l})}function e0(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function oc(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=e0(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return t}function cx(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,w=0,E=0,A=g.length;E!==A&&g[E]===0;)E++,p++;for(var I=(A-E)*l+1>>>0,P=new Uint8Array(I);E!==A;){for(var O=g[E],b=0,x=I-1;(O!==0||b<w)&&x!==-1;x--,b++)O+=256*P[x]>>>0,P[x]=O%a>>>0,O=O/a>>>0;if(O!==0)throw new Error("Non-zero carry");w=b,E++}for(var S=I-w;S!==I&&P[S]===0;)S++;for(var C=c.repeat(p);S<I;++S)C+=r.charAt(P[S]);return C}function f(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var w=0,E=0;g[p]===c;)w++,p++;for(var A=(g.length-p)*u+1>>>0,I=new Uint8Array(A);g[p];){var P=t[g.charCodeAt(p)];if(P===255)return;for(var O=0,b=A-1;(P!==0||O<E)&&b!==-1;b--,O++)P+=a*I[b]>>>0,I[b]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");E=O,p++}if(g[p]!==" "){for(var x=A-E;x!==A&&I[x]===0;)x++;for(var S=new Uint8Array(w+(A-x)),C=w;x!==A;)S[C++]=I[x++];return S}}}function d(g){var p=f(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var ux=cx,lx=ux;const hx=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},fx=r=>new TextEncoder().encode(r),dx=r=>new TextDecoder().decode(r);class px{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class gx{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return t0(this,e)}}class yx{constructor(e){this.decoders=e}or(e){return t0(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const t0=(r,e)=>new yx({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class mx{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new px(e,t,n),this.decoder=new gx(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Bl=({name:r,prefix:e,encode:t,decode:n})=>new mx(r,e,t,n),Vc=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=lx(t,e);return Bl({prefix:r,name:e,encode:n,decode:i=>hx(s(i))})},wx=(r,e,t,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const h=s[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},bx=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},pt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Bl({prefix:e,name:r,encode(s){return bx(s,n,t)},decode(s){return wx(s,n,t,r)}}),vx=Bl({prefix:"\0",name:"identity",encode:r=>dx(r),decode:r=>fx(r)}),Ex=Object.freeze(Object.defineProperty({__proto__:null,identity:vx},Symbol.toStringTag,{value:"Module"})),Ax=pt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ix=Object.freeze(Object.defineProperty({__proto__:null,base2:Ax},Symbol.toStringTag,{value:"Module"})),Px=pt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),xx=Object.freeze(Object.defineProperty({__proto__:null,base8:Px},Symbol.toStringTag,{value:"Module"})),Ox=Vc({prefix:"9",name:"base10",alphabet:"0123456789"}),Sx=Object.freeze(Object.defineProperty({__proto__:null,base10:Ox},Symbol.toStringTag,{value:"Module"})),Dx=pt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Cx=pt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),_x=Object.freeze(Object.defineProperty({__proto__:null,base16:Dx,base16upper:Cx},Symbol.toStringTag,{value:"Module"})),Nx=pt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Tx=pt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rx=pt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bx=pt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$x=pt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kx=pt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ux=pt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Lx=pt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fx=pt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Mx=Object.freeze(Object.defineProperty({__proto__:null,base32:Nx,base32hex:$x,base32hexpad:Ux,base32hexpadupper:Lx,base32hexupper:kx,base32pad:Rx,base32padupper:Bx,base32upper:Tx,base32z:Fx},Symbol.toStringTag,{value:"Module"})),jx=Vc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hx=Vc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),qx=Object.freeze(Object.defineProperty({__proto__:null,base36:jx,base36upper:Hx},Symbol.toStringTag,{value:"Module"})),zx=Vc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vx=Vc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Gx=Object.freeze(Object.defineProperty({__proto__:null,base58btc:zx,base58flickr:Vx},Symbol.toStringTag,{value:"Module"})),Kx=pt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Qx=pt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Wx=pt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Jx=pt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Yx=Object.freeze(Object.defineProperty({__proto__:null,base64:Kx,base64pad:Qx,base64url:Wx,base64urlpad:Jx},Symbol.toStringTag,{value:"Module"})),r0=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Zx=r0.reduce((r,e,t)=>(r[t]=e,r),[]),Xx=r0.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function eO(r){return r.reduce((e,t)=>(e+=Zx[t],e),"")}function tO(r){const e=[];for(const t of r){const n=Xx[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const rO=Bl({prefix:"🚀",name:"base256emoji",encode:eO,decode:tO}),nO=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:rO},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Mg={...Ex,...Ix,...xx,...Sx,..._x,...Mx,...qx,...Gx,...Yx,...nO};function n0(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const jg=n0("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ih=n0("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=e0(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),s0={utf8:jg,"utf-8":jg,hex:Mg.base16,latin1:Ih,ascii:Ih,binary:Ih,...Mg};function yr(r,e="utf8"){const t=s0[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function jt(r,e="utf8"){const t=s0[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const sO={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var iO={};const oO=":";function Eo(r){const[e,t]=r.split(oO);return{namespace:e,reference:t}}function Hg(r,e=[]){const t=[];return Object.keys(r).forEach(n=>{if(e.length&&!e.includes(n))return;const s=r[n];t.push(...s.accounts)}),t}function i0(r,e){return r.includes(":")?[r]:e.chains||[]}var aO=Object.defineProperty,cO=Object.defineProperties,uO=Object.getOwnPropertyDescriptors,qg=Object.getOwnPropertySymbols,lO=Object.prototype.hasOwnProperty,hO=Object.prototype.propertyIsEnumerable,zg=(r,e,t)=>e in r?aO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vg=(r,e)=>{for(var t in e||(e={}))lO.call(e,t)&&zg(r,t,e[t]);if(qg)for(var t of qg(e))hO.call(e,t)&&zg(r,t,e[t]);return r},fO=(r,e)=>cO(r,uO(e));const dO="ReactNative",tr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},pO="js";function nl(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ss(){return!vi.getDocument()&&!!vi.getNavigator()&&navigator.product===dO}function gO(){return Ss()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function yO(){return Ss()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Gc(){return!nl()&&!!vi.getNavigator()&&!!vi.getDocument()}function Kc(){return Ss()?tr.reactNative:nl()?tr.node:Gc()?tr.browser:tr.unknown}function Gg(){var r;try{return Ss()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function mO(r,e){const t=new URLSearchParams(r);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const s=e[n];s!==void 0&&t.set(n,s)}return t.toString()}function wO(r){var e,t;const n=o0();try{return r!=null&&r.url&&n.url&&r.url!==n.url&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r==null?void 0:r.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(s=>s!=="")),fO(Vg(Vg({},n),r),{url:(r==null?void 0:r.url)||n.url,name:(r==null?void 0:r.name)||n.name,description:(r==null?void 0:r.description)||n.description,icons:(t=r==null?void 0:r.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),r||n}}function o0(){return PA.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function bO(){if(Kc()===tr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:n}=global.Platform;return[t,n].join("-")}const r=H1();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function vO(){var r;const e=Kc();return e===tr.browser?[e,((r=vi.getLocation())==null?void 0:r.host)||"unknown"].join(":"):e}function a0(r,e,t){const n=bO(),s=vO();return[[r,e].join("-"),[pO,t].join("-"),n,s].join("/")}function EO({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=t.split("?"),l=a0(r,e,n),h={auth:s,ua:l,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},f=mO(u[1]||"",h);return u[0]+"?"+f}function Vs(r,e){return r.filter(t=>e.includes(t)).length===r.length}function Cf(r){return Object.fromEntries(r.entries())}function _f(r){return new Map(Object.entries(r))}function Bs(r=Q.FIVE_MINUTES,e){const t=Q.toMiliseconds(r||Q.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},t),n=a,s=c})}}function vs(r,e,t){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await r;n(o)}catch(o){s(o)}clearTimeout(i)})}function c0(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function AO(r){return c0("topic",r)}function IO(r){return c0("id",r)}function u0(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function Ke(r,e){return Q.fromMiliseconds(Date.now()+Q.toMiliseconds(r))}function es(r){return Date.now()>=Q.toMiliseconds(r)}function we(r,e){return`${r}${e?`:${e}`:""}`}function Uu(r=[],e=[]){return[...new Set([...r,...e])]}async function PO({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=xO(i,r,e),a=Kc();if(a===tr.browser){if(!((n=vi.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}OO(o)}else a===tr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function xO(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const i=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${_O(n,!0)}`}else s=`${s}/wc?${n}`;return s}function OO(r){let e="_self";CO()?e="_top":(DO()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function SO(r,e){let t="";try{if(Gc()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function Kg(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function Qg(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function ep(){return typeof process<"u"&&iO.IS_VITEST==="true"}function DO(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function CO(){try{return window.self!==window.top}catch{return!1}}function _O(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function l0(r){return Buffer.from(r,"base64").toString("utf-8")}function NO(r){return new Promise(e=>setTimeout(e,r))}function gc(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function TO(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Qc(r,...e){if(!TO(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function tp(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");gc(r.outputLen),gc(r.blockLen)}function fa(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function h0(r,e){Qc(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const gu=BigInt(2**32-1),Wg=BigInt(32);function RO(r,e=!1){return e?{h:Number(r&gu),l:Number(r>>Wg&gu)}:{h:Number(r>>Wg&gu)|0,l:Number(r&gu)|0}}function BO(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=RO(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const $O=(r,e,t)=>r<<t|e>>>32-t,kO=(r,e,t)=>e<<t|r>>>32-t,UO=(r,e,t)=>e<<t-32|r>>>64-t,LO=(r,e,t)=>r<<t-32|e>>>64-t,ji=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function FO(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Ph(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Mr(r,e){return r<<32-e|r>>>e}const Jg=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function MO(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function Yg(r){for(let e=0;e<r.length;e++)r[e]=MO(r[e])}function jO(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function da(r){return typeof r=="string"&&(r=jO(r)),Qc(r),r}function HO(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Qc(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let rp=class{clone(){return this._cloneInto()}};function f0(r){const e=n=>r().update(da(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function _a(r=32){if(ji&&typeof ji.getRandomValues=="function")return ji.getRandomValues(new Uint8Array(r));if(ji&&typeof ji.randomBytes=="function")return ji.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const d0=[],p0=[],g0=[],qO=BigInt(0),Ha=BigInt(1),zO=BigInt(2),VO=BigInt(7),GO=BigInt(256),KO=BigInt(113);for(let r=0,e=Ha,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],d0.push(2*(5*n+t)),p0.push((r+1)*(r+2)/2%64);let s=qO;for(let i=0;i<7;i++)e=(e<<Ha^(e>>VO)*KO)%GO,e&zO&&(s^=Ha<<(Ha<<BigInt(i))-Ha);g0.push(s)}const[QO,WO]=BO(g0,!0),Zg=(r,e,t)=>t>32?UO(r,e,t):$O(r,e,t),Xg=(r,e,t)=>t>32?LO(r,e,t):kO(r,e,t);function JO(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=t[c],l=t[c+1],h=Zg(u,l,1)^t[a],f=Xg(u,l,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=p0[o],c=Zg(s,i,a),u=Xg(s,i,a),l=d0[o];s=r[l],i=r[l+1],r[l]=c,r[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=QO[n],r[1]^=WO[n]}t.fill(0)}let YO=class y0 extends rp{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,gc(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=FO(this.state)}keccak(){Jg||Yg(this.state32),JO(this.state32,this.rounds),Jg||Yg(this.state32),this.posOut=0,this.pos=0}update(e){fa(this);const{blockLen:t,state:n}=this;e=da(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){fa(this,!1),Qc(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return gc(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(h0(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new y0(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const ZO=(r,e,t)=>f0(()=>new YO(e,r,t)),XO=ZO(1,136,256/8),eS="https://rpc.walletconnect.org/v1";function m0(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Buffer.from(XO(t)).toString("hex")}async function tS(r,e,t,n,s,i){switch(t.t){case"eip191":return await rS(r,e,t.s);case"eip1271":return await nS(r,e,t.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function rS(r,e,t){return(await f2({hash:m0(e),signature:t})).toLowerCase()===r.toLowerCase()}async function nS(r,e,t,n,s,i){const o=Eo(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",u="0000000000000000000000000000000000000000000000000000000000000041",l=t.substring(2),h=m0(e).substring(2),f=a+h+c+u+l,d=await fetch(`${i||eS}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:sS(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:f},"latest"]})}),{result:g}=await d.json();return g?g.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function sS(){return Date.now()+Math.floor(Math.random()*1e3)}function iS(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Buffer.from(r,"base64").slice(1,65);return g2.encode(i)}var oS=Object.defineProperty,aS=Object.defineProperties,cS=Object.getOwnPropertyDescriptors,ey=Object.getOwnPropertySymbols,uS=Object.prototype.hasOwnProperty,lS=Object.prototype.propertyIsEnumerable,ty=(r,e,t)=>e in r?oS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hS=(r,e)=>{for(var t in e||(e={}))uS.call(e,t)&&ty(r,t,e[t]);if(ey)for(var t of ey(e))lS.call(e,t)&&ty(r,t,e[t]);return r},fS=(r,e)=>aS(r,cS(e));const dS="did:pkh:",np=r=>r==null?void 0:r.split(":"),pS=r=>{const e=r&&np(r);if(e)return r.includes(dS)?e[3]:e[1]},Nf=r=>{const e=r&&np(r);if(e)return e[2]+":"+e[3]},sl=r=>{const e=r&&np(r);if(e)return e.pop()};async function ry(r){const{cacao:e,projectId:t}=r,{s:n,p:s}=e,i=w0(s,s.iss),o=sl(s.iss);return await tS(o,i,n,Nf(s.iss),t)}const w0=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=sl(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const i=`URI: ${r.aud||r.uri}`,o=`Version: ${r.version}`,a=`Chain ID: ${pS(e)}`,c=`Nonce: ${r.nonce}`,u=`Issued At: ${r.iat}`,l=r.exp?`Expiration Time: ${r.exp}`:void 0,h=r.nbf?`Not Before: ${r.nbf}`:void 0,f=r.requestId?`Request ID: ${r.requestId}`:void 0,d=r.resources?`Resources:${r.resources.map(p=>`
- ${p}`).join("")}`:void 0,g=Lu(r.resources);if(g){const p=yc(g);s=IS(s,p)}return[t,n,"",s,"",i,o,a,c,u,l,h,f,d].filter(p=>p!=null).join(`
`)};function gS(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function yS(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function Ii(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function mS(r,e,t,n={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[r]:wS(e,t,n)}}}function wS(r,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...n)}function b0(r){return Ii(r),`urn:recap:${gS(r).replace(/=/g,"")}`}function yc(r){const e=yS(r.replace("urn:recap:",""));return Ii(e),e}function bS(r,e,t){const n=mS(r,e,t);return b0(n)}function vS(r){return r&&r.includes("urn:recap:")}function ES(r,e){const t=yc(r),n=yc(e),s=AS(t,n);return b0(s)}function AS(r,e){Ii(r),Ii(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=r.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,u;n.att[s]=fS(hS({},n.att[s]),{[a]:((c=r.att[s])==null?void 0:c[a])||((u=e.att[s])==null?void 0:u[a])})})}),n}function IS(r="",e){Ii(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,f)=>h.action.localeCompare(f.action));const u={};c.forEach(h=>{u[h.ability]||(u[h.ability]=[]),u[h.ability].push(h.action)});const l=Object.keys(u).map(h=>(s++,`(${s}) '${h}': '${u[h].join("', '")}' for '${a}'.`));n.push(l.join(", ").replace(".,","."))});const i=n.join(" "),o=`${t}${i}`;return`${r?r+" ":""}${o}`}function ny(r){var e;const t=yc(r);Ii(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function sy(r){const e=yc(r);Ii(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function Lu(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return vS(e)?e:void 0}function xh(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function v0(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function er(r,...e){if(!v0(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function iy(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function PS(r,e){er(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function oy(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}const As=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),xS=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),OS=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!OS)throw new Error("Non little-endian hardware is not supported");function SS(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function Tf(r){if(typeof r=="string")r=SS(r);else if(v0(r))r=Rf(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function DS(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function CS(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const _S=(r,e)=>{function t(n,...s){if(er(n),r.nonceLength!==void 0){const u=s[0];if(!u)throw new Error("nonce / iv required");r.varSizeNonce?er(u):er(u,r.nonceLength)}const i=r.tagLength;i&&s[1]!==void 0&&er(s[1]);const o=e(n,...s),a=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");er(l)}};let c=!1;return{encrypt(u,l){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,er(u),a(o.encrypt.length,l),o.encrypt(u,l)},decrypt(u,l){if(er(u),i&&u.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,l),o.decrypt(u,l)}}}return Object.assign(t,r),t};function ay(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!NS(e))throw new Error("invalid output, must be aligned");return e}function cy(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i);r.setUint32(e+4,o,n),r.setUint32(e+0,a,n)}function NS(r){return r.byteOffset%4===0}function Rf(r){return Uint8Array.from(r)}function pa(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}const E0=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),TS=E0("expand 16-byte k"),RS=E0("expand 32-byte k"),BS=As(TS),$S=As(RS);function pe(r,e){return r<<e|r>>>32-e}function Bf(r){return r.byteOffset%4===0}const yu=64,kS=16,A0=2**32-1,uy=new Uint32Array;function US(r,e,t,n,s,i,o,a){const c=s.length,u=new Uint8Array(yu),l=As(u),h=Bf(s)&&Bf(i),f=h?As(s):uy,d=h?As(i):uy;for(let g=0;g<c;o++){if(r(e,t,n,l,o,a),o>=A0)throw new Error("arx: counter overflow");const p=Math.min(yu,c-g);if(h&&p===yu){const w=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let E=0,A;E<kS;E++)A=w+E,d[A]=f[A]^l[E];g+=yu;continue}for(let w=0,E;w<p;w++)E=g+w,i[E]=s[E]^u[w];g+=p}}function LS(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=DS({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return xh(s),xh(o),oy(i),oy(t),(a,c,u,l,h=0)=>{er(a),er(c),er(u);const f=u.length;if(l===void 0&&(l=new Uint8Array(f)),er(l),xh(h),h<0||h>=A0)throw new Error("arx: counter overflow");if(l.length<f)throw new Error(`arx: output (${l.length}) is shorter than data (${f})`);const d=[];let g=a.length,p,w;if(g===32)d.push(p=Rf(a)),w=$S;else if(g===16&&t)p=new Uint8Array(32),p.set(a),p.set(a,16),w=BS,d.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);Bf(c)||d.push(c=Rf(c));const E=As(p);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(w,E,As(c.subarray(0,16)),E),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const P=new Uint8Array(12);P.set(c,i?0:12-c.length),c=P,d.push(c)}const I=As(c);return US(r,w,E,I,u,l,h,o),pa(...d),l}}const it=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class FS{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Tf(e),er(e,32);const t=it(e,0),n=it(e,2),s=it(e,4),i=it(e,6),o=it(e,8),a=it(e,10),c=it(e,12),u=it(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=it(e,16+2*l)}process(e,t,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],u=o[2],l=o[3],h=o[4],f=o[5],d=o[6],g=o[7],p=o[8],w=o[9],E=it(e,t+0),A=it(e,t+2),I=it(e,t+4),P=it(e,t+6),O=it(e,t+8),b=it(e,t+10),x=it(e,t+12),S=it(e,t+14);let C=i[0]+(E&8191),R=i[1]+((E>>>13|A<<3)&8191),L=i[2]+((A>>>10|I<<6)&8191),M=i[3]+((I>>>7|P<<9)&8191),V=i[4]+((P>>>4|O<<12)&8191),$=i[5]+(O>>>1&8191),m=i[6]+((O>>>14|b<<2)&8191),v=i[7]+((b>>>11|x<<5)&8191),_=i[8]+((x>>>8|S<<8)&8191),B=i[9]+(S>>>5|s),T=0,U=T+C*a+R*(5*w)+L*(5*p)+M*(5*g)+V*(5*d);T=U>>>13,U&=8191,U+=$*(5*f)+m*(5*h)+v*(5*l)+_*(5*u)+B*(5*c),T+=U>>>13,U&=8191;let z=T+C*c+R*a+L*(5*w)+M*(5*p)+V*(5*g);T=z>>>13,z&=8191,z+=$*(5*d)+m*(5*f)+v*(5*h)+_*(5*l)+B*(5*u),T+=z>>>13,z&=8191;let G=T+C*u+R*c+L*a+M*(5*w)+V*(5*p);T=G>>>13,G&=8191,G+=$*(5*g)+m*(5*d)+v*(5*f)+_*(5*h)+B*(5*l),T+=G>>>13,G&=8191;let J=T+C*l+R*u+L*c+M*a+V*(5*w);T=J>>>13,J&=8191,J+=$*(5*p)+m*(5*g)+v*(5*d)+_*(5*f)+B*(5*h),T+=J>>>13,J&=8191;let K=T+C*h+R*l+L*u+M*c+V*a;T=K>>>13,K&=8191,K+=$*(5*w)+m*(5*p)+v*(5*g)+_*(5*d)+B*(5*f),T+=K>>>13,K&=8191;let ee=T+C*f+R*h+L*l+M*u+V*c;T=ee>>>13,ee&=8191,ee+=$*a+m*(5*w)+v*(5*p)+_*(5*g)+B*(5*d),T+=ee>>>13,ee&=8191;let re=T+C*d+R*f+L*h+M*l+V*u;T=re>>>13,re&=8191,re+=$*c+m*a+v*(5*w)+_*(5*p)+B*(5*g),T+=re>>>13,re&=8191;let ce=T+C*g+R*d+L*f+M*h+V*l;T=ce>>>13,ce&=8191,ce+=$*u+m*c+v*a+_*(5*w)+B*(5*p),T+=ce>>>13,ce&=8191;let de=T+C*p+R*g+L*d+M*f+V*h;T=de>>>13,de&=8191,de+=$*l+m*u+v*c+_*a+B*(5*w),T+=de>>>13,de&=8191;let ne=T+C*w+R*p+L*g+M*d+V*f;T=ne>>>13,ne&=8191,ne+=$*h+m*l+v*u+_*c+B*a,T+=ne>>>13,ne&=8191,T=(T<<2)+T|0,T=T+U|0,U=T&8191,T=T>>>13,z+=T,i[0]=U,i[1]=z,i[2]=G,i[3]=J,i[4]=K,i[5]=ee,i[6]=re,i[7]=ce,i[8]=de,i[9]=ne}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;pa(n)}update(e){iy(this);const{buffer:t,blockLen:n}=this;e=Tf(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){pa(this.h,this.r,this.buffer,this.pad)}digestInto(e){iy(this),PS(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function MS(r){const e=(n,s)=>r(s).update(Tf(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const jS=MS(r=>new FS(r));function HS(r,e,t,n,s,i=20){let o=r[0],a=r[1],c=r[2],u=r[3],l=e[0],h=e[1],f=e[2],d=e[3],g=e[4],p=e[5],w=e[6],E=e[7],A=s,I=t[0],P=t[1],O=t[2],b=o,x=a,S=c,C=u,R=l,L=h,M=f,V=d,$=g,m=p,v=w,_=E,B=A,T=I,U=P,z=O;for(let J=0;J<i;J+=2)b=b+R|0,B=pe(B^b,16),$=$+B|0,R=pe(R^$,12),b=b+R|0,B=pe(B^b,8),$=$+B|0,R=pe(R^$,7),x=x+L|0,T=pe(T^x,16),m=m+T|0,L=pe(L^m,12),x=x+L|0,T=pe(T^x,8),m=m+T|0,L=pe(L^m,7),S=S+M|0,U=pe(U^S,16),v=v+U|0,M=pe(M^v,12),S=S+M|0,U=pe(U^S,8),v=v+U|0,M=pe(M^v,7),C=C+V|0,z=pe(z^C,16),_=_+z|0,V=pe(V^_,12),C=C+V|0,z=pe(z^C,8),_=_+z|0,V=pe(V^_,7),b=b+L|0,z=pe(z^b,16),v=v+z|0,L=pe(L^v,12),b=b+L|0,z=pe(z^b,8),v=v+z|0,L=pe(L^v,7),x=x+M|0,B=pe(B^x,16),_=_+B|0,M=pe(M^_,12),x=x+M|0,B=pe(B^x,8),_=_+B|0,M=pe(M^_,7),S=S+V|0,T=pe(T^S,16),$=$+T|0,V=pe(V^$,12),S=S+V|0,T=pe(T^S,8),$=$+T|0,V=pe(V^$,7),C=C+R|0,U=pe(U^C,16),m=m+U|0,R=pe(R^m,12),C=C+R|0,U=pe(U^C,8),m=m+U|0,R=pe(R^m,7);let G=0;n[G++]=o+b|0,n[G++]=a+x|0,n[G++]=c+S|0,n[G++]=u+C|0,n[G++]=l+R|0,n[G++]=h+L|0,n[G++]=f+M|0,n[G++]=d+V|0,n[G++]=g+$|0,n[G++]=p+m|0,n[G++]=w+v|0,n[G++]=E+_|0,n[G++]=A+B|0,n[G++]=I+T|0,n[G++]=P+U|0,n[G++]=O+z|0}const qS=LS(HS,{counterRight:!1,counterLength:4,allowShortKeys:!1}),zS=new Uint8Array(16),ly=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(zS.subarray(t))},VS=new Uint8Array(32);function hy(r,e,t,n,s){const i=r(e,t,VS),o=jS.create(i);s&&ly(o,s),ly(o,n);const a=new Uint8Array(16),c=xS(a);cy(c,0,BigInt(s?s.length:0),!0),cy(c,8,BigInt(n.length),!0),o.update(a);const u=o.digest();return pa(i,a),u}const GS=r=>(e,t,n)=>({encrypt(s,i){const o=s.length;i=ay(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);r(e,t,a,a,1);const c=hy(r,e,t,a,n);return i.set(c,o),pa(c),i},decrypt(s,i){i=ay(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=hy(r,e,t,o,n);if(!CS(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),r(e,t,i,i,1),pa(c),i}}),I0=_S({blockSize:64,nonceLength:12,tagLength:16},GS(qS));let P0=class extends rp{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,tp(e);const n=da(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return fa(this),this.iHash.update(e),this}digestInto(e){fa(this),Qc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const $l=(r,e,t)=>new P0(r,e).update(t).digest();$l.create=(r,e)=>new P0(r,e);function KS(r,e,t){return tp(r),t===void 0&&(t=new Uint8Array(r.outputLen)),$l(r,da(t),da(e))}const Oh=new Uint8Array([0]),fy=new Uint8Array;function QS(r,e,t,n=32){if(tp(r),gc(n),n>255*r.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/r.outputLen);t===void 0&&(t=fy);const i=new Uint8Array(s*r.outputLen),o=$l.create(r,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let u=0;u<s;u++)Oh[0]=u+1,a.update(u===0?fy:c).update(t).update(Oh).digestInto(c),i.set(c,r.outputLen*u),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Oh.fill(0),i.slice(0,n)}const WS=(r,e,t,n,s)=>QS(r,KS(r,e,t),n,s);function JS(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,u=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+u,a,n)}function YS(r,e,t){return r&e^~r&t}function ZS(r,e,t){return r&e^r&t^e&t}let XS=class extends rp{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ph(this.buffer)}update(e){fa(this);const{view:t,buffer:n,blockLen:s}=this;e=da(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Ph(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){fa(this),h0(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;JS(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Ph(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,l[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const eD=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Kn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qn=new Uint32Array(64);class tD extends XS{constructor(){super(64,32,8,!1),this.A=Kn[0]|0,this.B=Kn[1]|0,this.C=Kn[2]|0,this.D=Kn[3]|0,this.E=Kn[4]|0,this.F=Kn[5]|0,this.G=Kn[6]|0,this.H=Kn[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Qn[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const f=Qn[h-15],d=Qn[h-2],g=Mr(f,7)^Mr(f,18)^f>>>3,p=Mr(d,17)^Mr(d,19)^d>>>10;Qn[h]=p+Qn[h-7]+g+Qn[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let h=0;h<64;h++){const f=Mr(a,6)^Mr(a,11)^Mr(a,25),d=l+f+YS(a,c,u)+eD[h]+Qn[h]|0,g=(Mr(n,2)^Mr(n,13)^Mr(n,22))+ZS(n,s,i)|0;l=u,u=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,s,i,o,a,c,u,l)}roundClean(){Qn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Wc=f0(()=>new tD);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const kl=BigInt(0),Ul=BigInt(1),rD=BigInt(2);function Pi(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Jc(r){if(!Pi(r))throw new Error("Uint8Array expected")}function ga(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const nD=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function ya(r){Jc(r);let e="";for(let t=0;t<r.length;t++)e+=nD[r[t]];return e}function fo(r){const e=r.toString(16);return e.length&1?"0"+e:e}function sp(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?kl:BigInt("0x"+r)}const dn={_0:48,_9:57,A:65,F:70,a:97,f:102};function dy(r){if(r>=dn._0&&r<=dn._9)return r-dn._0;if(r>=dn.A&&r<=dn.F)return r-(dn.A-10);if(r>=dn.a&&r<=dn.f)return r-(dn.a-10)}function ma(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=dy(r.charCodeAt(i)),a=dy(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function mi(r){return sp(ya(r))}function mc(r){return Jc(r),sp(ya(Uint8Array.from(r).reverse()))}function wa(r,e){return ma(r.toString(16).padStart(e*2,"0"))}function Ll(r,e){return wa(r,e).reverse()}function sD(r){return ma(fo(r))}function Xt(r,e,t){let n;if(typeof e=="string")try{n=ma(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Pi(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function wc(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Jc(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}function iD(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function oD(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const Sh=r=>typeof r=="bigint"&&kl<=r;function Fl(r,e,t){return Sh(r)&&Sh(e)&&Sh(t)&&e<=r&&r<t}function Ln(r,e,t,n){if(!Fl(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function x0(r){let e;for(e=0;r>kl;r>>=Ul,e+=1);return e}function aD(r,e){return r>>BigInt(e)&Ul}function cD(r,e,t){return r|(t?Ul:kl)<<BigInt(e)}const ip=r=>(rD<<BigInt(r-1))-Ul,Dh=r=>new Uint8Array(r),py=r=>Uint8Array.from(r);function O0(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Dh(r),s=Dh(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...l)=>t(s,n,...l),c=(l=Dh())=>{s=a(py([0]),l),n=a(),l.length!==0&&(s=a(py([1]),l),n=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const h=[];for(;l<e;){n=a();const f=n.slice();h.push(f),l+=n.length}return wc(...h)};return(l,h)=>{o(),c(l);let f;for(;!(f=h(u()));)c();return o(),f}}const uD={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Pi(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Na(r,e,t={}){const n=(s,i,o)=>{const a=uD[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const lD=()=>{throw new Error("not implemented")};function $f(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}var hD=Object.freeze({__proto__:null,isBytes:Pi,abytes:Jc,abool:ga,bytesToHex:ya,numberToHexUnpadded:fo,hexToNumber:sp,hexToBytes:ma,bytesToNumberBE:mi,bytesToNumberLE:mc,numberToBytesBE:wa,numberToBytesLE:Ll,numberToVarBytesBE:sD,ensureBytes:Xt,concatBytes:wc,equalBytes:iD,utf8ToBytes:oD,inRange:Fl,aInRange:Ln,bitLen:x0,bitGet:aD,bitSet:cD,bitMask:ip,createHmacDrbg:O0,validateObject:Na,notImplemented:lD,memoized:$f});const nt=BigInt(0),Le=BigInt(1),Ls=BigInt(2),fD=BigInt(3),kf=BigInt(4),gy=BigInt(5),yy=BigInt(8);function Lt(r,e){const t=r%e;return t>=nt?t:e+t}function S0(r,e,t){if(e<nt)throw new Error("invalid exponent, negatives unsupported");if(t<=nt)throw new Error("invalid modulus");if(t===Le)return nt;let n=Le;for(;e>nt;)e&Le&&(n=n*r%t),r=r*r%t,e>>=Le;return n}function Ir(r,e,t){let n=r;for(;e-- >nt;)n*=n,n%=t;return n}function Uf(r,e){if(r===nt)throw new Error("invert: expected non-zero number");if(e<=nt)throw new Error("invert: expected positive modulus, got "+e);let t=Lt(r,e),n=e,s=nt,i=Le;for(;t!==nt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==Le)throw new Error("invert: does not exist");return Lt(s,e)}function dD(r){const e=(r-Le)/Ls;let t,n,s;for(t=r-Le,n=0;t%Ls===nt;t/=Ls,n++);for(s=Ls;s<r&&S0(s,e,r)!==r-Le;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+Le)/kf;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(t+Le)/Ls;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,s),t),l=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let f=1;for(let g=o.sqr(h);f<c&&!o.eql(g,o.ONE);f++)g=o.sqr(g);const d=o.pow(u,Le<<BigInt(c-f-1));u=o.sqr(d),l=o.mul(l,d),h=o.mul(h,u),c=f}return l}}function pD(r){if(r%kf===fD){const e=(r+Le)/kf;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%yy===gy){const e=(r-gy)/yy;return function(t,n){const s=t.mul(n,Ls),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,Ls),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return dD(r)}const gD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function yD(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=gD.reduce((n,s)=>(n[s]="function",n),e);return Na(r,t)}function mD(r,e,t){if(t<nt)throw new Error("invalid exponent, negatives unsupported");if(t===nt)return r.ONE;if(t===Le)return e;let n=r.ONE,s=e;for(;t>nt;)t&Le&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Le;return n}function wD(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function D0(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function C0(r,e,t=!1,n={}){if(r<=nt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=D0(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:ip(s),ZERO:nt,ONE:Le,create:c=>Lt(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return nt<=c&&c<r},is0:c=>c===nt,isOdd:c=>(c&Le)===Le,neg:c=>Lt(-c,r),eql:(c,u)=>c===u,sqr:c=>Lt(c*c,r),add:(c,u)=>Lt(c+u,r),sub:(c,u)=>Lt(c-u,r),mul:(c,u)=>Lt(c*u,r),pow:(c,u)=>mD(a,c,u),div:(c,u)=>Lt(c*Uf(u,r),r),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Uf(c,r),sqrt:n.sqrt||(c=>(o||(o=pD(r)),o(a,c))),invertBatch:c=>wD(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>t?Ll(c,i):wa(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?mc(c):mi(c)}});return Object.freeze(a)}function _0(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function N0(r){const e=_0(r);return e+Math.ceil(e/2)}function bD(r,e,t=!1){const n=r.length,s=_0(e),i=N0(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?mc(r):mi(r),a=Lt(o,e-Le)+Le;return t?Ll(a,s):wa(a,s)}const my=BigInt(0),mu=BigInt(1);function Ch(r,e){const t=e.negate();return r?t:e}function T0(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function _h(r,e){T0(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function vD(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function ED(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const Nh=new WeakMap,R0=new WeakMap;function Th(r){return R0.get(r)||1}function AD(r,e){return{constTimeNegate:Ch,hasPrecomputes(t){return Th(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>my;)n&mu&&(s=s.add(i)),i=i.double(),n>>=mu;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=_h(n,e),o=[];let a=t,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=_h(t,e);let a=r.ZERO,c=r.BASE;const u=BigInt(2**t-1),l=2**t,h=BigInt(t);for(let f=0;f<i;f++){const d=f*o;let g=Number(s&u);s>>=h,g>o&&(g-=l,s+=mu);const p=d,w=d+Math.abs(g)-1,E=f%2!==0,A=g<0;g===0?c=c.add(Ch(E,n[p])):a=a.add(Ch(A,n[w]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=_h(t,e),c=BigInt(2**t-1),u=2**t,l=BigInt(t);for(let h=0;h<o;h++){const f=h*a;if(s===my)break;let d=Number(s&c);if(s>>=l,d>a&&(d-=u,s+=mu),d===0)continue;let g=n[f+Math.abs(d)-1];d<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(t,n,s){let i=Nh.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&Nh.set(n,s(i))),i},wNAFCached(t,n,s){const i=Th(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Th(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){T0(n,e),R0.set(t,n),Nh.delete(t)}}}function ID(r,e,t,n){if(vD(t,r),ED(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=x0(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let h=u;h>=0;h-=o){c.fill(s);for(let d=0;d<n.length;d++){const g=n[d],p=Number(g>>BigInt(h)&BigInt(a));c[p]=c[p].add(t[d])}let f=s;for(let d=c.length-1,g=s;d>0;d--)g=g.add(c[d]),f=f.add(g);if(l=l.add(f),h!==0)for(let d=0;d<o;d++)l=l.double()}return l}function B0(r){return yD(r.Fp),Na(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...D0(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Hi=BigInt(0),Rh=BigInt(1);function PD(r){return Na(r,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r})}function xD(r){const e=PD(r),{P:t}=e,n=A=>Lt(A,t),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(A=>A),c=e.powPminus2||(A=>S0(A,t-BigInt(2),t));function u(A,I,P){const O=n(A*(I-P));return I=n(I-O),P=n(P+O),[I,P]}const l=(e.a-BigInt(2))/BigInt(4);function h(A,I){Ln("u",A,Hi,t),Ln("scalar",I,Hi,t);const P=I,O=A;let b=Rh,x=Hi,S=A,C=Rh,R=Hi,L;for(let V=BigInt(s-1);V>=Hi;V--){const $=P>>V&Rh;R^=$,L=u(R,b,S),b=L[0],S=L[1],L=u(R,x,C),x=L[0],C=L[1],R=$;const m=b+x,v=n(m*m),_=b-x,B=n(_*_),T=v-B,U=S+C,z=S-C,G=n(z*m),J=n(U*_),K=G+J,ee=G-J;S=n(K*K),C=n(O*n(ee*ee)),b=n(v*B),x=n(T*(v+n(l*T)))}L=u(R,b,S),b=L[0],S=L[1],L=u(R,x,C),x=L[0],C=L[1];const M=c(x);return n(b*M)}function f(A){return Ll(n(A),i)}function d(A){const I=Xt("u coordinate",A,i);return o===32&&(I[31]&=127),mc(I)}function g(A){const I=Xt("scalar",A),P=I.length;if(P!==i&&P!==o){let O=""+i+" or "+o;throw new Error("invalid scalar, expected "+O+" bytes, got "+P)}return mc(a(I))}function p(A,I){const P=d(I),O=g(A),b=h(P,O);if(b===Hi)throw new Error("invalid private or public key received");return f(b)}const w=f(e.Gu);function E(A){return p(A,w)}return{scalarMult:p,scalarMultBase:E,getSharedSecret:(A,I)=>p(A,I),getPublicKey:A=>E(A),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:w}}const Lf=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const OD=BigInt(1),wy=BigInt(2),SD=BigInt(3),DD=BigInt(5);BigInt(8);function CD(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=Lf,o=r*r%i*r%i,a=Ir(o,wy,i)*o%i,c=Ir(a,OD,i)*r%i,u=Ir(c,DD,i)*c%i,l=Ir(u,e,i)*u%i,h=Ir(l,t,i)*l%i,f=Ir(h,n,i)*h%i,d=Ir(f,s,i)*f%i,g=Ir(d,s,i)*f%i,p=Ir(g,e,i)*u%i;return{pow_p_5_8:Ir(p,wy,i)*r%i,b2:o}}function _D(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const Ff=xD({P:Lf,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:r=>{const e=Lf,{pow_p_5_8:t,b2:n}=CD(r);return Lt(Ir(t,SD,e)*n,e)},adjustScalarBytes:_D,randomBytes:_a});function by(r){r.lowS!==void 0&&ga("lowS",r.lowS),r.prehash!==void 0&&ga("prehash",r.prehash)}function ND(r){const e=B0(r);Na(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:TD,hexToBytes:RD}=hD;class BD extends Error{constructor(e=""){super(e)}}const En={Err:BD,_tlv:{encode:(r,e)=>{const{Err:t}=En;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=fo(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?fo(s.length/2|128):"";return fo(r)+i+s+e},decode(r,e){const{Err:t}=En;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const u=e.subarray(n,n+c);if(u.length!==c)throw new t("tlv.decode: length bytes not complete");if(u[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=En;if(r<$n)throw new e("integer: negative integers are not allowed");let t=fo(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=En;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return TD(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=En,s=typeof r=="string"?RD(r):r;Jc(s);const{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:u,l}=n.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(u)}},hexFromSig(r){const{_tlv:e,_int:t}=En,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}},$n=BigInt(0),Xe=BigInt(1);BigInt(2);const vy=BigInt(3);BigInt(4);function $D(r){const e=ND(r),{Fp:t}=e,n=C0(e.n,e.nBitLength),s=e.toBytes||((p,w,E)=>{const A=w.toAffine();return wc(Uint8Array.from([4]),t.toBytes(A.x),t.toBytes(A.y))}),i=e.fromBytes||(p=>{const w=p.subarray(1),E=t.fromBytes(w.subarray(0,t.BYTES)),A=t.fromBytes(w.subarray(t.BYTES,2*t.BYTES));return{x:E,y:A}});function o(p){const{a:w,b:E}=e,A=t.sqr(p),I=t.mul(A,p);return t.add(t.add(I,t.mul(p,w)),E)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(p){return Fl(p,Xe,e.n)}function c(p){const{allowedPrivateKeyLengths:w,nByteLength:E,wrapPrivateKey:A,n:I}=e;if(w&&typeof p!="bigint"){if(Pi(p)&&(p=ya(p)),typeof p!="string"||!w.includes(p.length))throw new Error("invalid private key");p=p.padStart(E*2,"0")}let P;try{P=typeof p=="bigint"?p:mi(Xt("private key",p,E))}catch{throw new Error("invalid private key, expected hex or "+E+" bytes, got "+typeof p)}return A&&(P=Lt(P,I)),Ln("private key",P,Xe,I),P}function u(p){if(!(p instanceof f))throw new Error("ProjectivePoint expected")}const l=$f((p,w)=>{const{px:E,py:A,pz:I}=p;if(t.eql(I,t.ONE))return{x:E,y:A};const P=p.is0();w==null&&(w=P?t.ONE:t.inv(I));const O=t.mul(E,w),b=t.mul(A,w),x=t.mul(I,w);if(P)return{x:t.ZERO,y:t.ZERO};if(!t.eql(x,t.ONE))throw new Error("invZ was invalid");return{x:O,y:b}}),h=$f(p=>{if(p.is0()){if(e.allowInfinityPoint&&!t.is0(p.py))return;throw new Error("bad point: ZERO")}const{x:w,y:E}=p.toAffine();if(!t.isValid(w)||!t.isValid(E))throw new Error("bad point: x or y not FE");const A=t.sqr(E),I=o(w);if(!t.eql(A,I))throw new Error("bad point: equation left != right");if(!p.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class f{constructor(w,E,A){if(this.px=w,this.py=E,this.pz=A,w==null||!t.isValid(w))throw new Error("x required");if(E==null||!t.isValid(E))throw new Error("y required");if(A==null||!t.isValid(A))throw new Error("z required");Object.freeze(this)}static fromAffine(w){const{x:E,y:A}=w||{};if(!w||!t.isValid(E)||!t.isValid(A))throw new Error("invalid affine point");if(w instanceof f)throw new Error("projective point not allowed");const I=P=>t.eql(P,t.ZERO);return I(E)&&I(A)?f.ZERO:new f(E,A,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(w){const E=t.invertBatch(w.map(A=>A.pz));return w.map((A,I)=>A.toAffine(E[I])).map(f.fromAffine)}static fromHex(w){const E=f.fromAffine(i(Xt("pointHex",w)));return E.assertValidity(),E}static fromPrivateKey(w){return f.BASE.multiply(c(w))}static msm(w,E){return ID(f,n,w,E)}_setWindowSize(w){g.setWindowSize(this,w)}assertValidity(){h(this)}hasEvenY(){const{y:w}=this.toAffine();if(t.isOdd)return!t.isOdd(w);throw new Error("Field doesn't support isOdd")}equals(w){u(w);const{px:E,py:A,pz:I}=this,{px:P,py:O,pz:b}=w,x=t.eql(t.mul(E,b),t.mul(P,I)),S=t.eql(t.mul(A,b),t.mul(O,I));return x&&S}negate(){return new f(this.px,t.neg(this.py),this.pz)}double(){const{a:w,b:E}=e,A=t.mul(E,vy),{px:I,py:P,pz:O}=this;let b=t.ZERO,x=t.ZERO,S=t.ZERO,C=t.mul(I,I),R=t.mul(P,P),L=t.mul(O,O),M=t.mul(I,P);return M=t.add(M,M),S=t.mul(I,O),S=t.add(S,S),b=t.mul(w,S),x=t.mul(A,L),x=t.add(b,x),b=t.sub(R,x),x=t.add(R,x),x=t.mul(b,x),b=t.mul(M,b),S=t.mul(A,S),L=t.mul(w,L),M=t.sub(C,L),M=t.mul(w,M),M=t.add(M,S),S=t.add(C,C),C=t.add(S,C),C=t.add(C,L),C=t.mul(C,M),x=t.add(x,C),L=t.mul(P,O),L=t.add(L,L),C=t.mul(L,M),b=t.sub(b,C),S=t.mul(L,R),S=t.add(S,S),S=t.add(S,S),new f(b,x,S)}add(w){u(w);const{px:E,py:A,pz:I}=this,{px:P,py:O,pz:b}=w;let x=t.ZERO,S=t.ZERO,C=t.ZERO;const R=e.a,L=t.mul(e.b,vy);let M=t.mul(E,P),V=t.mul(A,O),$=t.mul(I,b),m=t.add(E,A),v=t.add(P,O);m=t.mul(m,v),v=t.add(M,V),m=t.sub(m,v),v=t.add(E,I);let _=t.add(P,b);return v=t.mul(v,_),_=t.add(M,$),v=t.sub(v,_),_=t.add(A,I),x=t.add(O,b),_=t.mul(_,x),x=t.add(V,$),_=t.sub(_,x),C=t.mul(R,v),x=t.mul(L,$),C=t.add(x,C),x=t.sub(V,C),C=t.add(V,C),S=t.mul(x,C),V=t.add(M,M),V=t.add(V,M),$=t.mul(R,$),v=t.mul(L,v),V=t.add(V,$),$=t.sub(M,$),$=t.mul(R,$),v=t.add(v,$),M=t.mul(V,v),S=t.add(S,M),M=t.mul(_,v),x=t.mul(m,x),x=t.sub(x,M),M=t.mul(m,V),C=t.mul(_,C),C=t.add(C,M),new f(x,S,C)}subtract(w){return this.add(w.negate())}is0(){return this.equals(f.ZERO)}wNAF(w){return g.wNAFCached(this,w,f.normalizeZ)}multiplyUnsafe(w){const{endo:E,n:A}=e;Ln("scalar",w,$n,A);const I=f.ZERO;if(w===$n)return I;if(this.is0()||w===Xe)return this;if(!E||g.hasPrecomputes(this))return g.wNAFCachedUnsafe(this,w,f.normalizeZ);let{k1neg:P,k1:O,k2neg:b,k2:x}=E.splitScalar(w),S=I,C=I,R=this;for(;O>$n||x>$n;)O&Xe&&(S=S.add(R)),x&Xe&&(C=C.add(R)),R=R.double(),O>>=Xe,x>>=Xe;return P&&(S=S.negate()),b&&(C=C.negate()),C=new f(t.mul(C.px,E.beta),C.py,C.pz),S.add(C)}multiply(w){const{endo:E,n:A}=e;Ln("scalar",w,Xe,A);let I,P;if(E){const{k1neg:O,k1:b,k2neg:x,k2:S}=E.splitScalar(w);let{p:C,f:R}=this.wNAF(b),{p:L,f:M}=this.wNAF(S);C=g.constTimeNegate(O,C),L=g.constTimeNegate(x,L),L=new f(t.mul(L.px,E.beta),L.py,L.pz),I=C.add(L),P=R.add(M)}else{const{p:O,f:b}=this.wNAF(w);I=O,P=b}return f.normalizeZ([I,P])[0]}multiplyAndAddUnsafe(w,E,A){const I=f.BASE,P=(b,x)=>x===$n||x===Xe||!b.equals(I)?b.multiplyUnsafe(x):b.multiply(x),O=P(this,E).add(P(w,A));return O.is0()?void 0:O}toAffine(w){return l(this,w)}isTorsionFree(){const{h:w,isTorsionFree:E}=e;if(w===Xe)return!0;if(E)return E(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:w,clearCofactor:E}=e;return w===Xe?this:E?E(f,this):this.multiplyUnsafe(e.h)}toRawBytes(w=!0){return ga("isCompressed",w),this.assertValidity(),s(f,this,w)}toHex(w=!0){return ga("isCompressed",w),ya(this.toRawBytes(w))}}f.BASE=new f(e.Gx,e.Gy,t.ONE),f.ZERO=new f(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,g=AD(f,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function kD(r){const e=B0(r);return Na(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function UD(r){const e=kD(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o($){return Lt($,n)}function a($){return Uf($,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=$D({...e,toBytes($,m,v){const _=m.toAffine(),B=t.toBytes(_.x),T=wc;return ga("isCompressed",v),v?T(Uint8Array.from([m.hasEvenY()?2:3]),B):T(Uint8Array.from([4]),B,t.toBytes(_.y))},fromBytes($){const m=$.length,v=$[0],_=$.subarray(1);if(m===s&&(v===2||v===3)){const B=mi(_);if(!Fl(B,Xe,t.ORDER))throw new Error("Point is not on curve");const T=l(B);let U;try{U=t.sqrt(T)}catch(G){const J=G instanceof Error?": "+G.message:"";throw new Error("Point is not on curve"+J)}const z=(U&Xe)===Xe;return(v&1)===1!==z&&(U=t.neg(U)),{x:B,y:U}}else if(m===i&&v===4){const B=t.fromBytes(_.subarray(0,t.BYTES)),T=t.fromBytes(_.subarray(t.BYTES,2*t.BYTES));return{x:B,y:T}}else{const B=s,T=i;throw new Error("invalid Point, expected length of "+B+", or uncompressed "+T+", got "+m)}}}),f=$=>ya(wa($,e.nByteLength));function d($){const m=n>>Xe;return $>m}function g($){return d($)?o(-$):$}const p=($,m,v)=>mi($.slice(m,v));class w{constructor(m,v,_){this.r=m,this.s=v,this.recovery=_,this.assertValidity()}static fromCompact(m){const v=e.nByteLength;return m=Xt("compactSignature",m,v*2),new w(p(m,0,v),p(m,v,2*v))}static fromDER(m){const{r:v,s:_}=En.toSig(Xt("DER",m));return new w(v,_)}assertValidity(){Ln("r",this.r,Xe,n),Ln("s",this.s,Xe,n)}addRecoveryBit(m){return new w(this.r,this.s,m)}recoverPublicKey(m){const{r:v,s:_,recovery:B}=this,T=b(Xt("msgHash",m));if(B==null||![0,1,2,3].includes(B))throw new Error("recovery id invalid");const U=B===2||B===3?v+e.n:v;if(U>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const z=(B&1)===0?"02":"03",G=c.fromHex(z+f(U)),J=a(U),K=o(-T*J),ee=o(_*J),re=c.BASE.multiplyAndAddUnsafe(G,K,ee);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return ma(this.toDERHex())}toDERHex(){return En.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ma(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const E={isValidPrivateKey($){try{return u($),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const $=N0(e.n);return bD(e.randomBytes($),e.n)},precompute($=8,m=c.BASE){return m._setWindowSize($),m.multiply(BigInt(3)),m}};function A($,m=!0){return c.fromPrivateKey($).toRawBytes(m)}function I($){const m=Pi($),v=typeof $=="string",_=(m||v)&&$.length;return m?_===s||_===i:v?_===2*s||_===2*i:$ instanceof c}function P($,m,v=!0){if(I($))throw new Error("first arg must be private key");if(!I(m))throw new Error("second arg must be public key");return c.fromHex(m).multiply(u($)).toRawBytes(v)}const O=e.bits2int||function($){if($.length>8192)throw new Error("input is too large");const m=mi($),v=$.length*8-e.nBitLength;return v>0?m>>BigInt(v):m},b=e.bits2int_modN||function($){return o(O($))},x=ip(e.nBitLength);function S($){return Ln("num < 2^"+e.nBitLength,$,$n,x),wa($,e.nByteLength)}function C($,m,v=R){if(["recovered","canonical"].some(de=>de in v))throw new Error("sign() legacy options not supported");const{hash:_,randomBytes:B}=e;let{lowS:T,prehash:U,extraEntropy:z}=v;T==null&&(T=!0),$=Xt("msgHash",$),by(v),U&&($=Xt("prehashed msgHash",_($)));const G=b($),J=u(m),K=[S(J),S(G)];if(z!=null&&z!==!1){const de=z===!0?B(t.BYTES):z;K.push(Xt("extraEntropy",de))}const ee=wc(...K),re=G;function ce(de){const ne=O(de);if(!h(ne))return;const Ne=a(ne),He=c.BASE.multiply(ne).toAffine(),Re=o(He.x);if(Re===$n)return;const _e=o(Ne*o(re+Re*J));if(_e===$n)return;let Ge=(He.x===Re?0:2)|Number(He.y&Xe),un=_e;return T&&d(_e)&&(un=g(_e),Ge^=1),new w(Re,un,Ge)}return{seed:ee,k2sig:ce}}const R={lowS:e.lowS,prehash:!1},L={lowS:e.lowS,prehash:!1};function M($,m,v=R){const{seed:_,k2sig:B}=C($,m,v),T=e;return O0(T.hash.outputLen,T.nByteLength,T.hmac)(_,B)}c.BASE._setWindowSize(8);function V($,m,v,_=L){var _e;const B=$;m=Xt("msgHash",m),v=Xt("publicKey",v);const{lowS:T,prehash:U,format:z}=_;if(by(_),"strict"in _)throw new Error("options.strict was renamed to lowS");if(z!==void 0&&z!=="compact"&&z!=="der")throw new Error("format must be compact or der");const G=typeof B=="string"||Pi(B),J=!G&&!z&&typeof B=="object"&&B!==null&&typeof B.r=="bigint"&&typeof B.s=="bigint";if(!G&&!J)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let K,ee;try{if(J&&(K=new w(B.r,B.s)),G){try{z!=="compact"&&(K=w.fromDER(B))}catch(Ge){if(!(Ge instanceof En.Err))throw Ge}!K&&z!=="der"&&(K=w.fromCompact(B))}ee=c.fromHex(v)}catch{return!1}if(!K||T&&K.hasHighS())return!1;U&&(m=e.hash(m));const{r:re,s:ce}=K,de=b(m),ne=a(ce),Ne=o(de*ne),He=o(re*ne),Re=(_e=c.BASE.multiplyAndAddUnsafe(ee,Ne,He))==null?void 0:_e.toAffine();return Re?o(Re.x)===re:!1}return{CURVE:e,getPublicKey:A,getSharedSecret:P,sign:M,verify:V,ProjectivePoint:c,Signature:w,utils:E}}function LD(r){return{hash:r,hmac:(e,...t)=>$l(r,e,HO(...t)),randomBytes:_a}}function FD(r,e){const t=n=>UD({...r,...LD(n)});return{...t(e),create:t}}const $0=C0(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),MD=$0.create(BigInt("-3")),jD=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),HD=FD({a:MD,b:jD,Fp:$0,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Wc),k0="base10",_t="base16",Rr="base64pad",rs="base64url",Yc="utf8",U0=0,Fn=1,Zc=2,qD=0,Ey=1,ac=12,op=32;function zD(){const r=Ff.utils.randomPrivateKey(),e=Ff.getPublicKey(r);return{privateKey:jt(r,_t),publicKey:jt(e,_t)}}function Mf(){const r=_a(op);return jt(r,_t)}function VD(r,e){const t=Ff.getSharedSecret(yr(r,_t),yr(e,_t)),n=WS(Wc,t,void 0,void 0,op);return jt(n,_t)}function Fu(r){const e=Wc(yr(r,_t));return jt(e,_t)}function rn(r){const e=Wc(yr(r,Yc));return jt(e,_t)}function L0(r){return yr(`${r}`,k0)}function xi(r){return Number(jt(r,k0))}function F0(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function M0(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function GD(r){const e=L0(typeof r.type<"u"?r.type:U0);if(xi(e)===Fn&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?yr(r.senderPublicKey,_t):void 0,n=typeof r.iv<"u"?yr(r.iv,_t):_a(ac),s=yr(r.symKey,_t),i=I0(s,n).encrypt(yr(r.message,Yc)),o=j0({type:e,sealed:i,iv:n,senderPublicKey:t});return r.encoding===rs?F0(o):o}function KD(r){const e=yr(r.symKey,_t),{sealed:t,iv:n}=bc({encoded:r.encoded,encoding:r.encoding}),s=I0(e,n).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return jt(s,Yc)}function QD(r,e){const t=L0(Zc),n=_a(ac),s=yr(r,Yc),i=j0({type:t,sealed:s,iv:n});return e===rs?F0(i):i}function WD(r,e){const{sealed:t}=bc({encoded:r,encoding:e});return jt(t,Yc)}function j0(r){if(xi(r.type)===Zc)return jt(oc([r.type,r.sealed]),Rr);if(xi(r.type)===Fn){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return jt(oc([r.type,r.senderPublicKey,r.iv,r.sealed]),Rr)}return jt(oc([r.type,r.iv,r.sealed]),Rr)}function bc(r){const e=(r.encoding||Rr)===rs?M0(r.encoded):r.encoded,t=yr(e,Rr),n=t.slice(qD,Ey),s=Ey;if(xi(n)===Fn){const c=s+op,u=c+ac,l=t.slice(s,c),h=t.slice(c,u),f=t.slice(u);return{type:n,sealed:f,iv:h,senderPublicKey:l}}if(xi(n)===Zc){const c=t.slice(s),u=_a(ac);return{type:n,sealed:c,iv:u}}const i=s+ac,o=t.slice(s,i),a=t.slice(i);return{type:n,sealed:a,iv:o}}function JD(r,e){const t=bc({encoded:r,encoding:e==null?void 0:e.encoding});return H0({type:xi(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?jt(t.senderPublicKey,_t):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function H0(r){const e=(r==null?void 0:r.type)||U0;if(e===Fn){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Ay(r){return r.type===Fn&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function Iy(r){return r.type===Zc}function YD(r){const e=Buffer.from(r.x,"base64"),t=Buffer.from(r.y,"base64");return oc([new Uint8Array([4]),e,t])}function ZD(r,e){const[t,n,s]=r.split("."),i=Buffer.from(M0(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${n}`,u=Wc(c),l=YD(e);if(!HD.verify(oc([o,a]),u,l))throw new Error("Invalid signature");return Df(r).payload}const XD="irn";function il(r){return(r==null?void 0:r.relay)||{protocol:XD}}function Ya(r){const e=sO[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}function eC(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=r[s];t[i]=o}}),t}function Py(r){if(!r.includes("wc:")){const u=l0(r);u!=null&&u.includes("wc:")&&(r=u)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),s=r.substring(e+1,t).split("@"),i=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(i),a={};o.forEach((u,l)=>{a[l]=u});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:tC(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:eC(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function tC(r){return r.startsWith("//")?r.substring(2):r}function rC(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(s=>{const i=s,o=t+e+i;r[i]&&(n[o]=r[i])}),n}function xy(r){const e=new URLSearchParams,t=rC(r.relay);Object.keys(t).sort().forEach(s=>{e.set(s,t[s])}),e.set("symKey",r.symKey),r.expiryTimestamp&&e.set("expiryTimestamp",r.expiryTimestamp.toString()),r.methods&&e.set("methods",r.methods.join(","));const n=e.toString();return`${r.protocol}:${r.topic}@${r.version}?${n}`}function wu(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function Ta(r){const e=[];return r.forEach(t=>{const[n,s]=t.split(":");e.push(`${n}:${s}`)}),e}function nC(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Ta(t.accounts))}),e}function sC(r,e){const t=[];return Object.values(r).forEach(n=>{Ta(n.accounts).includes(e)&&t.push(...n.methods)}),t}function iC(r,e){const t=[];return Object.values(r).forEach(n=>{Ta(n.accounts).includes(e)&&t.push(...n.events)}),t}function ap(r){return r.includes(":")}function Za(r){return ap(r)?r.split(":")[0]:r}function oC(r){const e={};return r==null||r.forEach(t=>{var n;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function Oy(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=oC(e);for(const[n,s]of Object.entries(t))s.methods?s.methods=Uu(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}const aC={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},cC={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function W(r,e){const{message:t,code:n}=cC[r];return{message:e?`${t} ${e}`:t,code:n}}function ve(r,e){const{message:t,code:n}=aC[r];return{message:e?`${t} ${e}`:t,code:n}}function Br(r,e){return!!Array.isArray(r)}function vc(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function ut(r){return typeof r>"u"}function ze(r,e){return e&&ut(r)?!0:typeof r=="string"&&!!r.trim().length}function cp(r,e){return e&&ut(r)?!0:typeof r=="number"&&!isNaN(r)}function uC(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),s=Object.keys(t);let i=!0;return Vs(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:u}=r.namespaces[o],l=Ta(a),h=t[o];(!Vs(i0(o,h),l)||!Vs(h.methods,c)||!Vs(h.events,u))&&(i=!1)}),i):!1}function ol(r){return ze(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function lC(r){if(ze(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&ol(t)}}return!1}function hC(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(ze(r,!1)){if(e(r))return!0;const t=l0(r);return e(t)}}catch{}return!1}function fC(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function dC(r){return r==null?void 0:r.topic}function pC(r,e){let t=null;return ze(r==null?void 0:r.publicKey,!1)||(t=W("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Sy(r){let e=!0;return Br(r)?r.length&&(e=r.every(t=>ze(t,!1))):e=!1,e}function gC(r,e,t){let n=null;return Br(e)&&e.length?e.forEach(s=>{n||ol(s)||(n=ve("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):ol(r)||(n=ve("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function yC(r,e,t){let n=null;return Object.entries(r).forEach(([s,i])=>{if(n)return;const o=gC(s,i0(s,i),`${e} ${t}`);o&&(n=o)}),n}function mC(r,e){let t=null;return Br(r)?r.forEach(n=>{t||lC(n)||(t=ve("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=ve("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function wC(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=mC(n==null?void 0:n.accounts,`${e} namespace`);s&&(t=s)}),t}function bC(r,e){let t=null;return Sy(r==null?void 0:r.methods)?Sy(r==null?void 0:r.events)||(t=ve("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=ve("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function q0(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=bC(n,`${e}, namespace`);s&&(t=s)}),t}function vC(r,e,t){let n=null;if(r&&vc(r)){const s=q0(r,e);s&&(n=s);const i=yC(r,e,t);i&&(n=i)}else n=W("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function Bh(r,e){let t=null;if(r&&vc(r)){const n=q0(r,e);n&&(t=n);const s=wC(r,e);s&&(t=s)}else t=W("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function z0(r){return ze(r.protocol,!0)}function EC(r,e){let t=!1;return r?r&&Br(r)&&r.length&&r.forEach(n=>{t=z0(n)}):t=!0,t}function AC(r){return typeof r=="number"}function $t(r){return typeof r<"u"&&typeof r!==null}function IC(r){return!(!r||typeof r!="object"||!r.code||!cp(r.code,!1)||!r.message||!ze(r.message,!1))}function PC(r){return!(ut(r)||!ze(r.method,!1))}function xC(r){return!(ut(r)||ut(r.result)&&ut(r.error)||!cp(r.id,!1)||!ze(r.jsonrpc,!1))}function OC(r){return!(ut(r)||!ze(r.name,!1))}function Dy(r,e){return!(!ol(e)||!nC(r).includes(e))}function SC(r,e,t){return ze(t,!1)?sC(r,e).includes(t):!1}function DC(r,e,t){return ze(t,!1)?iC(r,e).includes(t):!1}function Cy(r,e,t){let n=null;const s=CC(r),i=_C(e),o=Object.keys(s),a=Object.keys(i),c=_y(Object.keys(r)),u=_y(Object.keys(e)),l=c.filter(h=>!u.includes(h));return l.length&&(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${l.toString()}
      Received: ${Object.keys(e).toString()}`)),Vs(o,a)||(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||n)return;const f=Ta(e[h].accounts);f.includes(h)||(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${f.toString()}`))}),o.forEach(h=>{n||(Vs(s[h].methods,i[h].methods)?Vs(s[h].events,i[h].events)||(n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${h}`)):n=W("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${h}`))}),n}function CC(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function _y(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function _C(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=Ta(r[t].accounts);n==null||n.forEach(s=>{e[s]={accounts:r[t].accounts.filter(i=>i.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function NC(r,e){return cp(r,!1)&&r<=e.max&&r>=e.min}function Ny(){const r=Kc();return new Promise(e=>{switch(r){case tr.browser:e(TC());break;case tr.reactNative:e(RC());break;case tr.node:e(BC());break;default:e(!0)}})}function TC(){return Gc()&&(navigator==null?void 0:navigator.onLine)}async function RC(){if(Ss()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function BC(){return!0}function $C(r){switch(Kc()){case tr.browser:kC(r);break;case tr.reactNative:UC(r);break}}function kC(r){!Ss()&&Gc()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function UC(r){Ss()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const $h={};class qa{static get(e){return $h[e]}static set(e,t){$h[e]=t}static delete(e){delete $h[e]}}class Ri{}let LC=class extends Ri{constructor(e){super()}};const Ty=Q.FIVE_SECONDS,Ra={pulse:"heartbeat_pulse"};let FC=class V0 extends LC{constructor(e){super(e),this.events=new nr.EventEmitter,this.interval=Ty,this.interval=(e==null?void 0:e.interval)||Ty}static async init(e){const t=new V0(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Q.toMiliseconds(this.interval))}pulse(){this.events.emit(Ra.pulse)}};const MC=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,jC=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,HC=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function qC(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){zC(r);return}return e}function zC(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function bu(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!HC.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(MC.test(r)||jC.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,qC)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function VC(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function Ye(r,...e){try{return VC(r(...e))}catch(t){return Promise.reject(t)}}function GC(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function KC(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function Mu(r){if(GC(r))return String(r);if(KC(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return Mu(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const jf="base64:";function QC(r){return typeof r=="string"?r:jf+YC(r)}function WC(r){return typeof r!="string"||!r.startsWith(jf)?r:JC(r.slice(jf.length))}function JC(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function YC(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Bt(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function ZC(...r){return Bt(r.join(":"))}function vu(r){return r=Bt(r),r?r+":":""}function XC(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function e_(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const t_="memory",r_=()=>{const r=new Map;return{name:t_,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function n_(r={}){const e={mounts:{"":r.driver||r_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=u=>{for(const l of e.mountpoints)if(u.startsWith(l))return{base:l,relativeKey:u.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:u,driver:e.mounts[""]}},n=(u,l)=>e.mountpoints.filter(h=>h.startsWith(u)||l&&u.startsWith(h)).map(h=>({relativeBase:u.length>h.length?u.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(u,l)=>{if(e.watching){l=Bt(l);for(const h of e.watchListeners)h(u,l)}},i=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await Ry(e.mounts[u],s,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,l,h)=>{const f=new Map,d=g=>{let p=f.get(g.base);return p||(p={driver:g.driver,base:g.base,items:[]},f.set(g.base,p)),p};for(const g of u){const p=typeof g=="string",w=Bt(p?g:g.key),E=p?void 0:g.value,A=p||!g.options?l:{...l,...g.options},I=t(w);d(I).items.push({key:w,value:E,relativeKey:I.relativeKey,options:A})}return Promise.all([...f.values()].map(g=>h(g))).then(g=>g.flat())},c={hasItem(u,l={}){u=Bt(u);const{relativeKey:h,driver:f}=t(u);return Ye(f.hasItem,h,l)},getItem(u,l={}){u=Bt(u);const{relativeKey:h,driver:f}=t(u);return Ye(f.getItem,h,l).then(d=>bu(d))},getItems(u,l={}){return a(u,l,h=>h.driver.getItems?Ye(h.driver.getItems,h.items.map(f=>({key:f.relativeKey,options:f.options})),l).then(f=>f.map(d=>({key:ZC(h.base,d.key),value:bu(d.value)}))):Promise.all(h.items.map(f=>Ye(h.driver.getItem,f.relativeKey,f.options).then(d=>({key:f.key,value:bu(d)})))))},getItemRaw(u,l={}){u=Bt(u);const{relativeKey:h,driver:f}=t(u);return f.getItemRaw?Ye(f.getItemRaw,h,l):Ye(f.getItem,h,l).then(d=>WC(d))},async setItem(u,l,h={}){if(l===void 0)return c.removeItem(u);u=Bt(u);const{relativeKey:f,driver:d}=t(u);d.setItem&&(await Ye(d.setItem,f,Mu(l),h),d.watch||s("update",u))},async setItems(u,l){await a(u,l,async h=>{if(h.driver.setItems)return Ye(h.driver.setItems,h.items.map(f=>({key:f.relativeKey,value:Mu(f.value),options:f.options})),l);h.driver.setItem&&await Promise.all(h.items.map(f=>Ye(h.driver.setItem,f.relativeKey,Mu(f.value),f.options)))})},async setItemRaw(u,l,h={}){if(l===void 0)return c.removeItem(u,h);u=Bt(u);const{relativeKey:f,driver:d}=t(u);if(d.setItemRaw)await Ye(d.setItemRaw,f,l,h);else if(d.setItem)await Ye(d.setItem,f,QC(l),h);else return;d.watch||s("update",u)},async removeItem(u,l={}){typeof l=="boolean"&&(l={removeMeta:l}),u=Bt(u);const{relativeKey:h,driver:f}=t(u);f.removeItem&&(await Ye(f.removeItem,h,l),(l.removeMeta||l.removeMata)&&await Ye(f.removeItem,h+"$",l),f.watch||s("remove",u))},async getMeta(u,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),u=Bt(u);const{relativeKey:h,driver:f}=t(u),d=Object.create(null);if(f.getMeta&&Object.assign(d,await Ye(f.getMeta,h,l)),!l.nativeOnly){const g=await Ye(f.getItem,h+"$",l).then(p=>bu(p));g&&typeof g=="object"&&(typeof g.atime=="string"&&(g.atime=new Date(g.atime)),typeof g.mtime=="string"&&(g.mtime=new Date(g.mtime)),Object.assign(d,g))}return d},setMeta(u,l,h={}){return this.setItem(u+"$",l,h)},removeMeta(u,l={}){return this.removeItem(u+"$",l)},async getKeys(u,l={}){var w;u=vu(u);const h=n(u,!0);let f=[];const d=[];let g=!0;for(const E of h){(w=E.driver.flags)!=null&&w.maxDepth||(g=!1);const A=await Ye(E.driver.getKeys,E.relativeBase,l);for(const I of A){const P=E.mountpoint+Bt(I);f.some(O=>P.startsWith(O))||d.push(P)}f=[E.mountpoint,...f.filter(I=>!I.startsWith(E.mountpoint))]}const p=l.maxDepth!==void 0&&!g;return d.filter(E=>(!p||XC(E,l.maxDepth))&&e_(E,u))},async clear(u,l={}){u=vu(u),await Promise.all(n(u,!1).map(async h=>{if(h.driver.clear)return Ye(h.driver.clear,h.relativeBase,l);if(h.driver.removeItem){const f=await h.driver.getKeys(h.relativeBase||"",l);return Promise.all(f.map(d=>h.driver.removeItem(d,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>By(u)))},async watch(u){return await i(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,l){if(u=vu(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((h,f)=>f.length-h.length)),e.mounts[u]=l,e.watching&&Promise.resolve(Ry(l,s,u)).then(h=>{e.unwatch[u]=h}).catch(console.error),c},async unmount(u,l=!0){var h,f;u=vu(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&((f=(h=e.unwatch)[u])==null||f.call(h),delete e.unwatch[u]),l&&await By(e.mounts[u]),e.mountpoints=e.mountpoints.filter(d=>d!==u),delete e.mounts[u])},getMount(u=""){u=Bt(u)+":";const l=t(u);return{driver:l.driver,base:l.base}},getMounts(u="",l={}){return u=Bt(u),n(u,l.parents).map(f=>({driver:f.driver,base:f.mountpoint}))},keys:(u,l={})=>c.getKeys(u,l),get:(u,l={})=>c.getItem(u,l),set:(u,l,h={})=>c.setItem(u,l,h),has:(u,l={})=>c.hasItem(u,l),del:(u,l={})=>c.removeItem(u,l),remove:(u,l={})=>c.removeItem(u,l)};return c}function Ry(r,e,t){return r.watch?r.watch((n,s)=>e(n,t+s)):()=>{}}async function By(r){typeof r.dispose=="function"&&await Ye(r.dispose)}function Bi(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function G0(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const n=Bi(t);return(s,i)=>n.then(o=>i(o.transaction(e,s).objectStore(e)))}let kh;function Xc(){return kh||(kh=G0("keyval-store","keyval")),kh}function $y(r,e=Xc()){return e("readonly",t=>Bi(t.get(r)))}function s_(r,e,t=Xc()){return t("readwrite",n=>(n.put(e,r),Bi(n.transaction)))}function i_(r,e=Xc()){return e("readwrite",t=>(t.delete(r),Bi(t.transaction)))}function o_(r=Xc()){return r("readwrite",e=>(e.clear(),Bi(e.transaction)))}function a_(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Bi(r.transaction)}function c_(r=Xc()){return r("readonly",e=>{if(e.getAllKeys)return Bi(e.getAllKeys());const t=[];return a_(e,n=>t.push(n.key)).then(()=>t)})}const u_="idb-keyval";var l_=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let n;return r.dbName&&r.storeName&&(n=G0(r.dbName,r.storeName)),{name:u_,options:r,async hasItem(s){return!(typeof await $y(t(s),n)>"u")},async getItem(s){return await $y(t(s),n)??null},setItem(s,i){return s_(t(s),i,n)},removeItem(s){return i_(t(s),n)},getKeys(){return c_(n)},clear(){return o_(n)}}};const h_="WALLET_CONNECT_V2_INDEXED_DB",f_="keyvaluestorage";let d_=class{constructor(){this.indexedDb=n_({driver:l_({dbName:h_,storeName:f_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Hn(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Uh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ju={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Uh<"u"&&Uh.localStorage?ju.exports=Uh.localStorage:typeof window<"u"&&window.localStorage?ju.exports=window.localStorage:ju.exports=new e})();function p_(r){var e;return[r[0],Ai((e=r[1])!=null?e:"")]}let g_=class{constructor(){this.localStorage=ju.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(p_)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Ai(t)}async setItem(e,t){this.localStorage.setItem(e,Hn(t))}async removeItem(e){this.localStorage.removeItem(e)}};const y_="wc_storage_version",ky=1,m_=async(r,e,t)=>{const n=y_,s=await e.getItem(n);if(s&&s>=ky){t(e);return}const i=await r.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await r.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(n,ky),t(e),w_(r,o)},w_=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let b_=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new g_;this.storage=e;try{const t=new d_;m_(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Lh,Uy;function v_(){if(Uy)return Lh;Uy=1;function r(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Lh=e;function e(t,n,s){var i=s&&s.stringify||r,o=1;if(typeof t=="object"&&t!==null){var a=n.length+o;if(a===1)return t;var c=new Array(a);c[0]=i(t);for(var u=1;u<a;u++)c[u]=i(n[u]);return c.join(" ")}if(typeof t!="string")return t;var l=n.length;if(l===0)return t;for(var h="",f=1-o,d=-1,g=t&&t.length||0,p=0;p<g;){if(t.charCodeAt(p)===37&&p+1<g){switch(d=d>-1?d:0,t.charCodeAt(p+1)){case 100:case 102:if(f>=l||n[f]==null)break;d<p&&(h+=t.slice(d,p)),h+=Number(n[f]),d=p+2,p++;break;case 105:if(f>=l||n[f]==null)break;d<p&&(h+=t.slice(d,p)),h+=Math.floor(Number(n[f])),d=p+2,p++;break;case 79:case 111:case 106:if(f>=l||n[f]===void 0)break;d<p&&(h+=t.slice(d,p));var w=typeof n[f];if(w==="string"){h+="'"+n[f]+"'",d=p+2,p++;break}if(w==="function"){h+=n[f].name||"<anonymous>",d=p+2,p++;break}h+=i(n[f]),d=p+2,p++;break;case 115:if(f>=l)break;d<p&&(h+=t.slice(d,p)),h+=String(n[f]),d=p+2,p++;break;case 37:d<p&&(h+=t.slice(d,p)),h+="%",d=p+2,p++,f--;break}++f}++p}return d===-1?t:(d<g&&(h+=t.slice(d)),h)}return Lh}var Fh,Ly;function E_(){if(Ly)return Fh;Ly=1;const r=v_();Fh=s;const e=O().console||{},t={mapHttpRequest:g,mapHttpResponse:g,wrapRequestSerializer:p,wrapResponseSerializer:p,wrapErrorSerializer:p,req:g,res:g,err:f};function n(b,x){return Array.isArray(b)?b.filter(function(C){return C!=="!stdSerializers.err"}):b===!0?Object.keys(x):!1}function s(b){b=b||{},b.browser=b.browser||{};const x=b.browser.transmit;if(x&&typeof x.send!="function")throw Error("pino: transmit option must have a send function");const S=b.browser.write||e;b.browser.write&&(b.browser.asObject=!0);const C=b.serializers||{},R=n(b.browser.serialize,C);let L=b.browser.serialize;Array.isArray(b.browser.serialize)&&b.browser.serialize.indexOf("!stdSerializers.err")>-1&&(L=!1);const M=["error","fatal","warn","info","debug","trace"];typeof S=="function"&&(S.error=S.fatal=S.warn=S.info=S.debug=S.trace=S),b.enabled===!1&&(b.level="silent");const V=b.level||"info",$=Object.create(S);$.log||($.log=w),Object.defineProperty($,"levelVal",{get:v}),Object.defineProperty($,"level",{get:_,set:B});const m={transmit:x,serialize:R,asObject:b.browser.asObject,levels:M,timestamp:d(b)};$.levels=s.levels,$.level=V,$.setMaxListeners=$.getMaxListeners=$.emit=$.addListener=$.on=$.prependListener=$.once=$.prependOnceListener=$.removeListener=$.removeAllListeners=$.listeners=$.listenerCount=$.eventNames=$.write=$.flush=w,$.serializers=C,$._serialize=R,$._stdErrSerialize=L,$.child=T,x&&($._logEvent=h());function v(){return this.level==="silent"?1/0:this.levels.values[this.level]}function _(){return this._level}function B(U){if(U!=="silent"&&!this.levels.values[U])throw Error("unknown level "+U);this._level=U,i(m,$,"error","log"),i(m,$,"fatal","error"),i(m,$,"warn","error"),i(m,$,"info","log"),i(m,$,"debug","log"),i(m,$,"trace","log")}function T(U,z){if(!U)throw new Error("missing bindings for child Pino");z=z||{},R&&U.serializers&&(z.serializers=U.serializers);const G=z.serializers;if(R&&G){var J=Object.assign({},C,G),K=b.browser.serialize===!0?Object.keys(J):R;delete U.serializers,c([U],K,J,this._stdErrSerialize)}function ee(re){this._childLevel=(re._childLevel|0)+1,this.error=u(re,U,"error"),this.fatal=u(re,U,"fatal"),this.warn=u(re,U,"warn"),this.info=u(re,U,"info"),this.debug=u(re,U,"debug"),this.trace=u(re,U,"trace"),J&&(this.serializers=J,this._serialize=K),x&&(this._logEvent=h([].concat(re._logEvent.bindings,U)))}return ee.prototype=this,new ee(this)}return $}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=t,s.stdTimeFunctions=Object.assign({},{nullTime:E,epochTime:A,unixTime:I,isoTime:P});function i(b,x,S,C){const R=Object.getPrototypeOf(x);x[S]=x.levelVal>x.levels.values[S]?w:R[S]?R[S]:e[S]||e[C]||w,o(b,x,S)}function o(b,x,S){!b.transmit&&x[S]===w||(x[S]=function(C){return function(){const L=b.timestamp(),M=new Array(arguments.length),V=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var $=0;$<M.length;$++)M[$]=arguments[$];if(b.serialize&&!b.asObject&&c(M,this._serialize,this.serializers,this._stdErrSerialize),b.asObject?C.call(V,a(this,S,M,L)):C.apply(V,M),b.transmit){const m=b.transmit.level||x.level,v=s.levels.values[m],_=s.levels.values[S];if(_<v)return;l(this,{ts:L,methodLevel:S,methodValue:_,transmitValue:s.levels.values[b.transmit.level||x.level],send:b.transmit.send,val:x.levelVal},M)}}}(x[S]))}function a(b,x,S,C){b._serialize&&c(S,b._serialize,b.serializers,b._stdErrSerialize);const R=S.slice();let L=R[0];const M={};C&&(M.time=C),M.level=s.levels.values[x];let V=(b._childLevel|0)+1;if(V<1&&(V=1),L!==null&&typeof L=="object"){for(;V--&&typeof R[0]=="object";)Object.assign(M,R.shift());L=R.length?r(R.shift(),R):void 0}else typeof L=="string"&&(L=r(R.shift(),R));return L!==void 0&&(M.msg=L),M}function c(b,x,S,C){for(const R in b)if(C&&b[R]instanceof Error)b[R]=s.stdSerializers.err(b[R]);else if(typeof b[R]=="object"&&!Array.isArray(b[R]))for(const L in b[R])x&&x.indexOf(L)>-1&&L in S&&(b[R][L]=S[L](b[R][L]))}function u(b,x,S){return function(){const C=new Array(1+arguments.length);C[0]=x;for(var R=1;R<C.length;R++)C[R]=arguments[R-1];return b[S].apply(this,C)}}function l(b,x,S){const C=x.send,R=x.ts,L=x.methodLevel,M=x.methodValue,V=x.val,$=b._logEvent.bindings;c(S,b._serialize||Object.keys(b.serializers),b.serializers,b._stdErrSerialize===void 0?!0:b._stdErrSerialize),b._logEvent.ts=R,b._logEvent.messages=S.filter(function(m){return $.indexOf(m)===-1}),b._logEvent.level.label=L,b._logEvent.level.value=M,C(L,b._logEvent,V),b._logEvent=h($)}function h(b){return{ts:0,messages:[],bindings:b||[],level:{label:"",value:0}}}function f(b){const x={type:b.constructor.name,msg:b.message,stack:b.stack};for(const S in b)x[S]===void 0&&(x[S]=b[S]);return x}function d(b){return typeof b.timestamp=="function"?b.timestamp:b.timestamp===!1?E:A}function g(){return{}}function p(b){return b}function w(){}function E(){return!1}function A(){return Date.now()}function I(){return Math.round(Date.now()/1e3)}function P(){return new Date(Date.now()).toISOString()}function O(){function b(x){return typeof x<"u"&&x}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return b(self)||b(window)||b(this)||{}}}return Fh}var oo=E_();const eu=Vd(oo),A_={level:"info"},tu="custom_context",up=1e3*1024;let I_=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Fy=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new I_(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},K0=class{constructor(e,t=up){this.level=e??"error",this.levelValue=oo.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new Fy(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===oo.levels.values.error?console.error(e):t===oo.levels.values.warn?console.warn(e):t===oo.levels.values.debug?console.debug(e):t===oo.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Hn({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new Fy(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Hn({extraMetadata:e})),new Blob(t,{type:"application/json"})}},P_=class{constructor(e,t=up){this.baseChunkLogger=new K0(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},x_=class{constructor(e,t=up){this.baseChunkLogger=new K0(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var O_=Object.defineProperty,S_=Object.defineProperties,D_=Object.getOwnPropertyDescriptors,My=Object.getOwnPropertySymbols,C_=Object.prototype.hasOwnProperty,__=Object.prototype.propertyIsEnumerable,jy=(r,e,t)=>e in r?O_(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,al=(r,e)=>{for(var t in e||(e={}))C_.call(e,t)&&jy(r,t,e[t]);if(My)for(var t of My(e))__.call(e,t)&&jy(r,t,e[t]);return r},cl=(r,e)=>S_(r,D_(e));function Ml(r){return cl(al({},r),{level:(r==null?void 0:r.level)||A_.level})}function N_(r,e=tu){return r[e]||""}function T_(r,e,t=tu){return r[t]=e,r}function qt(r,e=tu){let t="";return typeof r.bindings>"u"?t=N_(r,e):t=r.bindings().context||"",t}function R_(r,e,t=tu){const n=qt(r,t);return n.trim()?`${n}/${e}`:e}function Nt(r,e,t=tu){const n=R_(r,e,t),s=r.child({context:n});return T_(s,n,t)}function B_(r){var e,t;const n=new P_((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:eu(cl(al({},r.opts),{level:"trace",browser:cl(al({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function $_(r){var e;const t=new x_((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:eu(cl(al({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function k_(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?B_(r):$_(r)}var U_=Object.defineProperty,L_=(r,e,t)=>e in r?U_(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hy=(r,e,t)=>L_(r,typeof e!="symbol"?e+"":e,t);let F_=class extends Ri{constructor(e){super(),this.opts=e,Hy(this,"protocol","wc"),Hy(this,"version",2)}};var M_=Object.defineProperty,j_=(r,e,t)=>e in r?M_(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,H_=(r,e,t)=>j_(r,e+"",t);let q_=class extends Ri{constructor(e,t){super(),this.core=e,this.logger=t,H_(this,"records",new Map)}},z_=class{constructor(e,t){this.logger=e,this.core=t}},V_=class extends Ri{constructor(e,t){super(),this.relayer=e,this.logger=t}},G_=class extends Ri{constructor(e){super()}},K_=class{constructor(e,t,n,s){this.core=e,this.logger=t,this.name=n}},Q_=class extends Ri{constructor(e,t){super(),this.relayer=e,this.logger=t}},W_=class extends Ri{constructor(e,t){super(),this.core=e,this.logger=t}},J_=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},Y_=class{constructor(e,t){this.projectId=e,this.logger=t}},Z_=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}};var X_=Object.defineProperty,eN=(r,e,t)=>e in r?X_(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qy=(r,e,t)=>eN(r,typeof e!="symbol"?e+"":e,t);let tN=class{constructor(e){this.opts=e,qy(this,"protocol","wc"),qy(this,"version",2)}},rN=class{constructor(e){this.client=e}};const nN="PARSE_ERROR",sN="INVALID_REQUEST",iN="METHOD_NOT_FOUND",oN="INVALID_PARAMS",Q0="INTERNAL_ERROR",lp="SERVER_ERROR",aN=[-32700,-32600,-32601,-32602,-32603],cc={[nN]:{code:-32700,message:"Parse error"},[sN]:{code:-32600,message:"Invalid Request"},[iN]:{code:-32601,message:"Method not found"},[oN]:{code:-32602,message:"Invalid params"},[Q0]:{code:-32603,message:"Internal error"},[lp]:{code:-32e3,message:"Server error"}},W0=lp;function cN(r){return aN.includes(r)}function zy(r){return Object.keys(cc).includes(r)?cc[r]:cc[W0]}function uN(r){const e=Object.values(cc).find(t=>t.code===r);return e||cc[W0]}function J0(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var Mh={},pn={},Vy;function lN(){if(Vy)return pn;Vy=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.isBrowserCryptoAvailable=pn.getSubtleCrypto=pn.getBrowerCrypto=void 0;function r(){return(tn==null?void 0:tn.crypto)||(tn==null?void 0:tn.msCrypto)||{}}pn.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}pn.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return pn.isBrowserCryptoAvailable=t,pn}var gn={},Gy;function hN(){if(Gy)return gn;Gy=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.isBrowser=gn.isNode=gn.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}gn.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}gn.isNode=e;function t(){return!r()&&!e()}return gn.isBrowser=t,gn}var Ky;function fN(){return Ky||(Ky=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=qc;e.__exportStar(lN(),r),e.__exportStar(hN(),r)}(Mh)),Mh}var dN=fN();function Vr(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function Gs(r=6){return BigInt(Vr(r))}function Es(r,e,t){return{id:t||Vr(),jsonrpc:"2.0",method:r,params:e}}function jl(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Hl(r,e,t){return{id:r,jsonrpc:"2.0",error:pN(e)}}function pN(r,e){return typeof r>"u"?zy(Q0):(typeof r=="string"&&(r=Object.assign(Object.assign({},zy(lp)),{message:r})),cN(r.code)&&(r=uN(r.code)),r)}class gN{}let yN=class extends gN{constructor(){super()}};class mN extends yN{constructor(e){super()}}const wN="^https?:",bN="^wss?:";function vN(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Y0(r,e){const t=vN(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function Qy(r){return Y0(r,wN)}function Wy(r){return Y0(r,bN)}function EN(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Z0(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function hp(r){return Z0(r)&&"method"in r}function ql(r){return Z0(r)&&(Gr(r)||pr(r))}function Gr(r){return"result"in r}function pr(r){return"error"in r}let mr=class extends mN{constructor(e){super(e),this.events=new nr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Es(e.method,e.params||[],e.id||Gs().toString()),t)}async requestStrict(e,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{pr(i)?s(i.error):n(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ql(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const AN=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),IN=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Jy=r=>r.split("?")[0],Yy=10,PN=AN();let xN=class{constructor(e){if(this.url=e,this.events=new nr.EventEmitter,this.registering=!1,!Wy(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Hn(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Wy(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const s=dN.isReactNative()?void 0:{rejectUnauthorized:!EN(e)},i=new PN(e,[],s);IN()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ai(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=Hl(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return J0(e,Jy(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Yy&&this.events.setMaxListeners(Yy)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Jy(this.url)}`));return this.events.emit("register_error",t),t}};var ON={};const X0="wc",ev=2,Hf="core",cn=`${X0}@2:${Hf}:`,SN={logger:"error"},DN={database:":memory:"},CN="crypto",Zy="client_ed25519_seed",_N=Q.ONE_DAY,NN="keychain",TN="0.3",RN="messages",BN="0.3",Xy=Q.SIX_HOURS,$N="publisher",tv="irn",kN="error",rv="wss://relay.walletconnect.org",UN="relayer",tt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},LN="_subscription",sr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},FN=.1,qf="2.19.2",De={link_mode:"link_mode",relay:"relay"},Hu={inbound:"inbound",outbound:"outbound"},MN="0.3",jN="WALLETCONNECT_CLIENT_ID",em="WALLETCONNECT_LINK_MODE_APPS",Kt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},HN="subscription",qN="0.3",zN="pairing",VN="0.3",za={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},Fs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},vr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},GN="history",KN="0.3",QN="expirer",ar={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},WN="0.3",JN="verify-api",YN="https://verify.walletconnect.com",nv="https://verify.walletconnect.org",uc=nv,ZN=`${uc}/v3`,XN=[YN,nv],e3="echo",t3="https://echo.walletconnect.com",zr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},yn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Er={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Ns={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Ts={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Va={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},r3=.1,n3="event-client",s3=86400,i3="https://pulse.walletconnect.org/batch";function o3(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,w=0,E=0,A=g.length;E!==A&&g[E]===0;)E++,p++;for(var I=(A-E)*l+1>>>0,P=new Uint8Array(I);E!==A;){for(var O=g[E],b=0,x=I-1;(O!==0||b<w)&&x!==-1;x--,b++)O+=256*P[x]>>>0,P[x]=O%a>>>0,O=O/a>>>0;if(O!==0)throw new Error("Non-zero carry");w=b,E++}for(var S=I-w;S!==I&&P[S]===0;)S++;for(var C=c.repeat(p);S<I;++S)C+=r.charAt(P[S]);return C}function f(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var w=0,E=0;g[p]===c;)w++,p++;for(var A=(g.length-p)*u+1>>>0,I=new Uint8Array(A);g[p];){var P=t[g.charCodeAt(p)];if(P===255)return;for(var O=0,b=A-1;(P!==0||O<E)&&b!==-1;b--,O++)P+=a*I[b]>>>0,I[b]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");E=O,p++}if(g[p]!==" "){for(var x=A-E;x!==A&&I[x]===0;)x++;for(var S=new Uint8Array(w+(A-x)),C=w;x!==A;)S[C++]=I[x++];return S}}}function d(g){var p=f(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var a3=o3,c3=a3;const sv=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},u3=r=>new TextEncoder().encode(r),l3=r=>new TextDecoder().decode(r);class h3{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class f3{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return iv(this,e)}}class d3{constructor(e){this.decoders=e}or(e){return iv(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const iv=(r,e)=>new d3({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class p3{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new h3(e,t,n),this.decoder=new f3(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const zl=({name:r,prefix:e,encode:t,decode:n})=>new p3(r,e,t,n),ru=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=c3(t,e);return zl({prefix:r,name:e,encode:n,decode:i=>sv(s(i))})},g3=(r,e,t,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const h=s[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},y3=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},gt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>zl({prefix:e,name:r,encode(s){return y3(s,n,t)},decode(s){return g3(s,n,t,r)}}),m3=zl({prefix:"\0",name:"identity",encode:r=>l3(r),decode:r=>u3(r)});var w3=Object.freeze({__proto__:null,identity:m3});const b3=gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var v3=Object.freeze({__proto__:null,base2:b3});const E3=gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var A3=Object.freeze({__proto__:null,base8:E3});const I3=ru({prefix:"9",name:"base10",alphabet:"0123456789"});var P3=Object.freeze({__proto__:null,base10:I3});const x3=gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O3=gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var S3=Object.freeze({__proto__:null,base16:x3,base16upper:O3});const D3=gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),C3=gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_3=gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),N3=gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),T3=gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),R3=gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),B3=gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$3=gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),k3=gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var U3=Object.freeze({__proto__:null,base32:D3,base32upper:C3,base32pad:_3,base32padupper:N3,base32hex:T3,base32hexupper:R3,base32hexpad:B3,base32hexpadupper:$3,base32z:k3});const L3=ru({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),F3=ru({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var M3=Object.freeze({__proto__:null,base36:L3,base36upper:F3});const j3=ru({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),H3=ru({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var q3=Object.freeze({__proto__:null,base58btc:j3,base58flickr:H3});const z3=gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),V3=gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),G3=gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),K3=gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Q3=Object.freeze({__proto__:null,base64:z3,base64pad:V3,base64url:G3,base64urlpad:K3});const ov=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),W3=ov.reduce((r,e,t)=>(r[t]=e,r),[]),J3=ov.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Y3(r){return r.reduce((e,t)=>(e+=W3[t],e),"")}function Z3(r){const e=[];for(const t of r){const n=J3[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const X3=zl({prefix:"🚀",name:"base256emoji",encode:Y3,decode:Z3});var eT=Object.freeze({__proto__:null,base256emoji:X3}),tT=av,tm=128,rT=-128,nT=Math.pow(2,31);function av(r,e,t){e=e||[],t=t||0;for(var n=t;r>=nT;)e[t++]=r&255|tm,r/=128;for(;r&rT;)e[t++]=r&255|tm,r>>>=7;return e[t]=r|0,av.bytes=t-n+1,e}var sT=zf,iT=128,rm=127;function zf(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw zf.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&rm)<<s:(o&rm)*Math.pow(2,s),s+=7}while(o>=iT);return zf.bytes=i-n,t}var oT=Math.pow(2,7),aT=Math.pow(2,14),cT=Math.pow(2,21),uT=Math.pow(2,28),lT=Math.pow(2,35),hT=Math.pow(2,42),fT=Math.pow(2,49),dT=Math.pow(2,56),pT=Math.pow(2,63),gT=function(r){return r<oT?1:r<aT?2:r<cT?3:r<uT?4:r<lT?5:r<hT?6:r<fT?7:r<dT?8:r<pT?9:10},yT={encode:tT,decode:sT,encodingLength:gT},cv=yT;const nm=(r,e,t=0)=>(cv.encode(r,e,t),e),sm=r=>cv.encodingLength(r),Vf=(r,e)=>{const t=e.byteLength,n=sm(r),s=n+sm(t),i=new Uint8Array(s+t);return nm(r,i,0),nm(t,i,n),i.set(e,s),new mT(r,t,e,i)};class mT{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const uv=({name:r,code:e,encode:t})=>new wT(r,e,t);class wT{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Vf(this.code,t):t.then(n=>Vf(this.code,n))}else throw Error("Unknown type, must be binary type")}}const lv=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),bT=uv({name:"sha2-256",code:18,encode:lv("SHA-256")}),vT=uv({name:"sha2-512",code:19,encode:lv("SHA-512")});var ET=Object.freeze({__proto__:null,sha256:bT,sha512:vT});const hv=0,AT="identity",fv=sv,IT=r=>Vf(hv,fv(r)),PT={code:hv,name:AT,encode:fv,digest:IT};var xT=Object.freeze({__proto__:null,identity:PT});new TextEncoder,new TextDecoder;const im={...w3,...v3,...A3,...P3,...S3,...U3,...M3,...q3,...Q3,...eT};({...ET,...xT});function OT(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function dv(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const om=dv("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),jh=dv("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=OT(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),ST={utf8:om,"utf-8":om,hex:im.base16,latin1:jh,ascii:jh,binary:jh,...im};function DT(r,e="utf8"){const t=ST[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var CT=Object.defineProperty,_T=(r,e,t)=>e in r?CT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jr=(r,e,t)=>_T(r,typeof e!="symbol"?e+"":e,t);class NT{constructor(e,t){this.core=e,this.logger=t,jr(this,"keychain",new Map),jr(this,"name",NN),jr(this,"version",TN),jr(this,"initialized",!1),jr(this,"storagePrefix",cn),jr(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),jr(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),jr(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),jr(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=W("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),jr(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Nt(t,this.name)}get context(){return qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Cf(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_f(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var TT=Object.defineProperty,RT=(r,e,t)=>e in r?TT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ot=(r,e,t)=>RT(r,typeof e!="symbol"?e+"":e,t);class BT{constructor(e,t,n){this.core=e,this.logger=t,ot(this,"name",CN),ot(this,"keychain"),ot(this,"randomSessionIdentifier",Mf()),ot(this,"initialized",!1),ot(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),ot(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),ot(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=Fg(s);return Xb(i.publicKey)}),ot(this,"generateKeyPair",()=>{this.isInitialized();const s=zD();return this.setPrivateKey(s.publicKey,s.privateKey)}),ot(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=Fg(i),a=this.randomSessionIdentifier;return await ax(a,s,_N,o)}),ot(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=VD(a,i);return this.setSymKey(c,o)}),ot(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Fu(s);return await this.keychain.set(o,s),o}),ot(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),ot(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),ot(this,"encode",async(s,i,o)=>{this.isInitialized();const a=H0(o),c=Hn(i);if(Iy(a))return QD(c,o==null?void 0:o.encoding);if(Ay(a)){const f=a.senderPublicKey,d=a.receiverPublicKey;s=await this.generateSharedKey(f,d)}const u=this.getSymKey(s),{type:l,senderPublicKey:h}=a;return GD({type:l,symKey:u,message:c,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),ot(this,"decode",async(s,i,o)=>{this.isInitialized();const a=JD(i,o);if(Iy(a)){const c=WD(i,o==null?void 0:o.encoding);return Ai(c)}if(Ay(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;s=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(s),u=KD({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return Ai(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),ot(this,"getPayloadType",(s,i=Rr)=>{const o=bc({encoded:s,encoding:i});return xi(o.type)}),ot(this,"getPayloadSenderPublicKey",(s,i=Rr)=>{const o=bc({encoded:s,encoding:i});return o.senderPublicKey?jt(o.senderPublicKey,_t):void 0}),this.core=e,this.logger=Nt(t,this.name),this.keychain=n||new NT(this.core,this.logger)}get context(){return qt(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Zy)}catch{e=Mf(),await this.keychain.set(Zy,e)}return DT(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var $T=Object.defineProperty,kT=Object.defineProperties,UT=Object.getOwnPropertyDescriptors,am=Object.getOwnPropertySymbols,LT=Object.prototype.hasOwnProperty,FT=Object.prototype.propertyIsEnumerable,Gf=(r,e,t)=>e in r?$T(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,MT=(r,e)=>{for(var t in e||(e={}))LT.call(e,t)&&Gf(r,t,e[t]);if(am)for(var t of am(e))FT.call(e,t)&&Gf(r,t,e[t]);return r},jT=(r,e)=>kT(r,UT(e)),zt=(r,e,t)=>Gf(r,typeof e!="symbol"?e+"":e,t);class HT extends z_{constructor(e,t){super(e,t),this.logger=e,this.core=t,zt(this,"messages",new Map),zt(this,"messagesWithoutClientAck",new Map),zt(this,"name",RN),zt(this,"version",BN),zt(this,"initialized",!1),zt(this,"storagePrefix",cn),zt(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),zt(this,"set",async(n,s,i)=>{this.isInitialized();const o=rn(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===Hu.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,jT(MT({},c),{[o]:s}))}return await this.persist(),o}),zt(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),zt(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),zt(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=rn(s);return typeof i[o]<"u"}),zt(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=rn(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),zt(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Nt(e,this.name),this.core=t}get context(){return qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Cf(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Cf(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_f(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?_f(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var qT=Object.defineProperty,zT=Object.defineProperties,VT=Object.getOwnPropertyDescriptors,cm=Object.getOwnPropertySymbols,GT=Object.prototype.hasOwnProperty,KT=Object.prototype.propertyIsEnumerable,Kf=(r,e,t)=>e in r?qT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Eu=(r,e)=>{for(var t in e||(e={}))GT.call(e,t)&&Kf(r,t,e[t]);if(cm)for(var t of cm(e))KT.call(e,t)&&Kf(r,t,e[t]);return r},Hh=(r,e)=>zT(r,VT(e)),Ar=(r,e,t)=>Kf(r,typeof e!="symbol"?e+"":e,t);class QT extends V_{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Ar(this,"events",new nr.EventEmitter),Ar(this,"name",$N),Ar(this,"queue",new Map),Ar(this,"publishTimeout",Q.toMiliseconds(Q.ONE_MINUTE)),Ar(this,"initialPublishTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),Ar(this,"needsTransportRestart",!1),Ar(this,"publish",async(n,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||Xy,c=il(i),u=(i==null?void 0:i.prompt)||!1,l=(i==null?void 0:i.tag)||0,h=(i==null?void 0:i.id)||Gs().toString(),f={topic:n,message:s,opts:{ttl:a,relay:c,prompt:u,tag:l,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},d=`Failed to publish payload, please try again. id:${h} tag:${l}`;try{const g=new Promise(async p=>{const w=({id:A})=>{f.opts.id===A&&(this.removeRequestFromQueue(A),this.relayer.events.removeListener(tt.publish,w),p(f))};this.relayer.events.on(tt.publish,w);const E=vs(new Promise((A,I)=>{this.rpcPublish({topic:n,message:s,ttl:a,prompt:u,tag:l,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(A).catch(P=>{this.logger.warn(P,P==null?void 0:P.message),I(P)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${l}`);try{await E,this.events.removeListener(tt.publish,w)}catch(A){this.queue.set(h,Hh(Eu({},f),{attempt:1})),this.logger.warn(A,A==null?void 0:A.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:n,message:s,opts:i}}),await vs(g,this.publishTimeout,d)}catch(g){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(g),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw g}finally{this.queue.delete(h)}}),Ar(this,"on",(n,s)=>{this.events.on(n,s)}),Ar(this,"once",(n,s)=>{this.events.once(n,s)}),Ar(this,"off",(n,s)=>{this.events.off(n,s)}),Ar(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=Nt(t,this.name),this.registerEventListeners()}get context(){return qt(this.logger)}async rpcPublish(e){var t,n,s,i;const{topic:o,message:a,ttl:c=Xy,prompt:u,tag:l,id:h,attestation:f,tvf:d}=e,g={method:Ya(il().protocol).publish,params:Eu({topic:o,message:a,ttl:c,prompt:u,tag:l,attestation:f},d),id:h};ut((t=g.params)==null?void 0:t.prompt)&&((n=g.params)==null||delete n.prompt),ut((s=g.params)==null?void 0:s.tag)&&((i=g.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:g});const p=await this.relayer.request(g);return this.relayer.events.emit(tt.publish,e),this.logger.debug("Successfully Published Payload"),p}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const n=e.attempt+1;this.queue.set(t,Hh(Eu({},e),{attempt:n}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(Hh(Eu({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ra.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(tt.connection_stalled);return}this.checkQueue()}),this.relayer.on(tt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var WT=Object.defineProperty,JT=(r,e,t)=>e in r?WT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qi=(r,e,t)=>JT(r,typeof e!="symbol"?e+"":e,t);class YT{constructor(){qi(this,"map",new Map),qi(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),qi(this,"get",e=>this.map.get(e)||[]),qi(this,"exists",(e,t)=>this.get(e).includes(t)),qi(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const s=n.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),qi(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var ZT=Object.defineProperty,XT=Object.defineProperties,eR=Object.getOwnPropertyDescriptors,um=Object.getOwnPropertySymbols,tR=Object.prototype.hasOwnProperty,rR=Object.prototype.propertyIsEnumerable,Qf=(r,e,t)=>e in r?ZT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ga=(r,e)=>{for(var t in e||(e={}))tR.call(e,t)&&Qf(r,t,e[t]);if(um)for(var t of um(e))rR.call(e,t)&&Qf(r,t,e[t]);return r},qh=(r,e)=>XT(r,eR(e)),Pe=(r,e,t)=>Qf(r,typeof e!="symbol"?e+"":e,t);class nR extends Q_{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Pe(this,"subscriptions",new Map),Pe(this,"topicMap",new YT),Pe(this,"events",new nr.EventEmitter),Pe(this,"name",HN),Pe(this,"version",qN),Pe(this,"pending",new Map),Pe(this,"cached",[]),Pe(this,"initialized",!1),Pe(this,"storagePrefix",cn),Pe(this,"subscribeTimeout",Q.toMiliseconds(Q.ONE_MINUTE)),Pe(this,"initialSubscribeTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),Pe(this,"clientId"),Pe(this,"batchSubscribeTopicsLimit",500),Pe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Pe(this,"subscribe",async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const i=il(s),o={topic:n,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),Pe(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),Pe(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),Pe(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),Pe(this,"on",(n,s)=>{this.events.on(n,s)}),Pe(this,"once",(n,s)=>{this.events.once(n,s)}),Pe(this,"off",(n,s)=>{this.events.off(n,s)}),Pe(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),Pe(this,"start",async()=>{await this.onConnect()}),Pe(this,"stop",async()=>{await this.onDisconnect()}),Pe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Pe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),Pe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Ra.pulse,async()=>{await this.checkPending()}),this.events.on(Kt.created,async n=>{const s=Kt.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(Kt.deleted,async n=>{const s=Kt.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=Nt(t,this.name),this.clientId=""}get context(){return qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const s=il(n);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=ve("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,n){var s;(!n||(n==null?void 0:n.transportType)===De.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const i={method:Ya(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===De.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(l=>this.logger.warn(l))},Q.toMiliseconds(Q.ONE_SECOND)),a;const c=new Promise(async l=>{const h=f=>{f.topic===e&&(this.events.removeListener(Kt.created,h),l(f.id))};this.events.on(Kt.created,h);try{const f=await vs(new Promise((d,g)=>{this.relayer.request(i).catch(p=>{this.logger.warn(p,p==null?void 0:p.message),g(p)}).then(d)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Kt.created,h),l(f)}catch{}}),u=await vs(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return u?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(tt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:Ya(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await vs(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(tt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:Ya(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await vs(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(tt.connection_stalled)}return s}rpcUnsubscribe(e,t,n){const s={method:Ya(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,qh(Ga({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Ga({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Ga({},t)),this.topicMap.set(t.topic,e),this.events.emit(Kt.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Kt.deleted,qh(Ga({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Kt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Kt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>qh(Ga({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await NO(Q.toMiliseconds(Q.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return rn(e+await this.getClientId())}}var sR=Object.defineProperty,lm=Object.getOwnPropertySymbols,iR=Object.prototype.hasOwnProperty,oR=Object.prototype.propertyIsEnumerable,Wf=(r,e,t)=>e in r?sR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hm=(r,e)=>{for(var t in e||(e={}))iR.call(e,t)&&Wf(r,t,e[t]);if(lm)for(var t of lm(e))oR.call(e,t)&&Wf(r,t,e[t]);return r},ge=(r,e,t)=>Wf(r,typeof e!="symbol"?e+"":e,t);class aR extends G_{constructor(e){super(e),ge(this,"protocol","wc"),ge(this,"version",2),ge(this,"core"),ge(this,"logger"),ge(this,"events",new nr.EventEmitter),ge(this,"provider"),ge(this,"messages"),ge(this,"subscriber"),ge(this,"publisher"),ge(this,"name",UN),ge(this,"transportExplicitlyClosed",!1),ge(this,"initialized",!1),ge(this,"connectionAttemptInProgress",!1),ge(this,"relayUrl"),ge(this,"projectId"),ge(this,"packageName"),ge(this,"bundleId"),ge(this,"hasExperiencedNetworkDisruption",!1),ge(this,"pingTimeout"),ge(this,"heartBeatTimeout",Q.toMiliseconds(Q.THIRTY_SECONDS+Q.FIVE_SECONDS)),ge(this,"reconnectTimeout"),ge(this,"connectPromise"),ge(this,"reconnectInProgress",!1),ge(this,"requestsInFlight",[]),ge(this,"connectTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),ge(this,"request",async t=>{var n,s;this.logger.debug("Publishing Request Payload");const i=t.id||Gs().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=t.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),ge(this,"resetPingTimeout",()=>{nl()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),ge(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),ge(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(tt.connect)}),ge(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),ge(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(tt.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ge(this,"registerProviderListeners",()=>{this.provider.on(sr.payload,this.onPayloadHandler),this.provider.on(sr.connect,this.onConnectHandler),this.provider.on(sr.disconnect,this.onDisconnectHandler),this.provider.on(sr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Nt(e.logger,this.name):eu(Ml({level:e.logger||kN})),this.messages=new HT(this.logger,e.core),this.subscriber=new nR(this,this.logger),this.publisher=new QT(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||rv,this.projectId=e.projectId,gO()?this.packageName=Gg():yO()&&(this.bundleId=Gg()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return qt(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:De.relay},Hu.outbound)}async subscribe(e,t){var n,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const u=l=>{l.topic===e&&(this.subscriber.off(Kt.created,u),c())};return await Promise.all([new Promise(l=>{c=l,this.subscriber.on(Kt.created,u)}),new Promise(async(l,h)=>{a=await this.subscriber.subscribe(e,hm({internal:{throwOnFailedPublish:o}},t)).catch(f=>{o&&h(f)})||a,l()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await vs(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Ny())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const s=Ke(Q.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(tt.message,e),await this.recordMessageEvent(e,Hu.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(sr.disconnect,i),await vs(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(sr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(sr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(sr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,Q.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,s,i;if(nl())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new mr(new xN(EO({sdkVersion:qf,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:s}=e;await this.messages.set(n,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),hp(e)){if(!e.method.endsWith(LN))return;const t=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=t.data,a={topic:n,message:s,publishedAt:i,transportType:De.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(hm({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else ql(e)&&this.events.emit(tt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Hu.inbound),this.events.emit(tt.message,e))}async acknowledgePayload(e){const t=jl(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(sr.payload,this.onPayloadHandler),this.provider.off(sr.connect,this.onConnectHandler),this.provider.off(sr.disconnect,this.onDisconnectHandler),this.provider.off(sr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Ny();$C(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(tt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Q.toMiliseconds(FN)))))}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}function cR(){}function fm(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function dm(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function pm(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const uR="[object RegExp]",lR="[object String]",hR="[object Number]",fR="[object Boolean]",gm="[object Arguments]",dR="[object Symbol]",pR="[object Date]",gR="[object Map]",yR="[object Set]",mR="[object Array]",wR="[object Function]",bR="[object ArrayBuffer]",zh="[object Object]",vR="[object Error]",ER="[object DataView]",AR="[object Uint8Array]",IR="[object Uint8ClampedArray]",PR="[object Uint16Array]",xR="[object Uint32Array]",OR="[object BigUint64Array]",SR="[object Int8Array]",DR="[object Int16Array]",CR="[object Int32Array]",_R="[object BigInt64Array]",NR="[object Float32Array]",TR="[object Float64Array]";function RR(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function BR(r,e,t){return Xa(r,e,void 0,void 0,void 0,void 0,t)}function Xa(r,e,t,n,s,i,o){const a=o(r,e,t,n,s,i);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return lc(r,e,i,o)}return lc(r,e,i,o)}function lc(r,e,t,n){if(Object.is(r,e))return!0;let s=pm(r),i=pm(e);if(s===gm&&(s=zh),i===gm&&(i=zh),s!==i)return!1;switch(s){case lR:return r.toString()===e.toString();case hR:{const c=r.valueOf(),u=e.valueOf();return RR(c,u)}case fR:case pR:case dR:return Object.is(r.valueOf(),e.valueOf());case uR:return r.source===e.source&&r.flags===e.flags;case wR:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(s){case gR:{if(r.size!==e.size)return!1;for(const[c,u]of r.entries())if(!e.has(c)||!Xa(u,e.get(c),c,r,e,t,n))return!1;return!0}case yR:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),u=Array.from(e.values());for(let l=0;l<c.length;l++){const h=c[l],f=u.findIndex(d=>Xa(h,d,void 0,r,e,t,n));if(f===-1)return!1;u.splice(f,1)}return!0}case mR:case AR:case IR:case PR:case xR:case OR:case SR:case DR:case CR:case _R:case NR:case TR:{if(typeof Buffer<"u"&&Buffer.isBuffer(r)!==Buffer.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!Xa(r[c],e[c],c,r,e,t,n))return!1;return!0}case bR:return r.byteLength!==e.byteLength?!1:lc(new Uint8Array(r),new Uint8Array(e),t,n);case ER:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:lc(new Uint8Array(r),new Uint8Array(e),t,n);case vR:return r.name===e.name&&r.message===e.message;case zh:{if(!(lc(r.constructor,e.constructor,t,n)||fm(r)&&fm(e)))return!1;const c=[...Object.keys(r),...dm(r)],u=[...Object.keys(e),...dm(e)];if(c.length!==u.length)return!1;for(let l=0;l<c.length;l++){const h=c[l],f=r[h];if(!Object.hasOwn(e,h))return!1;const d=e[h];if(!Xa(f,d,h,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function $R(r,e){return BR(r,e,cR)}var kR=Object.defineProperty,ym=Object.getOwnPropertySymbols,UR=Object.prototype.hasOwnProperty,LR=Object.prototype.propertyIsEnumerable,Jf=(r,e,t)=>e in r?kR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mm=(r,e)=>{for(var t in e||(e={}))UR.call(e,t)&&Jf(r,t,e[t]);if(ym)for(var t of ym(e))LR.call(e,t)&&Jf(r,t,e[t]);return r},Rt=(r,e,t)=>Jf(r,typeof e!="symbol"?e+"":e,t);class $i extends K_{constructor(e,t,n,s=cn,i=void 0){super(e,t,n,s),this.core=e,this.logger=t,this.name=n,Rt(this,"map",new Map),Rt(this,"version",MN),Rt(this,"cached",[]),Rt(this,"initialized",!1),Rt(this,"getKey"),Rt(this,"storagePrefix",cn),Rt(this,"recentlyDeleted",[]),Rt(this,"recentlyDeletedLimit",200),Rt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!ut(o)?this.map.set(this.getKey(o),o):fC(o)?this.map.set(o.id,o):dC(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Rt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Rt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Rt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>$R(a[c],o[c]))):this.values)),Rt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=mm(mm({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Rt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Nt(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=W("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var FR=Object.defineProperty,MR=(r,e,t)=>e in r?FR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ue=(r,e,t)=>MR(r,typeof e!="symbol"?e+"":e,t);class jR{constructor(e,t){this.core=e,this.logger=t,ue(this,"name",zN),ue(this,"version",VN),ue(this,"events",new Gd),ue(this,"pairings"),ue(this,"initialized",!1),ue(this,"storagePrefix",cn),ue(this,"ignoredPayloadTypes",[Fn]),ue(this,"registeredMethods",[]),ue(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ue(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),ue(this,"create",async n=>{this.isInitialized();const s=Mf(),i=await this.core.crypto.setSymKey(s),o=Ke(Q.FIVE_MINUTES),a={protocol:tv},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},u=xy({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(Fs.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType}),{topic:i,uri:u}}),ue(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[zr.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:u}=Py(n.uri);s.props.properties.topic=i,s.addTrace(zr.pairing_uri_validation_success),s.addTrace(zr.pairing_uri_not_expired);let l;if(this.pairings.keys.includes(i)){if(l=this.pairings.get(i),s.addTrace(zr.existing_pairing),l.active)throw s.setError(yn.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(zr.pairing_not_expired)}const h=c||Ke(Q.FIVE_MINUTES),f={topic:i,relay:a,expiry:h,active:!1,methods:u};this.core.expirer.set(i,h),await this.pairings.set(i,f),s.addTrace(zr.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(Fs.create,f),s.addTrace(zr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(zr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(yn.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(d){throw s.setError(yn.subscribe_pairing_topic_failure),d}return s.addTrace(zr.subscribe_pairing_topic_success),f}),ue(this,"activate",async({topic:n})=>{this.isInitialized();const s=Ke(Q.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),ue(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Bs();this.events.once(we("pairing_ping",i),({error:u})=>{u?c(u):a()}),await o()}}),ue(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),ue(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),ue(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ue(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",ve("USER_DISCONNECTED")),await this.deletePairing(s))}),ue(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return xy({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ue(this,"sendRequest",async(n,s,i)=>{const o=Es(s,i),a=await this.core.crypto.encode(n,o),c=za[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),ue(this,"sendResult",async(n,s,i)=>{const o=jl(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,u=za[c].res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),ue(this,"sendError",async(n,s,i)=>{const o=Hl(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,u=za[c]?za[c].res:za.unregistered_method.res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),ue(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,ve("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),ue(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>es(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),ue(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ue(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ue(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(Fs.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ue(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Gr(s)?this.events.emit(we("pairing_ping",i),{}):pr(s)&&this.events.emit(we("pairing_ping",i),{error:s.error})},500)}),ue(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Fs.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ue(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=ve("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),ue(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(ve("WC_METHOD_UNSUPPORTED",n))}),ue(this,"isValidPair",(n,s)=>{var i;if(!$t(n)){const{message:a}=W("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(yn.malformed_pairing_uri),new Error(a)}if(!hC(n.uri)){const{message:a}=W("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(yn.malformed_pairing_uri),new Error(a)}const o=Py(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=W("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(yn.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=W("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(yn.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Q.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(yn.pairing_expired);const{message:a}=W("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ue(this,"isValidPing",async n=>{if(!$t(n)){const{message:i}=W("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ue(this,"isValidDisconnect",async n=>{if(!$t(n)){const{message:i}=W("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ue(this,"isValidPairingTopic",async n=>{if(!ze(n,!1)){const{message:s}=W("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=W("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(es(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=W("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=Nt(t,this.name),this.pairings=new $i(this.core,this.logger,this.name,this.storagePrefix)}get context(){return qt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tt.message,async e=>{const{topic:t,message:n,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==De.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(t,n);hp(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):ql(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(ar.expired,async e=>{const{topic:t}=u0(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Fs.expire,{topic:t}))})}}var HR=Object.defineProperty,qR=(r,e,t)=>e in r?HR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,at=(r,e,t)=>qR(r,typeof e!="symbol"?e+"":e,t);class zR extends q_{constructor(e,t){super(e,t),this.core=e,this.logger=t,at(this,"records",new Map),at(this,"events",new nr.EventEmitter),at(this,"name",GN),at(this,"version",KN),at(this,"cached",[]),at(this,"initialized",!1),at(this,"storagePrefix",cn),at(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),at(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:Ke(Q.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(vr.created,o)}),at(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=pr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(vr.updated,s))}),at(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),at(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(vr.deleted,i)}}),this.persist()}),at(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),at(this,"on",(n,s)=>{this.events.on(n,s)}),at(this,"once",(n,s)=>{this.events.once(n,s)}),at(this,"off",(n,s)=>{this.events.off(n,s)}),at(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Nt(t,this.name)}get context(){return qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Es(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(vr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(vr.created,e=>{const t=vr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(vr.updated,e=>{const t=vr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(vr.deleted,e=>{const t=vr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(Ra.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{Q.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(vr.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var VR=Object.defineProperty,GR=(r,e,t)=>e in r?VR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yt=(r,e,t)=>GR(r,typeof e!="symbol"?e+"":e,t);class KR extends W_{constructor(e,t){super(e,t),this.core=e,this.logger=t,yt(this,"expirations",new Map),yt(this,"events",new nr.EventEmitter),yt(this,"name",QN),yt(this,"version",WN),yt(this,"cached",[]),yt(this,"initialized",!1),yt(this,"storagePrefix",cn),yt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),yt(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),yt(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(ar.created,{target:i,expiration:o})}),yt(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),yt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(ar.deleted,{target:s,expiration:i})}}),yt(this,"on",(n,s)=>{this.events.on(n,s)}),yt(this,"once",(n,s)=>{this.events.once(n,s)}),yt(this,"off",(n,s)=>{this.events.off(n,s)}),yt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Nt(t,this.name)}get context(){return qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return AO(e);if(typeof e=="number")return IO(e);const{message:t}=W("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ar.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;Q.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(ar.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Ra.pulse,()=>this.checkExpirations()),this.events.on(ar.created,e=>{const t=ar.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(ar.expired,e=>{const t=ar.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(ar.deleted,e=>{const t=ar.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var QR=Object.defineProperty,WR=(r,e,t)=>e in r?QR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qe=(r,e,t)=>WR(r,typeof e!="symbol"?e+"":e,t);class JR extends J_{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,qe(this,"name",JN),qe(this,"abortController"),qe(this,"isDevEnv"),qe(this,"verifyUrlV3",ZN),qe(this,"storagePrefix",cn),qe(this,"version",ev),qe(this,"publicKey"),qe(this,"fetchPromise"),qe(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Q.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),qe(this,"register",async s=>{if(!Gc()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const u=vi.getDocument(),l=this.startAbortTimer(Q.ONE_SECOND*5),h=await new Promise((f,d)=>{const g=()=>{window.removeEventListener("message",w),u.body.removeChild(p),d("attestation aborted")};this.abortController.signal.addEventListener("abort",g);const p=u.createElement("iframe");p.src=c,p.style.display="none",p.addEventListener("error",g,{signal:this.abortController.signal});const w=E=>{if(E.data&&typeof E.data=="string")try{const A=JSON.parse(E.data);if(A.type==="verify_attestation"){if(Df(A.attestation).payload.id!==o)return;clearInterval(l),u.body.removeChild(p),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",w),f(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};u.body.appendChild(p),window.addEventListener("message",w,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(u){this.logger.warn(u)}return""}),qe(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Df(i).payload.id!==a)return;const u=await this.isValidJwtAttestation(i);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),qe(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Q.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),qe(this,"getVerifyUrl",s=>{let i=s||uc;return XN.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${uc}`),i=uc),i}),qe(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Q.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),qe(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),qe(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),qe(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),qe(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),qe(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),qe(this,"validateAttestation",(s,i)=>{const o=ZD(s,i.publicKey),a={hasExpired:Q.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Nt(t,this.name),this.abortController=new AbortController,this.isDevEnv=ep(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return qt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Q.toMiliseconds(e))}}var YR=Object.defineProperty,ZR=(r,e,t)=>e in r?YR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,wm=(r,e,t)=>ZR(r,typeof e!="symbol"?e+"":e,t);class XR extends Y_{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,wm(this,"context",e3),wm(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${t3}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Nt(t,this.context)}}var eB=Object.defineProperty,bm=Object.getOwnPropertySymbols,tB=Object.prototype.hasOwnProperty,rB=Object.prototype.propertyIsEnumerable,Yf=(r,e,t)=>e in r?eB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ka=(r,e)=>{for(var t in e||(e={}))tB.call(e,t)&&Yf(r,t,e[t]);if(bm)for(var t of bm(e))rB.call(e,t)&&Yf(r,t,e[t]);return r},We=(r,e,t)=>Yf(r,typeof e!="symbol"?e+"":e,t);class nB extends Z_{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,We(this,"context",n3),We(this,"storagePrefix",cn),We(this,"storageVersion",r3),We(this,"events",new Map),We(this,"shouldPersist",!1),We(this,"init",async()=>{if(!ep())try{const s={eventId:Qg(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:a0(this.core.relayer.protocol,this.core.relayer.version,qf)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),We(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,u=Qg(),l=this.core.projectId||"",h=Date.now(),f=Ka({eventId:u,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:l,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,f),this.shouldPersist=!0),f}),We(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Ka(Ka({},a),this.setMethods(a.eventId))}),We(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),We(this,"setEventListeners",()=>{this.core.heartbeat.on(Ra.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Q.fromMiliseconds(Date.now())-Q.fromMiliseconds(s.timestamp)>s3&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),We(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),We(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),We(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),We(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),We(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,Ka(Ka({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),We(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),We(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${i3}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${qf}${i}`,{method:"POST",body:JSON.stringify(s)})}),We(this,"getAppDomain",()=>o0().url),this.logger=Nt(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var sB=Object.defineProperty,vm=Object.getOwnPropertySymbols,iB=Object.prototype.hasOwnProperty,oB=Object.prototype.propertyIsEnumerable,Zf=(r,e,t)=>e in r?sB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Em=(r,e)=>{for(var t in e||(e={}))iB.call(e,t)&&Zf(r,t,e[t]);if(vm)for(var t of vm(e))oB.call(e,t)&&Zf(r,t,e[t]);return r},Oe=(r,e,t)=>Zf(r,typeof e!="symbol"?e+"":e,t);let aB=class pv extends F_{constructor(e){var t;super(e),Oe(this,"protocol",X0),Oe(this,"version",ev),Oe(this,"name",Hf),Oe(this,"relayUrl"),Oe(this,"projectId"),Oe(this,"customStoragePrefix"),Oe(this,"events",new nr.EventEmitter),Oe(this,"logger"),Oe(this,"heartbeat"),Oe(this,"relayer"),Oe(this,"crypto"),Oe(this,"storage"),Oe(this,"history"),Oe(this,"expirer"),Oe(this,"pairing"),Oe(this,"verify"),Oe(this,"echoClient"),Oe(this,"linkModeSupportedApps"),Oe(this,"eventClient"),Oe(this,"initialized",!1),Oe(this,"logChunkController"),Oe(this,"on",(a,c)=>this.events.on(a,c)),Oe(this,"once",(a,c)=>this.events.once(a,c)),Oe(this,"off",(a,c)=>this.events.off(a,c)),Oe(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Oe(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:u})=>{if(!a||!c)return;const l={topic:a,message:c,publishedAt:Date.now(),transportType:De.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:u})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||rv,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Ml({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:SN.logger,name:Hf}),{logger:i,chunkLoggerController:o}=k_({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Nt(i,this.name),this.heartbeat=new FC,this.crypto=new BT(this,this.logger,e==null?void 0:e.keychain),this.history=new zR(this,this.logger),this.expirer=new KR(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new b_(Em(Em({},DN),e==null?void 0:e.storageOptions)),this.relayer=new aR({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new jR(this,this.logger),this.verify=new JR(this,this.logger,this.storage),this.echoClient=new XR(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new nB(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new pv(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(jN,n),t}get context(){return qt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(em,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(em)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&ON.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const cB=aB,gv="wc",yv=2,mv="client",fp=`${gv}@${yv}:${mv}:`,Vh={name:mv,logger:"error"},Am="WALLETCONNECT_DEEPLINK_CHOICE",uB="proposal",Im="Proposal expired",lB="session",zi=Q.SEVEN_DAYS,hB="engine",Je={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Q.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Q.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1119}}},Gh={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},Hr={idle:"IDLE",active:"ACTIVE"},Pm={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},fB="request",dB=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],pB="wc",gB="auth",yB="authKeys",mB="pairingTopics",wB="requests",Vl=`${pB}@${1.5}:${gB}:`,qu=`${Vl}:PUB_KEY`;var bB=Object.defineProperty,vB=Object.defineProperties,EB=Object.getOwnPropertyDescriptors,xm=Object.getOwnPropertySymbols,AB=Object.prototype.hasOwnProperty,IB=Object.prototype.propertyIsEnumerable,Xf=(r,e,t)=>e in r?bB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,xe=(r,e)=>{for(var t in e||(e={}))AB.call(e,t)&&Xf(r,t,e[t]);if(xm)for(var t of xm(e))IB.call(e,t)&&Xf(r,t,e[t]);return r},Et=(r,e)=>vB(r,EB(e)),H=(r,e,t)=>Xf(r,typeof e!="symbol"?e+"":e,t);class PB extends rN{constructor(e){super(e),H(this,"name",hB),H(this,"events",new Gd),H(this,"initialized",!1),H(this,"requestQueue",{state:Hr.idle,queue:[]}),H(this,"sessionRequestQueue",{state:Hr.idle,queue:[]}),H(this,"requestQueueDelay",Q.ONE_SECOND),H(this,"expectedPairingMethodMap",new Map),H(this,"recentlyDeletedMap",new Map),H(this,"recentlyDeletedLimit",200),H(this,"relayMessageCache",[]),H(this,"pendingSessions",new Map),H(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Je)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay)))}),H(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=Et(xe({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:u}=n;let l=s,h,f=!1;try{if(l){const b=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),f=b.active}}catch(b){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),b}if(!l||!f){const{topic:b,uri:x}=await this.client.core.pairing.create();l=b,h=x}if(!l){const{message:b}=W("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(b)}const d=await this.client.core.crypto.generateKeyPair(),g=Je.wc_sessionPropose.req.ttl||Q.FIVE_MINUTES,p=Ke(g),w=Et(xe(xe({requiredNamespaces:i,optionalNamespaces:o,relays:u??[{protocol:tv}],proposer:{publicKey:d,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:l},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Vr()}),E=we("session_connect",w.id),{reject:A,resolve:I,done:P}=Bs(g,Im),O=({id:b})=>{b===w.id&&(this.client.events.off("proposal_expire",O),this.pendingSessions.delete(w.id),this.events.emit(E,{error:{message:Im,code:0}}))};return this.client.events.on("proposal_expire",O),this.events.once(E,({error:b,session:x})=>{this.client.events.off("proposal_expire",O),b?A(b):x&&I(x)}),await this.sendRequest({topic:l,method:"wc_sessionPropose",params:w,throwOnFailedPublish:!0,clientRpcId:w.id}),await this.setProposal(w.id,w),{uri:h,approval:P}}),H(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),H(this,"approve",async t=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[Er.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(C){throw o.setError(Ns.no_internet_connection),C}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(C){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(Ns.proposal_not_found),C}try{await this.isValidApprove(t)}catch(C){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Ns.session_approve_namespace_validation_failure),C}const{id:a,relayProtocol:c,namespaces:u,sessionProperties:l,scopedProperties:h,sessionConfig:f}=t,d=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:g,proposer:p,requiredNamespaces:w,optionalNamespaces:E}=d;let A=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:g});A||(A=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Er.session_approve_started,properties:{topic:g,trace:[Er.session_approve_started,Er.session_namespaces_validation_success]}}));const I=await this.client.core.crypto.generateKeyPair(),P=p.publicKey,O=await this.client.core.crypto.generateSharedKey(I,P),b=xe(xe(xe({relay:{protocol:c??"irn"},namespaces:u,controller:{publicKey:I,metadata:this.client.metadata},expiry:Ke(zi)},l&&{sessionProperties:l}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),x=De.relay;A.addTrace(Er.subscribing_session_topic);try{await this.client.core.relayer.subscribe(O,{transportType:x})}catch(C){throw A.setError(Ns.subscribe_session_topic_failure),C}A.addTrace(Er.subscribe_session_topic_success);const S=Et(xe({},b),{topic:O,requiredNamespaces:w,optionalNamespaces:E,pairingTopic:g,acknowledged:!1,self:b.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:I,transportType:De.relay});await this.client.session.set(O,S),A.addTrace(Er.store_session);try{A.addTrace(Er.publishing_session_settle),await this.sendRequest({topic:O,method:"wc_sessionSettle",params:b,throwOnFailedPublish:!0}).catch(C=>{throw A==null||A.setError(Ns.session_settle_publish_failure),C}),A.addTrace(Er.session_settle_publish_success),A.addTrace(Er.publishing_session_approve),await this.sendResult({id:a,topic:g,result:{relay:{protocol:c??"irn"},responderPublicKey:I},throwOnFailedPublish:!0}).catch(C=>{throw A==null||A.setError(Ns.session_approve_publish_failure),C}),A.addTrace(Er.session_approve_publish_success)}catch(C){throw this.client.logger.error(C),this.client.session.delete(O,ve("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(O),C}return this.client.core.eventClient.deleteEvent({eventId:A.eventId}),await this.client.core.pairing.updateMetadata({topic:g,metadata:p.metadata}),await this.client.proposal.delete(a,ve("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}),await this.setExpiry(O,Ke(zi)),{topic:O,acknowledged:()=>Promise.resolve(this.client.session.get(O))}}),H(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=t;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&(await this.sendError({id:n,topic:i,error:s,rpcOpts:Je.wc_sessionPropose.reject}),await this.client.proposal.delete(n,ve("USER_DISCONNECTED")))}),H(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:n,namespaces:s}=t,{done:i,resolve:o,reject:a}=Bs(),c=Vr(),u=Gs().toString(),l=this.client.session.get(n).namespaces;return this.events.once(we("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:u}).catch(h=>{this.client.logger.error(h),this.client.session.update(n,{namespaces:l}),a(h)}),{acknowledged:i}}),H(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,s=Vr(),{done:i,resolve:o,reject:a}=Bs();return this.events.once(we("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Ke(zi)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),H(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(E){throw this.client.logger.error("request() -> isValidRequest() failed"),E}const{chainId:n,request:s,topic:i,expiry:o=Je.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===De.relay&&await this.confirmOnlineStateOrThrow();const c=Vr(),u=Gs().toString(),{done:l,resolve:h,reject:f}=Bs(o,"Request expired. Please try again.");this.events.once(we("session_request",c),({error:E,result:A})=>{E?f(E):h(A)});const d="wc_sessionRequest",g=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(g)return await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:i,method:d,params:{request:Et(xe({},s),{expiryTimestamp:Ke(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:g}).catch(E=>f(E)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await l();const p={request:Et(xe({},s),{expiryTimestamp:Ke(o)}),chainId:n},w=this.shouldSetTVF(d,p);return await Promise.all([new Promise(async E=>{await this.sendRequest(xe({clientRpcId:c,relayRpcId:u,topic:i,method:d,params:p,expiry:o,throwOnFailedPublish:!0},w&&{tvf:this.getTVFParams(c,p)})).catch(A=>f(A)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),E()}),new Promise(async E=>{var A;if(!((A=a.sessionConfig)!=null&&A.disableDeepLink)){const I=await SO(this.client.core.storage,Am);await PO({id:c,topic:i,wcDeepLink:I})}E()}),l()]).then(E=>E[2])}),H(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:i}=s,o=this.client.session.get(n);o.transportType===De.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Gr(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):pr(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(t)}),H(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=Vr(),i=Gs().toString(),{done:o,resolve:a,reject:c}=Bs();this.events.once(we("session_ping",s),({error:u})=>{u?c(u):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),H(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:s,chainId:i}=t,o=Gs().toString(),a=Vr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),H(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:ve("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=W("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),H(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>uC(n,t)))),H(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),H(this,"authenticate",async(t,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?De.link_mode:De.relay;o===De.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:u,domain:l,nonce:h,type:f,exp:d,nbf:g,methods:p=[],expiry:w}=t,E=[...t.resources||[]],{topic:A,uri:I}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:I}});const P=await this.client.core.crypto.generateKeyPair(),O=Fu(P);if(await Promise.all([this.client.auth.authKeys.set(qu,{responseTopic:O,publicKey:P}),this.client.auth.pairingTopics.set(O,{topic:O,pairingTopic:A})]),await this.client.core.relayer.subscribe(O,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),p.length>0){const{namespace:T}=Eo(a[0]);let U=bS(T,"request",p);Lu(E)&&(U=ES(U,E.pop())),E.push(U)}const b=w&&w>Je.wc_sessionAuthenticate.req.ttl?w:Je.wc_sessionAuthenticate.req.ttl,x={authPayload:{type:f??"caip122",chains:a,statement:c,aud:u,domain:l,version:"1",nonce:h,iat:new Date().toISOString(),exp:d,nbf:g,resources:E},requester:{publicKey:P,metadata:this.client.metadata},expiryTimestamp:Ke(b)},S={eip155:{chains:a,methods:[...new Set(["personal_sign",...p])],events:["chainChanged","accountsChanged"]}},C={requiredNamespaces:{},optionalNamespaces:S,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:P,metadata:this.client.metadata},expiryTimestamp:Ke(Je.wc_sessionPropose.req.ttl),id:Vr()},{done:R,resolve:L,reject:M}=Bs(b,"Request expired"),V=Vr(),$=we("session_connect",C.id),m=we("session_request",V),v=async({error:T,session:U})=>{this.events.off(m,_),T?M(T):U&&L({session:U})},_=async T=>{var U,z,G;if(await this.deletePendingAuthRequest(V,{message:"fulfilled",code:0}),T.error){const ne=ve("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return T.error.code===ne.code?void 0:(this.events.off($,v),M(T.error.message))}await this.deleteProposal(C.id),this.events.off($,v);const{cacaos:J,responder:K}=T.result,ee=[],re=[];for(const ne of J){await ry({cacao:ne,projectId:this.client.core.projectId})||(this.client.logger.error(ne,"Signature verification failed"),M(ve("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Ne}=ne,He=Lu(Ne.resources),Re=[Nf(Ne.iss)],_e=sl(Ne.iss);if(He){const Ge=ny(He),un=sy(He);ee.push(...Ge),Re.push(...un)}for(const Ge of Re)re.push(`${Ge}:${_e}`)}const ce=await this.client.core.crypto.generateSharedKey(P,K.publicKey);let de;ee.length>0&&(de={topic:ce,acknowledged:!0,self:{publicKey:P,metadata:this.client.metadata},peer:K,controller:K.publicKey,expiry:Ke(zi),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:Oy([...new Set(ee)],[...new Set(re)]),transportType:o},await this.client.core.relayer.subscribe(ce,{transportType:o}),await this.client.session.set(ce,de),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:K.metadata}),de=this.client.session.get(ce)),(U=this.client.metadata.redirect)!=null&&U.linkMode&&(z=K.metadata.redirect)!=null&&z.linkMode&&(G=K.metadata.redirect)!=null&&G.universal&&n&&(this.client.core.addLinkModeSupportedApp(K.metadata.redirect.universal),this.client.session.update(ce,{transportType:De.link_mode})),L({auths:J,session:de})};this.events.once($,v),this.events.once(m,_);let B;try{if(i){const T=Es("wc_sessionAuthenticate",x,V);this.client.core.history.set(A,T);const U=await this.client.core.crypto.encode("",T,{type:Zc,encoding:rs});B=wu(n,A,U)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:x,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:V}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:C,expiry:Je.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:C.id})])}catch(T){throw this.events.off($,v),this.events.off(m,_),T}return await this.setProposal(C.id,C),await this.setAuthRequest(V,{request:Et(xe({},x),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:B??I,response:R}}),H(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Ts.authenticated_session_approve_started]}});try{this.isInitialized()}catch(w){throw i.setError(Va.no_internet_connection),w}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(Va.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||De.relay;a===De.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),l=Fu(c),h={type:Fn,receiverPublicKey:c,senderPublicKey:u},f=[],d=[];for(const w of s){if(!await ry({cacao:w,projectId:this.client.core.projectId})){i.setError(Va.invalid_cacao);const O=ve("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:l,error:O,encodeOpts:h}),new Error(O.message)}i.addTrace(Ts.cacaos_verified);const{p:E}=w,A=Lu(E.resources),I=[Nf(E.iss)],P=sl(E.iss);if(A){const O=ny(A),b=sy(A);f.push(...O),I.push(...b)}for(const O of I)d.push(`${O}:${P}`)}const g=await this.client.core.crypto.generateSharedKey(u,c);i.addTrace(Ts.create_authenticated_session_topic);let p;if((f==null?void 0:f.length)>0){p={topic:g,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Ke(zi),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Oy([...new Set(f)],[...new Set(d)]),transportType:a},i.addTrace(Ts.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(g,{transportType:a})}catch(w){throw i.setError(Va.subscribe_authenticated_session_topic_failure),w}i.addTrace(Ts.subscribe_authenticated_session_topic_success),await this.client.session.set(g,p),i.addTrace(Ts.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Ts.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:n,result:{cacaos:s,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(w){throw i.setError(Va.authenticated_session_approve_publish_failure),w}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:p}}),H(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:s}=t,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===De.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Fu(o),u={type:Fn,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:u,rpcOpts:Je.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,ve("USER_DISCONNECTED"))}),H(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:s}=t;return w0(n,s)}),H(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),H(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),H(this,"deleteSession",async t=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,ve("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Am).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===s&&this.deletePendingSessionRequest(u.id,ve("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Hr.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),H(this,"deleteProposal",async(t,n)=>{if(n)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Ns.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,ve("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),H(this,"deletePendingSessionRequest",async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=Hr.idle,this.client.events.emit("session_request_expire",{id:t}))}),H(this,"deletePendingAuthRequest",async(t,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])}),H(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),H(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,Ke(Je.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),H(this,"setAuthRequest",async(t,n)=>{const{request:s,pairingTopic:i,transportType:o=De.relay}=n;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),H(this,"setPendingSessionRequest",async t=>{const{id:n,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||Ke(Je.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),H(this,"sendRequest",async t=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:u,appLink:l,tvf:h}=t,f=Es(s,i,c);let d;const g=!!l;try{const E=g?rs:Rr;d=await this.client.core.crypto.encode(n,f,{encoding:E})}catch(E){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),E}let p;if(dB.includes(s)){const E=rn(JSON.stringify(f)),A=rn(d);p=await this.client.core.verify.register({id:A,decryptedId:E})}const w=Je[s].req;if(w.attestation=p,o&&(w.ttl=o),a&&(w.id=a),this.client.core.history.set(n,f),g){const E=wu(l,n,d);await global.Linking.openURL(E,this.client.name)}else{const E=Je[s].req;o&&(E.ttl=o),a&&(E.id=a),E.tvf=Et(xe({},h),{correlationId:f.id}),u?(E.internal=Et(xe({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,d,E)):this.client.core.relayer.publish(n,d,E).catch(A=>this.client.logger.error(A))}return f.id}),H(this,"sendResult",async t=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,u=jl(n,i);let l;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const g=h?rs:Rr;l=await this.client.core.crypto.encode(s,u,Et(xe({},a||{}),{encoding:g}))}catch(g){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),g}let f,d;try{f=await this.client.core.history.get(s,n);const g=f.request;try{this.shouldSetTVF(g.method,g.params)&&(d=this.getTVFParams(n,g.params,i))}catch(p){this.client.logger.warn("sendResult() -> getTVFParams() failed",p)}}catch(g){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),g}if(h){const g=wu(c,s,l);await global.Linking.openURL(g,this.client.name)}else{const g=f.request.method,p=Je[g].res;p.tvf=Et(xe({},d),{correlationId:n}),o?(p.internal=Et(xe({},p.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,l,p)):this.client.core.relayer.publish(s,l,p).catch(w=>this.client.logger.error(w))}await this.client.core.history.resolve(u)}),H(this,"sendError",async t=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,u=Hl(n,i);let l;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const d=h?rs:Rr;l=await this.client.core.crypto.encode(s,u,Et(xe({},o||{}),{encoding:d}))}catch(d){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),d}let f;try{f=await this.client.core.history.get(s,n)}catch(d){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),d}if(h){const d=wu(c,s,l);await global.Linking.openURL(d,this.client.name)}else{const d=f.request.method,g=a||Je[d].res;this.client.core.relayer.publish(s,l,g)}await this.client.core.history.resolve(u)}),H(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;es(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{es(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),H(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),H(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),H(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Hr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Hr.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Hr.idle}),H(this,"processRequest",async t=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),H(this,"onRelayEventResponse",async t=>{const{topic:n,payload:s,transportType:i}=t,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),H(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:s}=W("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),H(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),H(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const u=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u==null||u.setError(yn.proposal_listener_not_found)),this.isValidConnect(xe({},s.params));const l=a.expiryTimestamp||Ke(Je.wc_sessionPropose.req.ttl),h=xe({id:c,pairingTopic:n,expiryTimestamp:l},a);await this.setProposal(c,h);const f=await this.getVerifyContext({attestationId:i,hash:rn(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});u==null||u.addTrace(zr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:f})}catch(u){await this.sendError({id:c,topic:n,error:u,rpcOpts:Je.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),H(this,"onSessionProposeResponse",async(t,n,s)=>{const{id:i}=n;if(Gr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const l=await this.client.core.crypto.generateSharedKey(c,u);this.pendingSessions.set(i,{sessionTopic:l,pairingTopic:t,proposalId:i,publicKey:c});const h=await this.client.core.relayer.subscribe(l,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:t})}else if(pr(n)){await this.client.proposal.delete(i,ve("USER_DISCONNECTED"));const o=we("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),H(this,"onSessionSettleRequest",async(t,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:u,sessionProperties:l,scopedProperties:h,sessionConfig:f}=n.params,d=[...this.pendingSessions.values()].find(w=>w.sessionTopic===t);if(!d)return this.client.logger.error(`Pending session not found for topic ${t}`);const g=this.client.proposal.get(d.proposalId),p=Et(xe(xe(xe({topic:t,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:d.pairingTopic,requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces,controller:a.publicKey,self:{publicKey:d.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},l&&{sessionProperties:l}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),{transportType:De.relay});await this.client.session.set(p.topic,p),await this.setExpiry(p.topic,p.expiry),await this.client.core.pairing.updateMetadata({topic:d.pairingTopic,metadata:p.peer.metadata}),this.client.events.emit("session_connect",{session:p}),this.events.emit(we("session_connect",d.proposalId),{session:p}),this.pendingSessions.delete(d.proposalId),this.deleteProposal(d.proposalId,!1),this.cleanupDuplicatePairings(p),await this.sendResult({id:n.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),H(this,"onSessionSettleResponse",async(t,n)=>{const{id:s}=n;Gr(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(we("session_approve",s),{})):pr(n)&&(await this.client.session.delete(t,ve("USER_DISCONNECTED")),this.events.emit(we("session_approve",s),{error:n.error}))}),H(this,"onSessionUpdateRequest",async(t,n)=>{const{params:s,id:i}=n;try{const o=`${t}_session_update`,a=qa.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:ve("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(xe({topic:t},s));try{qa.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0})}catch(c){throw qa.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),H(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),H(this,"onSessionUpdateResponse",(t,n)=>{const{id:s}=n,i=we("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Gr(n)?this.events.emit(we("session_update",s),{}):pr(n)&&this.events.emit(we("session_update",s),{error:n.error})}),H(this,"onSessionExtendRequest",async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Ke(zi)),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),H(this,"onSessionExtendResponse",(t,n)=>{const{id:s}=n,i=we("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Gr(n)?this.events.emit(we("session_extend",s),{}):pr(n)&&this.events.emit(we("session_extend",s),{error:n.error})}),H(this,"onSessionPingRequest",async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),H(this,"onSessionPingResponse",(t,n)=>{const{id:s}=n,i=we("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Gr(n)?this.events.emit(we("session_ping",s),{}):pr(n)&&this.events.emit(we("session_ping",s),{error:n.error})},500)}),H(this,"onSessionDeleteRequest",async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(tt.publish,async()=>{i(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:ve("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),H(this,"onSessionRequest",async t=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:u,transportType:l}=t,{id:h,params:f}=a;try{await this.isValidRequest(xe({topic:o},f));const d=this.client.session.get(o),g=await this.getVerifyContext({attestationId:c,hash:rn(JSON.stringify(Es("wc_sessionRequest",f,h))),encryptedId:u,metadata:d.peer.metadata,transportType:l}),p={id:h,topic:o,params:f,verifyContext:g};await this.setPendingSessionRequest(p),l===De.link_mode&&(n=d.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=d.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(p):(this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue())}catch(d){await this.sendError({id:h,topic:o,error:d}),this.client.logger.error(d)}}),H(this,"onSessionRequestResponse",(t,n)=>{const{id:s}=n,i=we("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Gr(n)?this.events.emit(we("session_request",s),{result:n.result}):pr(n)&&this.events.emit(we("session_request",s),{error:n.error})}),H(this,"onSessionEventRequest",async(t,n)=>{const{id:s,params:i}=n;try{const o=`${t}_session_event_${i.event.name}`,a=qa.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(xe({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),qa.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),H(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Gr(n)?this.events.emit(we("session_request",s),{result:n.result}):pr(n)&&this.events.emit(we("session_request",s),{error:n.error})}),H(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:u,authPayload:l,expiryTimestamp:h}=i.params,f=await this.getVerifyContext({attestationId:o,hash:rn(JSON.stringify(i)),encryptedId:a,metadata:u.metadata,transportType:c}),d={requester:u,pairingTopic:s,id:i.id,authPayload:l,verifyContext:f,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:d,pairingTopic:s,transportType:c}),c===De.link_mode&&(n=u.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:f})}catch(u){this.client.logger.error(u);const l=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),f=this.getAppLinkIfEnabled(i.params.requester.metadata,c),d={type:Fn,receiverPublicKey:l,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:u,encodeOpts:d,rpcOpts:Je.wc_sessionAuthenticate.autoReject,appLink:f})}}),H(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),H(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Hr.idle,this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay))}),H(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=we("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(we("session_request",i.request.id),{error:n})})}),H(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Hr.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Hr.active,this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),H(this,"emitSessionRequest",t=>{this.client.events.emit("session_request",t)}),H(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:Es("wc_sessionPropose",Et(xe({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),H(this,"isValidConnect",async t=>{if(!$t(t)){const{message:u}=W("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(u)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(ut(n)||await this.isValidPairingTopic(n),!EC(c)){const{message:u}=W("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}if(!ut(s)&&vc(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!ut(i)&&vc(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),ut(o)||this.validateSessionProps(o,"sessionProperties"),!ut(a)){this.validateSessionProps(a,"scopedProperties");const u=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(l=>u.includes(l)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(u)}`)}}),H(this,"validateNamespaces",(t,n)=>{const s=vC(t,"connect()",n);if(s)throw new Error(s.message)}),H(this,"isValidApprove",async t=>{if(!$t(t))throw new Error(W("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),u=Bh(s,"approve()");if(u)throw new Error(u.message);const l=Cy(c.requiredNamespaces,s,"approve()");if(l)throw new Error(l.message);if(!ze(i,!0)){const{message:h}=W("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(ut(o)||this.validateSessionProps(o,"sessionProperties"),!ut(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(a).every(f=>h.has(f)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),H(this,"isValidReject",async t=>{if(!$t(t)){const{message:i}=W("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:n,reason:s}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!IC(s)){const{message:i}=W("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),H(this,"isValidSessionSettleRequest",t=>{if(!$t(t)){const{message:u}=W("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(u)}const{relay:n,controller:s,namespaces:i,expiry:o}=t;if(!z0(n)){const{message:u}=W("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=pC(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Bh(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(es(o)){const{message:u}=W("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),H(this,"isValidUpdate",async t=>{if(!$t(t)){const{message:c}=W("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:s}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Bh(s,"update()");if(o)throw new Error(o.message);const a=Cy(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),H(this,"isValidExtend",async t=>{if(!$t(t)){const{message:s}=W("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),H(this,"isValidRequest",async t=>{if(!$t(t)){const{message:c}=W("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Dy(a,i)){const{message:c}=W("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!PC(s)){const{message:c}=W("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!SC(a,i,s.method)){const{message:c}=W("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!NC(o,Gh)){const{message:c}=W("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Gh.min} and ${Gh.max}`);throw new Error(c)}}),H(this,"isValidRespond",async t=>{var n;if(!$t(t)){const{message:o}=W("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(o){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),o}if(!xC(i)){const{message:o}=W("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),H(this,"isValidPing",async t=>{if(!$t(t)){const{message:s}=W("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),H(this,"isValidEmit",async t=>{if(!$t(t)){const{message:a}=W("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Dy(o,i)){const{message:a}=W("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!OC(s)){const{message:a}=W("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!DC(o,i,s.name)){const{message:a}=W("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),H(this,"isValidDisconnect",async t=>{if(!$t(t)){const{message:s}=W("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),H(this,"isValidAuthenticate",t=>{const{chains:n,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!ze(s,!1))throw new Error("uri is required parameter");if(!ze(i,!1))throw new Error("domain is required parameter");if(!ze(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>Eo(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Eo(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),H(this,"getVerifyContext",async t=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||uc,validation:"UNKNOWN",origin:o.url||""}};try{if(a===De.link_mode){const l=this.getAppLinkIfEnabled(o,a);return c.verified.validation=l&&new URL(l).origin===new URL(o.url).origin?"VALID":"INVALID",c}const u=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});u&&(c.verified.origin=u.origin,c.verified.isScam=u.isScam,c.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),H(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=W("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),H(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),H(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),H(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:s}=W("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(s)}}),H(this,"isLinkModeEnabled",(t,n)=>{var s,i,o,a,c,u,l,h,f;return!t||n!==De.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:u.universal)!==""&&((l=t==null?void 0:t.redirect)==null?void 0:l.universal)!==void 0&&((h=t==null?void 0:t.redirect)==null?void 0:h.universal)!==""&&((f=t==null?void 0:t.redirect)==null?void 0:f.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),H(this,"getAppLinkIfEnabled",(t,n)=>{var s;return this.isLinkModeEnabled(t,n)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),H(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=Kg(t,"topic")||"",s=decodeURIComponent(Kg(t,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:De.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),H(this,"registerLinkModeListeners",async()=>{var t;if(ep()||Ss()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),H(this,"shouldSetTVF",(t,n)=>{if(!n||t!=="wc_sessionRequest")return!1;const{request:s}=n;return Object.keys(Pm).includes(s.method)}),H(this,"getTVFParams",(t,n,s)=>{var i,o;try{const a=n.request.method,c=this.extractTxHashesFromResult(a,s);return Et(xe({correlationId:t,rpcMethods:[a],chainId:n.chainId},this.isValidContractData(n.request.params)&&{contractAddresses:[(o=(i=n.request.params)==null?void 0:i[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),H(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((n=t==null?void 0:t[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),H(this,"extractTxHashesFromResult",(t,n)=>{try{const s=Pm[t];if(typeof n=="string")return[n];const i=n[s.key];if(Br(i))return t==="solana_signAllTransactions"?i.map(o=>iS(o)):i;if(typeof i=="string")return[i]}catch(s){this.client.logger.warn("Error extracting tx hashes from result",s)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(tt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(qu)?this.client.auth.authKeys.get(qu):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:i===De.link_mode?rs:Rr});hp(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:rn(n)})):ql(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(ar.expired,async e=>{const{topic:t,id:n}=u0(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,W("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,W("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Fs.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Fs.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!ze(e,!1)){const{message:t}=W("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(es(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=W("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!ze(e,!1)){const{message:t}=W("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(es(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=W("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=W("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(ze(e,!1)){const{message:t}=W("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=W("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!AC(e)){const{message:t}=W("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(es(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=W("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class xB extends $i{constructor(e,t){super(e,t,uB,fp),this.core=e,this.logger=t}}let OB=class extends $i{constructor(e,t){super(e,t,lB,fp),this.core=e,this.logger=t}};class SB extends $i{constructor(e,t){super(e,t,fB,fp,n=>n.id),this.core=e,this.logger=t}}class DB extends $i{constructor(e,t){super(e,t,yB,Vl,()=>qu),this.core=e,this.logger=t}}class CB extends $i{constructor(e,t){super(e,t,mB,Vl),this.core=e,this.logger=t}}class _B extends $i{constructor(e,t){super(e,t,wB,Vl,n=>n.id),this.core=e,this.logger=t}}var NB=Object.defineProperty,TB=(r,e,t)=>e in r?NB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Kh=(r,e,t)=>TB(r,typeof e!="symbol"?e+"":e,t);class RB{constructor(e,t){this.core=e,this.logger=t,Kh(this,"authKeys"),Kh(this,"pairingTopics"),Kh(this,"requests"),this.authKeys=new DB(this.core,this.logger),this.pairingTopics=new CB(this.core,this.logger),this.requests=new _B(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var BB=Object.defineProperty,$B=(r,e,t)=>e in r?BB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,le=(r,e,t)=>$B(r,typeof e!="symbol"?e+"":e,t);let kB=class wv extends tN{constructor(e){super(e),le(this,"protocol",gv),le(this,"version",yv),le(this,"name",Vh.name),le(this,"metadata"),le(this,"core"),le(this,"logger"),le(this,"events",new nr.EventEmitter),le(this,"engine"),le(this,"session"),le(this,"proposal"),le(this,"pendingRequest"),le(this,"auth"),le(this,"signConfig"),le(this,"on",(n,s)=>this.events.on(n,s)),le(this,"once",(n,s)=>this.events.once(n,s)),le(this,"off",(n,s)=>this.events.off(n,s)),le(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),le(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),le(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),le(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),le(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),le(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||Vh.name,this.metadata=wO(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:eu(Ml({level:(e==null?void 0:e.logger)||Vh.logger}));this.core=(e==null?void 0:e.core)||new cB(e),this.logger=Nt(t,this.name),this.session=new OB(this.core,this.logger),this.proposal=new xB(this.core,this.logger),this.pendingRequest=new SB(this.core,this.logger),this.engine=new PB(this),this.auth=new RB(this.core,this.logger)}static async init(e){const t=new wv(e);return await t.initialize(),t}get context(){return qt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},Q.toMiliseconds(Q.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Au={exports:{}},Om;function UB(){return Om||(Om=1,function(r,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof tn<"u"&&tn,n=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof tn<"u"&&tn||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(m){return m&&DataView.prototype.isPrototypeOf(m)}if(c.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(m){return m&&l.indexOf(Object.prototype.toString.call(m))>-1};function f(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(m)||m==="")throw new TypeError('Invalid character in header field name: "'+m+'"');return m.toLowerCase()}function d(m){return typeof m!="string"&&(m=String(m)),m}function g(m){var v={next:function(){var _=m.shift();return{done:_===void 0,value:_}}};return c.iterable&&(v[Symbol.iterator]=function(){return v}),v}function p(m){this.map={},m instanceof p?m.forEach(function(v,_){this.append(_,v)},this):Array.isArray(m)?m.forEach(function(v){if(v.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+v.length);this.append(v[0],v[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(v){this.append(v,m[v])},this)}p.prototype.append=function(m,v){m=f(m),v=d(v);var _=this.map[m];this.map[m]=_?_+", "+v:v},p.prototype.delete=function(m){delete this.map[f(m)]},p.prototype.get=function(m){return m=f(m),this.has(m)?this.map[m]:null},p.prototype.has=function(m){return this.map.hasOwnProperty(f(m))},p.prototype.set=function(m,v){this.map[f(m)]=d(v)},p.prototype.forEach=function(m,v){for(var _ in this.map)this.map.hasOwnProperty(_)&&m.call(v,this.map[_],_,this)},p.prototype.keys=function(){var m=[];return this.forEach(function(v,_){m.push(_)}),g(m)},p.prototype.values=function(){var m=[];return this.forEach(function(v){m.push(v)}),g(m)},p.prototype.entries=function(){var m=[];return this.forEach(function(v,_){m.push([_,v])}),g(m)},c.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function w(m){if(!m._noBody){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}}function E(m){return new Promise(function(v,_){m.onload=function(){v(m.result)},m.onerror=function(){_(m.error)}})}function A(m){var v=new FileReader,_=E(v);return v.readAsArrayBuffer(m),_}function I(m){var v=new FileReader,_=E(v),B=/charset=([A-Za-z0-9_-]+)/.exec(m.type),T=B?B[1]:"utf-8";return v.readAsText(m,T),_}function P(m){for(var v=new Uint8Array(m),_=new Array(v.length),B=0;B<v.length;B++)_[B]=String.fromCharCode(v[B]);return _.join("")}function O(m){if(m.slice)return m.slice(0);var v=new Uint8Array(m.byteLength);return v.set(new Uint8Array(m)),v.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(m){this.bodyUsed=this.bodyUsed,this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:c.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:c.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():c.arrayBuffer&&c.blob&&u(m)?(this._bodyArrayBuffer=O(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||h(m))?this._bodyArrayBuffer=O(m):this._bodyText=m=Object.prototype.toString.call(m):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var m=w(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var m=w(this);return m||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(A);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var m=w(this);if(m)return m;if(this._bodyBlob)return I(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(P(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(R)}),this.json=function(){return this.text().then(JSON.parse)},this}var x=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function S(m){var v=m.toUpperCase();return x.indexOf(v)>-1?v:m}function C(m,v){if(!(this instanceof C))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');v=v||{};var _=v.body;if(m instanceof C){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,v.headers||(this.headers=new p(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!_&&m._bodyInit!=null&&(_=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=v.credentials||this.credentials||"same-origin",(v.headers||!this.headers)&&(this.headers=new p(v.headers)),this.method=S(v.method||this.method||"GET"),this.mode=v.mode||this.mode||null,this.signal=v.signal||this.signal||function(){if("AbortController"in a){var U=new AbortController;return U.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&_)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(_),(this.method==="GET"||this.method==="HEAD")&&(v.cache==="no-store"||v.cache==="no-cache")){var B=/([?&])_=[^&]*/;if(B.test(this.url))this.url=this.url.replace(B,"$1_="+new Date().getTime());else{var T=/\?/;this.url+=(T.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}C.prototype.clone=function(){return new C(this,{body:this._bodyInit})};function R(m){var v=new FormData;return m.trim().split("&").forEach(function(_){if(_){var B=_.split("="),T=B.shift().replace(/\+/g," "),U=B.join("=").replace(/\+/g," ");v.append(decodeURIComponent(T),decodeURIComponent(U))}}),v}function L(m){var v=new p,_=m.replace(/\r?\n[\t ]+/g," ");return _.split("\r").map(function(B){return B.indexOf(`
`)===0?B.substr(1,B.length):B}).forEach(function(B){var T=B.split(":"),U=T.shift().trim();if(U){var z=T.join(":").trim();try{v.append(U,z)}catch(G){console.warn("Response "+G.message)}}}),v}b.call(C.prototype);function M(m,v){if(!(this instanceof M))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(v||(v={}),this.type="default",this.status=v.status===void 0?200:v.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=v.statusText===void 0?"":""+v.statusText,this.headers=new p(v.headers),this.url=v.url||"",this._initBody(m)}b.call(M.prototype),M.prototype.clone=function(){return new M(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},M.error=function(){var m=new M(null,{status:200,statusText:""});return m.ok=!1,m.status=0,m.type="error",m};var V=[301,302,303,307,308];M.redirect=function(m,v){if(V.indexOf(v)===-1)throw new RangeError("Invalid status code");return new M(null,{status:v,headers:{location:m}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(v,_){this.message=v,this.name=_;var B=Error(v);this.stack=B.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function $(m,v){return new Promise(function(_,B){var T=new C(m,v);if(T.signal&&T.signal.aborted)return B(new o.DOMException("Aborted","AbortError"));var U=new XMLHttpRequest;function z(){U.abort()}U.onload=function(){var K={statusText:U.statusText,headers:L(U.getAllResponseHeaders()||"")};T.url.indexOf("file://")===0&&(U.status<200||U.status>599)?K.status=200:K.status=U.status,K.url="responseURL"in U?U.responseURL:K.headers.get("X-Request-URL");var ee="response"in U?U.response:U.responseText;setTimeout(function(){_(new M(ee,K))},0)},U.onerror=function(){setTimeout(function(){B(new TypeError("Network request failed"))},0)},U.ontimeout=function(){setTimeout(function(){B(new TypeError("Network request timed out"))},0)},U.onabort=function(){setTimeout(function(){B(new o.DOMException("Aborted","AbortError"))},0)};function G(K){try{return K===""&&a.location.href?a.location.href:K}catch{return K}}if(U.open(T.method,G(T.url),!0),T.credentials==="include"?U.withCredentials=!0:T.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&(c.blob?U.responseType="blob":c.arrayBuffer&&(U.responseType="arraybuffer")),v&&typeof v.headers=="object"&&!(v.headers instanceof p||a.Headers&&v.headers instanceof a.Headers)){var J=[];Object.getOwnPropertyNames(v.headers).forEach(function(K){J.push(f(K)),U.setRequestHeader(K,d(v.headers[K]))}),T.headers.forEach(function(K,ee){J.indexOf(ee)===-1&&U.setRequestHeader(ee,K)})}else T.headers.forEach(function(K,ee){U.setRequestHeader(ee,K)});T.signal&&(T.signal.addEventListener("abort",z),U.onreadystatechange=function(){U.readyState===4&&T.signal.removeEventListener("abort",z)}),U.send(typeof T._bodyInit>"u"?null:T._bodyInit)})}return $.polyfill=!0,a.fetch||(a.fetch=$,a.Headers=p,a.Request=C,a.Response=M),o.Headers=p,o.Request=C,o.Response=M,o.fetch=$,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=t.fetch?t:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,r.exports=e}(Au,Au.exports)),Au.exports}var LB=UB();const Sm=Vd(LB);var FB=Object.defineProperty,MB=Object.defineProperties,jB=Object.getOwnPropertyDescriptors,Dm=Object.getOwnPropertySymbols,HB=Object.prototype.hasOwnProperty,qB=Object.prototype.propertyIsEnumerable,Cm=(r,e,t)=>e in r?FB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_m=(r,e)=>{for(var t in e||(e={}))HB.call(e,t)&&Cm(r,t,e[t]);if(Dm)for(var t of Dm(e))qB.call(e,t)&&Cm(r,t,e[t]);return r},Nm=(r,e)=>MB(r,jB(e));const zB={Accept:"application/json","Content-Type":"application/json"},VB="POST",Tm={headers:zB,method:VB},Rm=10;class Ur{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new nr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Qy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Hn(e),n=await(await Sm(this.url,Nm(_m({},Tm),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!Qy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Hn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Sm(e,Nm(_m({},Tm),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ai(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=Hl(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return J0(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Rm&&this.events.setMaxListeners(Rm)}}const Bm="error",GB="wss://relay.walletconnect.org",KB="wc",QB="universal_provider",Iu=`${KB}@2:${QB}:`,bv="https://rpc.walletconnect.org/v1/",ao="generic",WB=`${bv}bundler`,wr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function JB(){}function dp(r){return r==null||typeof r!="object"&&typeof r!="function"}function pp(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function YB(r){if(dp(r))return r;if(Array.isArray(r)||pp(r)||r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);const e=Object.getPrototypeOf(r),t=e.constructor;if(r instanceof Date||r instanceof Map||r instanceof Set)return new t(r);if(r instanceof RegExp){const n=new t(r);return n.lastIndex=r.lastIndex,n}if(r instanceof DataView)return new t(r.buffer.slice(0));if(r instanceof Error){const n=new t(r.message);return n.stack=r.stack,n.name=r.name,n.cause=r.cause,n}if(typeof File<"u"&&r instanceof File)return new t([r],r.name,{type:r.type,lastModified:r.lastModified});if(typeof r=="object"){const n=Object.create(e);return Object.assign(n,r)}return r}function $m(r){return typeof r=="object"&&r!==null}function vv(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function Ev(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const ZB="[object RegExp]",Av="[object String]",Iv="[object Number]",Pv="[object Boolean]",xv="[object Arguments]",XB="[object Symbol]",e8="[object Date]",t8="[object Map]",r8="[object Set]",n8="[object Array]",s8="[object ArrayBuffer]",i8="[object Object]",o8="[object DataView]",a8="[object Uint8Array]",c8="[object Uint8ClampedArray]",u8="[object Uint16Array]",l8="[object Uint32Array]",h8="[object Int8Array]",f8="[object Int16Array]",d8="[object Int32Array]",p8="[object Float32Array]",g8="[object Float64Array]";function y8(r,e){return po(r,void 0,r,new Map,e)}function po(r,e,t,n=new Map,s=void 0){const i=s==null?void 0:s(r,e,t,n);if(i!=null)return i;if(dp(r))return r;if(n.has(r))return n.get(r);if(Array.isArray(r)){const o=new Array(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=po(r[a],a,t,n,s);return Object.hasOwn(r,"index")&&(o.index=r.index),Object.hasOwn(r,"input")&&(o.input=r.input),o}if(r instanceof Date)return new Date(r.getTime());if(r instanceof RegExp){const o=new RegExp(r.source,r.flags);return o.lastIndex=r.lastIndex,o}if(r instanceof Map){const o=new Map;n.set(r,o);for(const[a,c]of r)o.set(a,po(c,a,t,n,s));return o}if(r instanceof Set){const o=new Set;n.set(r,o);for(const a of r)o.add(po(a,void 0,t,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(r))return r.subarray();if(pp(r)){const o=new(Object.getPrototypeOf(r)).constructor(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=po(r[a],a,t,n,s);return o}if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);if(r instanceof DataView){const o=new DataView(r.buffer.slice(0),r.byteOffset,r.byteLength);return n.set(r,o),Ms(o,r,t,n,s),o}if(typeof File<"u"&&r instanceof File){const o=new File([r],r.name,{type:r.type});return n.set(r,o),Ms(o,r,t,n,s),o}if(r instanceof Blob){const o=new Blob([r],{type:r.type});return n.set(r,o),Ms(o,r,t,n,s),o}if(r instanceof Error){const o=new r.constructor;return n.set(r,o),o.message=r.message,o.name=r.name,o.stack=r.stack,o.cause=r.cause,Ms(o,r,t,n,s),o}if(typeof r=="object"&&m8(r)){const o=Object.create(Object.getPrototypeOf(r));return n.set(r,o),Ms(o,r,t,n,s),o}return r}function Ms(r,e,t=r,n,s){const i=[...Object.keys(e),...vv(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(r,a);(c==null||c.writable)&&(r[a]=po(e[a],a,t,n,s))}}function m8(r){switch(Ev(r)){case xv:case n8:case s8:case o8:case Pv:case e8:case p8:case g8:case h8:case f8:case d8:case t8:case Iv:case i8:case ZB:case r8:case Av:case XB:case a8:case c8:case u8:case l8:return!0;default:return!1}}function w8(r,e){return y8(r,(t,n,s,i)=>{if(typeof r=="object")switch(Object.prototype.toString.call(r)){case Iv:case Av:case Pv:{const o=new r.constructor(r==null?void 0:r.valueOf());return Ms(o,r),o}case xv:{const o={};return Ms(o,r),o.length=r.length,o[Symbol.iterator]=r[Symbol.iterator],o}default:return}})}function km(r){return w8(r)}function Um(r){return r!==null&&typeof r=="object"&&Ev(r)==="[object Arguments]"}function b8(r){return pp(r)}function v8(r){var t;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!((t=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&t.writable)?!1:r.toString()===`[object ${n}]`}let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e}function E8(r,...e){const t=e.slice(0,-1),n=e[e.length-1];let s=r;for(let i=0;i<t.length;i++){const o=t[i];s=ed(s,o,n,new Map)}return s}function ed(r,e,t,n){if(dp(r)&&(r=Object(r)),e==null||typeof e!="object")return r;if(n.has(e))return YB(n.get(e));if(n.set(e,r),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...vv(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=r[o];if(Um(a)&&(a={...a}),Um(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=km(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const l=[],h=Reflect.ownKeys(c);for(let f=0;f<h.length;f++){const d=h[f];l[d]=c[d]}c=l}else c=[];const u=t(c,a,o,r,e,n);u!=null?r[o]=u:Array.isArray(a)||$m(c)&&$m(a)?r[o]=ed(c,a,t,n):c==null&&v8(a)?r[o]=ed({},a,t,n):c==null&&b8(a)?r[o]=km(a):(c===void 0||a!==void 0)&&(r[o]=a)}return r}function A8(r,...e){return E8(r,...e,JB)}var I8=Object.defineProperty,P8=Object.defineProperties,x8=Object.getOwnPropertyDescriptors,Lm=Object.getOwnPropertySymbols,O8=Object.prototype.hasOwnProperty,S8=Object.prototype.propertyIsEnumerable,Fm=(r,e,t)=>e in r?I8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Pu=(r,e)=>{for(var t in e||(e={}))O8.call(e,t)&&Fm(r,t,e[t]);if(Lm)for(var t of Lm(e))S8.call(e,t)&&Fm(r,t,e[t]);return r},D8=(r,e)=>P8(r,x8(e));function rr(r,e,t){var n;const s=Eo(r);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${bv}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function ki(r){return r.includes(":")?r.split(":")[1]:r}function Ov(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function C8(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const n=[];return t.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function Qh(r={},e={}){const t=Mm(r),n=Mm(e);return A8(t,n)}function Mm(r){var e,t,n,s;const i={};if(!vc(r))return i;for(const[o,a]of Object.entries(r)){const c=ap(o)?[o]:a.chains,u=a.methods||[],l=a.events||[],h=a.rpcMap||{},f=Za(o);i[f]=D8(Pu(Pu({},i[f]),a),{chains:Uu(c,(e=i[f])==null?void 0:e.chains),methods:Uu(u,(t=i[f])==null?void 0:t.methods),events:Uu(l,(n=i[f])==null?void 0:n.events),rpcMap:Pu(Pu({},h),(s=i[f])==null?void 0:s.rpcMap)})}return i}function jm(r){return r.includes(":")?r.split(":")[2]:r}function Hm(r){const e={};for(const[t,n]of Object.entries(r)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=ap(t)?[t]:n.chains?n.chains:Ov(n.accounts);e[t]={chains:a,methods:s,events:i,accounts:o}}return e}function Wh(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const Sv={},me=r=>Sv[r],Jh=(r,e)=>{Sv[r]=e};var _8=Object.defineProperty,N8=(r,e,t)=>e in r?_8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vi=(r,e,t)=>N8(r,typeof e!="symbol"?e+"":e,t);class T8{constructor(e){Vi(this,"name","polkadot"),Vi(this,"client"),Vi(this,"httpProviders"),Vi(this,"events"),Vi(this,"namespace"),Vi(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ki(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}}var R8=Object.defineProperty,B8=Object.defineProperties,$8=Object.getOwnPropertyDescriptors,qm=Object.getOwnPropertySymbols,k8=Object.prototype.hasOwnProperty,U8=Object.prototype.propertyIsEnumerable,td=(r,e,t)=>e in r?R8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zm=(r,e)=>{for(var t in e||(e={}))k8.call(e,t)&&td(r,t,e[t]);if(qm)for(var t of qm(e))U8.call(e,t)&&td(r,t,e[t]);return r},Vm=(r,e)=>B8(r,$8(e)),Gi=(r,e,t)=>td(r,typeof e!="symbol"?e+"":e,t);class L8{constructor(e){Gi(this,"name","eip155"),Gi(this,"client"),Gi(this,"chainId"),Gi(this,"namespace"),Gi(this,"httpProviders"),Gi(this,"events"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||rr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=parseInt(ki(t));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,s;const i=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0];if(!i)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((s=o==null?void 0:o.sessionProperties)==null?void 0:s.capabilities)||{};if(a!=null&&a[i])return a==null?void 0:a[i];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Vm(zm({},o.sessionProperties||{}),{capabilities:Vm(zm({},a||{}),{[i]:c})})})}catch(u){console.warn("Failed to update session with capabilities",u)}return c}async getCallStatus(e){var t,n;const s=this.client.session.get(e.topic),i=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Es("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${WB}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var F8=Object.defineProperty,M8=(r,e,t)=>e in r?F8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ki=(r,e,t)=>M8(r,typeof e!="symbol"?e+"":e,t);class j8{constructor(e){Ki(this,"name","solana"),Ki(this,"client"),Ki(this,"httpProviders"),Ki(this,"events"),Ki(this,"namespace"),Ki(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ki(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}}var H8=Object.defineProperty,q8=(r,e,t)=>e in r?H8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qi=(r,e,t)=>q8(r,typeof e!="symbol"?e+"":e,t);class z8{constructor(e){Qi(this,"name","cosmos"),Qi(this,"client"),Qi(this,"httpProviders"),Qi(this,"events"),Qi(this,"namespace"),Qi(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ki(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}}var V8=Object.defineProperty,G8=(r,e,t)=>e in r?V8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wi=(r,e,t)=>G8(r,typeof e!="symbol"?e+"":e,t);class K8{constructor(e){Wi(this,"name","algorand"),Wi(this,"client"),Wi(this,"httpProviders"),Wi(this,"events"),Wi(this,"namespace"),Wi(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||rr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new mr(new Ur(n,me("disableProviderPing")))}}var Q8=Object.defineProperty,W8=(r,e,t)=>e in r?Q8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ji=(r,e,t)=>W8(r,typeof e!="symbol"?e+"":e,t);class J8{constructor(e){Ji(this,"name","cip34"),Ji(this,"client"),Ji(this,"httpProviders"),Ji(this,"events"),Ji(this,"namespace"),Ji(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),s=ki(t);e[s]=this.createHttpProvider(s,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}}var Y8=Object.defineProperty,Z8=(r,e,t)=>e in r?Y8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Yi=(r,e,t)=>Z8(r,typeof e!="symbol"?e+"":e,t);class X8{constructor(e){Yi(this,"name","elrond"),Yi(this,"client"),Yi(this,"httpProviders"),Yi(this,"events"),Yi(this,"namespace"),Yi(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ki(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}}var e$=Object.defineProperty,t$=(r,e,t)=>e in r?e$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zi=(r,e,t)=>t$(r,typeof e!="symbol"?e+"":e,t);class r${constructor(e){Zi(this,"name","multiversx"),Zi(this,"client"),Zi(this,"httpProviders"),Zi(this,"events"),Zi(this,"namespace"),Zi(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=ki(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}}var n$=Object.defineProperty,s$=(r,e,t)=>e in r?n$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Xi=(r,e,t)=>s$(r,typeof e!="symbol"?e+"":e,t);class i${constructor(e){Xi(this,"name","near"),Xi(this,"client"),Xi(this,"httpProviders"),Xi(this,"events"),Xi(this,"namespace"),Xi(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||rr(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace);return typeof n>"u"?void 0:new mr(new Ur(n,me("disableProviderPing")))}}var o$=Object.defineProperty,a$=(r,e,t)=>e in r?o$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,eo=(r,e,t)=>a$(r,typeof e!="symbol"?e+"":e,t);class c${constructor(e){eo(this,"name","tezos"),eo(this,"client"),eo(this,"httpProviders"),eo(this,"events"),eo(this,"namespace"),eo(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||rr(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace);return typeof n>"u"?void 0:new mr(new Ur(n))}}var u$=Object.defineProperty,l$=(r,e,t)=>e in r?u$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,to=(r,e,t)=>l$(r,typeof e!="symbol"?e+"":e,t);class h${constructor(e){to(this,"name",ao),to(this,"client"),to(this,"httpProviders"),to(this,"events"),to(this,"namespace"),to(this,"chainId"),this.namespace=e.namespace,this.events=me("events"),this.client=me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{const i=Eo(s);n[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,me("disableProviderPing")))}}var f$=Object.defineProperty,d$=Object.defineProperties,p$=Object.getOwnPropertyDescriptors,Gm=Object.getOwnPropertySymbols,g$=Object.prototype.hasOwnProperty,y$=Object.prototype.propertyIsEnumerable,rd=(r,e,t)=>e in r?f$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,xu=(r,e)=>{for(var t in e||(e={}))g$.call(e,t)&&rd(r,t,e[t]);if(Gm)for(var t of Gm(e))y$.call(e,t)&&rd(r,t,e[t]);return r},Yh=(r,e)=>d$(r,p$(e)),ir=(r,e,t)=>rd(r,typeof e!="symbol"?e+"":e,t);let m$=class Dv{constructor(e){ir(this,"client"),ir(this,"namespaces"),ir(this,"optionalNamespaces"),ir(this,"sessionProperties"),ir(this,"scopedProperties"),ir(this,"events",new Gd),ir(this,"rpcProviders",{}),ir(this,"session"),ir(this,"providerOpts"),ir(this,"logger"),ir(this,"uri"),ir(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:eu(Ml({level:(e==null?void 0:e.logger)||Bm})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Dv(e);return await t.initialize(),t}async request(e,t,n){const[s,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:xu({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>t(null,jl(i,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:ve("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=Hm(this.session.namespaces);this.namespaces=Qh(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const s=await n();this.session=s;const i=Hm(s.namespaces);return this.namespaces=Qh(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,s]=this.validateChain(e),i=this.getProvider(n);i.name===ao?i.setDefaultChain(`${n}:${s}`,t):i.setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Br(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await kB.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Bm,relayUrl:this.providerOpts.relayUrl||GB,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Za(t)))];Jh("client",this.client),Jh("events",this.events),Jh("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=C8(t,this.session),s=Ov(n),i=Qh(this.namespaces,this.optionalNamespaces),o=Yh(xu({},i[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new L8({namespace:o});break;case"algorand":this.rpcProviders[t]=new K8({namespace:o});break;case"solana":this.rpcProviders[t]=new j8({namespace:o});break;case"cosmos":this.rpcProviders[t]=new z8({namespace:o});break;case"polkadot":this.rpcProviders[t]=new T8({namespace:o});break;case"cip34":this.rpcProviders[t]=new J8({namespace:o});break;case"elrond":this.rpcProviders[t]=new X8({namespace:o});break;case"multiversx":this.rpcProviders[t]=new r$({namespace:o});break;case"near":this.rpcProviders[t]=new i$({namespace:o});break;case"tezos":this.rpcProviders[t]=new c$({namespace:o});break;default:this.rpcProviders[ao]?this.rpcProviders[ao].updateNamespace(o):this.rpcProviders[ao]=new h$({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:n}=e;n===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:n,topic:s}=e;if(s!==((t=this.session)==null?void 0:t.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&Br(o)&&this.events.emit("accountsChanged",o.map(jm))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=Za(o),u=Wh(o)!==Wh(a)?`${c}:${Wh(a)}`:o;this.onChainChanged(u)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=t,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Yh(xu({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Yh(xu({},ve("USER_DISCONNECTED")),{data:e.topic})))}),this.on(wr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[ao]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:s,scopedProperties:i}=e;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[t,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(o=>Za(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=Za(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(n,s),this.events.emit("chainChanged",s);const i=this.getProvider(n).getDefaultChain();t||this.getProvider(n).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:n}){var s,i;try{if(t===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(jm);if(!Br(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,s={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Iu}/${e}${s}`,t)}async getFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Iu}/${e}${n}`)}async deleteFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Iu}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const n of t)n.startsWith(Iu)&&await this.client.core.storage.removeItem(n)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}};const w$=m$,b$="wc",v$="ethereum_provider",E$=`${b$}@2:${v$}:`,A$="https://rpc.walletconnect.org/v1/",nd=["eth_sendTransaction","personal_sign"],I$=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],sd=["chainChanged","accountsChanged"],P$=["chainChanged","accountsChanged","message","disconnect","connect"];var x$=Object.defineProperty,O$=Object.defineProperties,S$=Object.getOwnPropertyDescriptors,Km=Object.getOwnPropertySymbols,D$=Object.prototype.hasOwnProperty,C$=Object.prototype.propertyIsEnumerable,id=(r,e,t)=>e in r?x$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,co=(r,e)=>{for(var t in e||(e={}))D$.call(e,t)&&id(r,t,e[t]);if(Km)for(var t of Km(e))C$.call(e,t)&&id(r,t,e[t]);return r},Zh=(r,e)=>O$(r,S$(e)),Vt=(r,e,t)=>id(r,typeof e!="symbol"?e+"":e,t);function ul(r){return Number(r[0].split(":")[1])}function Ou(r){return`0x${r.toString(16)}`}function _$(r){const{chains:e,optionalChains:t,methods:n,optionalMethods:s,events:i,optionalEvents:o,rpcMap:a}=r;if(!Br(e))throw new Error("Invalid chains");const c={chains:e,methods:n||nd,events:i||sd,rpcMap:co({},e.length?{[ul(e)]:a[ul(e)]}:{})},u=i==null?void 0:i.filter(d=>!sd.includes(d)),l=n==null?void 0:n.filter(d=>!nd.includes(d));if(!t&&!o&&!s&&!(u!=null&&u.length)&&!(l!=null&&l.length))return{required:e.length?c:void 0};const h=(u==null?void 0:u.length)&&(l==null?void 0:l.length)||!t,f={chains:[...new Set(h?c.chains.concat(t||[]):t)],methods:[...new Set(c.methods.concat(s!=null&&s.length?s:I$))],events:[...new Set(c.events.concat(o!=null&&o.length?o:P$))],rpcMap:a};return{required:e.length?c:void 0,optional:t.length?f:void 0}}class gp{constructor(){Vt(this,"events",new nr.EventEmitter),Vt(this,"namespace","eip155"),Vt(this,"accounts",[]),Vt(this,"signer"),Vt(this,"chainId",1),Vt(this,"modal"),Vt(this,"rpc"),Vt(this,"STORAGE_KEY",E$),Vt(this,"on",(e,t)=>(this.events.on(e,t),this)),Vt(this,"once",(e,t)=>(this.events.once(e,t),this)),Vt(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),Vt(this,"off",(e,t)=>(this.events.off(e,t),this)),Vt(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){const t=new gp;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,n){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),n)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:n}=_$(this.rpc);try{const s=await new Promise(async(o,a)=>{var c;this.rpc.showQrModal&&((c=this.modal)==null||c.subscribeModal(l=>{!l.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))}));const u=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(Zh(co({namespaces:co({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:e==null?void 0:e.pairingTopic,scopedProperties:u})).then(l=>{o(l)}).catch(l=>{a(new Error(l.message))})});if(!s)return;const i=Hg(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:i),this.setAccounts(i),this.events.emit("connect",{chainId:Ou(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const n=await new Promise(async(i,o)=>{var a;this.rpc.showQrModal&&((a=this.modal)==null||a.subscribeModal(c=>{!c.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),o(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Zh(co({},e),{chains:this.rpc.chains}),t).then(c=>{i(c)}).catch(c=>{o(new Error(c.message))})}),s=n.session;if(s){const i=Hg(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:i),this.setAccounts(i),this.events.emit("connect",{chainId:Ou(this.chainId)})}return n}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Ou(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Zh(co({},ve("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Ou(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,n,s]=e.split(":");return{chainId:`${t}:${n}`,address:s}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,n;const s=(t=e==null?void 0:e.chains)!=null?t:[],i=(n=e==null?void 0:e.optionalChains)!=null?n:[],o=s.concat(i);if(!o.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const a=s.length?(e==null?void 0:e.methods)||nd:[],c=s.length?(e==null?void 0:e.events)||sd:[],u=(e==null?void 0:e.optionalMethods)||[],l=(e==null?void 0:e.optionalEvents)||[],h=(e==null?void 0:e.rpcMap)||this.buildRpcMap(o,e.projectId),f=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(d=>this.formatChainId(d)),optionalChains:i.map(d=>this.formatChainId(d)),methods:a,events:c,optionalMethods:u,optionalEvents:l,rpcMap:h,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:f,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const n={};return e.forEach(s=>{n[s]=this.getRpcUrl(s,t)}),n}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ul(this.rpc.chains):ul(this.rpc.optionalChains),this.signer=await w$.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await cb(()=>import("./index-BhW0X2_7.js").then(s=>s.i),[]);t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(co({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:n,rpcMap:s}=e;t&&Br(t)&&(this.rpc.chains=t.map(i=>this.formatChainId(i)),t.forEach(i=>{this.rpc.rpcMap[i]=(s==null?void 0:s[i])||this.getRpcUrl(i)})),n&&Br(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(i=>this.formatChainId(i)),n.forEach(i=>{this.rpc.rpcMap[i]=(s==null?void 0:s[i])||this.getRpcUrl(i)}))}getRpcUrl(e,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[e])||`${A$}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const N$=gp,T$="6.13.5";function R$(r,e,t){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function Pt(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,i)=>(n[e[i]]=s,n),{})}function te(r,e,t){for(let n in e){let s=e[n];const i=t?t[n]:null;i&&R$(s,i,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function go(r){if(r==null)return"null";if(Array.isArray(r))return"[ "+r.map(go).join(", ")+" ]";if(r instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let n=0;n<r.length;n++)t+=e[r[n]>>4],t+=e[r[n]&15];return t}if(typeof r=="object"&&typeof r.toJSON=="function")return go(r.toJSON());switch(typeof r){case"boolean":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"number":return r.toString();case"string":return JSON.stringify(r);case"object":{const e=Object.keys(r);return e.sort(),"{ "+e.map(t=>`${go(t)}: ${go(r[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function ht(r,e){return r&&r.code===e}function yp(r){return ht(r,"CALL_EXCEPTION")}function Be(r,e,t){let n=r;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${go(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+go(a))}}i.push(`code=${e}`),i.push(`version=${T$}`),i.length&&(r+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return te(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&te(s,{shortMessage:n}),s}function j(r,e,t,n){if(!r)throw Be(e,t,n)}function N(r,e,t,n){j(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function Cv(r,e,t){t==null&&(t=""),t&&(t=": "+t),j(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),j(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");r.push(e)}catch{}return r},[]);function nu(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),j(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function _v(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let i=0;i<n.length;i++)n[i]=parseInt(r.substring(s,s+2),16),s+=2;return n}N(!1,"invalid BytesLike value",e||"value",r)}function fe(r,e){return _v(r,e,!1)}function xt(r,e){return _v(r,e,!0)}function Se(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function mp(r){return Se(r,!0)||r instanceof Uint8Array}const Qm="0123456789abcdef";function Z(r){const e=fe(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=Qm[(s&240)>>4]+Qm[s&15]}return t}function je(r){return"0x"+r.map(e=>Z(e).substring(2)).join("")}function Ao(r){return Se(r,!0)?(r.length-2)/2:fe(r).length}function $e(r,e,t){const n=fe(r);return t!=null&&t>n.length&&j(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),Z(n.slice(e??0,t??n.length))}function Nv(r,e,t){const n=fe(r);j(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),Z(s)}function Oi(r,e){return Nv(r,e,!0)}function B$(r,e){return Nv(r,e,!1)}const Gl=BigInt(0),Tr=BigInt(1),od=9007199254740991;function ll(r,e){const t=Kl(r,"value"),n=BigInt(oe(e,"width"));if(j(t>>n===Gl,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-Tr){const s=(Tr<<n)-Tr;return-((~t&s)+Tr)}return t}function Tv(r,e){let t=X(r,"value");const n=BigInt(oe(e,"width")),s=Tr<<n-Tr;if(t<Gl){t=-t,j(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const i=(Tr<<n)-Tr;return(~t&i)+Tr}else j(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function Ks(r,e){const t=Kl(r,"value"),n=BigInt(oe(e,"bits"));return t&(Tr<<n)-Tr}function X(r,e){switch(typeof r){case"bigint":return r;case"number":return N(Number.isInteger(r),"underflow",e||"value",r),N(r>=-9007199254740991&&r<=od,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){N(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}N(!1,"invalid BigNumberish value",e||"value",r)}function Kl(r,e){const t=X(r,e);return j(t>=Gl,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const Wm="0123456789abcdef";function Ql(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=Wm[t>>4],e+=Wm[t&15];return BigInt(e)}return X(r)}function oe(r,e){switch(typeof r){case"bigint":return N(r>=-9007199254740991&&r<=od,"overflow",e||"value",r),Number(r);case"number":return N(Number.isInteger(r),"underflow",e||"value",r),N(r>=-9007199254740991&&r<=od,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return oe(BigInt(r),e)}catch(t){N(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}N(!1,"invalid numeric value",e||"value",r)}function $$(r){return oe(Ql(r))}function Ps(r,e){let n=Kl(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=oe(e,"width");for(j(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function Ot(r){const e=Kl(r,"value");if(e===Gl)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const i=s*2;n[s]=parseInt(t.substring(i,i+2),16)}return n}function yo(r){let e=Z(mp(r)?r:Ot(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const Jm="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const Ym=BigInt(58);function k$(r){const e=fe(r);let t=Ql(e),n="";for(;t;)n=Jm[Number(t%Ym)]+n,t/=Ym;for(let s=0;s<e.length&&!e[s];s++)n=Jm[0]+n;return n}function U$(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return fe(e)}function L$(r){const e=fe(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var So;class Rv{constructor(e,t,n){k(this,"filter");k(this,"emitter");F(this,So);D(this,So,t),te(this,{emitter:e,filter:n})}async removeListener(){y(this,So)!=null&&await this.emitter.off(this.filter,y(this,So))}}So=new WeakMap;function F$(r,e,t,n,s){N(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function Bv(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return r==="OVERRUN"?t.length-e-1:0}function M$(r,e,t,n,s){return r==="OVERLONG"?(N(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),Bv(r,e,t))}const j$=Object.freeze({error:F$,ignore:Bv,replace:M$});function H$(r,e){e==null&&(e=j$.error);const t=fe(r,"bytes"),n=[];let s=0;for(;s<t.length;){const i=t[s++];if(i>>7===0){n.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let c=i&(1<<8-o-1)-1;for(let u=0;u<o;u++){let l=t[s];if((l&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),c=null;break}c=c<<6|l&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,n,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,n,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,t,n,c);continue}n.push(c)}}return n}function Mn(r,e){N(typeof r=="string","invalid string value","str",r);let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const i=r.charCodeAt(n);N(n<r.length&&(i&64512)===56320,"invalid surrogate pair","str",r);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function q$(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function hl(r,e){return q$(H$(r,e))}function $v(r){async function e(t,n){j(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();j(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),j(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=Be("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=Be("request cancelled","CANCELLED"),o.abort()});const c={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal};let u;try{u=await fetch(t.url,c)}catch(d){throw clearTimeout(a),i||d}clearTimeout(a);const l={};u.headers.forEach((d,g)=>{l[g.toLowerCase()]=d});const h=await u.arrayBuffer(),f=h==null?null:new Uint8Array(h);return{statusCode:u.status,statusMessage:u.statusText,headers:l,body:f}}return e}const z$=12,V$=250;let Zm=$v();const G$=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),K$=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Xh=!1;async function kv(r,e){try{const t=r.match(G$);if(!t)throw new Error("invalid data");return new Is(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?U$(t[3]):W$(t[3]))}catch{return new Is(599,"BAD REQUEST (invalid data: URI)",{},null,new xs(r))}}function Uv(r){async function e(t,n){try{const s=t.match(K$);if(!s)throw new Error("invalid link");return new xs(`${r}${s[2]}`)}catch{return new Is(599,"BAD REQUEST (invalid IPFS URI)",{},null,new xs(t))}}return e}const Su={data:kv,ipfs:Uv("https://gateway.ipfs.io/ipfs/")},Lv=new WeakMap;var Ys,ns;class Q${constructor(e){F(this,Ys);F(this,ns);D(this,Ys,[]),D(this,ns,!1),Lv.set(e,()=>{if(!y(this,ns)){D(this,ns,!0);for(const t of y(this,Ys))setTimeout(()=>{t()},0);D(this,Ys,[])}})}addListener(e){j(!y(this,ns),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),y(this,Ys).push(e)}get cancelled(){return y(this,ns)}checkSignal(){j(!this.cancelled,"cancelled","CANCELLED",{})}}Ys=new WeakMap,ns=new WeakMap;function Du(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var Do,Co,Sr,In,_o,No,Ze,Wt,Pn,Zs,Xs,ei,Kr,Dr,ss,ti,ec;const Il=class Il{constructor(e){F(this,ti);F(this,Do);F(this,Co);F(this,Sr);F(this,In);F(this,_o);F(this,No);F(this,Ze);F(this,Wt);F(this,Pn);F(this,Zs);F(this,Xs);F(this,ei);F(this,Kr);F(this,Dr);F(this,ss);D(this,No,String(e)),D(this,Do,!1),D(this,Co,!0),D(this,Sr,{}),D(this,In,""),D(this,_o,3e5),D(this,Dr,{slotInterval:V$,maxAttempts:z$}),D(this,ss,null)}get url(){return y(this,No)}set url(e){D(this,No,String(e))}get body(){return y(this,Ze)==null?null:new Uint8Array(y(this,Ze))}set body(e){if(e==null)D(this,Ze,void 0),D(this,Wt,void 0);else if(typeof e=="string")D(this,Ze,Mn(e)),D(this,Wt,"text/plain");else if(e instanceof Uint8Array)D(this,Ze,e),D(this,Wt,"application/octet-stream");else if(typeof e=="object")D(this,Ze,Mn(JSON.stringify(e))),D(this,Wt,"application/json");else throw new Error("invalid body")}hasBody(){return y(this,Ze)!=null}get method(){return y(this,In)?y(this,In):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),D(this,In,String(e).toUpperCase())}get headers(){const e=Object.assign({},y(this,Sr));return y(this,Pn)&&(e.authorization=`Basic ${L$(Mn(y(this,Pn)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&y(this,Wt)&&(e["content-type"]=y(this,Wt)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){y(this,Sr)[String(e).toLowerCase()]=String(t)}clearHeaders(){D(this,Sr,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return y(this,Pn)||null}setCredentials(e,t){N(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),D(this,Pn,`${e}:${t}`)}get allowGzip(){return y(this,Co)}set allowGzip(e){D(this,Co,!!e)}get allowInsecureAuthentication(){return!!y(this,Do)}set allowInsecureAuthentication(e){D(this,Do,!!e)}get timeout(){return y(this,_o)}set timeout(e){N(e>=0,"timeout must be non-zero","timeout",e),D(this,_o,e)}get preflightFunc(){return y(this,Zs)||null}set preflightFunc(e){D(this,Zs,e)}get processFunc(){return y(this,Xs)||null}set processFunc(e){D(this,Xs,e)}get retryFunc(){return y(this,ei)||null}set retryFunc(e){D(this,ei,e)}get getUrlFunc(){return y(this,ss)||Zm}set getUrlFunc(e){D(this,ss,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${y(this,Ze)?Z(y(this,Ze)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(y(this,Dr).slotInterval=e.slotInterval),e.maxAttempts!=null&&(y(this,Dr).maxAttempts=e.maxAttempts)}send(){return j(y(this,Kr)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),D(this,Kr,new Q$(this)),q(this,ti,ec).call(this,0,Xm()+this.timeout,0,this,new Is(0,"",{},null,this))}cancel(){j(y(this,Kr)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Lv.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();j(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Il(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,D(s,Sr,Object.assign({},y(this,Sr))),y(this,Ze)&&D(s,Ze,new Uint8Array(y(this,Ze))),D(s,Wt,y(this,Wt)),s}clone(){const e=new Il(this.url);return D(e,In,y(this,In)),y(this,Ze)&&D(e,Ze,y(this,Ze)),D(e,Wt,y(this,Wt)),D(e,Sr,Object.assign({},y(this,Sr))),D(e,Pn,y(this,Pn)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),D(e,Zs,y(this,Zs)),D(e,Xs,y(this,Xs)),D(e,ei,y(this,ei)),D(e,Dr,Object.assign({},y(this,Dr))),D(e,ss,y(this,ss)),e}static lockConfig(){Xh=!0}static getGateway(e){return Su[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Xh)throw new Error("gateways locked");Su[e]=t}static registerGetUrl(e){if(Xh)throw new Error("gateways locked");Zm=e}static createGetUrlFunc(e){return $v()}static createDataGateway(){return kv}static createIpfsGatewayFunc(e){return Uv(e)}};Do=new WeakMap,Co=new WeakMap,Sr=new WeakMap,In=new WeakMap,_o=new WeakMap,No=new WeakMap,Ze=new WeakMap,Wt=new WeakMap,Pn=new WeakMap,Zs=new WeakMap,Xs=new WeakMap,ei=new WeakMap,Kr=new WeakMap,Dr=new WeakMap,ss=new WeakMap,ti=new WeakSet,ec=async function(e,t,n,s,i){var l,h,f;if(e>=y(this,Dr).maxAttempts)return i.makeServerError("exceeded maximum retry limit");j(Xm()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await J$(n);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in Su){const d=await Su[a](o.url,Du(y(s,Kr)));if(d instanceof Is){let g=d;if(this.processFunc){Du(y(s,Kr));try{g=await this.processFunc(o,g)}catch(p){(p.throttle==null||typeof p.stall!="number")&&g.makeServerError("error in post-processing function",p).assertOk()}}return g}o=d}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,Du(y(s,Kr)));let u=new Is(c.statusCode,c.statusMessage,c.headers,c.body,s);if(u.statusCode===301||u.statusCode===302){try{const d=u.headers.location||"";return q(l=o.redirect(d),ti,ec).call(l,e+1,t,0,s,u)}catch{}return u}else if(u.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,u,e))){const d=u.headers["retry-after"];let g=y(this,Dr).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof d=="string"&&d.match(/^[1-9][0-9]*$/)&&(g=parseInt(d)),q(h=o.clone(),ti,ec).call(h,e+1,t,g,s,u)}if(this.processFunc){Du(y(s,Kr));try{u=await this.processFunc(o,u)}catch(d){(d.throttle==null||typeof d.stall!="number")&&u.makeServerError("error in post-processing function",d).assertOk();let g=y(this,Dr).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return d.stall>=0&&(g=d.stall),q(f=o.clone(),ti,ec).call(f,e+1,t,g,s,u)}}return u};let xs=Il;var Nc,Tc,Rc,Jt,To,ri;const Lp=class Lp{constructor(e,t,n,s,i){F(this,Nc);F(this,Tc);F(this,Rc);F(this,Jt);F(this,To);F(this,ri);D(this,Nc,e),D(this,Tc,t),D(this,Rc,Object.keys(n).reduce((o,a)=>(o[a.toLowerCase()]=String(n[a]),o),{})),D(this,Jt,s==null?null:new Uint8Array(s)),D(this,To,i||null),D(this,ri,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${y(this,Jt)?Z(y(this,Jt)):"null"}>`}get statusCode(){return y(this,Nc)}get statusMessage(){return y(this,Tc)}get headers(){return Object.assign({},y(this,Rc))}get body(){return y(this,Jt)==null?null:new Uint8Array(y(this,Jt))}get bodyText(){try{return y(this,Jt)==null?"":hl(y(this,Jt))}catch{j(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{j(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new Lp(599,n,this.headers,this.body,y(this,To)||void 0);return D(s,ri,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:N(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw te(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return y(this,Jt)!=null}get request(){return y(this,To)}ok(){return y(this,ri).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=y(this,ri);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{y(this,Jt)&&(s=hl(y(this,Jt)))}catch{}j(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Nc=new WeakMap,Tc=new WeakMap,Rc=new WeakMap,Jt=new WeakMap,To=new WeakMap,ri=new WeakMap;let Is=Lp;function Xm(){return new Date().getTime()}function W$(r){return Mn(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function J$(r){return new Promise(e=>setTimeout(e,r))}const Y$=BigInt(-1),Pr=BigInt(0),mo=BigInt(1),Z$=BigInt(5),ro={};let Io="0000";for(;Io.length<80;)Io+=Io;function Rs(r){let e=Io;for(;e.length<r;)e+=e;return BigInt("1"+e.substring(0,r))}function Qa(r,e,t){const n=BigInt(e.width);if(e.signed){const s=mo<<n-mo;j(t==null||r>=-s&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r>Pr?r=ll(Ks(r,n),n):r=-ll(Ks(-r,n),n)}else{const s=mo<<n;j(t==null||r>=0&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r=(r%s+s)%s&s-mo}return r}function ef(r){typeof r=="number"&&(r=`fixed128x${r}`);let e=!0,t=128,n=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")e=!1;else{const i=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);N(i,"invalid fixed format","format",r),e=i[1]!=="u",t=parseInt(i[2]),n=parseInt(i[3])}}else if(r){const i=r,o=(a,c,u)=>i[a]==null?u:(N(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),n=o("decimals","number",n)}N(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),N(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function X$(r,e){let t="";r<Pr&&(t="-",r*=Y$);let n=r.toString();if(e===0)return t+n;for(;n.length<=e;)n=Io+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var Cr,Ee,At,be,$s,mn,cd,ud,ld,hd;const ts=class ts{constructor(e,t,n){F(this,be);k(this,"format");F(this,Cr);F(this,Ee);F(this,At);k(this,"_value");nu(e,ro,"FixedNumber"),D(this,Ee,t),D(this,Cr,n);const s=X$(t,n.decimals);te(this,{format:n.name,_value:s}),D(this,At,Rs(n.decimals))}get signed(){return y(this,Cr).signed}get width(){return y(this,Cr).width}get decimals(){return y(this,Cr).decimals}get value(){return y(this,Ee)}addUnsafe(e){return q(this,be,cd).call(this,e)}add(e){return q(this,be,cd).call(this,e,"add")}subUnsafe(e){return q(this,be,ud).call(this,e)}sub(e){return q(this,be,ud).call(this,e,"sub")}mulUnsafe(e){return q(this,be,ld).call(this,e)}mul(e){return q(this,be,ld).call(this,e,"mul")}mulSignal(e){q(this,be,$s).call(this,e);const t=y(this,Ee)*y(e,Ee);return j(t%y(this,At)===Pr,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),q(this,be,mn).call(this,t/y(this,At),"mulSignal")}divUnsafe(e){return q(this,be,hd).call(this,e)}div(e){return q(this,be,hd).call(this,e,"div")}divSignal(e){j(y(e,Ee)!==Pr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),q(this,be,$s).call(this,e);const t=y(this,Ee)*y(this,At);return j(t%y(e,Ee)===Pr,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),q(this,be,mn).call(this,t/y(e,Ee),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=Rs(s):s<0&&(t*=Rs(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=y(this,Ee);return y(this,Ee)<Pr&&(e-=y(this,At)-mo),e=y(this,Ee)/y(this,At)*y(this,At),q(this,be,mn).call(this,e,"floor")}ceiling(){let e=y(this,Ee);return y(this,Ee)>Pr&&(e+=y(this,At)-mo),e=y(this,Ee)/y(this,At)*y(this,At),q(this,be,mn).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=Z$*Rs(t-1);let s=this.value+n;const i=Rs(t);return s=s/i*i,Qa(s,y(this,Cr),"round"),new ts(ro,s,y(this,Cr))}isZero(){return y(this,Ee)===Pr}isNegative(){return y(this,Ee)<Pr}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return ts.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:oe(t),i=ef(n);let o=X(e,"value");const a=s-i.decimals;if(a>0){const c=Rs(a);j(o%c===Pr,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=Rs(-a));return Qa(o,i,"fromValue"),new ts(ro,o,i)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);N(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=ef(t);let i=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=Io;j(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(n[1]+i+o);return Qa(a,s,"fromString"),new ts(ro,a,s)}static fromBytes(e,t){let n=Ql(fe(e,"value"));const s=ef(t);return s.signed&&(n=ll(n,s.width)),Qa(n,s,"fromBytes"),new ts(ro,n,s)}};Cr=new WeakMap,Ee=new WeakMap,At=new WeakMap,be=new WeakSet,$s=function(e){N(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},mn=function(e,t){return e=Qa(e,y(this,Cr),t),new ts(ro,e,y(this,Cr))},cd=function(e,t){return q(this,be,$s).call(this,e),q(this,be,mn).call(this,y(this,Ee)+y(e,Ee),t)},ud=function(e,t){return q(this,be,$s).call(this,e),q(this,be,mn).call(this,y(this,Ee)-y(e,Ee),t)},ld=function(e,t){return q(this,be,$s).call(this,e),q(this,be,mn).call(this,y(this,Ee)*y(e,Ee)/y(this,At),t)},hd=function(e,t){return j(y(e,Ee)!==Pr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),q(this,be,$s).call(this,e),q(this,be,mn).call(this,y(this,Ee)*y(this,At)/y(e,Ee),t)};let ad=ts;function ek(r){let e=r.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function ew(r,e,t){let n=0;for(let s=0;s<t;s++)n=n*256+r[e+s];return n}function tw(r,e,t,n){const s=[];for(;t<e+1+n;){const i=Fv(r,t);s.push(i.result),t+=i.consumed,j(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:r,length:n,offset:e})}return{consumed:1+n,result:s}}function Fv(r,e){j(r.length!==0,"data too short","BUFFER_OVERRUN",{buffer:r,length:0,offset:1});const t=n=>{j(n<=r.length,"data short segment too short","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n})};if(r[e]>=248){const n=r[e]-247;t(e+1+n);const s=ew(r,e+1,n);return t(e+1+n+s),tw(r,e,e+1+n,n+s)}else if(r[e]>=192){const n=r[e]-192;return t(e+1+n),tw(r,e,e+1,n)}else if(r[e]>=184){const n=r[e]-183;t(e+1+n);const s=ew(r,e+1,n);t(e+1+n+s);const i=Z(r.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:i}}else if(r[e]>=128){const n=r[e]-128;t(e+1+n);const s=Z(r.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:ek(r[e])}}function Wl(r){const e=fe(r,"data"),t=Fv(e,0);return N(t.consumed===e.length,"unexpected junk after rlp payload","data",r),t.result}function rw(r){const e=[];for(;r;)e.unshift(r&255),r>>=8;return e}function Mv(r){if(Array.isArray(r)){let n=[];if(r.forEach(function(i){n=n.concat(Mv(i))}),n.length<=55)return n.unshift(192+n.length),n;const s=rw(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call(fe(r,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=rw(e.length);return t.unshift(183+t.length),t.concat(e)}const nw="0123456789abcdef";function Si(r){let e="0x";for(const t of Mv(r))e+=nw[t>>4],e+=nw[t&15];return e}function tk(r,e){N(typeof r=="string","value must be a string","value",r);let t=18;return t=oe(e,"unit"),ad.fromString(r,{decimals:t,width:512}).value}function rk(r){return tk(r,18)}const St=32,fd=new Uint8Array(St),nk=["then"],Cu={},jv=new WeakMap;function js(r){return jv.get(r)}function sw(r,e){jv.set(r,e)}function Wa(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function dd(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof ba?dd(js(n),n,t):n):r.reduce((n,s,i)=>{let o=e.getValue(s);return s in n||(t&&o instanceof ba&&(o=dd(js(o),o,t)),n[s]=o),n},{})}var Ro;const wo=class wo extends Array{constructor(...t){const n=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;n!==Cu&&(s=t,i=[],o=!1);super(s.length);F(this,Ro);s.forEach((u,l)=>{this[l]=u});const a=i.reduce((u,l)=>(typeof l=="string"&&u.set(l,(u.get(l)||0)+1),u),new Map);if(sw(this,Object.freeze(s.map((u,l)=>{const h=i[l];return h!=null&&a.get(h)===1?h:null}))),D(this,Ro,[]),y(this,Ro)==null&&y(this,Ro),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(u,l,h)=>{if(typeof l=="string"){if(l.match(/^[0-9]+$/)){const d=oe(l,"%index");if(d<0||d>=this.length)throw new RangeError("out of result range");const g=u[d];return g instanceof Error&&Wa(`index ${d}`,g),g}if(nk.indexOf(l)>=0)return Reflect.get(u,l,h);const f=u[l];if(f instanceof Function)return function(...d){return f.apply(this===h?u:this,d)};if(!(l in u))return u.getValue.apply(this===h?u:this,[l])}return Reflect.get(u,l,h)}});return sw(c,js(this)),c}toArray(t){const n=[];return this.forEach((s,i)=>{s instanceof Error&&Wa(`index ${i}`,s),t&&s instanceof wo&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=js(this);return n.reduce((s,i,o)=>(j(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),dd(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=js(this),i=[],o=[];for(let a=t;a<n;a++)i.push(this[a]),o.push(s[a]);return new wo(Cu,i,o)}filter(t,n){const s=js(this),i=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&Wa(`index ${a}`,c),t.call(n,c,a,this)&&(i.push(c),o.push(s[a]))}return new wo(Cu,i,o)}map(t,n){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&Wa(`index ${i}`,o),s.push(t.call(n,o,i,this))}return s}getValue(t){const n=js(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&Wa(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new wo(Cu,t,n)}};Ro=new WeakMap;let ba=wo;function iw(r){let e=Ot(r);return j(e.length<=St,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:St,offset:e.length}),e.length!==St&&(e=xt(je([fd.slice(e.length%St),e]))),e}class zn{constructor(e,t,n,s){k(this,"name");k(this,"type");k(this,"localName");k(this,"dynamic");te(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){N(!1,e,this.localName,t)}}var xn,ni,Bo,zu;class pd{constructor(){F(this,Bo);F(this,xn);F(this,ni);D(this,xn,[]),D(this,ni,0)}get data(){return je(y(this,xn))}get length(){return y(this,ni)}appendWriter(e){return q(this,Bo,zu).call(this,xt(e.data))}writeBytes(e){let t=xt(e);const n=t.length%St;return n&&(t=xt(je([t,fd.slice(n)]))),q(this,Bo,zu).call(this,t)}writeValue(e){return q(this,Bo,zu).call(this,iw(e))}writeUpdatableValue(){const e=y(this,xn).length;return y(this,xn).push(fd),D(this,ni,y(this,ni)+St),t=>{y(this,xn)[e]=iw(t)}}}xn=new WeakMap,ni=new WeakMap,Bo=new WeakSet,zu=function(e){return y(this,xn).push(e),D(this,ni,y(this,ni)+e.length),e.length};var kt,Yt,si,ii,is,Ti,yd,Hv;const Fp=class Fp{constructor(e,t,n){F(this,Ti);k(this,"allowLoose");F(this,kt);F(this,Yt);F(this,si);F(this,ii);F(this,is);te(this,{allowLoose:!!t}),D(this,kt,xt(e)),D(this,si,0),D(this,ii,null),D(this,is,n??1024),D(this,Yt,0)}get data(){return Z(y(this,kt))}get dataLength(){return y(this,kt).length}get consumed(){return y(this,Yt)}get bytes(){return new Uint8Array(y(this,kt))}subReader(e){const t=new Fp(y(this,kt).slice(y(this,Yt)+e),this.allowLoose,y(this,is));return D(t,ii,this),t}readBytes(e,t){let n=q(this,Ti,Hv).call(this,0,e,!!t);return q(this,Ti,yd).call(this,e),D(this,Yt,y(this,Yt)+n.length),n.slice(0,e)}readValue(){return Ql(this.readBytes(St))}readIndex(){return $$(this.readBytes(St))}};kt=new WeakMap,Yt=new WeakMap,si=new WeakMap,ii=new WeakMap,is=new WeakMap,Ti=new WeakSet,yd=function(e){var t;if(y(this,ii))return q(t=y(this,ii),Ti,yd).call(t,e);D(this,si,y(this,si)+e),j(y(this,is)<1||y(this,si)<=y(this,is)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${y(this,is)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:xt(y(this,kt)),offset:y(this,Yt),length:e,info:{bytesRead:y(this,si),dataLength:this.dataLength}})},Hv=function(e,t,n){let s=Math.ceil(t/St)*St;return y(this,Yt)+s>y(this,kt).length&&(this.allowLoose&&n&&y(this,Yt)+t<=y(this,kt).length?s=t:j(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:xt(y(this,kt)),length:y(this,kt).length,offset:y(this,Yt)+s})),y(this,kt).slice(y(this,Yt),y(this,Yt)+s)};let gd=Fp;function fl(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function wp(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function sk(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");fl(r.outputLen),fl(r.blockLen)}function va(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function qv(r,e){wp(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const tf=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zv=r=>r instanceof Uint8Array,ik=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),rf=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),qr=(r,e)=>r<<32-e|r>>>e,ok=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ok)throw new Error("Non little-endian hardware is not supported");function ak(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Jl(r){if(typeof r=="string"&&(r=ak(r)),!zv(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function ck(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!zv(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class bp{clone(){return this._cloneInto()}}function vp(r){const e=n=>r().update(Jl(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function uk(r=32){if(tf&&typeof tf.getRandomValues=="function")return tf.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class Vv extends bp{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,sk(e);const n=Jl(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return va(this),this.iHash.update(e),this}digestInto(e){va(this),wp(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Gv=(r,e,t)=>new Vv(r,e).update(t).digest();Gv.create=(r,e)=>new Vv(r,e);function lk(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,u=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+u,a,n)}class Kv extends bp{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=rf(this.buffer)}update(e){va(this);const{view:t,buffer:n,blockLen:s}=this;e=Jl(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=rf(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){va(this),qv(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;lk(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=rf(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,l[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}}const hk=(r,e,t)=>r&e^~r&t,fk=(r,e,t)=>r&e^r&t^e&t,dk=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Wn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Jn=new Uint32Array(64);class pk extends Kv{constructor(){super(64,32,8,!1),this.A=Wn[0]|0,this.B=Wn[1]|0,this.C=Wn[2]|0,this.D=Wn[3]|0,this.E=Wn[4]|0,this.F=Wn[5]|0,this.G=Wn[6]|0,this.H=Wn[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Jn[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const f=Jn[h-15],d=Jn[h-2],g=qr(f,7)^qr(f,18)^f>>>3,p=qr(d,17)^qr(d,19)^d>>>10;Jn[h]=p+Jn[h-7]+g+Jn[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let h=0;h<64;h++){const f=qr(a,6)^qr(a,11)^qr(a,25),d=l+f+hk(a,c,u)+dk[h]+Jn[h]|0,p=(qr(n,2)^qr(n,13)^qr(n,22))+fk(n,s,i)|0;l=u,u=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,s,i,o,a,c,u,l)}roundClean(){Jn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Qv=vp(()=>new pk),_u=BigInt(2**32-1),md=BigInt(32);function Wv(r,e=!1){return e?{h:Number(r&_u),l:Number(r>>md&_u)}:{h:Number(r>>md&_u)|0,l:Number(r&_u)|0}}function Jv(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=Wv(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const gk=(r,e)=>BigInt(r>>>0)<<md|BigInt(e>>>0),yk=(r,e,t)=>r>>>t,mk=(r,e,t)=>r<<32-t|e>>>t,wk=(r,e,t)=>r>>>t|e<<32-t,bk=(r,e,t)=>r<<32-t|e>>>t,vk=(r,e,t)=>r<<64-t|e>>>t-32,Ek=(r,e,t)=>r>>>t-32|e<<64-t,Ak=(r,e)=>e,Ik=(r,e)=>r,Yv=(r,e,t)=>r<<t|e>>>32-t,Zv=(r,e,t)=>e<<t|r>>>32-t,Xv=(r,e,t)=>e<<t-32|r>>>64-t,eE=(r,e,t)=>r<<t-32|e>>>64-t;function Pk(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const xk=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Ok=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,Sk=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),Dk=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,Ck=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),_k=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,ie={fromBig:Wv,split:Jv,toBig:gk,shrSH:yk,shrSL:mk,rotrSH:wk,rotrSL:bk,rotrBH:vk,rotrBL:Ek,rotr32H:Ak,rotr32L:Ik,rotlSH:Yv,rotlSL:Zv,rotlBH:Xv,rotlBL:eE,add:Pk,add3L:xk,add3H:Ok,add4L:Sk,add4H:Dk,add5H:_k,add5L:Ck},[Nk,Tk]=ie.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Yn=new Uint32Array(80),Zn=new Uint32Array(80);class Rk extends Kv{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:h,Fl:f,Gh:d,Gl:g,Hh:p,Hl:w}=this;return[e,t,n,s,i,o,a,c,u,l,h,f,d,g,p,w]}set(e,t,n,s,i,o,a,c,u,l,h,f,d,g,p,w){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=h|0,this.Fl=f|0,this.Gh=d|0,this.Gl=g|0,this.Hh=p|0,this.Hl=w|0}process(e,t){for(let I=0;I<16;I++,t+=4)Yn[I]=e.getUint32(t),Zn[I]=e.getUint32(t+=4);for(let I=16;I<80;I++){const P=Yn[I-15]|0,O=Zn[I-15]|0,b=ie.rotrSH(P,O,1)^ie.rotrSH(P,O,8)^ie.shrSH(P,O,7),x=ie.rotrSL(P,O,1)^ie.rotrSL(P,O,8)^ie.shrSL(P,O,7),S=Yn[I-2]|0,C=Zn[I-2]|0,R=ie.rotrSH(S,C,19)^ie.rotrBH(S,C,61)^ie.shrSH(S,C,6),L=ie.rotrSL(S,C,19)^ie.rotrBL(S,C,61)^ie.shrSL(S,C,6),M=ie.add4L(x,L,Zn[I-7],Zn[I-16]),V=ie.add4H(M,b,R,Yn[I-7],Yn[I-16]);Yn[I]=V|0,Zn[I]=M|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:h,El:f,Fh:d,Fl:g,Gh:p,Gl:w,Hh:E,Hl:A}=this;for(let I=0;I<80;I++){const P=ie.rotrSH(h,f,14)^ie.rotrSH(h,f,18)^ie.rotrBH(h,f,41),O=ie.rotrSL(h,f,14)^ie.rotrSL(h,f,18)^ie.rotrBL(h,f,41),b=h&d^~h&p,x=f&g^~f&w,S=ie.add5L(A,O,x,Tk[I],Zn[I]),C=ie.add5H(S,E,P,b,Nk[I],Yn[I]),R=S|0,L=ie.rotrSH(n,s,28)^ie.rotrBH(n,s,34)^ie.rotrBH(n,s,39),M=ie.rotrSL(n,s,28)^ie.rotrBL(n,s,34)^ie.rotrBL(n,s,39),V=n&i^n&a^i&a,$=s&o^s&c^o&c;E=p|0,A=w|0,p=d|0,w=g|0,d=h|0,g=f|0,{h,l:f}=ie.add(u|0,l|0,C|0,R|0),u=a|0,l=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const m=ie.add3L(R,M,$);n=ie.add3H(m,C,L,V),s=m|0}({h:n,l:s}=ie.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=ie.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ie.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=ie.add(this.Dh|0,this.Dl|0,u|0,l|0),{h,l:f}=ie.add(this.Eh|0,this.El|0,h|0,f|0),{h:d,l:g}=ie.add(this.Fh|0,this.Fl|0,d|0,g|0),{h:p,l:w}=ie.add(this.Gh|0,this.Gl|0,p|0,w|0),{h:E,l:A}=ie.add(this.Hh|0,this.Hl|0,E|0,A|0),this.set(n,s,i,o,a,c,u,l,h,f,d,g,p,w,E,A)}roundClean(){Yn.fill(0),Zn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Bk=vp(()=>new Rk);function $k(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const ow=$k();ow.crypto||ow.msCrypto;function kk(r){switch(r){case"sha256":return Qv.create();case"sha512":return Bk.create()}N(!1,"invalid hashing algorithm name","algorithm",r)}const[tE,rE,nE]=[[],[],[]],Uk=BigInt(0),Ja=BigInt(1),Lk=BigInt(2),Fk=BigInt(7),Mk=BigInt(256),jk=BigInt(113);for(let r=0,e=Ja,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],tE.push(2*(5*n+t)),rE.push((r+1)*(r+2)/2%64);let s=Uk;for(let i=0;i<7;i++)e=(e<<Ja^(e>>Fk)*jk)%Mk,e&Lk&&(s^=Ja<<(Ja<<BigInt(i))-Ja);nE.push(s)}const[Hk,qk]=Jv(nE,!0),aw=(r,e,t)=>t>32?Xv(r,e,t):Yv(r,e,t),cw=(r,e,t)=>t>32?eE(r,e,t):Zv(r,e,t);function zk(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=t[c],l=t[c+1],h=aw(u,l,1)^t[a],f=cw(u,l,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=rE[o],c=aw(s,i,a),u=cw(s,i,a),l=tE[o];s=r[l],i=r[l+1],r[l]=c,r[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=Hk[n],r[1]^=qk[n]}t.fill(0)}class Ep extends bp{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,fl(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ik(this.state)}keccak(){zk(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){va(this);const{blockLen:t,state:n}=this;e=Jl(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,(t&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){va(this,!1),wp(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return fl(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(qv(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Ep(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Vk=(r,e,t)=>vp(()=>new Ep(e,r,t)),Gk=Vk(1,136,256/8);let sE=!1;const iE=function(r){return Gk(r)};let oE=iE;function Ve(r){const e=fe(r,"data");return Z(oE(e))}Ve._=iE;Ve.lock=function(){sE=!0};Ve.register=function(r){if(sE)throw new TypeError("keccak256 is locked");oE=r};Object.freeze(Ve);const aE=function(r){return kk("sha256").update(r).digest()};let cE=aE,uE=!1;function Ba(r){const e=fe(r,"data");return Z(cE(e))}Ba._=aE;Ba.lock=function(){uE=!0};Ba.register=function(r){if(uE)throw new Error("sha256 is locked");cE=r};Object.freeze(Ba);Object.freeze(Ba);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lE=BigInt(0),Yl=BigInt(1),Kk=BigInt(2),Zl=r=>r instanceof Uint8Array,Qk=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Ea(r){if(!Zl(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=Qk[r[t]];return e}function hE(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function Ap(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Aa(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,i=r.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function wi(r){return Ap(Ea(r))}function Ip(r){if(!Zl(r))throw new Error("Uint8Array expected");return Ap(Ea(Uint8Array.from(r).reverse()))}function Ia(r,e){return Aa(r.toString(16).padStart(e*2,"0"))}function Pp(r,e){return Ia(r,e).reverse()}function Wk(r){return Aa(hE(r))}function Or(r,e,t){let n;if(typeof e=="string")try{n=Aa(e)}catch(i){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Zl(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function Ec(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!Zl(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function Jk(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function Yk(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Zk(r){let e;for(e=0;r>lE;r>>=Yl,e+=1);return e}function Xk(r,e){return r>>BigInt(e)&Yl}const eU=(r,e,t)=>r|(t?Yl:lE)<<BigInt(e),xp=r=>(Kk<<BigInt(r-1))-Yl,nf=r=>new Uint8Array(r),uw=r=>Uint8Array.from(r);function fE(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=nf(r),s=nf(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...h)=>t(s,n,...h),c=(h=nf())=>{s=a(uw([0]),h),n=a(),h.length!==0&&(s=a(uw([1]),h),n=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){n=a();const d=n.slice();f.push(d),h+=n.length}return Ec(...f)};return(h,f)=>{o(),c(h);let d;for(;!(d=f(u()));)c();return o(),d}}const tU={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function su(r,e,t={}){const n=(s,i,o)=>{const a=tU[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const rU=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Xk,bitLen:Zk,bitMask:xp,bitSet:eU,bytesToHex:Ea,bytesToNumberBE:wi,bytesToNumberLE:Ip,concatBytes:Ec,createHmacDrbg:fE,ensureBytes:Or,equalBytes:Jk,hexToBytes:Aa,hexToNumber:Ap,numberToBytesBE:Ia,numberToBytesLE:Pp,numberToHexUnpadded:hE,numberToVarBytesBE:Wk,utf8ToBytes:Yk,validateObject:su},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const st=BigInt(0),Fe=BigInt(1),Hs=BigInt(2),nU=BigInt(3),wd=BigInt(4),lw=BigInt(5),hw=BigInt(8);BigInt(9);BigInt(16);function Ft(r,e){const t=r%e;return t>=st?t:e+t}function sU(r,e,t){if(t<=st||e<st)throw new Error("Expected power/modulo > 0");if(t===Fe)return st;let n=Fe;for(;e>st;)e&Fe&&(n=n*r%t),r=r*r%t,e>>=Fe;return n}function or(r,e,t){let n=r;for(;e-- >st;)n*=n,n%=t;return n}function bd(r,e){if(r===st||e<=st)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=Ft(r,e),n=e,s=st,i=Fe;for(;t!==st;){const a=n/t,c=n%t,u=s-i*a;n=t,t=c,s=i,i=u}if(n!==Fe)throw new Error("invert: does not exist");return Ft(s,e)}function iU(r){const e=(r-Fe)/Hs;let t,n,s;for(t=r-Fe,n=0;t%Hs===st;t/=Hs,n++);for(s=Hs;s<r&&sU(s,e,r)!==r-Fe;s++);if(n===1){const o=(r+Fe)/wd;return function(c,u){const l=c.pow(u,o);if(!c.eql(c.sqr(l),u))throw new Error("Cannot find square root");return l}}const i=(t+Fe)/Hs;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,l=a.pow(a.mul(a.ONE,s),t),h=a.pow(c,i),f=a.pow(c,t);for(;!a.eql(f,a.ONE);){if(a.eql(f,a.ZERO))return a.ZERO;let d=1;for(let p=a.sqr(f);d<u&&!a.eql(p,a.ONE);d++)p=a.sqr(p);const g=a.pow(l,Fe<<BigInt(u-d-1));l=a.sqr(g),h=a.mul(h,g),f=a.mul(f,l),u=d}return h}}function oU(r){if(r%wd===nU){const e=(r+Fe)/wd;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(r%hw===lw){const e=(r-lw)/hw;return function(n,s){const i=n.mul(s,Hs),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,Hs),o),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),s))throw new Error("Cannot find square root");return u}}return iU(r)}const aU=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cU(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=aU.reduce((n,s)=>(n[s]="function",n),e);return su(r,t)}function uU(r,e,t){if(t<st)throw new Error("Expected power > 0");if(t===st)return r.ONE;if(t===Fe)return e;let n=r.ONE,s=e;for(;t>st;)t&Fe&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Fe;return n}function lU(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function dE(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function hU(r,e,t=!1,n={}){if(r<=st)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:i}=dE(r,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=oU(r),a=Object.freeze({ORDER:r,BITS:s,BYTES:i,MASK:xp(s),ZERO:st,ONE:Fe,create:c=>Ft(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return st<=c&&c<r},is0:c=>c===st,isOdd:c=>(c&Fe)===Fe,neg:c=>Ft(-c,r),eql:(c,u)=>c===u,sqr:c=>Ft(c*c,r),add:(c,u)=>Ft(c+u,r),sub:(c,u)=>Ft(c-u,r),mul:(c,u)=>Ft(c*u,r),pow:(c,u)=>uU(a,c,u),div:(c,u)=>Ft(c*bd(u,r),r),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>bd(c,r),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>lU(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>t?Pp(c,i):Ia(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return t?Ip(c):wi(c)}});return Object.freeze(a)}function pE(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function gE(r){const e=pE(r);return e+Math.ceil(e/2)}function fU(r,e,t=!1){const n=r.length,s=pE(e),i=gE(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=t?wi(r):Ip(r),a=Ft(o,e-Fe)+Fe;return t?Pp(a,s):Ia(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const dU=BigInt(0),sf=BigInt(1);function pU(r,e){const t=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=r.ZERO,a=s;for(;i>dU;)i&sf&&(o=o.add(a)),a=a.double(),i>>=sf;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let u=s,l=u;for(let h=0;h<o;h++){l=u,c.push(l);for(let f=1;f<a;f++)l=l.add(u),c.push(l);u=l.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let u=r.ZERO,l=r.BASE;const h=BigInt(2**s-1),f=2**s,d=BigInt(s);for(let g=0;g<a;g++){const p=g*c;let w=Number(o&h);o>>=d,w>c&&(w-=f,o+=sf);const E=p,A=p+Math.abs(w)-1,I=g%2!==0,P=w<0;w===0?l=l.add(t(I,i[E])):u=u.add(t(P,i[A]))}return{p:u,f:l}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let u=i.get(s);return u||(u=this.precomputeWindow(s,c),c!==1&&i.set(s,a(u))),this.wNAF(c,u,o)}}}function yE(r){return cU(r.Fp),su(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...dE(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function gU(r){const e=yE(r);su(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:yU,hexToBytes:mU}=rU,Qs={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=Qs;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:yU(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=Qs,t=typeof r=="string"?mU(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=Qs._parseInt(t.subarray(2)),{d:o,l:a}=Qs._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(r){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,t=u=>{const l=u.toString(16);return l.length&1?`0${l}`:l},n=e(t(r.s)),s=e(t(r.r)),i=n.length/2,o=s.length/2,a=t(i),c=t(o);return`30${t(o+i+4)}02${c}${s}02${a}${n}`}},kn=BigInt(0),gr=BigInt(1);BigInt(2);const fw=BigInt(3);BigInt(4);function wU(r){const e=gU(r),{Fp:t}=e,n=e.toBytes||((g,p,w)=>{const E=p.toAffine();return Ec(Uint8Array.from([4]),t.toBytes(E.x),t.toBytes(E.y))}),s=e.fromBytes||(g=>{const p=g.subarray(1),w=t.fromBytes(p.subarray(0,t.BYTES)),E=t.fromBytes(p.subarray(t.BYTES,2*t.BYTES));return{x:w,y:E}});function i(g){const{a:p,b:w}=e,E=t.sqr(g),A=t.mul(E,g);return t.add(t.add(A,t.mul(g,p)),w)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(g){return typeof g=="bigint"&&kn<g&&g<e.n}function a(g){if(!o(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(g){const{allowedPrivateKeyLengths:p,nByteLength:w,wrapPrivateKey:E,n:A}=e;if(p&&typeof g!="bigint"){if(g instanceof Uint8Array&&(g=Ea(g)),typeof g!="string"||!p.includes(g.length))throw new Error("Invalid key");g=g.padStart(w*2,"0")}let I;try{I=typeof g=="bigint"?g:wi(Or("private key",g,w))}catch{throw new Error(`private key must be ${w} bytes, hex or bigint, not ${typeof g}`)}return E&&(I=Ft(I,A)),a(I),I}const u=new Map;function l(g){if(!(g instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,w,E){if(this.px=p,this.py=w,this.pz=E,p==null||!t.isValid(p))throw new Error("x required");if(w==null||!t.isValid(w))throw new Error("y required");if(E==null||!t.isValid(E))throw new Error("z required")}static fromAffine(p){const{x:w,y:E}=p||{};if(!p||!t.isValid(w)||!t.isValid(E))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");const A=I=>t.eql(I,t.ZERO);return A(w)&&A(E)?h.ZERO:new h(w,E,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const w=t.invertBatch(p.map(E=>E.pz));return p.map((E,A)=>E.toAffine(w[A])).map(h.fromAffine)}static fromHex(p){const w=h.fromAffine(s(Or("pointHex",p)));return w.assertValidity(),w}static fromPrivateKey(p){return h.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y:w}=this.toAffine();if(!t.isValid(p)||!t.isValid(w))throw new Error("bad point: x or y not FE");const E=t.sqr(w),A=i(p);if(!t.eql(E,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(t.isOdd)return!t.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){l(p);const{px:w,py:E,pz:A}=this,{px:I,py:P,pz:O}=p,b=t.eql(t.mul(w,O),t.mul(I,A)),x=t.eql(t.mul(E,O),t.mul(P,A));return b&&x}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:p,b:w}=e,E=t.mul(w,fw),{px:A,py:I,pz:P}=this;let O=t.ZERO,b=t.ZERO,x=t.ZERO,S=t.mul(A,A),C=t.mul(I,I),R=t.mul(P,P),L=t.mul(A,I);return L=t.add(L,L),x=t.mul(A,P),x=t.add(x,x),O=t.mul(p,x),b=t.mul(E,R),b=t.add(O,b),O=t.sub(C,b),b=t.add(C,b),b=t.mul(O,b),O=t.mul(L,O),x=t.mul(E,x),R=t.mul(p,R),L=t.sub(S,R),L=t.mul(p,L),L=t.add(L,x),x=t.add(S,S),S=t.add(x,S),S=t.add(S,R),S=t.mul(S,L),b=t.add(b,S),R=t.mul(I,P),R=t.add(R,R),S=t.mul(R,L),O=t.sub(O,S),x=t.mul(R,C),x=t.add(x,x),x=t.add(x,x),new h(O,b,x)}add(p){l(p);const{px:w,py:E,pz:A}=this,{px:I,py:P,pz:O}=p;let b=t.ZERO,x=t.ZERO,S=t.ZERO;const C=e.a,R=t.mul(e.b,fw);let L=t.mul(w,I),M=t.mul(E,P),V=t.mul(A,O),$=t.add(w,E),m=t.add(I,P);$=t.mul($,m),m=t.add(L,M),$=t.sub($,m),m=t.add(w,A);let v=t.add(I,O);return m=t.mul(m,v),v=t.add(L,V),m=t.sub(m,v),v=t.add(E,A),b=t.add(P,O),v=t.mul(v,b),b=t.add(M,V),v=t.sub(v,b),S=t.mul(C,m),b=t.mul(R,V),S=t.add(b,S),b=t.sub(M,S),S=t.add(M,S),x=t.mul(b,S),M=t.add(L,L),M=t.add(M,L),V=t.mul(C,V),m=t.mul(R,m),M=t.add(M,V),V=t.sub(L,V),V=t.mul(C,V),m=t.add(m,V),L=t.mul(M,m),x=t.add(x,L),L=t.mul(v,m),b=t.mul($,b),b=t.sub(b,L),L=t.mul($,M),S=t.mul(v,S),S=t.add(S,L),new h(b,x,S)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return d.wNAFCached(this,u,p,w=>{const E=t.invertBatch(w.map(A=>A.pz));return w.map((A,I)=>A.toAffine(E[I])).map(h.fromAffine)})}multiplyUnsafe(p){const w=h.ZERO;if(p===kn)return w;if(a(p),p===gr)return this;const{endo:E}=e;if(!E)return d.unsafeLadder(this,p);let{k1neg:A,k1:I,k2neg:P,k2:O}=E.splitScalar(p),b=w,x=w,S=this;for(;I>kn||O>kn;)I&gr&&(b=b.add(S)),O&gr&&(x=x.add(S)),S=S.double(),I>>=gr,O>>=gr;return A&&(b=b.negate()),P&&(x=x.negate()),x=new h(t.mul(x.px,E.beta),x.py,x.pz),b.add(x)}multiply(p){a(p);let w=p,E,A;const{endo:I}=e;if(I){const{k1neg:P,k1:O,k2neg:b,k2:x}=I.splitScalar(w);let{p:S,f:C}=this.wNAF(O),{p:R,f:L}=this.wNAF(x);S=d.constTimeNegate(P,S),R=d.constTimeNegate(b,R),R=new h(t.mul(R.px,I.beta),R.py,R.pz),E=S.add(R),A=C.add(L)}else{const{p:P,f:O}=this.wNAF(w);E=P,A=O}return h.normalizeZ([E,A])[0]}multiplyAndAddUnsafe(p,w,E){const A=h.BASE,I=(O,b)=>b===kn||b===gr||!O.equals(A)?O.multiplyUnsafe(b):O.multiply(b),P=I(this,w).add(I(p,E));return P.is0()?void 0:P}toAffine(p){const{px:w,py:E,pz:A}=this,I=this.is0();p==null&&(p=I?t.ONE:t.inv(A));const P=t.mul(w,p),O=t.mul(E,p),b=t.mul(A,p);if(I)return{x:t.ZERO,y:t.ZERO};if(!t.eql(b,t.ONE))throw new Error("invZ was invalid");return{x:P,y:O}}isTorsionFree(){const{h:p,isTorsionFree:w}=e;if(p===gr)return!0;if(w)return w(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:w}=e;return p===gr?this:w?w(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return Ea(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const f=e.nBitLength,d=pU(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function bU(r){const e=yE(r);return su(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function vU(r){const e=bU(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(m){return kn<m&&m<t.ORDER}function a(m){return Ft(m,n)}function c(m){return bd(m,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:f}=wU({...e,toBytes(m,v,_){const B=v.toAffine(),T=t.toBytes(B.x),U=Ec;return _?U(Uint8Array.from([v.hasEvenY()?2:3]),T):U(Uint8Array.from([4]),T,t.toBytes(B.y))},fromBytes(m){const v=m.length,_=m[0],B=m.subarray(1);if(v===s&&(_===2||_===3)){const T=wi(B);if(!o(T))throw new Error("Point is not on curve");const U=h(T);let z=t.sqrt(U);const G=(z&gr)===gr;return(_&1)===1!==G&&(z=t.neg(z)),{x:T,y:z}}else if(v===i&&_===4){const T=t.fromBytes(B.subarray(0,t.BYTES)),U=t.fromBytes(B.subarray(t.BYTES,2*t.BYTES));return{x:T,y:U}}else throw new Error(`Point of length ${v} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),d=m=>Ea(Ia(m,e.nByteLength));function g(m){const v=n>>gr;return m>v}function p(m){return g(m)?a(-m):m}const w=(m,v,_)=>wi(m.slice(v,_));class E{constructor(v,_,B){this.r=v,this.s=_,this.recovery=B,this.assertValidity()}static fromCompact(v){const _=e.nByteLength;return v=Or("compactSignature",v,_*2),new E(w(v,0,_),w(v,_,2*_))}static fromDER(v){const{r:_,s:B}=Qs.toSig(Or("DER",v));return new E(_,B)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(v){return new E(this.r,this.s,v)}recoverPublicKey(v){const{r:_,s:B,recovery:T}=this,U=x(Or("msgHash",v));if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");const z=T===2||T===3?_+e.n:_;if(z>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const G=(T&1)===0?"02":"03",J=u.fromHex(G+d(z)),K=c(z),ee=a(-U*K),re=a(B*K),ce=u.BASE.multiplyAndAddUnsafe(J,ee,re);if(!ce)throw new Error("point at infinify");return ce.assertValidity(),ce}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Aa(this.toDERHex())}toDERHex(){return Qs.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Aa(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const A={isValidPrivateKey(m){try{return l(m),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const m=gE(e.n);return fU(e.randomBytes(m),e.n)},precompute(m=8,v=u.BASE){return v._setWindowSize(m),v.multiply(BigInt(3)),v}};function I(m,v=!0){return u.fromPrivateKey(m).toRawBytes(v)}function P(m){const v=m instanceof Uint8Array,_=typeof m=="string",B=(v||_)&&m.length;return v?B===s||B===i:_?B===2*s||B===2*i:m instanceof u}function O(m,v,_=!0){if(P(m))throw new Error("first arg must be private key");if(!P(v))throw new Error("second arg must be public key");return u.fromHex(v).multiply(l(m)).toRawBytes(_)}const b=e.bits2int||function(m){const v=wi(m),_=m.length*8-e.nBitLength;return _>0?v>>BigInt(_):v},x=e.bits2int_modN||function(m){return a(b(m))},S=xp(e.nBitLength);function C(m){if(typeof m!="bigint")throw new Error("bigint expected");if(!(kn<=m&&m<S))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ia(m,e.nByteLength)}function R(m,v,_=L){if(["recovered","canonical"].some(ne=>ne in _))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:T}=e;let{lowS:U,prehash:z,extraEntropy:G}=_;U==null&&(U=!0),m=Or("msgHash",m),z&&(m=Or("prehashed msgHash",B(m)));const J=x(m),K=l(v),ee=[C(K),C(J)];if(G!=null){const ne=G===!0?T(t.BYTES):G;ee.push(Or("extraEntropy",ne))}const re=Ec(...ee),ce=J;function de(ne){const Ne=b(ne);if(!f(Ne))return;const He=c(Ne),Re=u.BASE.multiply(Ne).toAffine(),_e=a(Re.x);if(_e===kn)return;const Ge=a(He*a(ce+_e*K));if(Ge===kn)return;let un=(Re.x===_e?0:2)|Number(Re.y&gr),uu=Ge;return U&&g(Ge)&&(uu=p(Ge),un^=1),new E(_e,uu,un)}return{seed:re,k2sig:de}}const L={lowS:e.lowS,prehash:!1},M={lowS:e.lowS,prehash:!1};function V(m,v,_=L){const{seed:B,k2sig:T}=R(m,v,_),U=e;return fE(U.hash.outputLen,U.nByteLength,U.hmac)(B,T)}u.BASE._setWindowSize(8);function $(m,v,_,B=M){var Re;const T=m;if(v=Or("msgHash",v),_=Or("publicKey",_),"strict"in B)throw new Error("options.strict was renamed to lowS");const{lowS:U,prehash:z}=B;let G,J;try{if(typeof T=="string"||T instanceof Uint8Array)try{G=E.fromDER(T)}catch(_e){if(!(_e instanceof Qs.Err))throw _e;G=E.fromCompact(T)}else if(typeof T=="object"&&typeof T.r=="bigint"&&typeof T.s=="bigint"){const{r:_e,s:Ge}=T;G=new E(_e,Ge)}else throw new Error("PARSE");J=u.fromHex(_)}catch(_e){if(_e.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(U&&G.hasHighS())return!1;z&&(v=e.hash(v));const{r:K,s:ee}=G,re=x(v),ce=c(ee),de=a(re*ce),ne=a(K*ce),Ne=(Re=u.BASE.multiplyAndAddUnsafe(J,de,ne))==null?void 0:Re.toAffine();return Ne?a(Ne.x)===K:!1}return{CURVE:e,getPublicKey:I,getSharedSecret:O,sign:V,verify:$,ProjectivePoint:u,Signature:E,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function EU(r){return{hash:r,hmac:(e,...t)=>Gv(r,e,ck(...t)),randomBytes:uk}}function AU(r,e){const t=n=>vU({...r,...EU(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mE=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),dw=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),IU=BigInt(1),vd=BigInt(2),pw=(r,e)=>(r+e/vd)/e;function PU(r){const e=mE,t=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=r*r*r%e,l=u*u*r%e,h=or(l,t,e)*l%e,f=or(h,t,e)*l%e,d=or(f,vd,e)*u%e,g=or(d,s,e)*d%e,p=or(g,i,e)*g%e,w=or(p,a,e)*p%e,E=or(w,c,e)*w%e,A=or(E,a,e)*p%e,I=or(A,t,e)*l%e,P=or(I,o,e)*g%e,O=or(P,n,e)*u%e,b=or(O,vd,e);if(!Ed.eql(Ed.sqr(b),r))throw new Error("Cannot find square root");return b}const Ed=hU(mE,void 0,void 0,{sqrt:PU}),Xn=AU({a:BigInt(0),b:BigInt(7),Fp:Ed,n:dw,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=dw,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-IU*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=pw(i*r,e),c=pw(-n*r,e);let u=Ft(r-a*t-c*s,e),l=Ft(-a*n-c*i,e);const h=u>o,f=l>o;if(h&&(u=e-u),f&&(l=e-l),u>o||l>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:h,k1:u,k2neg:f,k2:l}}}},Qv);BigInt(0);Xn.ProjectivePoint;const Ac="0x0000000000000000000000000000000000000000",gw="0x0000000000000000000000000000000000000000000000000000000000000000",yw=BigInt(0),mw=BigInt(1),ww=BigInt(2),bw=BigInt(27),vw=BigInt(28),Nu=BigInt(35),no={};function Ew(r){return Oi(Ot(r),32)}var $o,ko,Uo,oi;const xr=class xr{constructor(e,t,n,s){F(this,$o);F(this,ko);F(this,Uo);F(this,oi);nu(e,no,"Signature"),D(this,$o,t),D(this,ko,n),D(this,Uo,s),D(this,oi,null)}get r(){return y(this,$o)}set r(e){N(Ao(e)===32,"invalid r","value",e),D(this,$o,Z(e))}get s(){return y(this,ko)}set s(e){N(Ao(e)===32,"invalid s","value",e);const t=Z(e);N(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),D(this,ko,t)}get v(){return y(this,Uo)}set v(e){const t=oe(e,"value");N(t===27||t===28,"invalid v","v",e),D(this,Uo,t)}get networkV(){return y(this,oi)}get legacyChainId(){const e=this.networkV;return e==null?null:xr.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=fe(this.s);return this.yParity&&(e[0]|=128),Z(e)}get compactSerialized(){return je([this.r,this.yParityAndS])}get serialized(){return je([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new xr(no,this.r,this.s,this.v);return this.networkV&&D(e,oi,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=X(e,"v");return t==bw||t==vw?yw:(N(t>=Nu,"invalid EIP-155 v","v",e),(t-Nu)/ww)}static getChainIdV(e,t){return X(e)*ww+BigInt(35+t-27)}static getNormalizedV(e){const t=X(e);return t===yw||t===bw?27:t===mw||t===vw?28:(N(t>=Nu,"invalid v","v",e),t&mw?27:28)}static from(e){function t(u,l){N(u,l,"signature",e)}if(e==null)return new xr(no,gw,gw,27);if(typeof e=="string"){const u=fe(e,"signature");if(u.length===64){const l=Z(u.slice(0,32)),h=u.slice(32,64),f=h[0]&128?28:27;return h[0]&=127,new xr(no,l,Z(h),f)}if(u.length===65){const l=Z(u.slice(0,32)),h=u.slice(32,64);t((h[0]&128)===0,"non-canonical s");const f=xr.getNormalizedV(u[64]);return new xr(no,l,Z(h),f)}t(!1,"invalid raw signature length")}if(e instanceof xr)return e.clone();const n=e.r;t(n!=null,"missing r");const s=Ew(n),i=function(u,l){if(u!=null)return Ew(u);if(l!=null){t(Se(l,32),"invalid yParityAndS");const h=fe(l);return h[0]&=127,Z(h)}t(!1,"missing s")}(e.s,e.yParityAndS);t((fe(i)[0]&128)==0,"non-canonical s");const{networkV:o,v:a}=function(u,l,h){if(u!=null){const f=X(u);return{networkV:f>=Nu?f:void 0,v:xr.getNormalizedV(f)}}if(l!=null)return t(Se(l,32),"invalid yParityAndS"),{v:fe(l)[0]&128?28:27};if(h!=null){switch(oe(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new xr(no,s,i,a);return o&&D(c,oi,o),t(e.yParity==null||oe(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};$o=new WeakMap,ko=new WeakMap,Uo=new WeakMap,oi=new WeakMap;let $r=xr;var On;const qs=class qs{constructor(e){F(this,On);N(Ao(e)===32,"invalid private key","privateKey","[REDACTED]"),D(this,On,Z(e))}get privateKey(){return y(this,On)}get publicKey(){return qs.computePublicKey(y(this,On))}get compressedPublicKey(){return qs.computePublicKey(y(this,On),!0)}sign(e){N(Ao(e)===32,"invalid digest length","digest",e);const t=Xn.sign(xt(e),xt(y(this,On)),{lowS:!0});return $r.from({r:Ps(t.r,32),s:Ps(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=qs.computePublicKey(e);return Z(Xn.getSharedSecret(xt(y(this,On)),fe(t),!1))}static computePublicKey(e,t){let n=fe(e,"key");if(n.length===32){const i=Xn.getPublicKey(n,!!t);return Z(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const s=Xn.ProjectivePoint.fromHex(n);return Z(s.toRawBytes(t))}static recoverPublicKey(e,t){N(Ao(e)===32,"invalid digest length","digest",e);const n=$r.from(t);let s=Xn.Signature.fromCompact(xt(je([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const i=s.recoverPublicKey(xt(e));return N(i!=null,"invalid signautre for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,n){const s=Xn.ProjectivePoint.fromHex(qs.computePublicKey(e).substring(2)),i=Xn.ProjectivePoint.fromHex(qs.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!n)}};On=new WeakMap;let Ic=qs;const xU=BigInt(0),OU=BigInt(36);function Aw(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=fe(Ve(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const Op={};for(let r=0;r<10;r++)Op[String(r)]=String(r);for(let r=0;r<26;r++)Op[String.fromCharCode(65+r)]=String(10+r);const Iw=15;function SU(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>Op[n]).join("");for(;e.length>=Iw;){let n=e.substring(0,Iw);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const DU=function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r}();function CU(r){r=r.toLowerCase();let e=xU;for(let t=0;t<r.length;t++)e=e*OU+DU[r[t]];return e}function Ae(r){if(N(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=Aw(r);return N(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){N(r.substring(2,4)===SU(r),"bad icap checksum","address",r);let e=CU(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Aw("0x"+e)}N(!1,"invalid address","address",r)}function _U(r){const e=Ae(r.from);let n=X(r.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,Ae($e(Ve(Si([e,n])),12))}function wE(r){return r&&typeof r.getAddress=="function"}async function of(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(j(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),N(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),Ae(t)}function Dt(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?Ae(r):(j(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),of(r,e.resolveName(r)));if(wE(r))return of(r,r.getAddress());if(r&&typeof r.then=="function")return of(r,r);N(!1,"unsupported addressable value","target",r)}const wn={};function Y(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new vt(wn,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function ye(r,e){return new vt(wn,`bytes${e||""}`,r,{size:e})}const Pw=Symbol.for("_ethers_typed");var ai;const bn=class bn{constructor(e,t,n,s){k(this,"type");k(this,"value");F(this,ai);k(this,"_typedSymbol");s==null&&(s=null),nu(wn,e,"Typed"),te(this,{_typedSymbol:Pw,type:t,value:n}),D(this,ai,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return y(this,ai)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return y(this,ai)===!0?-1:y(this,ai)===!1?this.value.length:null}static from(e,t){return new bn(wn,e,t)}static uint8(e){return Y(e,8)}static uint16(e){return Y(e,16)}static uint24(e){return Y(e,24)}static uint32(e){return Y(e,32)}static uint40(e){return Y(e,40)}static uint48(e){return Y(e,48)}static uint56(e){return Y(e,56)}static uint64(e){return Y(e,64)}static uint72(e){return Y(e,72)}static uint80(e){return Y(e,80)}static uint88(e){return Y(e,88)}static uint96(e){return Y(e,96)}static uint104(e){return Y(e,104)}static uint112(e){return Y(e,112)}static uint120(e){return Y(e,120)}static uint128(e){return Y(e,128)}static uint136(e){return Y(e,136)}static uint144(e){return Y(e,144)}static uint152(e){return Y(e,152)}static uint160(e){return Y(e,160)}static uint168(e){return Y(e,168)}static uint176(e){return Y(e,176)}static uint184(e){return Y(e,184)}static uint192(e){return Y(e,192)}static uint200(e){return Y(e,200)}static uint208(e){return Y(e,208)}static uint216(e){return Y(e,216)}static uint224(e){return Y(e,224)}static uint232(e){return Y(e,232)}static uint240(e){return Y(e,240)}static uint248(e){return Y(e,248)}static uint256(e){return Y(e,256)}static uint(e){return Y(e,256)}static int8(e){return Y(e,-8)}static int16(e){return Y(e,-16)}static int24(e){return Y(e,-24)}static int32(e){return Y(e,-32)}static int40(e){return Y(e,-40)}static int48(e){return Y(e,-48)}static int56(e){return Y(e,-56)}static int64(e){return Y(e,-64)}static int72(e){return Y(e,-72)}static int80(e){return Y(e,-80)}static int88(e){return Y(e,-88)}static int96(e){return Y(e,-96)}static int104(e){return Y(e,-104)}static int112(e){return Y(e,-112)}static int120(e){return Y(e,-120)}static int128(e){return Y(e,-128)}static int136(e){return Y(e,-136)}static int144(e){return Y(e,-144)}static int152(e){return Y(e,-152)}static int160(e){return Y(e,-160)}static int168(e){return Y(e,-168)}static int176(e){return Y(e,-176)}static int184(e){return Y(e,-184)}static int192(e){return Y(e,-192)}static int200(e){return Y(e,-200)}static int208(e){return Y(e,-208)}static int216(e){return Y(e,-216)}static int224(e){return Y(e,-224)}static int232(e){return Y(e,-232)}static int240(e){return Y(e,-240)}static int248(e){return Y(e,-248)}static int256(e){return Y(e,-256)}static int(e){return Y(e,-256)}static bytes1(e){return ye(e,1)}static bytes2(e){return ye(e,2)}static bytes3(e){return ye(e,3)}static bytes4(e){return ye(e,4)}static bytes5(e){return ye(e,5)}static bytes6(e){return ye(e,6)}static bytes7(e){return ye(e,7)}static bytes8(e){return ye(e,8)}static bytes9(e){return ye(e,9)}static bytes10(e){return ye(e,10)}static bytes11(e){return ye(e,11)}static bytes12(e){return ye(e,12)}static bytes13(e){return ye(e,13)}static bytes14(e){return ye(e,14)}static bytes15(e){return ye(e,15)}static bytes16(e){return ye(e,16)}static bytes17(e){return ye(e,17)}static bytes18(e){return ye(e,18)}static bytes19(e){return ye(e,19)}static bytes20(e){return ye(e,20)}static bytes21(e){return ye(e,21)}static bytes22(e){return ye(e,22)}static bytes23(e){return ye(e,23)}static bytes24(e){return ye(e,24)}static bytes25(e){return ye(e,25)}static bytes26(e){return ye(e,26)}static bytes27(e){return ye(e,27)}static bytes28(e){return ye(e,28)}static bytes29(e){return ye(e,29)}static bytes30(e){return ye(e,30)}static bytes31(e){return ye(e,31)}static bytes32(e){return ye(e,32)}static address(e){return new bn(wn,"address",e)}static bool(e){return new bn(wn,"bool",!!e)}static bytes(e){return new bn(wn,"bytes",e)}static string(e){return new bn(wn,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new bn(wn,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Pw}static dereference(e,t){if(bn.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};ai=new WeakMap;let vt=bn;class NU extends zn{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=vt.dereference(t,"string");try{n=Ae(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return Ae(Ps(e.readValue(),20))}}class TU extends zn{constructor(t){super(t.name,t.type,"_",t.dynamic);k(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function bE(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(u=>{const l=u.localName;return j(l,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:t}),j(!c[l],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:t}),c[l]=!0,t[l]})}else N(!1,"invalid tuple value","tuple",t);N(e.length===n.length,"types/value length mismatch","tuple",t);let s=new pd,i=new pd,o=[];e.forEach((c,u)=>{let l=n[u];if(c.dynamic){let h=i.length;c.encode(i,l);let f=s.writeUpdatableValue();o.push(d=>{f(d+h)})}else c.encode(s,l)}),o.forEach(c=>{c(s.length)});let a=r.appendWriter(s);return a+=r.appendWriter(i),a}function vE(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=r.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(u){if(ht(u,"BUFFER_OVERRUN"))throw u;o=u,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(r)}catch(a){if(ht(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),n.push(i.localName||null)}),ba.fromItems(t,n)}class RU extends zn{constructor(t,n,s){const i=t.type+"["+(n>=0?n:"")+"]",o=n===-1||t.dynamic;super("array",i,s,o);k(this,"coder");k(this,"length");te(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=vt.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),Cv(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return bE(t,o,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),j(n*St<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*St,length:t.dataLength}));let s=[];for(let i=0;i<n;i++)s.push(new TU(this.coder));return vE(t,s)}}class BU extends zn{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=vt.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class EE extends zn{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=xt(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class $U extends EE{constructor(e){super("bytes",e)}decode(e){return Z(super.decode(e))}}class kU extends zn{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);k(this,"size");te(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=xt(vt.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return Z(t.readBytes(this.size))}}const UU=new Uint8Array([]);class LU extends zn{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(UU)}decode(e){return e.readBytes(0),null}}const FU=BigInt(0),MU=BigInt(1),jU=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class HU extends zn{constructor(t,n,s){const i=(n?"int":"uint")+t*8;super(i,i,s,!1);k(this,"size");k(this,"signed");te(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=X(vt.dereference(n,this.type)),i=Ks(jU,St*8);if(this.signed){let o=Ks(i,this.size*8-1);(s>o||s<-(o+MU))&&this._throwError("value out-of-bounds",n),s=Tv(s,8*St)}else(s<FU||s>Ks(i,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=Ks(t.readValue(),this.size*8);return this.signed&&(n=ll(n,this.size*8)),n}}class qU extends EE{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Mn(vt.dereference(t,"string")))}decode(e){return hl(super.decode(e))}}class Tu extends zn{constructor(t,n){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,s);k(this,"coders");te(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,n){const s=vt.dereference(n,"tuple");return bE(t,this.coders,s)}decode(t){return vE(t,this.coders)}}function Di(r){return Ve(Mn(r))}var zU="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const xw=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),Ow=4;function VU(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),s=1,i=[0,1];for(let O=1;O<n;O++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,u=0;function l(){return c==0&&(u=u<<8|r[e++],c=8),u>>--c&1}const h=31,f=2**h,d=f>>>1,g=d>>1,p=f-1;let w=0;for(let O=0;O<h;O++)w=w<<1|l();let E=[],A=0,I=f;for(;;){let O=Math.floor(((w-A+1)*s-1)/I),b=0,x=n;for(;x-b>1;){let R=b+x>>>1;O<i[R]?x=R:b=R}if(b==0)break;E.push(b);let S=A+Math.floor(I*i[b]/s),C=A+Math.floor(I*i[b+1]/s)-1;for(;((S^C)&d)==0;)w=w<<1&p|l(),S=S<<1&p,C=C<<1&p|1;for(;S&~C&g;)w=w&d|w<<1&p>>>1|l(),S=S<<1^d,C=(C^d)<<1|d|1;A=S,I=1+C-S}let P=n-4;return E.map(O=>{switch(O-P){case 3:return P+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return P+256+(r[a++]<<8|r[a++]);case 1:return P+r[a++];default:return O-1}})}function GU(r){let e=0;return()=>r[e++]}function AE(r){return GU(VU(KU(r)))}function KU(r){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=r.length,n=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[r.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}function QU(r){return r&1?~r>>1:r>>1}function WU(r,e){let t=Array(r);for(let n=0,s=0;n<r;n++)t[n]=s+=QU(e());return t}function Pc(r,e=0){let t=[];for(;;){let n=r(),s=r();if(!s)break;e+=n;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function IE(r){return xc(()=>{let e=Pc(r);if(e.length)return e})}function PE(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(JU(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(YU(t,r))}return e.flat()}function xc(r){let e=[];for(;;){let t=r(e.length);if(!t)break;e.push(t)}return e}function xE(r,e,t){let n=Array(r).fill().map(()=>[]);for(let s=0;s<e;s++)WU(r,t).forEach((i,o)=>n[o].push(i));return n}function JU(r,e){let t=1+e(),n=e(),s=xc(e);return xE(s.length,1+r,e).flatMap((o,a)=>{let[c,...u]=o;return Array(s[a]).fill().map((l,h)=>{let f=h*n;return[c+h*t,u.map(d=>d+f)]})})}function YU(r,e){let t=1+e();return xE(t,1+r,e).map(s=>[s[0],s.slice(1)])}function ZU(r){let e=[],t=Pc(r);return s(n([]),[]),e;function n(i){let o=r(),a=xc(()=>{let c=Pc(r).map(u=>t[u]);if(c.length)return n(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let u of o)for(let l of u.Q)s(u,[...a,l],c)}}}function XU(r){return r.toString(16).toUpperCase().padStart(2,"0")}function OE(r){return`{${XU(r)}}`}function eL(r){let e=[];for(let t=0,n=r.length;t<n;){let s=r.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function Pa(r){let t=r.length;if(t<4096)return String.fromCodePoint(...r);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...r.slice(s,s+=4096)));return n.join("")}function tL(r,e){let t=r.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=r[s]-e[s];return n}var rL="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Oc=44032,dl=4352,pl=4449,gl=4519,SE=19,DE=21,xa=28,yl=DE*xa,nL=SE*yl,sL=Oc+nL,iL=dl+SE,oL=pl+DE,aL=gl+xa;function tc(r){return r>>24&255}function CE(r){return r&16777215}let Ad,Sw,Id,Vu;function cL(){let r=AE(rL);Ad=new Map(IE(r).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),Sw=new Set(Pc(r)),Id=new Map,Vu=new Map;for(let[e,t]of PE(r)){if(!Sw.has(e)&&t.length==2){let[n,s]=t,i=Vu.get(n);i||(i=new Map,Vu.set(n,i)),i.set(s,e)}Id.set(e,t.reverse())}}function _E(r){return r>=Oc&&r<sL}function uL(r,e){if(r>=dl&&r<iL&&e>=pl&&e<oL)return Oc+(r-dl)*yl+(e-pl)*xa;if(_E(r)&&e>gl&&e<aL&&(r-Oc)%xa==0)return r+(e-gl);{let t=Vu.get(r);return t&&(t=t.get(e),t)?t:-1}}function NE(r){Ad||cL();let e=[],t=[],n=!1;function s(i){let o=Ad.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of r)for(;;){if(i<128)e.push(i);else if(_E(i)){let o=i-Oc,a=o/yl|0,c=o%yl/xa|0,u=o%xa;s(dl+a),s(pl+c),u>0&&s(gl+u)}else{let o=Id.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(n&&e.length>1){let i=tc(e[0]);for(let o=1;o<e.length;o++){let a=tc(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let u=e[c+1];if(e[c+1]=e[c],e[c]=u,!c||(i=tc(e[--c]),i<=a))break}i=tc(e[o])}}return e}function lL(r){let e=[],t=[],n=-1,s=0;for(let i of r){let o=tc(i),a=CE(i);if(n==-1)o==0?n=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(n,...t),t.length=0,n=a):t.push(a),s=o;else{let c=uL(n,a);c>=0?n=c:s==0&&o==0?(e.push(n),n=a):(t.push(a),s=o)}}return n>=0&&e.push(n,...t),e}function TE(r){return NE(r).map(CE)}function hL(r){return lL(NE(r))}const Dw=45,RE=".",BE=65039,$E=1,ml=r=>Array.from(r);function Sc(r,e){return r.P.has(e)||r.Q.has(e)}class fL extends Array{get is_emoji(){return!0}}let Pd,kE,Ws,xd,UE,Po,af,uo,ks,Cw,Od;function Sp(){if(Pd)return;let r=AE(zU);const e=()=>Pc(r),t=()=>new Set(e()),n=(l,h)=>h.forEach(f=>l.add(f));Pd=new Map(PE(r)),kE=t(),Ws=e(),xd=new Set(e().map(l=>Ws[l])),Ws=new Set(Ws),UE=t(),t();let s=IE(r),i=r();const o=()=>{let l=new Set;return e().forEach(h=>n(l,s[h])),n(l,e()),l};Po=xc(l=>{let h=xc(r).map(f=>f+96);if(h.length){let f=l>=i;h[0]-=32,h=Pa(h),f&&(h=`Restricted[${h}]`);let d=o(),g=o(),p=!r();return{N:h,P:d,Q:g,M:p,R:f}}}),af=t(),uo=new Map;let a=e().concat(ml(af)).sort((l,h)=>l-h);a.forEach((l,h)=>{let f=r(),d=a[h]=f?a[h-f]:{V:[],M:new Map};d.V.push(l),af.has(l)||uo.set(l,d)});for(let{V:l,M:h}of new Set(uo.values())){let f=[];for(let g of l){let p=Po.filter(E=>Sc(E,g)),w=f.find(({G:E})=>p.some(A=>E.has(A)));w||(w={G:new Set,V:[]},f.push(w)),w.V.push(g),n(w.G,p)}let d=f.flatMap(g=>ml(g.G));for(let{G:g,V:p}of f){let w=new Set(d.filter(E=>!g.has(E)));for(let E of p)h.set(E,w)}}ks=new Set;let c=new Set;const u=l=>ks.has(l)?c.add(l):ks.add(l);for(let l of Po){for(let h of l.P)u(h);for(let h of l.Q)u(h)}for(let l of ks)!uo.has(l)&&!c.has(l)&&uo.set(l,$E);n(ks,TE(ks)),Cw=ZU(r).map(l=>fL.from(l)).sort(tL),Od=new Map;for(let l of Cw){let h=[Od];for(let f of l){let d=h.map(g=>{let p=g.get(f);return p||(p=new Map,g.set(f,p)),p});f===BE?h.push(...d):h=d}for(let f of h)f.V=l}}function Dp(r){return(LE(r)?"":`${Cp(Xl([r]))} `)+OE(r)}function Cp(r){return`"${r}"‎`}function dL(r){if(r.length>=4&&r[2]==Dw&&r[3]==Dw)throw new Error(`invalid label extension: "${Pa(r.slice(0,4))}"`)}function pL(r){for(let t=r.lastIndexOf(95);t>0;)if(r[--t]!==95)throw new Error("underscore allowed only at start")}function gL(r){let e=r[0],t=xw.get(e);if(t)throw hc(`leading ${t}`);let n=r.length,s=-1;for(let i=1;i<n;i++){e=r[i];let o=xw.get(e);if(o){if(s==i)throw hc(`${t} + ${o}`);s=i+1,t=o}}if(s==n)throw hc(`trailing ${t}`)}function Xl(r,e=1/0,t=OE){let n=[];yL(r[0])&&n.push("◌"),r.length>e&&(e>>=1,r=[...r.slice(0,e),8230,...r.slice(-e)]);let s=0,i=r.length;for(let o=0;o<i;o++){let a=r[o];LE(a)&&(n.push(Pa(r.slice(s,o))),n.push(t(a)),s=o+1)}return n.push(Pa(r.slice(s,i))),n.join("")}function yL(r){return Sp(),Ws.has(r)}function LE(r){return Sp(),UE.has(r)}function mL(r){return EL(wL(r,hL,PL))}function wL(r,e,t){if(!r)return[];Sp();let n=0;return r.split(RE).map(s=>{let i=eL(s),o={input:i,offset:n};n+=i.length+1;try{let a=o.tokens=IL(i,e,t),c=a.length,u;if(!c)throw new Error("empty label");let l=o.output=a.flat();if(pL(l),!(o.emoji=c>1||a[0].is_emoji)&&l.every(f=>f<128))dL(l),u="ASCII";else{let f=a.flatMap(d=>d.is_emoji?[]:d);if(!f.length)u="Emoji";else{if(Ws.has(l[0]))throw hc("leading combining mark");for(let p=1;p<c;p++){let w=a[p];if(!w.is_emoji&&Ws.has(w[0]))throw hc(`emoji + combining mark: "${Pa(a[p-1])} + ${Xl([w[0]])}"`)}gL(l);let d=ml(new Set(f)),[g]=vL(d);AL(g,f),bL(g,d),u=g.N}}o.type=u}catch(a){o.error=a}return o})}function bL(r,e){let t,n=[];for(let s of e){let i=uo.get(s);if(i===$E)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):ml(o),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(i=>Sc(s,i)))throw new Error(`whole-script confusable: ${r.N}/${s.N}`)}}function vL(r){let e=Po;for(let t of r){let n=e.filter(s=>Sc(s,t));if(!n.length)throw Po.some(s=>Sc(s,t))?ME(e[0],t):FE(t);if(e=n,n.length==1)break}return e}function EL(r){return r.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(r.length==1?s:`Invalid label ${Cp(Xl(e,63))}: ${s}`)}return Pa(n)}).join(RE)}function FE(r){return new Error(`disallowed character: ${Dp(r)}`)}function ME(r,e){let t=Dp(e),n=Po.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${r.N} + ${t}`)}function hc(r){return new Error(`illegal placement: ${r}`)}function AL(r,e){for(let t of e)if(!Sc(r,t))throw ME(r,t);if(r.M){let t=TE(e);for(let n=1,s=t.length;n<s;n++)if(xd.has(t[n])){let i=n+1;for(let o;i<s&&xd.has(o=t[i]);i++)for(let a=n;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${Dp(o)}`);if(i-n>Ow)throw new Error(`excessive non-spacing marks: ${Cp(Xl(t.slice(n-1,i)))} (${i-n}/${Ow})`);n=i}}}function IL(r,e,t){let n=[],s=[];for(r=r.slice().reverse();r.length;){let i=xL(r);if(i)s.length&&(n.push(e(s)),s=[]),n.push(t(i));else{let o=r.pop();if(ks.has(o))s.push(o);else{let a=Pd.get(o);if(a)s.push(...a);else if(!kE.has(o))throw FE(o)}}}return s.length&&n.push(e(s)),n}function PL(r){return r.filter(e=>e!=BE)}function xL(r,e){let t=Od,n,s=r.length;for(;s&&(t=t.get(r[--s]),!!t);){let{V:i}=t;i&&(n=i,r.length=s)}return n}const jE=new Uint8Array(32);jE.fill(0);function _w(r){return N(r.length!==0,"invalid ENS name; empty component","comp",r),r}function HE(r){const e=Mn(OL(r)),t=[];if(r.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(_w(e.slice(n,s))),n=s+1);return N(n<e.length,"invalid ENS name; empty component","name",r),t.push(_w(e.slice(n))),t}function OL(r){try{if(r.length===0)throw new Error("empty label");return mL(r)}catch(e){N(!1,`invalid ENS name (${e.message})`,"name",r)}}function Sd(r){N(typeof r=="string","invalid ENS name; not a string","name",r),N(r.length,"invalid ENS name (empty label)","name",r);let e=jE;const t=HE(r);for(;t.length;)e=Ve(je([e,Ve(t.pop())]));return Z(e)}function SL(r,e){const t=e;return N(t<=255,"DNS encoded label cannot exceed 255","length",t),Z(je(HE(r).map(n=>{N(n.length<=t,`label ${JSON.stringify(r)} exceeds ${t} bytes`,"name",r);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}function cf(r,e){return{address:Ae(r),storageKeys:e.map((t,n)=>(N(Se(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function Ui(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(N(t.length===2,"invalid slot set",`value[${n}]`,t),cf(t[0],t[1])):(N(t!=null&&typeof t=="object","invalid address-slot set","value",r),cf(t.address,t.storageKeys)));N(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,i)=>(s[i]=!0,s),{});return cf(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function DL(r){let e;return typeof r=="string"?e=Ic.computePublicKey(r,!1):e=r.publicKey,Ae(Ve("0x"+e.substring(4)).substring(26))}function CL(r,e){return DL(Ic.recoverPublicKey(r,e))}const et=BigInt(0),_L=BigInt(2),NL=BigInt(27),TL=BigInt(28),RL=BigInt(35),BL=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),uf=4096*32;function Nw(r,e){let t=r.toString(16);for(;t.length<2;)t="0"+t;return t+=Ba(e).substring(4),"0x"+t}function eh(r){return r==="0x"?null:Ae(r)}function _p(r,e){try{return Ui(r)}catch(t){N(!1,t.message,e,r)}}function iu(r,e){return r==="0x"?0:oe(r,e)}function Me(r,e){if(r==="0x")return et;const t=X(r,e);return N(t<=BL,"value exceeds uint size",e,t),t}function Ce(r,e){const t=X(r,"value"),n=Ot(t);return N(n.length<=32,"value too large",`tx.${e}`,t),n}function Np(r){return Ui(r).map(e=>[e.address,e.storageKeys])}function $L(r,e){N(Array.isArray(r),`invalid ${e}`,"value",r);for(let t=0;t<r.length;t++)N(Se(r[t],32),"invalid ${ param } hash",`value[${t}]`,r[t]);return r}function kL(r){const e=Wl(r);N(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",r);const t={type:0,nonce:iu(e[0],"nonce"),gasPrice:Me(e[1],"gasPrice"),gasLimit:Me(e[2],"gasLimit"),to:eh(e[3]),value:Me(e[4],"value"),data:Z(e[5]),chainId:et};if(e.length===6)return t;const n=Me(e[6],"v"),s=Me(e[7],"r"),i=Me(e[8],"s");if(s===et&&i===et)t.chainId=n;else{let o=(n-RL)/_L;o<et&&(o=et),t.chainId=o,N(o!==et||n===NL||n===TL,"non-canonical legacy v","v",e[6]),t.signature=$r.from({r:Oi(e[7],32),s:Oi(e[8],32),v:n})}return t}function UL(r,e){const t=[Ce(r.nonce,"nonce"),Ce(r.gasPrice||0,"gasPrice"),Ce(r.gasLimit,"gasLimit"),r.to||"0x",Ce(r.value,"value"),r.data];let n=et;if(r.chainId!=et)n=X(r.chainId,"tx.chainId"),N(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(r.signature){const i=r.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==et&&(t.push(Ot(n)),t.push("0x"),t.push("0x")),Si(t);let s=BigInt(27+e.yParity);return n!==et?s=$r.getChainIdV(n,e.v):BigInt(e.v)!==s&&N(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(Ot(s)),t.push(Ot(e.r)),t.push(Ot(e.s)),Si(t)}function Tp(r,e){let t;try{if(t=iu(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{N(!1,"invalid yParity","yParity",e[0])}const n=Oi(e[1],32),s=Oi(e[2],32),i=$r.from({r:n,s,yParity:t});r.signature=i}function LL(r){const e=Wl(fe(r).slice(1));N(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Z(r));const t={type:2,chainId:Me(e[0],"chainId"),nonce:iu(e[1],"nonce"),maxPriorityFeePerGas:Me(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Me(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Me(e[4],"gasLimit"),to:eh(e[5]),value:Me(e[6],"value"),data:Z(e[7]),accessList:_p(e[8],"accessList")};return e.length===9||Tp(t,e.slice(9)),t}function FL(r,e){const t=[Ce(r.chainId,"chainId"),Ce(r.nonce,"nonce"),Ce(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ce(r.maxFeePerGas||0,"maxFeePerGas"),Ce(r.gasLimit,"gasLimit"),r.to||"0x",Ce(r.value,"value"),r.data,Np(r.accessList||[])];return e&&(t.push(Ce(e.yParity,"yParity")),t.push(Ot(e.r)),t.push(Ot(e.s))),je(["0x02",Si(t)])}function ML(r){const e=Wl(fe(r).slice(1));N(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Z(r));const t={type:1,chainId:Me(e[0],"chainId"),nonce:iu(e[1],"nonce"),gasPrice:Me(e[2],"gasPrice"),gasLimit:Me(e[3],"gasLimit"),to:eh(e[4]),value:Me(e[5],"value"),data:Z(e[6]),accessList:_p(e[7],"accessList")};return e.length===8||Tp(t,e.slice(8)),t}function jL(r,e){const t=[Ce(r.chainId,"chainId"),Ce(r.nonce,"nonce"),Ce(r.gasPrice||0,"gasPrice"),Ce(r.gasLimit,"gasLimit"),r.to||"0x",Ce(r.value,"value"),r.data,Np(r.accessList||[])];return e&&(t.push(Ce(e.yParity,"recoveryParam")),t.push(Ot(e.r)),t.push(Ot(e.s))),je(["0x01",Si(t)])}function HL(r){let e=Wl(fe(r).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];N(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),N(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),N(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),N(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),N(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let c=0;c<e[1].length;c++)n.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}N(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",Z(r));const s={type:3,chainId:Me(e[0],"chainId"),nonce:iu(e[1],"nonce"),maxPriorityFeePerGas:Me(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Me(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Me(e[4],"gasLimit"),to:eh(e[5]),value:Me(e[6],"value"),data:Z(e[7]),accessList:_p(e[8],"accessList"),maxFeePerBlobGas:Me(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),N(s.to!=null,`invalid address for transaction type: ${t}`,"data",r),N(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",r);for(let i=0;i<s.blobVersionedHashes.length;i++)N(Se(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",r);return e.length===11||Tp(s,e.slice(11)),s}function qL(r,e,t){const n=[Ce(r.chainId,"chainId"),Ce(r.nonce,"nonce"),Ce(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ce(r.maxFeePerGas||0,"maxFeePerGas"),Ce(r.gasLimit,"gasLimit"),r.to||Ac,Ce(r.value,"value"),r.data,Np(r.accessList||[]),Ce(r.maxFeePerBlobGas||0,"maxFeePerBlobGas"),$L(r.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(Ce(e.yParity,"yParity")),n.push(Ot(e.r)),n.push(Ot(e.s)),t)?je(["0x03",Si([n,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):je(["0x03",Si(n)])}var Qr,Lo,Fo,Mo,jo,Ho,qo,zo,Vo,Go,Ko,Qo,ci,os,Sn,as,Wo,Gu;const vn=class vn{constructor(){F(this,Wo);F(this,Qr);F(this,Lo);F(this,Fo);F(this,Mo);F(this,jo);F(this,Ho);F(this,qo);F(this,zo);F(this,Vo);F(this,Go);F(this,Ko);F(this,Qo);F(this,ci);F(this,os);F(this,Sn);F(this,as);D(this,Qr,null),D(this,Lo,null),D(this,Mo,0),D(this,jo,et),D(this,Ho,null),D(this,qo,null),D(this,zo,null),D(this,Fo,"0x"),D(this,Vo,et),D(this,Go,et),D(this,Ko,null),D(this,Qo,null),D(this,ci,null),D(this,os,null),D(this,as,null),D(this,Sn,null)}get type(){return y(this,Qr)}set type(e){switch(e){case null:D(this,Qr,null);break;case 0:case"legacy":D(this,Qr,0);break;case 1:case"berlin":case"eip-2930":D(this,Qr,1);break;case 2:case"london":case"eip-1559":D(this,Qr,2);break;case 3:case"cancun":case"eip-4844":D(this,Qr,3);break;default:N(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=y(this,Lo);return e==null&&this.type===3?Ac:e}set to(e){D(this,Lo,e==null?null:Ae(e))}get nonce(){return y(this,Mo)}set nonce(e){D(this,Mo,oe(e,"value"))}get gasLimit(){return y(this,jo)}set gasLimit(e){D(this,jo,X(e))}get gasPrice(){const e=y(this,Ho);return e==null&&(this.type===0||this.type===1)?et:e}set gasPrice(e){D(this,Ho,e==null?null:X(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=y(this,qo);return e??(this.type===2||this.type===3?et:null)}set maxPriorityFeePerGas(e){D(this,qo,e==null?null:X(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=y(this,zo);return e??(this.type===2||this.type===3?et:null)}set maxFeePerGas(e){D(this,zo,e==null?null:X(e,"maxFeePerGas"))}get data(){return y(this,Fo)}set data(e){D(this,Fo,Z(e))}get value(){return y(this,Vo)}set value(e){D(this,Vo,X(e,"value"))}get chainId(){return y(this,Go)}set chainId(e){D(this,Go,X(e))}get signature(){return y(this,Ko)||null}set signature(e){D(this,Ko,e==null?null:$r.from(e))}get accessList(){const e=y(this,Qo)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){D(this,Qo,e==null?null:Ui(e))}get maxFeePerBlobGas(){const e=y(this,ci);return e==null&&this.type===3?et:e}set maxFeePerBlobGas(e){D(this,ci,e==null?null:X(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=y(this,os);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){N(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)N(Se(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}D(this,os,e)}get blobs(){return y(this,as)==null?null:y(this,as).map(e=>Object.assign({},e))}set blobs(e){if(e==null){D(this,as,null);return}const t=[],n=[];for(let s=0;s<e.length;s++){const i=e[s];if(mp(i)){j(y(this,Sn),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=fe(i);if(N(o.length<=uf,"blob is too large",`blobs[${s}]`,i),o.length!==uf){const u=new Uint8Array(uf);u.set(o),o=u}const a=y(this,Sn).blobToKzgCommitment(o),c=Z(y(this,Sn).computeBlobKzgProof(o,a));t.push({data:Z(o),commitment:Z(a),proof:c}),n.push(Nw(1,a))}else{const o=Z(i.commitment);t.push({data:Z(i.data),commitment:o,proof:Z(i.proof)}),n.push(Nw(1,o))}}D(this,as,t),D(this,os,n)}get kzg(){return y(this,Sn)}set kzg(e){D(this,Sn,e)}get hash(){return this.signature==null?null:Ve(q(this,Wo,Gu).call(this,!0,!1))}get unsignedHash(){return Ve(this.unsignedSerialized)}get from(){return this.signature==null?null:CL(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Ic.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return q(this,Wo,Gu).call(this,!0,!0)}get unsignedSerialized(){return q(this,Wo,Gu).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=y(this,ci)!=null||y(this,os);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&j(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),j(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),j(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):t?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return vn.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new vn;if(typeof e=="string"){const n=fe(e);if(n[0]>=127)return vn.from(kL(n));switch(n[0]){case 1:return vn.from(ML(n));case 2:return vn.from(LL(n));case 3:return vn.from(HL(n))}j(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new vn;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=$r.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(N(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),N(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(N(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),N(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};Qr=new WeakMap,Lo=new WeakMap,Fo=new WeakMap,Mo=new WeakMap,jo=new WeakMap,Ho=new WeakMap,qo=new WeakMap,zo=new WeakMap,Vo=new WeakMap,Go=new WeakMap,Ko=new WeakMap,Qo=new WeakMap,ci=new WeakMap,os=new WeakMap,Sn=new WeakMap,as=new WeakMap,Wo=new WeakSet,Gu=function(e,t){j(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return UL(this,n);case 1:return jL(this,n);case 2:return FL(this,n);case 3:return qL(this,n,t?this.blobs:null)}j(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let wl=vn;const qE=new Uint8Array(32);qE.fill(0);const zL=BigInt(-1),zE=BigInt(0),VE=BigInt(1),VL=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function GL(r){const e=fe(r),t=e.length%32;return t?je([e,qE.slice(t)]):Z(e)}const KL=Ps(VE,32),QL=Ps(zE,32),Tw={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},lf=["name","version","chainId","verifyingContract","salt"];function Rw(r){return function(e){return N(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const WL={name:Rw("name"),version:Rw("version"),chainId:function(r){const e=X(r,"domain.chainId");return N(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):yo(e)},verifyingContract:function(r){try{return Ae(r).toLowerCase()}catch{}N(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=fe(r,"domain.salt");return N(e.length===32,'invalid domain value "salt"',"domain.salt",r),Z(e)}};function hf(r){{const e=r.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);N(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",r);const s=Ks(VL,t?n-1:n),i=t?(s+VE)*zL:zE;return function(o){const a=X(o,"value");return N(a>=i&&a<=s,`value out-of-bounds for ${r}`,"value",a),Ps(t?Tv(a,256):a,32)}}}{const e=r.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return N(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",r),function(n){const s=fe(n);return N(s.length===t,`invalid length for ${r}`,"value",n),GL(n)}}}switch(r){case"address":return function(e){return Oi(Ae(e),32)};case"bool":return function(e){return e?KL:QL};case"bytes":return function(e){return Ve(e)};case"string":return function(e){return Di(e)}}return null}function Bw(r,e){return`${r}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function Ru(r){const e=r.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:r}}var Bc,Dn,Jo,Pl,GE;const cr=class cr{constructor(e){F(this,Pl);k(this,"primaryType");F(this,Bc);F(this,Dn);F(this,Jo);D(this,Dn,new Map),D(this,Jo,new Map);const t=new Map,n=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:u,type:l})=>{let{base:h,index:f}=Ru(l);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:u,type:h+(f||"")}}),t.set(c,new Set),n.set(c,[]),s.set(c,new Set)}),D(this,Bc,JSON.stringify(i));for(const c in i){const u=new Set;for(const l of i[c]){N(!u.has(l.name),`duplicate variable name ${JSON.stringify(l.name)} in ${JSON.stringify(c)}`,"types",e),u.add(l.name);const h=Ru(l.type).base;N(h!==c,`circular type reference to ${JSON.stringify(h)}`,"types",e),!hf(h)&&(N(n.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),n.get(h).push(c),t.get(c).add(h))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);N(o.length!==0,"missing primary type","types",e),N(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),te(this,{primaryType:o[0]});function a(c,u){N(!u.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),u.add(c);for(const l of t.get(c))if(n.has(l)){a(l,u);for(const h of u)s.get(h).add(l)}u.delete(c)}a(this.primaryType,new Set);for(const[c,u]of s){const l=Array.from(u);l.sort(),y(this,Dn).set(c,Bw(c,i[c])+l.map(h=>Bw(h,i[h])).join(""))}}get types(){return JSON.parse(y(this,Bc))}getEncoder(e){let t=y(this,Jo).get(e);return t||(t=q(this,Pl,GE).call(this,e),y(this,Jo).set(e,t)),t}encodeType(e){const t=y(this,Dn).get(e);return N(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Ve(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(hf(e))return n(e,t);const s=Ru(e).array;if(s)return N(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],n),o),{});N(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new cr(e)}static getPrimaryType(e){return cr.from(e).primaryType}static hashStruct(e,t,n){return cr.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const s=Tw[n];N(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:s})}return t.sort((n,s)=>lf.indexOf(n.name)-lf.indexOf(s.name)),cr.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return je(["0x1901",cr.hashDomain(e),cr.from(t).hash(n)])}static hash(e,t,n){return Ve(cr.encode(e,t,n))}static async resolveNames(e,t,n,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!Se(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=cr.from(t);o.visit(n,(a,c)=>(a==="address"&&!Se(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,t,n){cr.hashDomain(e);const s={},i=[];lf.forEach(c=>{const u=e[c];u!=null&&(s[c]=WL[c](u),i.push({name:c,type:Tw[c]}))});const o=cr.from(t);t=o.types;const a=Object.assign({},t);return N(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(n),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(n,(c,u)=>{if(c.match(/^bytes(\d*)/))return Z(fe(u));if(c.match(/^u?int/))return X(u).toString();switch(c){case"address":return u.toLowerCase();case"bool":return!!u;case"string":return N(typeof u=="string","invalid string","value",u),u}N(!1,"unsupported type","type",c)})}}};Bc=new WeakMap,Dn=new WeakMap,Jo=new WeakMap,Pl=new WeakSet,GE=function(e){{const s=hf(e);if(s)return s}const t=Ru(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{N(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return y(this,Dn).has(s)&&(a=a.map(Ve)),Ve(je(a))}}const n=this.types[e];if(n){const s=Di(y(this,Dn).get(e));return i=>{const o=n.map(({name:a,type:c})=>{const u=this.getEncoder(c)(i[a]);return y(this,Dn).has(c)?Ve(u):u});return o.unshift(s),je(o)}}N(!1,`unknown type: ${e}`,"type",e)};let bl=cr;function Ct(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const JL="external public payable override",YL=Ct(JL.split(" ")),KE="constant external internal payable private public pure view override",ZL=Ct(KE.split(" ")),QE="constructor error event fallback function receive struct",WE=Ct(QE.split(" ")),JE="calldata memory storage payable indexed",XL=Ct(JE.split(" ")),e4="tuple returns",t4=[QE,JE,e4,KE].join(" "),r4=Ct(t4.split(" ")),n4={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},s4=new RegExp("^(\\s*)"),i4=new RegExp("^([0-9]+)"),o4=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),YE=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),ZE=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var ct,_r,$c,Dd;const xl=class xl{constructor(e){F(this,$c);F(this,ct);F(this,_r);D(this,ct,0),D(this,_r,e.slice())}get offset(){return y(this,ct)}get length(){return y(this,_r).length-y(this,ct)}clone(){return new xl(y(this,_r))}reset(){D(this,ct,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=q(this,$c,Dd).call(this,y(this,ct)+1,e.match+1);return D(this,ct,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;y(this,ct)<e.match-1;){const n=this.peek().linkNext;t.push(q(this,$c,Dd).call(this,y(this,ct)+1,n)),D(this,ct,n)}return D(this,ct,e.match+1),t}peek(){if(y(this,ct)>=y(this,_r).length)throw new Error("out-of-bounds");return y(this,_r)[y(this,ct)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return $a(this,ct)._++,e}toString(){const e=[];for(let t=y(this,ct);t<y(this,_r).length;t++){const n=y(this,_r)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};ct=new WeakMap,_r=new WeakMap,$c=new WeakSet,Dd=function(e=0,t=0){return new xl(y(this,_r).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let kr=xl;function Ds(r){const e=[],t=o=>{const a=i<r.length?JSON.stringify(r[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let n=[],s=[],i=0;for(;i<r.length;){let o=r.substring(i),a=o.match(s4);a&&(i+=a[1].length,o=r.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let u=n4[o[0]]||"";if(u){if(c.type=u,c.text=o[0],i++,u==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(u=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(u==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(u==="OPEN_BRACKET")c.type="BRACKET";else if(u==="CLOSE_BRACKET"){let l=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;l=h+l,e[e.length-1].value=oe(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=l}continue}if(a=o.match(o4),a){if(c.text=a[1],i+=c.text.length,r4.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(ZE)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(i4),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new kr(e.map(o=>Object.freeze(o)))}function $w(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function th(r,e){if(e.peekKeyword(WE)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function qn(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function XE(r){let e=qn(r,ZL);return $w(e,Ct("constant payable nonpayable".split(" "))),$w(e,Ct("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function jn(r,e){return r.popParams().map(t=>ft.from(t,e))}function e1(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return X(r.pop().text);throw new Error("invalid gas")}return null}function Ci(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const a4=new RegExp(/^(.*)\[([0-9]*)\]$/);function kw(r){const e=r.match(ZE);if(N(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);N(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);N(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const Te={},Ht=Symbol.for("_ethers_internal"),Uw="_ParamTypeInternal",Lw="_ErrorInternal",Fw="_EventInternal",Mw="_ConstructorInternal",jw="_FallbackInternal",Hw="_FunctionInternal",qw="_StructInternal";var Yo,Ku;const ur=class ur{constructor(e,t,n,s,i,o,a,c){F(this,Yo);k(this,"name");k(this,"type");k(this,"baseType");k(this,"indexed");k(this,"components");k(this,"arrayLength");k(this,"arrayChildren");if(nu(e,Te,"ParamType"),Object.defineProperty(this,Ht,{value:Uw}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");te(this,{name:t,type:n,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,i)=>n.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return q(this,Yo,Ku).call(this,n,e,t,i=>{s[0]=i}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(ur.isParamType(e))return e;if(typeof e=="string")try{return ur.from(Ds(e),t)}catch{N(!1,"invalid param type","obj",e)}else if(e instanceof kr){let a="",c="",u=null;qn(e,Ct(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",u=e.popParams().map(p=>ur.from(p)),a=`tuple(${u.map(p=>p.format()).join(",")})`):(a=kw(e.popType("TYPE")),c=a);let l=null,h=null;for(;e.length&&e.peekType("BRACKET");){const p=e.pop();l=new ur(Te,"",a,c,null,u,h,l),h=p.value,a+=p.text,c="array",u=null}let f=null;if(qn(e,XL).has("indexed")){if(!t)throw new Error("");f=!0}const g=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new ur(Te,g,a,c,f,u,h,l)}const n=e.name;N(!n||typeof n=="string"&&n.match(YE),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(N(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(a4);if(o){const a=parseInt(o[2]||"-1"),c=ur.from({type:o[1],components:e.components});return new ur(Te,n||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(u=>ur.from(u)):null;return new ur(Te,n||"",i,"tuple",s,a,null,null)}return i=kw(e.type),new ur(Te,n||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[Ht]===Uw}};Yo=new WeakSet,Ku=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,u)=>{var l;q(l=o,Yo,Ku).call(l,e,c,n,h=>{a[u]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,u)=>{var l;q(l=o[u],Yo,Ku).call(l,e,c,n,h=>{a[u]=h})}),s(a);return}const i=n(this.type,t);i.then?e.push(async function(){s(await i)}()):s(i)};let ft=ur;class _i{constructor(e,t,n){k(this,"type");k(this,"inputs");nu(e,Te,"Fragment"),n=Object.freeze(n.slice()),te(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{_i.from(JSON.parse(e))}catch{}return _i.from(Ds(e))}if(e instanceof kr)switch(e.peekKeyword(WE)){case"constructor":return Un.from(e);case"error":return Mt.from(e);case"event":return nn.from(e);case"fallback":case"receive":return An.from(e);case"function":return sn.from(e);case"struct":return bi.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Un.from(e);case"error":return Mt.from(e);case"event":return nn.from(e);case"fallback":case"receive":return An.from(e);case"function":return sn.from(e);case"struct":return bi.from(e)}j(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}N(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Un.isFragment(e)}static isError(e){return Mt.isFragment(e)}static isEvent(e){return nn.isFragment(e)}static isFunction(e){return sn.isFragment(e)}static isStruct(e){return bi.isFragment(e)}}class rh extends _i{constructor(t,n,s,i){super(t,n,i);k(this,"name");N(typeof s=="string"&&s.match(YE),"invalid identifier","name",s),i=Object.freeze(i.slice()),te(this,{name:s})}}function Dc(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class Mt extends rh{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Ht,{value:Lw})}get selector(){return Di(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+Dc(e,this.inputs)),t.join(" ")}static from(e){if(Mt.isFragment(e))return e;if(typeof e=="string")return Mt.from(Ds(e));if(e instanceof kr){const t=th("error",e),n=jn(e);return Ci(e),new Mt(Te,t,n)}return new Mt(Te,e.name,e.inputs?e.inputs.map(ft.from):[])}static isFragment(e){return e&&e[Ht]===Lw}}class nn extends rh{constructor(t,n,s,i){super(t,"event",n,s);k(this,"anonymous");Object.defineProperty(this,Ht,{value:Fw}),te(this,{anonymous:i})}get topicHash(){return Di(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+Dc(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(i=>ft.from(i)),new nn(Te,t,n,!1).topicHash}static from(t){if(nn.isFragment(t))return t;if(typeof t=="string")try{return nn.from(Ds(t))}catch{N(!1,"invalid event fragment","obj",t)}else if(t instanceof kr){const n=th("event",t),s=jn(t,!0),i=!!qn(t,Ct(["anonymous"])).has("anonymous");return Ci(t),new nn(Te,n,s,i)}return new nn(Te,t.name,t.inputs?t.inputs.map(n=>ft.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Ht]===Fw}}class Un extends _i{constructor(t,n,s,i,o){super(t,n,s);k(this,"payable");k(this,"gas");Object.defineProperty(this,Ht,{value:Mw}),te(this,{payable:i,gas:o})}format(t){if(j(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${Dc(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Un.isFragment(t))return t;if(typeof t=="string")try{return Un.from(Ds(t))}catch{N(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof kr){qn(t,Ct(["constructor"]));const n=jn(t),s=!!qn(t,YL).has("payable"),i=e1(t);return Ci(t),new Un(Te,"constructor",n,s,i)}return new Un(Te,"constructor",t.inputs?t.inputs.map(ft.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ht]===Mw}}class An extends _i{constructor(t,n,s){super(t,"fallback",n);k(this,"payable");Object.defineProperty(this,Ht,{value:jw}),te(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(An.isFragment(t))return t;if(typeof t=="string")try{return An.from(Ds(t))}catch{N(!1,"invalid fallback fragment","obj",t)}else if(t instanceof kr){const n=t.toString(),s=t.peekKeyword(Ct(["fallback","receive"]));if(N(s,"type must be fallback or receive","obj",n),t.popKeyword(Ct(["fallback","receive"]))==="receive"){const c=jn(t);return N(c.length===0,"receive cannot have arguments","obj.inputs",c),qn(t,Ct(["payable"])),Ci(t),new An(Te,[],!0)}let o=jn(t);o.length?N(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[ft.from("bytes")];const a=XE(t);if(N(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),qn(t,Ct(["returns"])).has("returns")){const c=jn(t);N(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(u=>u.format("minimal")).join(", "))}return Ci(t),new An(Te,o,a==="payable")}if(t.type==="receive")return new An(Te,[],!0);if(t.type==="fallback"){const n=[ft.from("bytes")],s=t.stateMutability==="payable";return new An(Te,n,s)}N(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Ht]===jw}}class sn extends rh{constructor(t,n,s,i,o,a){super(t,"function",n,i);k(this,"constant");k(this,"outputs");k(this,"stateMutability");k(this,"payable");k(this,"gas");Object.defineProperty(this,Ht,{value:Hw}),o=Object.freeze(o.slice()),te(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return Di(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+Dc(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(Dc(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(i=>ft.from(i)),new sn(Te,t,"view",n,[],null).selector}static from(t){if(sn.isFragment(t))return t;if(typeof t=="string")try{return sn.from(Ds(t))}catch{N(!1,"invalid function fragment","obj",t)}else if(t instanceof kr){const s=th("function",t),i=jn(t),o=XE(t);let a=[];qn(t,Ct(["returns"])).has("returns")&&(a=jn(t));const c=e1(t);return Ci(t),new sn(Te,s,o,i,a,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new sn(Te,t.name,n,t.inputs?t.inputs.map(ft.from):[],t.outputs?t.outputs.map(ft.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ht]===Hw}}class bi extends rh{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Ht,{value:qw})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return bi.from(Ds(e))}catch{N(!1,"invalid struct fragment","obj",e)}else if(e instanceof kr){const t=th("struct",e),n=jn(e);return Ci(e),new bi(Te,t,n)}return new bi(Te,e.name,e.inputs?e.inputs.map(ft.from):[])}static isFragment(e){return e&&e[Ht]===qw}}const Lr=new Map;Lr.set(0,"GENERIC_PANIC");Lr.set(1,"ASSERT_FALSE");Lr.set(17,"OVERFLOW");Lr.set(18,"DIVIDE_BY_ZERO");Lr.set(33,"ENUM_RANGE_ERROR");Lr.set(34,"BAD_STORAGE_DATA");Lr.set(49,"STACK_UNDERFLOW");Lr.set(50,"ARRAY_RANGE_ERROR");Lr.set(65,"OUT_OF_MEMORY");Lr.set(81,"UNINITIALIZED_FUNCTION_CALL");const c4=new RegExp(/^bytes([0-9]*)$/),u4=new RegExp(/^(u?int)([0-9]*)$/);let ff=null,zw=1024;function l4(r,e,t,n){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const u=fe(t);if(t=Z(t),u.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(u.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(Z(u.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],u.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(Z(u.slice(0,4))==="0x4e487b71")try{const l=Number(n.decode(["uint256"],u.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[l]},i=`Panic due to ${Lr.get(l)||"UNKNOWN"}(${l})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?Ae(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Ae(e.from)),Be(s,"CALL_EXCEPTION",{action:r,data:t,reason:i,transaction:c,invocation:o,revert:a})}var cs,lo;const Ol=class Ol{constructor(){F(this,cs)}getDefaultValue(e){const t=e.map(s=>q(this,cs,lo).call(this,ft.from(s)));return new Tu(t,"_").defaultValue()}encode(e,t){Cv(t.length,e.length,"types/values length mismatch");const n=e.map(o=>q(this,cs,lo).call(this,ft.from(o))),s=new Tu(n,"_"),i=new pd;return s.encode(i,t),i.data}decode(e,t,n){const s=e.map(o=>q(this,cs,lo).call(this,ft.from(o)));return new Tu(s,"_").decode(new gd(t,n,zw))}static _setDefaultMaxInflation(e){N(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),zw=e}static defaultAbiCoder(){return ff==null&&(ff=new Ol),ff}static getBuiltinCallException(e,t,n){return l4(e,t,n,Ol.defaultAbiCoder())}};cs=new WeakSet,lo=function(e){if(e.isArray())return new RU(q(this,cs,lo).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Tu(e.components.map(n=>q(this,cs,lo).call(this,n)),e.name);switch(e.baseType){case"address":return new NU(e.name);case"bool":return new BU(e.name);case"string":return new qU(e.name);case"bytes":return new $U(e.name);case"":return new LU(e.name)}let t=e.type.match(u4);if(t){let n=parseInt(t[2]||"256");return N(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new HU(n/8,t[1]==="int",e.name)}if(t=e.type.match(c4),t){let n=parseInt(t[1]);return N(n!==0&&n<=32,"invalid bytes length","param",e),new kU(n,e.name)}N(!1,"invalid type","type",e.type)};let Cc=Ol;class h4{constructor(e,t,n){k(this,"fragment");k(this,"name");k(this,"signature");k(this,"topic");k(this,"args");const s=e.name,i=e.format();te(this,{fragment:e,name:s,signature:i,topic:t,args:n})}}class f4{constructor(e,t,n,s){k(this,"fragment");k(this,"name");k(this,"args");k(this,"signature");k(this,"selector");k(this,"value");const i=e.name,o=e.format();te(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:s})}}class d4{constructor(e,t,n){k(this,"fragment");k(this,"name");k(this,"args");k(this,"signature");k(this,"selector");const s=e.name,i=e.format();te(this,{fragment:e,name:s,args:n,signature:i,selector:t})}}class Vw{constructor(e){k(this,"hash");k(this,"_isIndexed");te(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const Gw={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},Kw={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&Gw[r.toString()]&&(e=Gw[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var Wr,Jr,Yr,mt,an,Qu,Wu;const zs=class zs{constructor(e){F(this,an);k(this,"fragments");k(this,"deploy");k(this,"fallback");k(this,"receive");F(this,Wr);F(this,Jr);F(this,Yr);F(this,mt);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,D(this,Yr,new Map),D(this,Wr,new Map),D(this,Jr,new Map);const n=[];for(const o of t)try{n.push(_i.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}te(this,{fragments:Object.freeze(n)});let s=null,i=!1;D(this,mt,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}te(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(N(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=y(this,Yr);break;case"event":c=y(this,Jr);break;case"error":c=y(this,Wr);break;default:return}const u=o.format();c.has(u)||c.set(u,o)}),this.deploy||te(this,{deploy:Un.from("constructor()")}),te(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Cc.defaultAbiCoder()}getFunctionName(e){const t=q(this,an,Qu).call(this,e,null,!1);return N(t,"no matching function","key",e),t.name}hasFunction(e){return!!q(this,an,Qu).call(this,e,null,!1)}getFunction(e,t){return q(this,an,Qu).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(y(this,Yr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Yr).get(s),n)}}getEventName(e){const t=q(this,an,Wu).call(this,e,null,!1);return N(t,"no matching event","key",e),t.name}hasEvent(e){return!!q(this,an,Wu).call(this,e,null,!1)}getEvent(e,t){return q(this,an,Wu).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(y(this,Jr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Jr).get(s),n)}}getError(e,t){if(Se(e)){const s=e.toLowerCase();if(Kw[s])return Mt.from(Kw[s].signature);for(const i of y(this,Wr).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of y(this,Wr))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Mt.from("error Error(string)"):e==="Panic"?Mt.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");N(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Mt.from(e).format(),e==="Error(string)")return Mt.from("error Error(string)");if(e==="Panic(uint256)")return Mt.from("error Panic(uint256)");const n=y(this,Wr).get(e);return n||null}forEachError(e){const t=Array.from(y(this,Wr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Wr).get(s),n)}}_decodeParams(e,t){return y(this,mt).decode(e,t)}_encodeParams(e,t){return y(this,mt).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);N(n,"unknown error","fragment",e),e=n}return N($e(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,$e(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);N(n,"unknown error","fragment",e),e=n}return je([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);N(n,"unknown function","fragment",e),e=n}return N($e(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,$e(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);N(n,"unknown function","fragment",e),e=n}return je([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);N(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const s=xt(t);if(s.length%32===0)try{return y(this,mt).decode(e.outputs,s)}catch{n="could not decode result data"}j(!1,n,"BAD_DATA",{value:Z(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=fe(e,"data"),s=Cc.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=Z(n.slice(0,4)),c=this.getError(a);if(c)try{const u=y(this,mt).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:u},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);N(n,"unknown function","fragment",e),e=n}return Z(y(this,mt).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);N(i,"unknown event","eventFragment",e),e=i}j(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(i,o)=>i.type==="string"?Di(o):i.type==="bytes"?Ve(Z(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Ps(o):i.type.match(/^bytes/)?o=B$(o,32):i.type==="address"&&y(this,mt).encode(["address"],[o]),Oi(Z(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){N(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?N(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?n.push(i.map(c=>s(a,c))):n.push(s(a,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);N(o,"unknown event","eventFragment",e),e=o}const n=[],s=[],i=[];return e.anonymous||n.push(e.topicHash),N(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(Di(c));else if(o.type==="bytes")n.push(Ve(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(y(this,mt).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:y(this,mt).encode(s,i),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const d=this.getEvent(e);N(d,"unknown event","eventFragment",e),e=d}if(n!=null&&!e.anonymous){const d=e.topicHash;N(Se(n[0],32)&&n[0].toLowerCase()===d,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((d,g)=>{d.indexed?d.type==="string"||d.type==="bytes"||d.baseType==="tuple"||d.baseType==="array"?(s.push(ft.from({type:"bytes32",name:d.name})),o.push(!0)):(s.push(d),o.push(!1)):(i.push(d),o.push(!1))});const a=n!=null?y(this,mt).decode(s,je(n)):null,c=y(this,mt).decode(i,t,!0),u=[],l=[];let h=0,f=0;return e.inputs.forEach((d,g)=>{let p=null;if(d.indexed)if(a==null)p=new Vw(null);else if(o[g])p=new Vw(a[f++]);else try{p=a[f++]}catch(w){p=w}else try{p=c[h++]}catch(w){p=w}u.push(p),l.push(d.name||null)}),ba.fromItems(u,l)}parseTransaction(e){const t=fe(e.data,"tx.data"),n=X(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(Z(t.slice(0,4)));if(!s)return null;const i=y(this,mt).decode(s.inputs,t.slice(4));return new f4(s,s.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new h4(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=Z(e),n=this.getError($e(t,0,4));if(!n)return null;const s=y(this,mt).decode(n.inputs,$e(t,4));return new d4(n,n.selector,s)}static from(e){return e instanceof zs?e:typeof e=="string"?new zs(JSON.parse(e)):typeof e.formatJson=="function"?new zs(e.formatJson()):typeof e.format=="function"?new zs(e.format("json")):new zs(e)}};Wr=new WeakMap,Jr=new WeakMap,Yr=new WeakMap,mt=new WeakMap,an=new WeakSet,Qu=function(e,t,n){if(Se(e)){const i=e.toLowerCase();for(const o of y(this,Yr).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Yr))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;vt.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let u=i.length-1;u>=0;u--){const l=i[u].inputs.length;l!==a&&(!c||l!==a-1)&&i.splice(u,1)}for(let u=i.length-1;u>=0;u--){const l=i[u].inputs;for(let h=0;h<t.length;h++)if(vt.isTyped(t[h])){if(h>=l.length){if(t[h].type==="overrides")continue;i.splice(u,1);break}if(t[h].type!==l[h].baseType){i.splice(u,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");N(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Yr).get(sn.from(e).format());return s||null},Wu=function(e,t,n){if(Se(e)){const i=e.toLowerCase();for(const o of y(this,Jr).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Jr))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(vt.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");N(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Jr).get(nn.from(e).format());return s||null};let Cd=zs;const t1=BigInt(0);function xo(r){return r??null}function ke(r){return r==null?null:r.toString()}class Qw{constructor(e,t,n){k(this,"gasPrice");k(this,"maxFeePerGas");k(this,"maxPriorityFeePerGas");te(this,{gasPrice:xo(e),maxFeePerGas:xo(t),maxPriorityFeePerGas:xo(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:ke(e),maxFeePerGas:ke(t),maxPriorityFeePerGas:ke(n)}}}function vl(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=Z(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=X(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=oe(r[s],`request.${s}`));return r.accessList&&(e.accessList=Ui(r.accessList)),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>mp(s)?Z(s):Object.assign({},s))),e}var Cn;class p4{constructor(e,t){k(this,"provider");k(this,"number");k(this,"hash");k(this,"timestamp");k(this,"parentHash");k(this,"parentBeaconBlockRoot");k(this,"nonce");k(this,"difficulty");k(this,"gasLimit");k(this,"gasUsed");k(this,"stateRoot");k(this,"receiptsRoot");k(this,"blobGasUsed");k(this,"excessBlobGas");k(this,"miner");k(this,"prevRandao");k(this,"extraData");k(this,"baseFeePerGas");F(this,Cn);D(this,Cn,e.transactions.map(n=>typeof n!="string"?new _c(n,t):n)),te(this,{provider:t,hash:xo(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:xo(e.prevRandao),extraData:e.extraData,baseFeePerGas:xo(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return y(this,Cn).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=y(this,Cn).slice();return e.length===0?[]:(j(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:u,number:l,parentHash:h,parentBeaconBlockRoot:f,stateRoot:d,receiptsRoot:g,timestamp:p,transactions:w}=this;return{_type:"Block",baseFeePerGas:ke(e),difficulty:ke(t),extraData:n,gasLimit:ke(s),gasUsed:ke(i),blobGasUsed:ke(this.blobGasUsed),excessBlobGas:ke(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:u,number:l,parentHash:h,timestamp:p,parentBeaconBlockRoot:f,stateRoot:d,receiptsRoot:g,transactions:w}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return y(this,Cn).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=y(this,Cn)[e];else{const n=e.toLowerCase();for(const s of y(this,Cn))if(typeof s=="string"){if(s!==n)continue;t=s;break}else{if(s.hash!==n)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;N(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return g4(this)}}Cn=new WeakMap;class ou{constructor(e,t){k(this,"provider");k(this,"transactionHash");k(this,"blockHash");k(this,"blockNumber");k(this,"removed");k(this,"address");k(this,"data");k(this,"topics");k(this,"index");k(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());te(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:u}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:u}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return j(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return j(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return j(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return y4(this)}}var kc;class r1{constructor(e,t){k(this,"provider");k(this,"to");k(this,"from");k(this,"contractAddress");k(this,"hash");k(this,"index");k(this,"blockHash");k(this,"blockNumber");k(this,"logsBloom");k(this,"gasUsed");k(this,"blobGasUsed");k(this,"cumulativeGasUsed");k(this,"gasPrice");k(this,"blobGasPrice");k(this,"type");k(this,"status");k(this,"root");F(this,kc);D(this,kc,Object.freeze(e.logs.map(s=>new ou(s,t))));let n=t1;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),te(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return y(this,kc)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:u,status:l,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:n,cumulativeGasUsed:ke(this.cumulativeGasUsed),from:t,gasPrice:ke(this.gasPrice),blobGasUsed:ke(this.blobGasUsed),blobGasPrice:ke(this.blobGasPrice),gasUsed:ke(this.gasUsed),hash:s,index:i,logs:u,logsBloom:c,root:h,status:l,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return s1(this)}reorderedEvent(e){return j(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),n1(this,e)}}kc=new WeakMap;var us;const Mp=class Mp{constructor(e,t){k(this,"provider");k(this,"blockNumber");k(this,"blockHash");k(this,"index");k(this,"hash");k(this,"type");k(this,"to");k(this,"from");k(this,"nonce");k(this,"gasLimit");k(this,"gasPrice");k(this,"maxPriorityFeePerGas");k(this,"maxFeePerGas");k(this,"maxFeePerBlobGas");k(this,"data");k(this,"value");k(this,"chainId");k(this,"signature");k(this,"accessList");k(this,"blobVersionedHashes");F(this,us);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,D(this,us,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:i,to:o,from:a,nonce:c,data:u,signature:l,accessList:h,blobVersionedHashes:f}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:t,blobVersionedHashes:f,chainId:ke(this.chainId),data:u,from:a,gasLimit:ke(this.gasLimit),gasPrice:ke(this.gasPrice),hash:s,maxFeePerGas:ke(this.maxFeePerGas),maxPriorityFeePerGas:ke(this.maxPriorityFeePerGas),maxFeePerBlobGas:ke(this.maxFeePerBlobGas),nonce:c,signature:l,to:o,index:n,type:i,value:ke(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await Pt({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let i=y(this,us),o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:f,nonce:d}=await Pt({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(d<this.nonce){i=f;return}if(a)return null;const g=await this.getTransaction();if(!(g&&g.blockNumber!=null))for(o===-1&&(o=i-3,o<y(this,us)&&(o=y(this,us)));o<=f;){if(a)return null;const p=await this.provider.getBlock(o,!0);if(p==null)return;for(const w of p)if(w===this.hash)return;for(let w=0;w<p.length;w++){const E=await p.getTransaction(w);if(E.from===this.from&&E.nonce===this.nonce){if(a)return null;const A=await this.provider.getTransactionReceipt(E.hash);if(A==null||f-A.blockNumber+1<n)return;let I="replaced";E.data===this.data&&E.to===this.to&&E.value===this.value?I="repriced":E.data==="0x"&&E.from===E.to&&E.value===t1&&(I="cancelled"),j(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:I==="replaced"||I==="cancelled",reason:I,replacement:E.replaceableTransaction(i),hash:E.hash,receipt:A})}}o++}},u=f=>{if(f==null||f.status!==0)return f;j(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:f.to,from:f.from,data:""},receipt:f})},l=await this.provider.getTransactionReceipt(this.hash);if(n===0)return u(l);if(l){if(await l.confirmations()>=n)return u(l)}else if(await c(),n===0)return null;return await new Promise((f,d)=>{const g=[],p=()=>{g.forEach(E=>E())};if(g.push(()=>{a=!0}),s>0){const E=setTimeout(()=>{p(),d(Be("wait for transaction timeout","TIMEOUT"))},s);g.push(()=>{clearTimeout(E)})}const w=async E=>{if(await E.confirmations()>=n){p();try{f(u(E))}catch(A){d(A)}}};if(g.push(()=>{this.provider.off(this.hash,w)}),this.provider.on(this.hash,w),i>=0){const E=async()=>{try{await c()}catch(A){if(ht(A,"TRANSACTION_REPLACED")){p(),d(A);return}}a||this.provider.once("block",E)};g.push(()=>{this.provider.off("block",E)}),this.provider.once("block",E)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return j(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),s1(this)}reorderedEvent(e){return j(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),j(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),n1(this,e)}replaceableTransaction(e){N(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new Mp(this,this.provider);return D(t,us,e),t}};us=new WeakMap;let _c=Mp;function g4(r){return{orphan:"drop-block",hash:r.hash,number:r.number}}function n1(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function s1(r){return{orphan:"drop-transaction",tx:r}}function y4(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class Rp extends ou{constructor(t,n,s){super(t,t.provider);k(this,"interface");k(this,"fragment");k(this,"args");const i=n.decodeEventLog(s,t.data,t.topics);te(this,{args:i,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class i1 extends ou{constructor(t,n){super(t,t.provider);k(this,"error");te(this,{error:n})}}var Zo;class m4 extends r1{constructor(t,n,s){super(s,n);F(this,Zo);D(this,Zo,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?y(this,Zo).getEvent(t.topics[0]):null;if(n)try{return new Rp(t,y(this,Zo),n)}catch(s){return new i1(t,s)}return t})}}Zo=new WeakMap;var Uc;class Bp extends _c{constructor(t,n,s){super(s,n);F(this,Uc);D(this,Uc,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new m4(y(this,Uc),this.provider,s)}}Uc=new WeakMap;class o1 extends Rv{constructor(t,n,s,i){super(t,n,s);k(this,"log");te(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class w4 extends o1{constructor(e,t,n,s,i){super(e,t,n,new Rp(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);te(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const Ww=BigInt(0);function a1(r){return r&&typeof r.call=="function"}function c1(r){return r&&typeof r.estimateGas=="function"}function nh(r){return r&&typeof r.resolveName=="function"}function u1(r){return r&&typeof r.sendTransaction=="function"}function l1(r){if(r!=null){if(nh(r))return r;if(r.provider)return r.provider}}var Lc;class b4{constructor(e,t,n){F(this,Lc);k(this,"fragment");if(te(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=Ni(e.runner,"resolveName"),i=nh(s)?s:null;D(this,Lc,async function(){const o=await Promise.all(t.inputs.map((a,c)=>n[c]==null?null:a.walkAsync(n[c],(l,h)=>l==="address"?Array.isArray(h)?Promise.all(h.map(f=>Dt(f,i))):Dt(h,i):h)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return y(this,Lc)}}Lc=new WeakMap;function Ni(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function Js(r){return r==null?null:r.provider||null}async function h1(r,e){const t=vt.dereference(r,"overrides");N(typeof t=="object","invalid overrides parameter","overrides",r);const n=vl(t);return N(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),N(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function v4(r,e,t){const n=Ni(r,"resolveName"),s=nh(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=vt.dereference(c,a),a==="address"?Dt(c,s):c))))}function E4(r){const e=async function(o){const a=await h1(o,["data"]);a.to=await r.getAddress(),a.from&&(a.from=await Dt(a.from,l1(r.runner)));const c=r.interface,u=X(a.value||Ww,"overrides.value")===Ww,l=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!l&&!u&&N(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),N(c.fallback||l,"cannot send data to receive-only contract","overrides.data",a.data);const h=c.receive||c.fallback&&c.fallback.payable;return N(h||u,"cannot send value to non-payable fallback","overrides.value",a.value),N(c.fallback||l,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=Ni(r.runner,"call");j(a1(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(u){throw yp(u)&&u.data?r.interface.makeError(u.data,c):u}},n=async function(o){const a=r.runner;j(u1(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),u=Js(r.runner);return new Bp(r.interface,u,c)},s=async function(o){const a=Ni(r.runner,"estimateGas");return j(c1(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await n(o);return te(i,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),i}function A4(r,e){const t=function(...u){const l=r.interface.getFunction(e,u);return j(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:u}}),l},n=async function(...u){const l=t(...u);let h={};if(l.inputs.length+1===u.length&&(h=await h1(u.pop()),h.from&&(h.from=await Dt(h.from,l1(r.runner)))),l.inputs.length!==u.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const f=await v4(r.runner,l.inputs,u);return Object.assign({},h,await Pt({to:r.getAddress(),data:r.interface.encodeFunctionData(l,f)}))},s=async function(...u){const l=await a(...u);return l.length===1?l[0]:l},i=async function(...u){const l=r.runner;j(u1(l),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await l.sendTransaction(await n(...u)),f=Js(r.runner);return new Bp(r.interface,f,h)},o=async function(...u){const l=Ni(r.runner,"estimateGas");return j(c1(l),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await l.estimateGas(await n(...u))},a=async function(...u){const l=Ni(r.runner,"call");j(a1(l),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await n(...u);let f="0x";try{f=await l.call(h)}catch(g){throw yp(g)&&g.data?r.interface.makeError(g.data,h):g}const d=t(...u);return r.interface.decodeFunctionResult(d,f)},c=async(...u)=>t(...u).constant?await s(...u):await i(...u);return te(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:o,populateTransaction:n,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const u=r.interface.getFunction(e);return j(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),u}}),c}function I4(r,e){const t=function(...s){const i=r.interface.getEvent(e,s);return j(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},n=function(...s){return new b4(r,t(...s),s)};return te(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return j(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const El=Symbol.for("_ethersInternal_contract"),f1=new WeakMap;function P4(r,e){f1.set(r[El],e)}function Qt(r){return f1.get(r[El])}function x4(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function $p(r,e){let t,n=null;if(Array.isArray(e)){const i=function(o){if(Se(o,32))return o;const a=r.interface.getEvent(o);return N(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?Se(e,32)?t=[e]:(n=r.interface.getEvent(e),N(n,"unknown fragment","event",e),t=[n.topicHash]):x4(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):N(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:s,topics:t}}async function rc(r,e){const{subs:t}=Qt(r);return t.get((await $p(r,e)).tag)||null}async function Jw(r,e,t){const n=Js(r.runner);j(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await $p(r,t),{addr:a,subs:c}=Qt(r);let u=c.get(i);if(!u){const h={address:a||r,topics:o},f=w=>{let E=s;if(E==null)try{E=r.interface.getEvent(w.topics[0])}catch{}if(E){const A=E,I=s?r.interface.decodeEventLog(s,w.data,w.topics):[];Nd(r,t,I,P=>new w4(r,P,t,A,w))}else Nd(r,t,[],A=>new o1(r,A,t,w))};let d=[];u={tag:i,listeners:[],start:()=>{d.length||d.push(n.on(h,f))},stop:async()=>{if(d.length==0)return;let w=d;d=[],await Promise.all(w),n.off(h,f)}},c.set(i,u)}return u}let _d=Promise.resolve();async function O4(r,e,t,n){await _d;const s=await rc(r,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);n&&c.push(n(a?null:o));try{o.call(r,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),Qt(r).subs.delete(s.tag)),i>0}async function Nd(r,e,t,n){try{await _d}catch{}const s=O4(r,e,t,n);return _d=s,await s}const Bu=["then"];var ab;ab=El;const fc=class fc{constructor(e,t,n,s){k(this,"target");k(this,"interface");k(this,"runner");k(this,"filters");k(this,ab);k(this,"fallback");N(typeof e=="string"||wE(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=Cd.from(t);te(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,El,{value:{}});let o,a=null,c=null;if(s){const h=Js(n);c=new Bp(this.interface,h,s)}let u=new Map;if(typeof e=="string")if(Se(e))a=e,o=Promise.resolve(e);else{const h=Ni(n,"resolveName");if(!nh(h))throw Be("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(f=>{if(f==null)throw Be("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Qt(this).addr=f,f})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Qt(this).addr=h,h});P4(this,{addrPromise:o,addr:a,deployTx:c,subs:u});const l=new Proxy({},{get:(h,f,d)=>{if(typeof f=="symbol"||Bu.indexOf(f)>=0)return Reflect.get(h,f,d);try{return this.getEvent(f)}catch(g){if(!ht(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(h,f)=>Bu.indexOf(f)>=0?Reflect.has(h,f):Reflect.has(h,f)||this.interface.hasEvent(String(f))});return te(this,{filters:l}),te(this,{fallback:i.receive||i.fallback?E4(this):null}),new Proxy(this,{get:(h,f,d)=>{if(typeof f=="symbol"||f in h||Bu.indexOf(f)>=0)return Reflect.get(h,f,d);try{return h.getFunction(f)}catch(g){if(!ht(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(h,f)=>typeof f=="symbol"||f in h||Bu.indexOf(f)>=0?Reflect.has(h,f):h.interface.hasFunction(f)})}connect(e){return new fc(this.target,this.interface,e)}attach(e){return new fc(e,this.interface,this.runner)}async getAddress(){return await Qt(this).addrPromise}async getDeployedCode(){const e=Js(this.runner);j(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=Js(this.runner);return j(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return Qt(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),A4(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),I4(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:i}=Qt(this),o=s||await i,{fragment:a,topics:c}=await $p(this,e),u={address:o,topics:c,fromBlock:t,toBlock:n},l=Js(this.runner);return j(l,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await l.getLogs(u)).map(h=>{let f=a;if(f==null)try{f=this.interface.getEvent(h.topics[0])}catch{}if(f)try{return new Rp(h,this.interface,f)}catch(d){return new i1(h,d)}return new ou(h,l)})}async on(e,t){const n=await Jw(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await Jw(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await Nd(this,e,t,null)}async listenerCount(e){if(e){const s=await rc(this,e);return s?s.listeners.length:0}const{subs:t}=Qt(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await rc(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=Qt(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:i})=>i));return n}async off(e,t){const n=await rc(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),Qt(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await rc(this,e);if(!t)return this;t.stop(),Qt(this).subs.delete(t.tag)}else{const{subs:t}=Qt(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends fc{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let Td=fc;function S4(){return Td}class Oo extends S4(){}function df(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):N(!1,"unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}class D4{constructor(e){k(this,"name");te(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const d1=new RegExp("^(ipfs)://(.*)$","i"),Yw=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),d1,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var ls,ui,hs,ho,Sl,p1;const bo=class bo{constructor(e,t,n){F(this,hs);k(this,"provider");k(this,"address");k(this,"name");F(this,ls);F(this,ui);te(this,{provider:e,address:t,name:n}),D(this,ls,null),D(this,ui,new Oo(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return y(this,ls)==null&&D(this,ls,(async()=>{try{return await y(this,ui).supportsInterface("0x9061b923")}catch(e){if(ht(e,"CALL_EXCEPTION"))return!1;throw D(this,ls,null),e}})()),await y(this,ls)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await q(this,hs,ho).call(this,"addr(bytes32)");return i==null||i===Ac?null:i}catch(i){if(ht(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await q(this,hs,ho).call(this,"addr(bytes32,uint)",[i]);if(Se(o,20))return Ae(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof D4&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const n=await q(this,hs,ho).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;j(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await q(this,hs,ho).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await q(this,hs,ho).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${k$("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;j(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<Yw.length;n++){const s=t.match(Yw[n]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=df(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const u=c[1],l=new Oo(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const p=await l.ownerOf(u);if(a!==p)return e.push({type:"!owner",value:p}),{url:null,linkage:e};e.push({type:"owner",value:p})}else if(i==="erc1155"){const p=await l.balanceOf(a,u);if(!p)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:p.toString()})}let h=await l[o](u);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",Ps(u,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=df(h)),e.push({type:"metadata-url",value:h});let f={};const d=await new xs(h).send();d.assertOk();try{f=d.bodyJson}catch{try{e.push({type:"!metadata",value:d.bodyText})}catch{const E=d.body;return E&&e.push({type:"!metadata",value:Z(E)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!f)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(f)});let g=f.image;if(typeof g!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!g.match(/^(https:\/\/|data:)/i)){if(g.match(d1)==null)return e.push({type:"!imageUrl-ipfs",value:g}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:g}),g=df(g)}return e.push({type:"url",value:g}),{linkage:e,url:g}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return j(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const i=await q(s=bo,Sl,p1).call(s,e,n);if(i!=null){const o=new bo(e,i,t);return n!==t&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};ls=new WeakMap,ui=new WeakMap,hs=new WeakSet,ho=async function(e,t){t=(t||[]).slice();const n=y(this,ui).interface;t.unshift(Sd(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),j(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[SL(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await y(this,ui)[e](...t);return s?n.decodeFunctionResult(s,i)[0]:i}catch(i){if(!ht(i,"CALL_EXCEPTION"))throw i}return null},Sl=new WeakSet,p1=async function(e,t){const n=await bo.getEnsAddress(e);try{const i=await new Oo(n,["function resolver(bytes32) view returns (address)"],e).resolver(Sd(t),{enableCcipRead:!0});return i===Ac?null:i}catch(s){throw s}return null},F(bo,Sl);let Al=bo;const Zw=BigInt(0);function he(r,e){return function(t){return t==null?e:r(t)}}function sh(r,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))}}function au(r,e){return t=>{const n={};for(const s in r){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=r[s](t[i]);o!==void 0&&(n[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";j(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return n}}function C4(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}N(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function Oa(r){return N(Se(r,!0),"invalid data","value",r),r}function lt(r){return N(Se(r,32),"invalid hash","value",r),r}const _4=au({address:Ae,blockHash:lt,blockNumber:oe,data:Oa,index:oe,removed:he(C4,!1),topics:sh(lt),transactionHash:lt,transactionIndex:oe},{index:["logIndex"]});function N4(r){return _4(r)}const T4=au({hash:he(lt),parentHash:lt,parentBeaconBlockRoot:he(lt,null),number:oe,timestamp:oe,nonce:he(Oa),difficulty:X,gasLimit:X,gasUsed:X,stateRoot:he(lt,null),receiptsRoot:he(lt,null),blobGasUsed:he(X,null),excessBlobGas:he(X,null),miner:he(Ae),prevRandao:he(lt,null),extraData:Oa,baseFeePerGas:he(X)},{prevRandao:["mixHash"]});function R4(r){const e=T4(r);return e.transactions=r.transactions.map(t=>typeof t=="string"?t:g1(t)),e}const B4=au({transactionIndex:oe,blockNumber:oe,transactionHash:lt,address:Ae,topics:sh(lt),data:Oa,index:oe,blockHash:lt},{index:["logIndex"]});function $4(r){return B4(r)}const k4=au({to:he(Ae,null),from:he(Ae,null),contractAddress:he(Ae,null),index:oe,root:he(Z),gasUsed:X,blobGasUsed:he(X,null),logsBloom:he(Oa),blockHash:lt,hash:lt,logs:sh($4),blockNumber:oe,cumulativeGasUsed:X,effectiveGasPrice:he(X),blobGasPrice:he(X,null),status:he(oe),type:he(oe,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function U4(r){return k4(r)}function g1(r){r.to&&X(r.to)===Zw&&(r.to="0x0000000000000000000000000000000000000000");const e=au({hash:lt,index:he(oe,void 0),type:t=>t==="0x"||t==null?0:oe(t),accessList:he(Ui,null),blobVersionedHashes:he(sh(lt,!0),null),blockHash:he(lt,null),blockNumber:he(oe,null),transactionIndex:he(oe,null),from:Ae,gasPrice:he(X),maxPriorityFeePerGas:he(X),maxFeePerGas:he(X),maxFeePerBlobGas:he(X,null),gasLimit:X,to:he(Ae,null),value:X,nonce:oe,data:Oa,creates:he(Ae,null),chainId:he(X,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(r);if(e.to==null&&e.creates==null&&(e.creates=_U(e)),(r.type===1||r.type===2)&&r.accessList==null&&(e.accessList=[]),r.signature?e.signature=$r.from(r.signature):e.signature=$r.from(r),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&X(e.blockHash)===Zw&&(e.blockHash=null),e}const L4="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class cu{constructor(e){k(this,"name");te(this,{name:e})}clone(){return new cu(this.name)}}class ih extends cu{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);k(this,"effectiveBlock");k(this,"txBase");k(this,"txCreate");k(this,"txDataZero");k(this,"txDataNonzero");k(this,"txAccessListStorageKey");k(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(n||{})[o];c==null&&(c=a),N(typeof c=="number",`invalud value for ${o}`,"costs",n),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),te(this,s)}clone(){return new ih(this.effectiveBlock,this)}}class oh extends cu{constructor(t,n){super("org.ethers.plugins.network.Ens");k(this,"address");k(this,"targetNetwork");te(this,{address:t||L4,targetNetwork:n??1})}clone(){return new oh(this.address,this.targetNetwork)}}var Fc,Mc;class F4 extends cu{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");F(this,Fc);F(this,Mc);D(this,Fc,t),D(this,Mc,n)}get url(){return y(this,Fc)}get processFunc(){return y(this,Mc)}clone(){return this}}Fc=new WeakMap,Mc=new WeakMap;const pf=new Map;var Xo,ea,fs;const vo=class vo{constructor(e,t){F(this,Xo);F(this,ea);F(this,fs);D(this,Xo,e),D(this,ea,X(t)),D(this,fs,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return y(this,Xo)}set name(e){D(this,Xo,e)}get chainId(){return y(this,ea)}set chainId(e){D(this,ea,X(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===X(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===X(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===X(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(y(this,fs).values())}attachPlugin(e){if(y(this,fs).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,fs).set(e.name,e.clone()),this}getPlugin(e){return y(this,fs).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new vo(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new ih;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=Ui(e.accessList);for(const i in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return n}static from(e){if(M4(),e==null)return vo.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=pf.get(e);if(t)return t();if(typeof e=="bigint")return new vo("unknown",e);N(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){N(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new vo(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new oh(e.ensAddress,e.ensNetwork)),t}N(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=pf.get(e);n&&N(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),pf.set(e,t)}};Xo=new WeakMap,ea=new WeakMap,fs=new WeakMap;let on=vo;function Xw(r,e){const t=String(r);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${r}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${r}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function eb(r){return new F4(r,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([n.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:Xw(a.maxFee,9),maxPriorityFeePerGas:Xw(a.maxPriorityFee,9)}}catch(i){j(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:i})}})}let tb=!1;function M4(){if(tb)return;tb=!0;function r(e,t,n){const s=function(){const i=new on(e,t);return n.ensNetwork!=null&&i.attachPlugin(new oh(null,n.ensNetwork)),i.attachPlugin(new ih),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};on.register(e,s),on.register(t,s),n.altNames&&n.altNames.forEach(i=>{on.register(i,s)})}r("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),r("ropsten",3,{ensNetwork:3}),r("rinkeby",4,{ensNetwork:4}),r("goerli",5,{ensNetwork:5}),r("kovan",42,{ensNetwork:42}),r("sepolia",11155111,{ensNetwork:11155111}),r("holesky",17e3,{ensNetwork:17e3}),r("classic",61,{}),r("classicKotti",6,{}),r("arbitrum",42161,{ensNetwork:1}),r("arbitrum-goerli",421613,{}),r("arbitrum-sepolia",421614,{}),r("base",8453,{ensNetwork:1}),r("base-goerli",84531,{}),r("base-sepolia",84532,{}),r("bnb",56,{ensNetwork:1}),r("bnbt",97,{}),r("linea",59144,{ensNetwork:1}),r("linea-goerli",59140,{}),r("linea-sepolia",59141,{}),r("matic",137,{ensNetwork:1,plugins:[eb("https://gasstation.polygon.technology/v2")]}),r("matic-amoy",80002,{}),r("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[eb("https://gasstation-testnet.polygon.technology/v2")]}),r("optimism",10,{ensNetwork:1,plugins:[]}),r("optimism-goerli",420,{}),r("optimism-sepolia",11155420,{}),r("xdai",100,{ensNetwork:1})}function Rd(r){return JSON.parse(JSON.stringify(r))}var _n,lr,ds,Zr,ta,Ju;class j4{constructor(e){F(this,ta);F(this,_n);F(this,lr);F(this,ds);F(this,Zr);D(this,_n,e),D(this,lr,null),D(this,ds,4e3),D(this,Zr,-2)}get pollingInterval(){return y(this,ds)}set pollingInterval(e){D(this,ds,e)}start(){y(this,lr)||(D(this,lr,y(this,_n)._setTimeout(q(this,ta,Ju).bind(this),y(this,ds))),q(this,ta,Ju).call(this))}stop(){y(this,lr)&&(y(this,_n)._clearTimeout(y(this,lr)),D(this,lr,null))}pause(e){this.stop(),e&&D(this,Zr,-2)}resume(){this.start()}}_n=new WeakMap,lr=new WeakMap,ds=new WeakMap,Zr=new WeakMap,ta=new WeakSet,Ju=async function(){try{const e=await y(this,_n).getBlockNumber();if(y(this,Zr)===-2){D(this,Zr,e);return}if(e!==y(this,Zr)){for(let t=y(this,Zr)+1;t<=e;t++){if(y(this,lr)==null)return;await y(this,_n).emit("block",t)}D(this,Zr,e)}}catch{}y(this,lr)!=null&&D(this,lr,y(this,_n)._setTimeout(q(this,ta,Ju).bind(this),y(this,ds)))};var li,hi,ps;class kp{constructor(e){F(this,li);F(this,hi);F(this,ps);D(this,li,e),D(this,ps,!1),D(this,hi,t=>{this._poll(t,y(this,li))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){y(this,ps)||(D(this,ps,!0),y(this,hi).call(this,-2),y(this,li).on("block",y(this,hi)))}stop(){y(this,ps)&&(D(this,ps,!1),y(this,li).off("block",y(this,hi)))}pause(e){this.stop()}resume(){this.start()}}li=new WeakMap,hi=new WeakMap,ps=new WeakMap;var ra,Nn;class H4 extends kp{constructor(t,n){super(t);F(this,ra);F(this,Nn);D(this,ra,n),D(this,Nn,-2)}pause(t){t&&D(this,Nn,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(y(this,ra));s!=null&&(y(this,Nn)===-2?D(this,Nn,s.number):s.number>y(this,Nn)&&(n.emit(y(this,ra),s.number),D(this,Nn,s.number)))}}ra=new WeakMap,Nn=new WeakMap;var Dl;class q4 extends kp{constructor(t,n){super(t);F(this,Dl);D(this,Dl,Rd(n))}async _poll(t,n){throw new Error("@TODO")}}Dl=new WeakMap;var na;class z4 extends kp{constructor(t,n){super(t);F(this,na);D(this,na,n)}async _poll(t,n){const s=await n.getTransactionReceipt(y(this,na));s&&n.emit(y(this,na),s)}}na=new WeakMap;var Tn,sa,ia,gs,hr,Cl,y1;class Up{constructor(e,t){F(this,Cl);F(this,Tn);F(this,sa);F(this,ia);F(this,gs);F(this,hr);D(this,Tn,e),D(this,sa,Rd(t)),D(this,ia,q(this,Cl,y1).bind(this)),D(this,gs,!1),D(this,hr,-2)}start(){y(this,gs)||(D(this,gs,!0),y(this,hr)===-2&&y(this,Tn).getBlockNumber().then(e=>{D(this,hr,e)}),y(this,Tn).on("block",y(this,ia)))}stop(){y(this,gs)&&(D(this,gs,!1),y(this,Tn).off("block",y(this,ia)))}pause(e){this.stop(),e&&D(this,hr,-2)}resume(){this.start()}}Tn=new WeakMap,sa=new WeakMap,ia=new WeakMap,gs=new WeakMap,hr=new WeakMap,Cl=new WeakSet,y1=async function(e){if(y(this,hr)===-2)return;const t=Rd(y(this,sa));t.fromBlock=y(this,hr)+1,t.toBlock=e;const n=await y(this,Tn).getLogs(t);if(n.length===0){y(this,hr)<e-60&&D(this,hr,e-60);return}for(const s of n)y(this,Tn).emit(y(this,sa),s),D(this,hr,s.blockNumber)};const V4=BigInt(2),G4=10;function $u(r){return r&&typeof r.then=="function"}function Yu(r,e){return r+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class m1{constructor(e){k(this,"name");te(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function K4(r){return JSON.parse(JSON.stringify(r))}function Bd(r){return r=Array.from(new Set(r).values()),r.sort(),r}async function gf(r,e){if(r==null)throw new Error("invalid event");if(Array.isArray(r)&&(r={topics:r}),typeof r=="string")switch(r){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:r,tag:r}}if(Se(r,32)){const t=r.toLowerCase();return{type:"transaction",tag:Yu("tx",{hash:t}),hash:t}}if(r.orphan){const t=r;return{type:"orphan",tag:Yu("orphan",t),filter:K4(t)}}if(r.address||r.topics){const t=r,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?Bd(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{Se(a)?s.push(a):i.push((async()=>{s.push(await Dt(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),n.address=Bd(s.map(a=>a.toLowerCase()))}return{filter:n,tag:Yu("event",n),type:"event"}}N(!1,"unknown ProviderEvent","event",r)}function yf(){return new Date().getTime()}const Q4={cacheTimeout:250,pollingInterval:4e3};var wt,ys,bt,oa,Zt,fi,ms,Rn,jc,fr,aa,ca,ae,Gt,$d,kd,nc,Ud,sc,Zu;class W4{constructor(e,t){F(this,ae);F(this,wt);F(this,ys);F(this,bt);F(this,oa);F(this,Zt);F(this,fi);F(this,ms);F(this,Rn);F(this,jc);F(this,fr);F(this,aa);F(this,ca);if(D(this,ca,Object.assign({},Q4,t||{})),e==="any")D(this,fi,!0),D(this,Zt,null);else if(e){const n=on.from(e);D(this,fi,!1),D(this,Zt,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else D(this,fi,!1),D(this,Zt,null);D(this,Rn,-1),D(this,ms,new Map),D(this,wt,new Map),D(this,ys,new Map),D(this,bt,null),D(this,oa,!1),D(this,jc,1),D(this,fr,new Map),D(this,aa,!1)}get pollingInterval(){return y(this,ca).pollingInterval}get provider(){return this}get plugins(){return Array.from(y(this,ys).values())}attachPlugin(e){if(y(this,ys).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,ys).set(e.name,e.connect(this)),this}getPlugin(e){return y(this,ys).get(e)||null}get disableCcipRead(){return y(this,aa)}set disableCcipRead(e){D(this,aa,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],u=c.replace("{sender}",s).replace("{data}",i),l=new xs(u);c.indexOf("{data}")===-1&&(l.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:l,index:a,urls:n});let h="unknown error",f;try{f=await l.send()}catch(d){o.push(d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:l,result:{error:d}});continue}try{const d=f.bodyJson;if(d.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:l,result:d}),d.data;d.message&&(h=d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:l,result:d})}catch{}j(f.statusCode<400||f.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:h}}),o.push(h)}j(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new p4(R4(e),this)}_wrapLog(e,t){return new ou(N4(e),this)}_wrapTransactionReceipt(e,t){return new r1(U4(e),this)}_wrapTransactionResponse(e,t){return new _c(g1(e),this)}_detectNetwork(){j(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){j(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=oe(await q(this,ae,Gt).call(this,{method:"getBlockNumber"}),"%response");return y(this,Rn)>=0&&D(this,Rn,e),e}_getAddress(e){return Dt(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Se(e))return Se(e,32)?e:yo(e);if(typeof e=="bigint"&&(e=oe(e,"blockTag")),typeof e=="number")return e>=0?yo(e):y(this,Rn)>=0?yo(y(this,Rn)+e):this.getBlockNumber().then(t=>yo(t+e));N(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?Bd(c.map(u=>u.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(c,u,l)=>{let h;switch(c.length){case 0:break;case 1:h=c[0];break;default:c.sort(),h=c}if(n&&(u!=null||l!=null))throw new Error("invalid filter");const f={};return h&&(f.address=h),t.length&&(f.topics=t),u&&(f.fromBlock=u),l&&(f.toBlock=l),n&&(f.blockHash=n),f};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=vl(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=Dt(t[s],this);$u(i)?n.push(async function(){t[s]=await i}()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);$u(s)?n.push(async function(){t.blockTag=await s}()):t.blockTag=s}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(y(this,Zt)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw y(this,Zt)===s&&D(this,Zt,null),i}})();return D(this,Zt,s),(await s).clone()}const e=y(this,Zt),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(y(this,fi)?(this.emit("network",n,t),y(this,Zt)===e&&D(this,Zt,Promise.resolve(n))):j(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await Pt({_block:q(this,ae,Ud).call(this,"latest",!1),gasPrice:(async()=>{try{const l=await q(this,ae,Gt).call(this,{method:"getGasPrice"});return X(l,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const l=await q(this,ae,Gt).call(this,{method:"getPriorityFee"});return X(l,"%response")}catch{}return null})()});let a=null,c=null;const u=this._wrapBlock(s,e);return u&&u.baseFeePerGas&&(c=o??BigInt("1000000000"),a=u.baseFeePerGas*V4+c),new Qw(i,a,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new xs(n.url),i=await n.processFunc(t,this,s);return new Qw(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return $u(t)&&(t=await t),X(await q(this,ae,Gt).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await Pt({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await q(this,ae,kd).call(this,q(this,ae,$d).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return X(await q(this,ae,nc).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return oe(await q(this,ae,nc).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Z(await q(this,ae,nc).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=X(t,"position");return Z(await q(this,ae,nc).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await Pt({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=wl.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await Pt({network:this.getNetwork(),params:q(this,ae,Ud).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await Pt({network:this.getNetwork(),params:q(this,ae,Gt).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await Pt({network:this.getNetwork(),params:q(this,ae,Gt).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await q(this,ae,Gt).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await Pt({network:this.getNetwork(),result:q(this,ae,Gt).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:Z(t)}async getLogs(e){let t=this._getFilter(e);$u(t)&&(t=await t);const{network:n,params:s}=await Pt({network:this.getNetwork(),params:q(this,ae,Gt).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,n))}_getProvider(e){j(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Al.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=Ae(e);const t=Sd(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await Al.getEnsAddress(this),i=await new Oo(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===Ac)return null;const a=await new Oo(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(n){if(ht(n,"BAD_DATA")&&n.value==="0x"||ht(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=async u=>{try{const l=await this.getTransactionReceipt(e);if(l!=null&&u-l.blockNumber+1>=s){i(l),a&&(clearTimeout(a),a=null);return}}catch(l){console.log("EEE",l)}this.once("block",c)};n!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(Be("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){j(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=y(this,fr).get(e);t&&(t.timer&&clearTimeout(t.timer),y(this,fr).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=$a(this,jc)._++,s=()=>{y(this,fr).delete(n),e()};if(this.paused)y(this,fr).set(n,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);y(this,fr).set(n,{timer:i,func:s,time:yf()})}return n}_forEachSubscriber(e){for(const t of y(this,wt).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new m1(e.type);case"block":{const t=new j4(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new H4(this,e.type);case"event":return new Up(this,e.filter);case"transaction":return new z4(this,e.hash);case"orphan":return new q4(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of y(this,wt).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),y(this,bt)!=null&&t.pause(y(this,bt));break}}async on(e,t){const n=await q(this,ae,Zu).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,y(this,bt)!=null&&n.subscriber.pause(y(this,bt))),this}async once(e,t){const n=await q(this,ae,Zu).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,y(this,bt)!=null&&n.subscriber.pause(y(this,bt))),this}async emit(e,...t){const n=await q(this,ae,sc).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const a=new Rv(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),y(this,wt).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await q(this,ae,sc).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of y(this,wt).values())t+=n.length;return t}async listeners(e){if(e){const n=await q(this,ae,sc).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of y(this,wt).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await q(this,ae,sc).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),y(this,wt).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await q(this,ae,Zu).call(this,e);n&&s.stop(),y(this,wt).delete(t)}else for(const[t,{started:n,subscriber:s}]of y(this,wt))n&&s.stop(),y(this,wt).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return y(this,oa)}destroy(){this.removeAllListeners();for(const e of y(this,fr).keys())this._clearTimeout(e);D(this,oa,!0)}get paused(){return y(this,bt)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(D(this,Rn,-1),y(this,bt)!=null){if(y(this,bt)==!!e)return;j(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),D(this,bt,!!e);for(const t of y(this,fr).values())t.timer&&clearTimeout(t.timer),t.time=yf()-t.time}resume(){if(y(this,bt)!=null){this._forEachSubscriber(e=>e.resume()),D(this,bt,null);for(const e of y(this,fr).values()){let t=e.time;t<0&&(t=0),e.time=yf(),setTimeout(e.func,t)}}}}wt=new WeakMap,ys=new WeakMap,bt=new WeakMap,oa=new WeakMap,Zt=new WeakMap,fi=new WeakMap,ms=new WeakMap,Rn=new WeakMap,jc=new WeakMap,fr=new WeakMap,aa=new WeakMap,ca=new WeakMap,ae=new WeakSet,Gt=async function(e){const t=y(this,ca).cacheTimeout;if(t<0)return await this._perform(e);const n=Yu(e.method,e);let s=y(this,ms).get(n);return s||(s=this._perform(e),y(this,ms).set(n,s),setTimeout(()=>{y(this,ms).get(n)===s&&y(this,ms).delete(n)},t)),await s},$d=async function(e,t,n){j(n<G4,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=vl(e);try{return Z(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&yp(i)&&i.data&&n>=0&&t==="latest"&&s.to!=null&&$e(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Dt(s.to,this);let c;try{c=eF($e(i.data,4))}catch(h){j(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}j(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const u=await this.ccipReadFetch(s,c.calldata,c.urls);j(u!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const l={to:a,data:je([c.selector,X4([u,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:l});try{const h=await q(this,ae,$d).call(this,l,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},l),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},l),error:h}),h}}throw i}},kd=async function(e){const{value:t}=await Pt({network:this.getNetwork(),value:e});return t},nc=async function(e,t,n){let s=this._getAddress(t),i=this._getBlockTag(n);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await q(this,ae,kd).call(this,q(this,ae,Gt).call(this,Object.assign(e,{address:s,blockTag:i})))},Ud=async function(e,t){if(Se(e,32))return await q(this,ae,Gt).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await q(this,ae,Gt).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},sc=async function(e,t){let n=await gf(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await gf({orphan:"drop-log",log:t[0]},this)),y(this,wt).get(n.tag)||null},Zu=async function(e){const t=await gf(e,this),n=t.tag;let s=y(this,wt).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},y(this,wt).set(n,s)),s};function J4(r,e){try{const t=Ld(r,e);if(t)return hl(t)}catch{}return null}function Ld(r,e){if(r==="0x")return null;try{const t=oe($e(r,e,e+32)),n=oe($e(r,t,t+32));return $e(r,t+32,t+32+n)}catch{}return null}function rb(r){const e=Ot(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function Y4(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}const Z4=new Uint8Array([]);function X4(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(Z4),t+=32;for(let n=0;n<r.length;n++){const s=fe(r[n]);e[n]=rb(t),e.push(rb(s.length)),e.push(Y4(s)),t+=32+Math.ceil(s.length/32)*32}return je(e)}const nb="0x0000000000000000000000000000000000000000000000000000000000000000";function eF(r){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};j(Ao(r)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=$e(r,0,32);j($e(t,0,12)===$e(nb,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=$e(t,12);try{const n=[],s=oe($e(r,32,64)),i=oe($e(r,s,s+32)),o=$e(r,s+32);for(let a=0;a<i;a++){const c=J4(o,a*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{j(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=Ld(r,64);if(n==null)throw new Error("abort");e.calldata=n}catch{j(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}j($e(r,100,128)===$e(nb,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=$e(r,96,100);try{const n=Ld(r,128);if(n==null)throw new Error("abort");e.extraData=n}catch{j(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function so(r,e){if(r.provider)return r.provider;j(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function sb(r,e){let t=vl(e);if(t.to!=null&&(t.to=Dt(t.to,r)),t.from!=null){const n=t.from;t.from=Promise.all([r.getAddress(),Dt(n,r)]).then(([s,i])=>(N(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=r.getAddress();return await Pt(t)}class tF{constructor(e){k(this,"provider");te(this,{provider:e||null})}async getNonce(e){return so(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await sb(this,e)}async populateTransaction(e){const t=so(this,"populateTransaction"),n=await sb(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const o=X(n.chainId);N(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=s.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?N(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&N(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await t.getFeeData();j(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.type=2,n.gasPrice!=null){const a=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=a,n.maxPriorityFeePerGas=a}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(j(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):j(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Pt(n)}async estimateGas(e){return so(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return so(this,"call").call(await this.populateCall(e))}async resolveName(e){return await so(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=so(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const s=wl.from(n);return await t.broadcastTransaction(await this.signTransaction(s))}}function rF(r){return JSON.parse(JSON.stringify(r))}var It,Xr,di,ws,pi,ua,Os,Fd,Md;class w1{constructor(e){F(this,Os);F(this,It);F(this,Xr);F(this,di);F(this,ws);F(this,pi);F(this,ua);D(this,It,e),D(this,Xr,null),D(this,di,q(this,Os,Fd).bind(this)),D(this,ws,!1),D(this,pi,null),D(this,ua,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){y(this,ws)||(D(this,ws,!0),q(this,Os,Fd).call(this,-2))}stop(){y(this,ws)&&(D(this,ws,!1),D(this,ua,!0),q(this,Os,Md).call(this),y(this,It).off("block",y(this,di)))}pause(e){e&&q(this,Os,Md).call(this),y(this,It).off("block",y(this,di))}resume(){this.start()}}It=new WeakMap,Xr=new WeakMap,di=new WeakMap,ws=new WeakMap,pi=new WeakMap,ua=new WeakMap,Os=new WeakSet,Fd=async function(e){try{y(this,Xr)==null&&D(this,Xr,this._subscribe(y(this,It)));let t=null;try{t=await y(this,Xr)}catch(i){if(!ht(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){D(this,Xr,null),y(this,It)._recoverSubscriber(this,this._recover(y(this,It)));return}const n=await y(this,It).getNetwork();if(y(this,pi)||D(this,pi,n),y(this,pi).chainId!==n.chainId)throw new Error("chaid changed");if(y(this,ua))return;const s=await y(this,It).send("eth_getFilterChanges",[t]);await this._emitResults(y(this,It),s)}catch(t){console.log("@TODO",t)}y(this,It).once("block",y(this,di))},Md=function(){const e=y(this,Xr);e&&(D(this,Xr,null),e.then(t=>{y(this,It).destroyed||y(this,It).send("eth_uninstallFilter",[t])}))};var gi;class nF extends w1{constructor(t,n){super(t);F(this,gi);D(this,gi,rF(n))}_recover(t){return new Up(t,y(this,gi))}async _subscribe(t){return await t.send("eth_newFilter",[y(this,gi)])}async _emitResults(t,n){for(const s of n)t.emit(y(this,gi),t._wrapLog(s,t._network))}}gi=new WeakMap;class sF extends w1{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const iF="bigint,boolean,function,number,string,symbol".split(/,/g);function Xu(r){if(r==null||iF.indexOf(typeof r)>=0||typeof r.getAddress=="function")return r;if(Array.isArray(r))return r.map(Xu);if(typeof r=="object")return Object.keys(r).reduce((e,t)=>(e[t]=r[t],e),{});throw new Error(`should not happen: ${r} (${typeof r})`)}function oF(r){return new Promise(e=>{setTimeout(e,r)})}function io(r){return r&&r.toLowerCase()}function ib(r){return r&&typeof r.pollingInterval=="number"}const b1={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class mf extends tF{constructor(t,n){super(t);k(this,"address");n=Ae(n),te(this,{address:n})}connect(t){j(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=Xu(t),s=[];if(n.from){const o=n.from;s.push((async()=>{const a=await Dt(o,this.provider);N(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await Dt(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const u=async()=>{try{const l=await this.provider.getTransaction(s);if(l!=null){i(l.replaceableTransaction(n));return}}catch(l){if(ht(l,"CANCELLED")||ht(l,"BAD_DATA")||ht(l,"NETWORK_ERROR")||ht(l,"UNSUPPORTED_OPERATION")){l.info==null&&(l.info={}),l.info.sendTransactionHash=s,o(l);return}if(ht(l,"INVALID_ARGUMENT")&&(c++,l.info==null&&(l.info={}),l.info.sendTransactionHash=s,c>10)){o(l);return}this.provider.emit("error",Be("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:l}))}this.provider._setTimeout(()=>{u()},a.pop()||4e3)};u()})}async signTransaction(t){const n=Xu(t);if(n.from){const i=await Dt(n.from,this.provider);N(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=i}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?Mn(t):t;return await this.provider.send("personal_sign",[Z(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const i=Xu(s),o=await bl.resolveNames(t,n,i,async a=>{const c=await Dt(a);return N(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(bl.getPayload(o.domain,n,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?Mn(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Z(n)])}}var yi,la,Bn,en,Nr,dr,Ut,Hc,jd;class aF extends W4{constructor(t,n){super(t,n);F(this,Hc);F(this,yi);F(this,la);F(this,Bn);F(this,en);F(this,Nr);F(this,dr);F(this,Ut);D(this,la,1),D(this,yi,Object.assign({},b1,n||{})),D(this,Bn,[]),D(this,en,null),D(this,dr,null),D(this,Ut,null);{let i=null;const o=new Promise(a=>{i=a});D(this,Nr,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(N(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&D(this,dr,on.from(t))):s&&(N(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),D(this,dr,s))}_getOption(t){return y(this,yi)[t]}get _network(){return j(y(this,dr),"network is not available yet","NETWORK_ERROR"),y(this,dr)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&X(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(y(this,dr))return y(this,dr)}else return t;return y(this,Ut)?await y(this,Ut):this.ready?(D(this,Ut,(async()=>{try{const n=on.from(X(await this.send("eth_chainId",[])));return D(this,Ut,null),n}catch(n){throw D(this,Ut,null),n}})()),await y(this,Ut)):(D(this,Ut,(async()=>{const n={id:$a(this,la)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],D(this,Ut,null)}catch(i){throw D(this,Ut,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return on.from(X(s.result));throw this.getRpcError(n,s)})()),await y(this,Ut))}_start(){y(this,Nr)==null||y(this,Nr).resolve==null||(y(this,Nr).resolve(),D(this,Nr,null),(async()=>{for(;y(this,dr)==null&&!this.destroyed;)try{D(this,dr,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Be("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await oF(1e3)}q(this,Hc,jd).call(this)})())}async _waitUntilReady(){if(y(this,Nr)!=null)return await y(this,Nr).promise}_getSubscriber(t){return t.type==="pending"?new sF(this):t.type==="event"?this._getOption("polling")?new Up(this,t.filter):new nF(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new m1("orphan"):super._getSubscriber(t)}get ready(){return y(this,Nr)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),n[i]=yo(X(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=Z(t[s]))}),t.accessList&&(n.accessList=Ui(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[io(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[io(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[io(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[io(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(io):t.filter.address=io(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:i}=n;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return Be("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=Hd(i),u=Cc.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return u.info={error:i,payload:t},u}const o=JSON.stringify(uF(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Be("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Be("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Be("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Be("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return Be("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?Be("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):Be("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Be("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=$a(this,la)._++,i=new Promise((o,a)=>{y(this,Bn).push({resolve:o,reject:a,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return q(this,Hc,jd).call(this),i}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await n;if(t>=i.length)throw new Error("no such account");return new mf(this,i[t])}const{accounts:s}=await Pt({network:this.getNetwork(),accounts:n});t=Ae(t);for(const i of s)if(Ae(i)===t)return new mf(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new mf(this,n))}destroy(){y(this,en)&&(clearTimeout(y(this,en)),D(this,en,null));for(const{payload:t,reject:n}of y(this,Bn))n(Be("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));D(this,Bn,[]),super.destroy()}}yi=new WeakMap,la=new WeakMap,Bn=new WeakMap,en=new WeakMap,Nr=new WeakMap,dr=new WeakMap,Ut=new WeakMap,Hc=new WeakSet,jd=function(){if(y(this,en))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");D(this,en,setTimeout(()=>{D(this,en,null);const n=y(this,Bn);for(D(this,Bn,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==y(this,yi).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>y(this,yi).batchMaxSize){n.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:u}of s){if(this.destroyed){c(Be("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:u.method}));continue}const l=o.filter(h=>h.id===u.id)[0];if(l==null){const h=Be("missing response for request","BAD_DATA",{value:o,info:{payload:u}});this.emit("error",h),c(h);continue}if("error"in l){c(this.getRpcError(u,l));continue}a(l.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var bs;class cF extends aF{constructor(t,n){super(t,n);F(this,bs);let s=this._getOption("pollingInterval");s==null&&(s=b1.pollingInterval),D(this,bs,s)}_getSubscriber(t){const n=super._getSubscriber(t);return ib(n)&&(n.pollingInterval=y(this,bs)),n}get pollingInterval(){return y(this,bs)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");D(this,bs,t),this._forEachSubscriber(n=>{ib(n)&&(n.pollingInterval=y(this,bs))})}}bs=new WeakMap;function Hd(r){if(r==null)return null;if(typeof r.message=="string"&&r.message.match(/revert/i)&&Se(r.data))return{message:r.message,data:r.data};if(typeof r=="object"){for(const e in r){const t=Hd(r[e]);if(t)return t}return null}if(typeof r=="string")try{return Hd(JSON.parse(r))}catch{}return null}function qd(r,e){if(r!=null){if(typeof r.message=="string"&&e.push(r.message),typeof r=="object")for(const t in r)qd(r[t],e);if(typeof r=="string")try{return qd(JSON.parse(r),e)}catch{}}}function uF(r){const e=[];return qd(r,e),e}var ha;class lF extends cF{constructor(t,n,s){const i=Object.assign({},s??{},{batchMaxCount:1});N(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,i);F(this,ha);D(this,ha,async(o,a)=>{const c={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:c});try{const u=await t.request(c);return this.emit("debug",{action:"receiveEip1193Result",result:u}),u}catch(u){const l=new Error(u.message);throw l.code=u.code,l.data=u.data,l.payload=c,this.emit("debug",{action:"receiveEip1193Error",error:l}),l}})}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){N(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await y(this,ha).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await y(this,ha).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(t)}}ha=new WeakMap;let ic,zd=null;const ob={1:"0x7E20f6A0306537280BD41B0e5a49c2A021DC8798",137:"0x57f5e0DDa1ddfdbBa469bCD6b6f90db5dE4ce69A",56:"0x7E20f6A0306537280BD41B0e5a49c2A021DC8798"},hF=[{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"value",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"burnFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"burnReservedTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"buyTokens",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"claimRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"endPresaleManually",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"manageReservedTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"manualActivatePresale",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IUniswapV2Router02",name:"router",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"},{internalType:"uint256",name:"nativeAmount",type:"uint256"}],name:"manualAddLiquidityCustom",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"ownerDisableClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"ownerEnableClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"ownerEndStaking",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"ownerStartStaking",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"pair",type:"address"},{internalType:"bool",name:"value",type:"bool"}],name:"setAutomatedMarketMakerPair",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"stakeTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_teamWallet",type:"address"},{internalType:"address",name:"_uniswapRouter",type:"address"},{internalType:"address",name:"_pancakeswapRouter",type:"address"},{internalType:"address",name:"_quickswapRouter",type:"address"},{internalType:"address",name:"_priceFeedAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"totalCollected",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];async function v1(r="1"){ic=await N$.init({projectId:"67c4292e272ac36fdbc049335adf6b67",chains:[parseInt(r)],optionalChains:[1,56,137],showQrModal:!0,methods:["eth_sendTransaction","eth_sign","personal_sign","eth_signTypedData"],events:["chainChanged","accountsChanged"]}),await ic.connect();const e=await ic.request({method:"eth_accounts"}),t=await ic.request({method:"eth_chainId"});window.connectedChainId=Number(t),alert(`Wallet verbunden:
Adresse: ${e[0]}
Chain-ID: ${t}`),E1()}document.getElementById("connectButton").addEventListener("click",()=>{const r=document.getElementById("chainSelect").value;v1(r)});window.addEventListener("load",()=>{var t;if(new URLSearchParams(window.location.search).get("autoconnect")==="true"){const n=((t=document.getElementById("chainSelect"))==null?void 0:t.value)||"1";v1(n)}});async function fF(r){var t;let e="";if(r===1)e="ethereum";else if(r===137||r===311)e="matic-network";else if(r===56)e="binancecoin";else return null;try{return(t=(await(await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${e}&vs_currencies=usd`)).json())[e])==null?void 0:t.usd}catch(n){return console.error("Fehler beim Preisabruf:",n),null}}async function E1(){const r=document.getElementById("cryptoAmount"),e=document.getElementById("qpepeResult"),t=parseFloat(r.value),n=1e-4;if(!window.connectedChainId){e.innerText="Please connect your wallet first.";return}if(!t||t<=0){e.innerText="";return}zd=await fF(window.connectedChainId);const s=zd;if(console.log("Aktueller Preis:",s),!s){alert("Price fetch failed.");return}const o=t*s/n;e.innerText=`You will receive approximately ${Math.floor(o).toLocaleString()} QPEPE Tokens`}document.getElementById("cryptoAmount").addEventListener("input",E1);async function dF(){const r=document.getElementById("cryptoAmount"),e=parseFloat(r.value);if(!window.connectedChainId){alert("Please connect your wallet first.");return}if(!e||e<=0){alert("Please enter a valid amount.");return}if(!zd){alert("Price fetch failed.");return}const n=new lF(ic).getSigner();console.log("Chain ID:",window.connectedChainId),console.log("Vertrag:",ob[window.connectedChainId]);const s=ob[window.connectedChainId],i=new Oo(s,hF,await n);try{const o=await i.buyTokens({value:rk(e.toString())});await o.wait(),alert(`Transaction sent! Hash: ${o.hash}`)}catch(o){console.error("Kauf fehlgeschlagen:",o),alert("Transaction failed.")}}window.buyToken=dF;export{WA as H,cb as _,pg as a,FA as b,yF as c,gF as d,_l as e,vF as f,wF as g,Vd as h,mF as r,bb as t,JA as w};
