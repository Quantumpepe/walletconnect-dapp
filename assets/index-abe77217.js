var aA=Object.defineProperty;var cA=(r,e,t)=>e in r?aA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var B=(r,e,t)=>(cA(r,typeof e!="symbol"?e+"":e,t),t),Bh=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var y=(r,e,t)=>(Bh(r,e,"read from private field"),t?t.call(r):e.get(r)),F=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},I=(r,e,t,n)=>(Bh(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);var Va=(r,e,t,n)=>({set _(s){I(r,e,s,t)},get _(){return y(r,e,n)}}),j=(r,e,t)=>(Bh(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const uA="modulepreload",lA=function(r){return"/walletconnect-dapp/"+r},vg={},C0=function(e,t,n){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=lA(i),i in vg)return;vg[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!n)for(let l=s.length-1;l>=0;l--){const h=s[l];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":uA,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((l,h)=>{u.addEventListener("load",l),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};var rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function hA(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var gp={exports:{}},Oo=typeof Reflect=="object"?Reflect:null,Eg=Oo&&typeof Oo.apply=="function"?Oo.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},nl;Oo&&typeof Oo.ownKeys=="function"?nl=Oo.ownKeys:Object.getOwnPropertySymbols?nl=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:nl=function(e){return Object.getOwnPropertyNames(e)};function fA(r){console&&console.warn&&console.warn(r)}var _0=Number.isNaN||function(e){return e!==e};function Ee(){Ee.init.call(this)}gp.exports=Ee;gp.exports.once=yA;Ee.EventEmitter=Ee;Ee.prototype._events=void 0;Ee.prototype._eventsCount=0;Ee.prototype._maxListeners=void 0;var Ag=10;function eh(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Ee,"defaultMaxListeners",{enumerable:!0,get:function(){return Ag},set:function(r){if(typeof r!="number"||r<0||_0(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Ag=r}});Ee.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ee.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||_0(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function N0(r){return r._maxListeners===void 0?Ee.defaultMaxListeners:r._maxListeners}Ee.prototype.getMaxListeners=function(){return N0(this)};Ee.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")Eg(c,this,t);else for(var u=c.length,l=$0(c,u),n=0;n<u;++n)Eg(l[n],this,t);return!0};function T0(r,e,t,n){var s,i,o;if(eh(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),o=i[e]),o===void 0)o=i[e]=t,++r._eventsCount;else if(typeof o=="function"?o=i[e]=n?[t,o]:[o,t]:n?o.unshift(t):o.push(t),s=N0(r),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,fA(a)}return r}Ee.prototype.addListener=function(e,t){return T0(this,e,t,!1)};Ee.prototype.on=Ee.prototype.addListener;Ee.prototype.prependListener=function(e,t){return T0(this,e,t,!0)};function dA(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function R0(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},s=dA.bind(n);return s.listener=t,n.wrapFn=s,s}Ee.prototype.once=function(e,t){return eh(t),this.on(e,R0(this,e,t)),this};Ee.prototype.prependOnceListener=function(e,t){return eh(t),this.prependListener(e,R0(this,e,t)),this};Ee.prototype.removeListener=function(e,t){var n,s,i,o,a;if(eh(t),s=this._events,s===void 0)return this;if(n=s[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():pA(n,i),n.length===1&&(s[e]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Ee.prototype.off=Ee.prototype.removeListener;Ee.prototype.removeAllListeners=function(e){var t,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var i=Object.keys(n),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function B0(r,e,t){var n=r._events;if(n===void 0)return[];var s=n[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?gA(s):$0(s,s.length)}Ee.prototype.listeners=function(e){return B0(this,e,!0)};Ee.prototype.rawListeners=function(e){return B0(this,e,!1)};Ee.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):F0.call(r,e)};Ee.prototype.listenerCount=F0;function F0(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ee.prototype.eventNames=function(){return this._eventsCount>0?nl(this._events):[]};function $0(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function pA(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function gA(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function yA(r,e){return new Promise(function(t,n){function s(o){r.removeListener(e,i),n(o)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",s),t([].slice.call(arguments))}k0(r,e,i,{once:!0}),e!=="error"&&mA(r,s,{once:!0})})}function mA(r,e,t){typeof r.on=="function"&&k0(r,"error",e,t)}function k0(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function s(i){n.once&&r.removeEventListener(e,s),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var nr=gp.exports;const yp=pp(nr);var Ig=globalThis&&globalThis.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))},wA=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),bA=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),vA=function(){function r(e,t,n,s){this.name=e,this.version=t,this.os=n,this.bot=s,this.type="bot-device"}return r}(),EA=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),AA=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),IA=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,PA=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Pg=3,xA=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",IA]],xg=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function OA(r){return r?Og(r):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new AA:typeof navigator<"u"?Og(navigator.userAgent):CA()}function SA(r){return r!==""&&xA.reduce(function(e,t){var n=t[0],s=t[1];if(e)return e;var i=s.exec(r);return!!i&&[n,i]},!1)}function Og(r){var e=SA(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new EA;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<Pg&&(s=Ig(Ig([],s,!0),_A(Pg-s.length),!0)):s=[];var i=s.join("."),o=DA(r),a=PA.exec(r);return a&&a[1]?new vA(t,i,o,a[1]):new wA(t,i,o)}function DA(r){for(var e=0,t=xg.length;e<t;e++){var n=xg[e],s=n[0],i=n[1],o=i.exec(r);if(o)return s}return null}function CA(){var r=typeof process<"u"&&process.version;return r?new bA(process.version.slice(1)):null}function _A(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var V={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var jf=function(r,e){return jf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},jf(r,e)};function NA(r,e){jf(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Hf=function(){return Hf=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Hf.apply(this,arguments)};function TA(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function RA(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function BA(r,e){return function(t,n){e(t,n,r)}}function FA(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function $A(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})}function kA(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,s=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){t.label=u[1];break}if(u[0]===6&&t.label<i[1]){t.label=i[1],i=u;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(u);break}i[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(l){u=[6,l],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function UA(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function LA(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function zf(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function U0(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function MA(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(U0(arguments[e]));return r}function jA(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Ac(r){return this instanceof Ac?(this.v=r,this):new Ac(r)}function HA(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){n[f]&&(s[f]=function(d){return new Promise(function(p,g){i.push([f,d,p,g])>1||a(f,d)})})}function a(f,d){try{c(n[f](d))}catch(p){h(i[0][3],p)}}function c(f){f.value instanceof Ac?Promise.resolve(f.value.v).then(u,l):h(i[0][2],f)}function u(f){a("next",f)}function l(f){a("throw",f)}function h(f,d){f(d),i.shift(),i.length&&a(i[0][0],i[0][1])}}function zA(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Ac(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function qA(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof zf=="function"?zf(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function VA(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function GA(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function KA(r){return r&&r.__esModule?r:{default:r}}function QA(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function WA(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const JA=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Hf},__asyncDelegator:zA,__asyncGenerator:HA,__asyncValues:qA,__await:Ac,__awaiter:$A,__classPrivateFieldGet:QA,__classPrivateFieldSet:WA,__createBinding:UA,__decorate:RA,__exportStar:LA,__extends:NA,__generator:kA,__importDefault:KA,__importStar:GA,__makeTemplateObject:VA,__metadata:FA,__param:BA,__read:U0,__rest:TA,__spread:MA,__spreadArrays:jA,__values:zf},Symbol.toStringTag,{value:"Module"})),lu=hA(JA);var Fh={},Ga={},Sg;function YA(){if(Sg)return Ga;Sg=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Ga.delay=r,Ga}var _s={},$h={},Ns={},Dg;function ZA(){return Dg||(Dg=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.ONE_THOUSAND=Ns.ONE_HUNDRED=void 0,Ns.ONE_HUNDRED=100,Ns.ONE_THOUSAND=1e3),Ns}var kh={},Cg;function XA(){return Cg||(Cg=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(kh)),kh}var _g;function L0(){return _g||(_g=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=lu;e.__exportStar(ZA(),r),e.__exportStar(XA(),r)}($h)),$h}var Ng;function e2(){if(Ng)return _s;Ng=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.fromMiliseconds=_s.toMiliseconds=void 0;const r=L0();function e(n){return n*r.ONE_THOUSAND}_s.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return _s.fromMiliseconds=t,_s}var Tg;function t2(){return Tg||(Tg=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=lu;e.__exportStar(YA(),r),e.__exportStar(e2(),r)}(Fh)),Fh}var Mi={},Rg;function r2(){if(Rg)return Mi;Rg=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:s})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Mi.Watch=r,Mi.default=r,Mi}var Uh={},Ka={},Bg;function n2(){if(Bg)return Ka;Bg=1,Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.IWatch=void 0;class r{}return Ka.IWatch=r,Ka}var Fg;function s2(){return Fg||(Fg=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),lu.__exportStar(n2(),r)}(Uh)),Uh}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=lu;e.__exportStar(t2(),r),e.__exportStar(r2(),r),e.__exportStar(s2(),r),e.__exportStar(L0(),r)})(V);var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=M0=xe.getLocation=xe.getLocationOrThrow=mp=xe.getNavigator=xe.getNavigatorOrThrow=hu=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function Bi(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}xe.getFromWindow=Bi;function $a(r){const e=Bi(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}xe.getFromWindowOrThrow=$a;function i2(){return $a("document")}xe.getDocumentOrThrow=i2;function o2(){return Bi("document")}var hu=xe.getDocument=o2;function a2(){return $a("navigator")}xe.getNavigatorOrThrow=a2;function c2(){return Bi("navigator")}var mp=xe.getNavigator=c2;function u2(){return $a("location")}xe.getLocationOrThrow=u2;function l2(){return Bi("location")}var M0=xe.getLocation=l2;function h2(){return $a("crypto")}xe.getCryptoOrThrow=h2;function f2(){return Bi("crypto")}xe.getCrypto=f2;function d2(){return $a("localStorage")}xe.getLocalStorageOrThrow=d2;function p2(){return Bi("localStorage")}xe.getLocalStorage=p2;var wp={};Object.defineProperty(wp,"__esModule",{value:!0});var j0=wp.getWindowMetadata=void 0;const $g=xe;function g2(){let r,e;try{r=$g.getDocumentOrThrow(),e=$g.getLocationOrThrow()}catch{return null}function t(){const h=r.getElementsByTagName("link"),f=[];for(let d=0;d<h.length;d++){const p=h[d],g=p.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const m=p.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let b=e.protocol+"//"+e.host;if(m.indexOf("/")===0)b+=m;else{const E=e.pathname.split("/");E.pop();const A=E.join("/");b+=A+"/"+m}f.push(b)}else if(m.indexOf("//")===0){const b=e.protocol+m;f.push(b)}else f.push(m)}}return f}function n(...h){const f=r.getElementsByTagName("meta");for(let d=0;d<f.length;d++){const p=f[d],g=["itemprop","property","name"].map(m=>p.getAttribute(m)).filter(m=>m?h.includes(m):!1);if(g.length&&g){const m=p.getAttribute("content");if(m)return m}}return""}function s(){let h=n("name","og:site_name","og:title","twitter:title");return h||(h=r.title),h}function i(){return n("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,u=t();return{description:a,url:c,icons:u,name:o}}j0=wp.getWindowMetadata=g2;function Ic(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function kg(r){return Ic(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const H0="2.23.2";let Qa={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${H0}`};class Ii extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof Ii?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=(()=>t.cause instanceof Ii&&t.cause.docsPath||t.docsPath)(),i=(a=Qa.getDocsUrl)==null?void 0:a.call(Qa,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...Qa.version?[`Version: ${Qa.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=H0}walk(e){return z0(this,e)}}function z0(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?z0(r.cause,e):e?null:r}class q0 extends Ii{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function ka(r,{dir:e,size:t=32}={}){return typeof r=="string"?y2(r,{dir:e,size:t}):m2(r,{dir:e,size:t})}function y2(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new q0({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function m2(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new q0({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}class w2 extends Ii{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class b2 extends Ii{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Ua(r,{size:e}){if(kg(r)>e)throw new b2({givenSize:kg(r),maxSize:e})}function qf(r,e={}){const{signed:t}=e;e.size&&Ua(r,{size:e.size});const n=BigInt(r);if(!t)return n;const s=(r.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function v2(r,e={}){return Number(qf(r,e))}const E2=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Vf(r,e={}){return typeof r=="number"||typeof r=="bigint"?G0(r,e):typeof r=="string"?P2(r,e):typeof r=="boolean"?A2(r,e):V0(r,e)}function A2(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(Ua(t,{size:e.size}),ka(t,{size:e.size})):t}function V0(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=E2[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(Ua(n,{size:e.size}),ka(n,{dir:"right",size:e.size})):n}function G0(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new w2({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?ka(a,{size:n}):a}const I2=new TextEncoder;function P2(r,e={}){const t=I2.encode(r);return V0(t,e)}const x2=new TextEncoder;function O2(r,e={}){return typeof r=="number"||typeof r=="bigint"?D2(r,e):typeof r=="boolean"?S2(r,e):Ic(r)?K0(r,e):Q0(r,e)}function S2(r,e={}){const t=new Uint8Array(1);return t[0]=Number(r),typeof e.size=="number"?(Ua(t,{size:e.size}),ka(t,{size:e.size})):t}const hn={zero:48,nine:57,A:65,F:70,a:97,f:102};function Ug(r){if(r>=hn.zero&&r<=hn.nine)return r-hn.zero;if(r>=hn.A&&r<=hn.F)return r-(hn.A-10);if(r>=hn.a&&r<=hn.f)return r-(hn.a-10)}function K0(r,e={}){let t=r;e.size&&(Ua(t,{size:e.size}),t=ka(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Ug(n.charCodeAt(a++)),u=Ug(n.charCodeAt(a++));if(c===void 0||u===void 0)throw new Ii(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+u}return i}function D2(r,e){const t=G0(r,e);return K0(t)}function Q0(r,e={}){const t=x2.encode(r);return typeof e.size=="number"?(Ua(t,{size:e.size}),ka(t,{dir:"right",size:e.size})):t}function Al(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function C2(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function th(r,...e){if(!C2(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function bL(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Al(r.outputLen),Al(r.blockLen)}function Lg(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function _2(r,e){th(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Tu=BigInt(2**32-1),Mg=BigInt(32);function N2(r,e=!1){return e?{h:Number(r&Tu),l:Number(r>>Mg&Tu)}:{h:Number(r>>Mg&Tu)|0,l:Number(r&Tu)|0}}function T2(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=N2(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const R2=(r,e,t)=>r<<t|e>>>32-t,B2=(r,e,t)=>e<<t|r>>>32-t,F2=(r,e,t)=>e<<t-32|r>>>64-t,$2=(r,e,t)=>r<<t-32|e>>>64-t,ji=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function k2(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function vL(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function EL(r,e){return r<<32-e|r>>>e}const jg=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function U2(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function Hg(r){for(let e=0;e<r.length;e++)r[e]=U2(r[e])}function L2(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function W0(r){return typeof r=="string"&&(r=L2(r)),th(r),r}function AL(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];th(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let M2=class{clone(){return this._cloneInto()}};function j2(r){const e=n=>r().update(W0(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function PL(r=32){if(ji&&typeof ji.getRandomValues=="function")return ji.getRandomValues(new Uint8Array(r));if(ji&&typeof ji.randomBytes=="function")return ji.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const J0=[],Y0=[],Z0=[],H2=BigInt(0),Wa=BigInt(1),z2=BigInt(2),q2=BigInt(7),V2=BigInt(256),G2=BigInt(113);for(let r=0,e=Wa,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],J0.push(2*(5*n+t)),Y0.push((r+1)*(r+2)/2%64);let s=H2;for(let i=0;i<7;i++)e=(e<<Wa^(e>>q2)*G2)%V2,e&z2&&(s^=Wa<<(Wa<<BigInt(i))-Wa);Z0.push(s)}const[K2,Q2]=T2(Z0,!0),zg=(r,e,t)=>t>32?F2(r,e,t):R2(r,e,t),qg=(r,e,t)=>t>32?$2(r,e,t):B2(r,e,t);function W2(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=t[c],l=t[c+1],h=zg(u,l,1)^t[a],f=qg(u,l,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=Y0[o],c=zg(s,i,a),u=qg(s,i,a),l=J0[o];s=r[l],i=r[l+1],r[l]=c,r[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=K2[n],r[1]^=Q2[n]}t.fill(0)}let J2=class X0 extends M2{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Al(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=k2(this.state)}keccak(){jg||Hg(this.state32),W2(this.state32,this.rounds),jg||Hg(this.state32),this.posOut=0,this.pos=0}update(e){Lg(this);const{blockLen:t,state:n}=this;e=W0(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Lg(this,!1),th(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Al(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(_2(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new X0(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const Y2=(r,e,t)=>j2(()=>new J2(e,r,t)),Z2=Y2(1,136,256/8);function eb(r,e){const t=e||"hex",n=Z2(Ic(r,{strict:!1})?O2(r):r);return t==="bytes"?n:Vf(n)}class X2 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const Lh=new X2(8192);function eI(r,e){if(Lh.has(`${r}.${e}`))return Lh.get(`${r}.${e}`);const t=e?`${e}${r.toLowerCase()}`:r.substring(2).toLowerCase(),n=eb(Q0(t),"bytes"),s=(e?t.substring(`${e}0x`.length):t).split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Lh.set(`${r}.${e}`,i),i}function tI(r){const e=eb(`0x${r.substring(4)}`).substring(26);return eI(`0x${e}`)}async function rI({hash:r,signature:e}){const t=Ic(r)?r:Vf(r),{secp256k1:n}=await C0(()=>import("./secp256k1-eac4e538.js"),[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:l,v:h,yParity:f}=e,d=Number(f??h),p=Vg(d);return new n.Signature(qf(u),qf(l)).addRecoveryBit(p)}const o=Ic(e)?e:Vf(e),a=v2(`0x${o.slice(130)}`),c=Vg(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function Vg(r){if(r===0||r===1)return r;if(r===27)return 0;if(r===28)return 1;throw new Error("Invalid yParityOrV value")}async function nI({hash:r,signature:e}){return tI(await rI({hash:r,signature:e}))}function sI(r){if(r.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let u=0;u<e.length;u++)e[u]=255;for(let u=0;u<r.length;u++){const l=r.charAt(u),h=l.charCodeAt(0);if(e[h]!==255)throw new TypeError(l+" is ambiguous");e[h]=u}const t=r.length,n=r.charAt(0),s=Math.log(t)/Math.log(256),i=Math.log(256)/Math.log(t);function o(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";let l=0,h=0,f=0;const d=u.length;for(;f!==d&&u[f]===0;)f++,l++;const p=(d-f)*i+1>>>0,g=new Uint8Array(p);for(;f!==d;){let E=u[f],A=0;for(let x=p-1;(E!==0||A<h)&&x!==-1;x--,A++)E+=256*g[x]>>>0,g[x]=E%t>>>0,E=E/t>>>0;if(E!==0)throw new Error("Non-zero carry");h=A,f++}let m=p-h;for(;m!==p&&g[m]===0;)m++;let b=n.repeat(l);for(;m<p;++m)b+=r.charAt(g[m]);return b}function a(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;let l=0,h=0,f=0;for(;u[l]===n;)h++,l++;const d=(u.length-l)*s+1>>>0,p=new Uint8Array(d);for(;l<u.length;){const E=u.charCodeAt(l);if(E>255)return;let A=e[E];if(A===255)return;let x=0;for(let D=d-1;(A!==0||x<f)&&D!==-1;D--,x++)A+=t*p[D]>>>0,p[D]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");f=x,l++}let g=d-f;for(;g!==d&&p[g]===0;)g++;const m=new Uint8Array(h+(d-g));let b=h;for(;g!==d;)m[b++]=p[g++];return m}function c(u){const l=a(u);if(l)return l;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var iI="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const oI=sI(iI),aI=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),cI=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Pi(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return cI(r)}catch{return r}}function qn(r){return typeof r=="string"?r:aI(r)||""}function uI(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function tb(r,...e){if(!uI(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Gg(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function lI(r,e){tb(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Hi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Mh=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function hI(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function rb(r){return typeof r=="string"&&(r=hI(r)),tb(r),r}let fI=class{clone(){return this._cloneInto()}};function dI(r){const e=n=>r().update(rb(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function nb(r=32){if(Hi&&typeof Hi.getRandomValues=="function")return Hi.getRandomValues(new Uint8Array(r));if(Hi&&typeof Hi.randomBytes=="function")return Hi.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function pI(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,u=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+u,a,n)}let gI=class extends fI{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Mh(this.buffer)}update(e){Gg(this);const{view:t,buffer:n,blockLen:s}=this;e=rb(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Mh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gg(this),lI(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;pI(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Mh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,l[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const Ru=BigInt(2**32-1),Gf=BigInt(32);function sb(r,e=!1){return e?{h:Number(r&Ru),l:Number(r>>Gf&Ru)}:{h:Number(r>>Gf&Ru)|0,l:Number(r&Ru)|0}}function yI(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=sb(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const mI=(r,e)=>BigInt(r>>>0)<<Gf|BigInt(e>>>0),wI=(r,e,t)=>r>>>t,bI=(r,e,t)=>r<<32-t|e>>>t,vI=(r,e,t)=>r>>>t|e<<32-t,EI=(r,e,t)=>r<<32-t|e>>>t,AI=(r,e,t)=>r<<64-t|e>>>t-32,II=(r,e,t)=>r>>>t-32|e<<64-t,PI=(r,e)=>e,xI=(r,e)=>r,OI=(r,e,t)=>r<<t|e>>>32-t,SI=(r,e,t)=>e<<t|r>>>32-t,DI=(r,e,t)=>e<<t-32|r>>>64-t,CI=(r,e,t)=>r<<t-32|e>>>64-t;function _I(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const NI=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),TI=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,RI=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),BI=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,FI=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),$I=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,ne={fromBig:sb,split:yI,toBig:mI,shrSH:wI,shrSL:bI,rotrSH:vI,rotrSL:EI,rotrBH:AI,rotrBL:II,rotr32H:PI,rotr32L:xI,rotlSH:OI,rotlSL:SI,rotlBH:DI,rotlBL:CI,add:_I,add3L:NI,add3H:TI,add4L:RI,add4H:BI,add5H:$I,add5L:FI},[kI,UI]=(()=>ne.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))))(),Kn=new Uint32Array(80),Qn=new Uint32Array(80);let LI=class extends gI{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:h,Fl:f,Gh:d,Gl:p,Hh:g,Hl:m}=this;return[e,t,n,s,i,o,a,c,u,l,h,f,d,p,g,m]}set(e,t,n,s,i,o,a,c,u,l,h,f,d,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=h|0,this.Fl=f|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let A=0;A<16;A++,t+=4)Kn[A]=e.getUint32(t),Qn[A]=e.getUint32(t+=4);for(let A=16;A<80;A++){const x=Kn[A-15]|0,D=Qn[A-15]|0,S=ne.rotrSH(x,D,1)^ne.rotrSH(x,D,8)^ne.shrSH(x,D,7),_=ne.rotrSL(x,D,1)^ne.rotrSL(x,D,8)^ne.shrSL(x,D,7),N=Kn[A-2]|0,T=Qn[A-2]|0,z=ne.rotrSH(N,T,19)^ne.rotrBH(N,T,61)^ne.shrSH(N,T,6),U=ne.rotrSL(N,T,19)^ne.rotrBL(N,T,61)^ne.shrSL(N,T,6),H=ne.add4L(_,U,Qn[A-7],Qn[A-16]),W=ne.add4H(H,S,z,Kn[A-7],Kn[A-16]);Kn[A]=W|0,Qn[A]=H|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:h,El:f,Fh:d,Fl:p,Gh:g,Gl:m,Hh:b,Hl:E}=this;for(let A=0;A<80;A++){const x=ne.rotrSH(h,f,14)^ne.rotrSH(h,f,18)^ne.rotrBH(h,f,41),D=ne.rotrSL(h,f,14)^ne.rotrSL(h,f,18)^ne.rotrBL(h,f,41),S=h&d^~h&g,_=f&p^~f&m,N=ne.add5L(E,D,_,UI[A],Qn[A]),T=ne.add5H(N,b,x,S,kI[A],Kn[A]),z=N|0,U=ne.rotrSH(n,s,28)^ne.rotrBH(n,s,34)^ne.rotrBH(n,s,39),H=ne.rotrSL(n,s,28)^ne.rotrBL(n,s,34)^ne.rotrBL(n,s,39),W=n&i^n&a^i&a,k=s&o^s&c^o&c;b=g|0,E=m|0,g=d|0,m=p|0,d=h|0,p=f|0,{h,l:f}=ne.add(u|0,l|0,T|0,z|0),u=a|0,l=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const w=ne.add3L(z,H,k);n=ne.add3H(w,T,U,W),s=w|0}({h:n,l:s}=ne.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=ne.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ne.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=ne.add(this.Dh|0,this.Dl|0,u|0,l|0),{h,l:f}=ne.add(this.Eh|0,this.El|0,h|0,f|0),{h:d,l:p}=ne.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:m}=ne.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:b,l:E}=ne.add(this.Hh|0,this.Hl|0,b|0,E|0),this.set(n,s,i,o,a,c,u,l,h,f,d,p,g,m,b,E)}roundClean(){Kn.fill(0),Qn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const MI=dI(()=>new LI);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bp=BigInt(0),ib=BigInt(1),jI=BigInt(2);function vp(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Ep(r){if(!vp(r))throw new Error("Uint8Array expected")}function jh(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const HI=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Ap(r){Ep(r);let e="";for(let t=0;t<r.length;t++)e+=HI[r[t]];return e}function ob(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?bp:BigInt("0x"+r)}const fn={_0:48,_9:57,A:65,F:70,a:97,f:102};function Kg(r){if(r>=fn._0&&r<=fn._9)return r-fn._0;if(r>=fn.A&&r<=fn.F)return r-(fn.A-10);if(r>=fn.a&&r<=fn.f)return r-(fn.a-10)}function ab(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=Kg(r.charCodeAt(i)),a=Kg(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function zI(r){return ob(Ap(r))}function sl(r){return Ep(r),ob(Ap(Uint8Array.from(r).reverse()))}function cb(r,e){return ab(r.toString(16).padStart(e*2,"0"))}function Kf(r,e){return cb(r,e).reverse()}function dn(r,e,t){let n;if(typeof e=="string")try{n=ab(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(vp(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Qg(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Ep(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const Hh=r=>typeof r=="bigint"&&bp<=r;function qI(r,e,t){return Hh(r)&&Hh(e)&&Hh(t)&&e<=r&&r<t}function Ja(r,e,t,n){if(!qI(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function VI(r){let e;for(e=0;r>bp;r>>=ib,e+=1);return e}const GI=r=>(jI<<BigInt(r-1))-ib,KI={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||vp(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Ip(r,e,t={}){const n=(s,i,o)=>{const a=KI[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function Wg(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const tt=BigInt(0),$e=BigInt(1),Us=BigInt(2),QI=BigInt(3),Qf=BigInt(4),Jg=BigInt(5),Yg=BigInt(8);function Ke(r,e){const t=r%e;return t>=tt?t:e+t}function WI(r,e,t){if(e<tt)throw new Error("invalid exponent, negatives unsupported");if(t<=tt)throw new Error("invalid modulus");if(t===$e)return tt;let n=$e;for(;e>tt;)e&$e&&(n=n*r%t),r=r*r%t,e>>=$e;return n}function Mr(r,e,t){let n=r;for(;e-- >tt;)n*=n,n%=t;return n}function Zg(r,e){if(r===tt)throw new Error("invert: expected non-zero number");if(e<=tt)throw new Error("invert: expected positive modulus, got "+e);let t=Ke(r,e),n=e,s=tt,i=$e;for(;t!==tt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==$e)throw new Error("invert: does not exist");return Ke(s,e)}function JI(r){const e=(r-$e)/Us;let t,n,s;for(t=r-$e,n=0;t%Us===tt;t/=Us,n++);for(s=Us;s<r&&WI(s,e,r)!==r-$e;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+$e)/Qf;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(t+$e)/Us;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,s),t),l=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let f=1;for(let p=o.sqr(h);f<c&&!o.eql(p,o.ONE);f++)p=o.sqr(p);const d=o.pow(u,$e<<BigInt(c-f-1));u=o.sqr(d),l=o.mul(l,d),h=o.mul(h,u),c=f}return l}}function YI(r){if(r%Qf===QI){const e=(r+$e)/Qf;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%Yg===Jg){const e=(r-Jg)/Yg;return function(t,n){const s=t.mul(n,Us),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,Us),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return JI(r)}const ZI=(r,e)=>(Ke(r,e)&$e)===$e,XI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function eP(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=XI.reduce((n,s)=>(n[s]="function",n),e);return Ip(r,t)}function tP(r,e,t){if(t<tt)throw new Error("invalid exponent, negatives unsupported");if(t===tt)return r.ONE;if(t===$e)return e;let n=r.ONE,s=e;for(;t>tt;)t&$e&&(n=r.mul(n,s)),s=r.sqr(s),t>>=$e;return n}function rP(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function ub(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function lb(r,e,t=!1,n={}){if(r<=tt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=ub(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:GI(s),ZERO:tt,ONE:$e,create:c=>Ke(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return tt<=c&&c<r},is0:c=>c===tt,isOdd:c=>(c&$e)===$e,neg:c=>Ke(-c,r),eql:(c,u)=>c===u,sqr:c=>Ke(c*c,r),add:(c,u)=>Ke(c+u,r),sub:(c,u)=>Ke(c-u,r),mul:(c,u)=>Ke(c*u,r),pow:(c,u)=>tP(a,c,u),div:(c,u)=>Ke(c*Zg(u,r),r),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Zg(c,r),sqrt:n.sqrt||(c=>(o||(o=YI(r)),o(a,c))),invertBatch:c=>rP(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>t?Kf(c,i):cb(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?sl(c):zI(c)}});return Object.freeze(a)}const Xg=BigInt(0),Bu=BigInt(1);function zh(r,e){const t=e.negate();return r?t:e}function hb(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function qh(r,e){hb(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function nP(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function sP(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const Vh=new WeakMap,fb=new WeakMap;function Gh(r){return fb.get(r)||1}function iP(r,e){return{constTimeNegate:zh,hasPrecomputes(t){return Gh(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>Xg;)n&Bu&&(s=s.add(i)),i=i.double(),n>>=Bu;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=qh(n,e),o=[];let a=t,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=qh(t,e);let a=r.ZERO,c=r.BASE;const u=BigInt(2**t-1),l=2**t,h=BigInt(t);for(let f=0;f<i;f++){const d=f*o;let p=Number(s&u);s>>=h,p>o&&(p-=l,s+=Bu);const g=d,m=d+Math.abs(p)-1,b=f%2!==0,E=p<0;p===0?c=c.add(zh(b,n[g])):a=a.add(zh(E,n[m]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=qh(t,e),c=BigInt(2**t-1),u=2**t,l=BigInt(t);for(let h=0;h<o;h++){const f=h*a;if(s===Xg)break;let d=Number(s&c);if(s>>=l,d>a&&(d-=u,s+=Bu),d===0)continue;let p=n[f+Math.abs(d)-1];d<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(t,n,s){let i=Vh.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&Vh.set(n,s(i))),i},wNAFCached(t,n,s){const i=Gh(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Gh(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){hb(n,e),fb.set(t,n),Vh.delete(t)}}}function oP(r,e,t,n){if(nP(t,r),sP(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=VI(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let h=u;h>=0;h-=o){c.fill(s);for(let d=0;d<n.length;d++){const p=n[d],g=Number(p>>BigInt(h)&BigInt(a));c[g]=c[g].add(t[d])}let f=s;for(let d=c.length-1,p=s;d>0;d--)p=p.add(c[d]),f=f.add(p);if(l=l.add(f),h!==0)for(let d=0;d<o;d++)l=l.double()}return l}function aP(r){return eP(r.Fp),Ip(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ub(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const br=BigInt(0),Tt=BigInt(1),Fu=BigInt(2),cP=BigInt(8),uP={zip215:!0};function lP(r){const e=aP(r);return Ip(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function hP(r){const e=lP(r),{Fp:t,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,u=Fu<<BigInt(a*8)-Tt,l=t.create,h=lb(e.n,e.nBitLength),f=e.uvRatio||((w,v)=>{try{return{isValid:!0,value:t.sqrt(w*t.inv(v))}}catch{return{isValid:!1,value:br}}}),d=e.adjustScalarBytes||(w=>w),p=e.domain||((w,v,P)=>{if(jh("phflag",P),v.length||P)throw new Error("Contexts/pre-hash are not supported");return w});function g(w,v){Ja("coordinate "+w,v,br,u)}function m(w){if(!(w instanceof A))throw new Error("ExtendedPoint expected")}const b=Wg((w,v)=>{const{ex:P,ey:R,ez:C}=w,$=w.is0();v==null&&(v=$?cP:t.inv(C));const q=l(P*v),G=l(R*v),Y=l(C*v);if($)return{x:br,y:Tt};if(Y!==Tt)throw new Error("invZ was invalid");return{x:q,y:G}}),E=Wg(w=>{const{a:v,d:P}=e;if(w.is0())throw new Error("bad point: ZERO");const{ex:R,ey:C,ez:$,et:q}=w,G=l(R*R),Y=l(C*C),Q=l($*$),ee=l(Q*Q),oe=l(G*v),ae=l(Q*l(oe+Y)),fe=l(ee+l(P*l(G*Y)));if(ae!==fe)throw new Error("bad point: equation left != right (1)");const re=l(R*C),_e=l($*q);if(re!==_e)throw new Error("bad point: equation left != right (2)");return!0});class A{constructor(v,P,R,C){this.ex=v,this.ey=P,this.ez=R,this.et=C,g("x",v),g("y",P),g("z",R),g("t",C),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof A)throw new Error("extended point not allowed");const{x:P,y:R}=v||{};return g("x",P),g("y",R),new A(P,R,Tt,l(P*R))}static normalizeZ(v){const P=t.invertBatch(v.map(R=>R.ez));return v.map((R,C)=>R.toAffine(P[C])).map(A.fromAffine)}static msm(v,P){return oP(A,h,v,P)}_setWindowSize(v){S.setWindowSize(this,v)}assertValidity(){E(this)}equals(v){m(v);const{ex:P,ey:R,ez:C}=this,{ex:$,ey:q,ez:G}=v,Y=l(P*G),Q=l($*C),ee=l(R*G),oe=l(q*C);return Y===Q&&ee===oe}is0(){return this.equals(A.ZERO)}negate(){return new A(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:v}=e,{ex:P,ey:R,ez:C}=this,$=l(P*P),q=l(R*R),G=l(Fu*l(C*C)),Y=l(v*$),Q=P+R,ee=l(l(Q*Q)-$-q),oe=Y+q,ae=oe-G,fe=Y-q,re=l(ee*ae),_e=l(oe*fe),je=l(ee*fe),Te=l(ae*oe);return new A(re,_e,Te,je)}add(v){m(v);const{a:P,d:R}=e,{ex:C,ey:$,ez:q,et:G}=this,{ex:Y,ey:Q,ez:ee,et:oe}=v;if(P===BigInt(-1)){const dg=l(($-C)*(Q+Y)),pg=l(($+C)*(Q-Y)),Rh=l(pg-dg);if(Rh===br)return this.double();const gg=l(q*Fu*oe),yg=l(G*Fu*ee),mg=yg+gg,wg=pg+dg,bg=yg-gg,nA=l(mg*Rh),sA=l(wg*bg),iA=l(mg*bg),oA=l(Rh*wg);return new A(nA,sA,oA,iA)}const ae=l(C*Y),fe=l($*Q),re=l(G*R*oe),_e=l(q*ee),je=l((C+$)*(Y+Q)-ae-fe),Te=_e-re,Ce=_e+re,Ve=l(fe-P*ae),ln=l(je*Te),Nu=l(Ce*Ve),tA=l(je*Ve),rA=l(Te*Ce);return new A(ln,Nu,rA,tA)}subtract(v){return this.add(v.negate())}wNAF(v){return S.wNAFCached(this,v,A.normalizeZ)}multiply(v){const P=v;Ja("scalar",P,Tt,n);const{p:R,f:C}=this.wNAF(P);return A.normalizeZ([R,C])[0]}multiplyUnsafe(v,P=A.ZERO){const R=v;return Ja("scalar",R,br,n),R===br?D:this.is0()||R===Tt?this:S.wNAFCachedUnsafe(this,R,A.normalizeZ,P)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return S.unsafeLadder(this,n).is0()}toAffine(v){return b(this,v)}clearCofactor(){const{h:v}=e;return v===Tt?this:this.multiplyUnsafe(v)}static fromHex(v,P=!1){const{d:R,a:C}=e,$=t.BYTES;v=dn("pointHex",v,$),jh("zip215",P);const q=v.slice(),G=v[$-1];q[$-1]=G&-129;const Y=sl(q),Q=P?u:t.ORDER;Ja("pointHex.y",Y,br,Q);const ee=l(Y*Y),oe=l(ee-Tt),ae=l(R*ee-C);let{isValid:fe,value:re}=f(oe,ae);if(!fe)throw new Error("Point.fromHex: invalid y coordinate");const _e=(re&Tt)===Tt,je=(G&128)!==0;if(!P&&re===br&&je)throw new Error("Point.fromHex: x=0 and x_0=1");return je!==_e&&(re=l(-re)),A.fromAffine({x:re,y:Y})}static fromPrivateKey(v){return T(v).point}toRawBytes(){const{x:v,y:P}=this.toAffine(),R=Kf(P,t.BYTES);return R[R.length-1]|=v&Tt?128:0,R}toHex(){return Ap(this.toRawBytes())}}A.BASE=new A(e.Gx,e.Gy,Tt,l(e.Gx*e.Gy)),A.ZERO=new A(br,Tt,Tt,br);const{BASE:x,ZERO:D}=A,S=iP(A,a*8);function _(w){return Ke(w,n)}function N(w){return _(sl(w))}function T(w){const v=t.BYTES;w=dn("private key",w,v);const P=dn("hashed private key",i(w),2*v),R=d(P.slice(0,v)),C=P.slice(v,2*v),$=N(R),q=x.multiply($),G=q.toRawBytes();return{head:R,prefix:C,scalar:$,point:q,pointBytes:G}}function z(w){return T(w).pointBytes}function U(w=new Uint8Array,...v){const P=Qg(...v);return N(i(p(P,dn("context",w),!!s)))}function H(w,v,P={}){w=dn("message",w),s&&(w=s(w));const{prefix:R,scalar:C,pointBytes:$}=T(v),q=U(P.context,R,w),G=x.multiply(q).toRawBytes(),Y=U(P.context,G,$,w),Q=_(q+Y*C);Ja("signature.s",Q,br,n);const ee=Qg(G,Kf(Q,t.BYTES));return dn("result",ee,t.BYTES*2)}const W=uP;function k(w,v,P,R=W){const{context:C,zip215:$}=R,q=t.BYTES;w=dn("signature",w,2*q),v=dn("message",v),P=dn("publicKey",P,q),$!==void 0&&jh("zip215",$),s&&(v=s(v));const G=sl(w.slice(q,2*q));let Y,Q,ee;try{Y=A.fromHex(P,$),Q=A.fromHex(w.slice(0,q),$),ee=x.multiplyUnsafe(G)}catch{return!1}if(!$&&Y.isSmallOrder())return!1;const oe=U(C,Q.toRawBytes(),Y.toRawBytes(),v);return Q.add(Y.multiplyUnsafe(oe)).subtract(ee).clearCofactor().equals(A.ZERO)}return x._setWindowSize(8),{CURVE:e,getPublicKey:z,sign:H,verify:k,ExtendedPoint:A,utils:{getExtendedPublicKey:T,randomPrivateKey:()=>o(t.BYTES),precompute(w=8,v=A.BASE){return v._setWindowSize(w),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const Pp=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ey=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const fP=BigInt(1),ty=BigInt(2);BigInt(3);const dP=BigInt(5),pP=BigInt(8);function gP(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=Pp,o=r*r%i*r%i,a=Mr(o,ty,i)*o%i,c=Mr(a,fP,i)*r%i,u=Mr(c,dP,i)*c%i,l=Mr(u,e,i)*u%i,h=Mr(l,t,i)*l%i,f=Mr(h,n,i)*h%i,d=Mr(f,s,i)*f%i,p=Mr(d,s,i)*f%i,g=Mr(p,e,i)*u%i;return{pow_p_5_8:Mr(g,ty,i)*r%i,b2:o}}function yP(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function mP(r,e){const t=Pp,n=Ke(e*e*e,t),s=Ke(n*n*e,t),i=gP(r*s).pow_p_5_8;let o=Ke(r*n*i,t);const a=Ke(e*o*o,t),c=o,u=Ke(o*ey,t),l=a===r,h=a===Ke(-r,t),f=a===Ke(-r*ey,t);return l&&(o=c),(h||f)&&(o=u),ZI(o,t)&&(o=Ke(-o,t)),{isValid:l||h,value:o}}const wP=(()=>lb(Pp,void 0,!0))(),bP=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:wP,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:pP,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:MI,randomBytes:nb,adjustScalarBytes:yP,uvRatio:mP}))(),db=(()=>hP(bP))(),vP="EdDSA",EP="JWT",Il=".",rh="base64url",pb="utf8",gb="utf8",AP=":",IP="did",PP="key",ry="base58btc",xP="z",OP="K36",SP=32;function xp(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function yb(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?xp(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function mb(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=yb(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return xp(t)}function DP(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,b=0,E=p.length;b!==E&&p[b]===0;)b++,g++;for(var A=(E-b)*l+1>>>0,x=new Uint8Array(A);b!==E;){for(var D=p[b],S=0,_=A-1;(D!==0||S<m)&&_!==-1;_--,S++)D+=256*x[_]>>>0,x[_]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");m=S,b++}for(var N=A-m;N!==A&&x[N]===0;)N++;for(var T=c.repeat(g);N<A;++N)T+=r.charAt(x[N]);return T}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,b=0;p[g]===c;)m++,g++;for(var E=(p.length-g)*u+1>>>0,A=new Uint8Array(E);p[g];){var x=t[p.charCodeAt(g)];if(x===255)return;for(var D=0,S=E-1;(x!==0||D<b)&&S!==-1;S--,D++)x+=a*A[S]>>>0,A[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");b=D,g++}if(p[g]!==" "){for(var _=E-b;_!==E&&A[_]===0;)_++;for(var N=new Uint8Array(m+(E-_)),T=m;_!==E;)N[T++]=A[_++];return N}}}function d(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var CP=DP,_P=CP;const wb=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},NP=r=>new TextEncoder().encode(r),TP=r=>new TextDecoder().decode(r);let RP=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},BP=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return bb(this,e)}},FP=class{constructor(e){this.decoders=e}or(e){return bb(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const bb=(r,e)=>new FP({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let $P=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new RP(e,t,n),this.decoder=new BP(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const nh=({name:r,prefix:e,encode:t,decode:n})=>new $P(r,e,t,n),fu=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=_P(t,e);return nh({prefix:r,name:e,encode:n,decode:i=>wb(s(i))})},kP=(r,e,t,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const h=s[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},UP=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},ft=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>nh({prefix:e,name:r,encode(s){return UP(s,n,t)},decode(s){return kP(s,n,t,r)}}),LP=nh({prefix:"\0",name:"identity",encode:r=>TP(r),decode:r=>NP(r)});var MP=Object.freeze({__proto__:null,identity:LP});const jP=ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var HP=Object.freeze({__proto__:null,base2:jP});const zP=ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var qP=Object.freeze({__proto__:null,base8:zP});const VP=fu({prefix:"9",name:"base10",alphabet:"0123456789"});var GP=Object.freeze({__proto__:null,base10:VP});const KP=ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),QP=ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var WP=Object.freeze({__proto__:null,base16:KP,base16upper:QP});const JP=ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),YP=ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ZP=ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),XP=ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ex=ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),tx=ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rx=ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),nx=ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),sx=ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ix=Object.freeze({__proto__:null,base32:JP,base32upper:YP,base32pad:ZP,base32padupper:XP,base32hex:ex,base32hexupper:tx,base32hexpad:rx,base32hexpadupper:nx,base32z:sx});const ox=fu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ax=fu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var cx=Object.freeze({__proto__:null,base36:ox,base36upper:ax});const ux=fu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),lx=fu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var hx=Object.freeze({__proto__:null,base58btc:ux,base58flickr:lx});const fx=ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),dx=ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),px=ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),gx=ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var yx=Object.freeze({__proto__:null,base64:fx,base64pad:dx,base64url:px,base64urlpad:gx});const vb=Array.from(""),mx=vb.reduce((r,e,t)=>(r[t]=e,r),[]),wx=vb.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function bx(r){return r.reduce((e,t)=>(e+=mx[t],e),"")}function vx(r){const e=[];for(const t of r){const n=wx[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const Ex=nh({prefix:"",name:"base256emoji",encode:bx,decode:vx});var Ax=Object.freeze({__proto__:null,base256emoji:Ex}),Ix=Eb,ny=128,Px=127,xx=~Px,Ox=Math.pow(2,31);function Eb(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Ox;)e[t++]=r&255|ny,r/=128;for(;r&xx;)e[t++]=r&255|ny,r>>>=7;return e[t]=r|0,Eb.bytes=t-n+1,e}var Sx=Wf,Dx=128,sy=127;function Wf(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw Wf.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&sy)<<s:(o&sy)*Math.pow(2,s),s+=7}while(o>=Dx);return Wf.bytes=i-n,t}var Cx=Math.pow(2,7),_x=Math.pow(2,14),Nx=Math.pow(2,21),Tx=Math.pow(2,28),Rx=Math.pow(2,35),Bx=Math.pow(2,42),Fx=Math.pow(2,49),$x=Math.pow(2,56),kx=Math.pow(2,63),Ux=function(r){return r<Cx?1:r<_x?2:r<Nx?3:r<Tx?4:r<Rx?5:r<Bx?6:r<Fx?7:r<$x?8:r<kx?9:10},Lx={encode:Ix,decode:Sx,encodingLength:Ux},Ab=Lx;const iy=(r,e,t=0)=>(Ab.encode(r,e,t),e),oy=r=>Ab.encodingLength(r),Jf=(r,e)=>{const t=e.byteLength,n=oy(r),s=n+oy(t),i=new Uint8Array(s+t);return iy(r,i,0),iy(t,i,n),i.set(e,s),new Mx(r,t,e,i)};let Mx=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};const Ib=({name:r,code:e,encode:t})=>new jx(r,e,t);let jx=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Jf(this.code,t):t.then(n=>Jf(this.code,n))}else throw Error("Unknown type, must be binary type")}};const Pb=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Hx=Ib({name:"sha2-256",code:18,encode:Pb("SHA-256")}),zx=Ib({name:"sha2-512",code:19,encode:Pb("SHA-512")});var qx=Object.freeze({__proto__:null,sha256:Hx,sha512:zx});const xb=0,Vx="identity",Ob=wb,Gx=r=>Jf(xb,Ob(r)),Kx={code:xb,name:Vx,encode:Ob,digest:Gx};var Qx=Object.freeze({__proto__:null,identity:Kx});new TextEncoder,new TextDecoder;const ay={...MP,...HP,...qP,...GP,...WP,...ix,...cx,...hx,...yx,...Ax};({...qx,...Qx});function Sb(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const cy=Sb("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Kh=Sb("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=yb(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Db={utf8:cy,"utf-8":cy,hex:ay.base16,latin1:Kh,ascii:Kh,binary:Kh,...ay};function sh(r,e="utf8"){const t=Db[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function La(r,e="utf8"){const t=Db[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?xp(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function uy(r){return Pi(sh(La(r,rh),pb))}function Pl(r){return sh(La(qn(r),pb),rh)}function Cb(r){const e=La(OP,ry),t=xP+sh(mb([e,r]),ry);return[IP,PP,t].join(AP)}function Wx(r){return sh(r,rh)}function Jx(r){return La(r,rh)}function Yx(r){return La([Pl(r.header),Pl(r.payload)].join(Il),gb)}function Zx(r){return[Pl(r.header),Pl(r.payload),Wx(r.signature)].join(Il)}function Yf(r){const e=r.split(Il),t=uy(e[0]),n=uy(e[1]),s=Jx(e[2]),i=La(e.slice(0,2).join(Il),gb);return{header:t,payload:n,signature:s,data:i}}function ly(r=nb(SP)){const e=db.getPublicKey(r);return{secretKey:mb([r,e]),publicKey:e}}async function Xx(r,e,t,n,s=V.fromMiliseconds(Date.now())){const i={alg:vP,typ:EP},o=Cb(n.publicKey),a=s+t,c={iss:o,sub:r,aud:e,iat:s,exp:a},u=Yx({header:i,payload:c}),l=db.sign(u,n.secretKey.slice(0,32));return Zx({header:i,payload:c,signature:l})}function _b(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function gc(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=_b(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return t}function eO(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,b=0,E=p.length;b!==E&&p[b]===0;)b++,g++;for(var A=(E-b)*l+1>>>0,x=new Uint8Array(A);b!==E;){for(var D=p[b],S=0,_=A-1;(D!==0||S<m)&&_!==-1;_--,S++)D+=256*x[_]>>>0,x[_]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");m=S,b++}for(var N=A-m;N!==A&&x[N]===0;)N++;for(var T=c.repeat(g);N<A;++N)T+=r.charAt(x[N]);return T}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,b=0;p[g]===c;)m++,g++;for(var E=(p.length-g)*u+1>>>0,A=new Uint8Array(E);p[g];){var x=t[p.charCodeAt(g)];if(x===255)return;for(var D=0,S=E-1;(x!==0||D<b)&&S!==-1;S--,D++)x+=a*A[S]>>>0,A[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");b=D,g++}if(p[g]!==" "){for(var _=E-b;_!==E&&A[_]===0;)_++;for(var N=new Uint8Array(m+(E-_)),T=m;_!==E;)N[T++]=A[_++];return N}}}function d(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var tO=eO,rO=tO;const nO=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},sO=r=>new TextEncoder().encode(r),iO=r=>new TextDecoder().decode(r);class oO{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class aO{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Nb(this,e)}}class cO{constructor(e){this.decoders=e}or(e){return Nb(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Nb=(r,e)=>new cO({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class uO{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new oO(e,t,n),this.decoder=new aO(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ih=({name:r,prefix:e,encode:t,decode:n})=>new uO(r,e,t,n),du=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=rO(t,e);return ih({prefix:r,name:e,encode:n,decode:i=>nO(s(i))})},lO=(r,e,t,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const h=s[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},hO=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},dt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>ih({prefix:e,name:r,encode(s){return hO(s,n,t)},decode(s){return lO(s,n,t,r)}}),fO=ih({prefix:"\0",name:"identity",encode:r=>iO(r),decode:r=>sO(r)}),dO=Object.freeze(Object.defineProperty({__proto__:null,identity:fO},Symbol.toStringTag,{value:"Module"})),pO=dt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),gO=Object.freeze(Object.defineProperty({__proto__:null,base2:pO},Symbol.toStringTag,{value:"Module"})),yO=dt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),mO=Object.freeze(Object.defineProperty({__proto__:null,base8:yO},Symbol.toStringTag,{value:"Module"})),wO=du({prefix:"9",name:"base10",alphabet:"0123456789"}),bO=Object.freeze(Object.defineProperty({__proto__:null,base10:wO},Symbol.toStringTag,{value:"Module"})),vO=dt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),EO=dt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),AO=Object.freeze(Object.defineProperty({__proto__:null,base16:vO,base16upper:EO},Symbol.toStringTag,{value:"Module"})),IO=dt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),PO=dt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),xO=dt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),OO=dt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),SO=dt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),DO=dt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),CO=dt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_O=dt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),NO=dt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),TO=Object.freeze(Object.defineProperty({__proto__:null,base32:IO,base32hex:SO,base32hexpad:CO,base32hexpadupper:_O,base32hexupper:DO,base32pad:xO,base32padupper:OO,base32upper:PO,base32z:NO},Symbol.toStringTag,{value:"Module"})),RO=du({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),BO=du({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),FO=Object.freeze(Object.defineProperty({__proto__:null,base36:RO,base36upper:BO},Symbol.toStringTag,{value:"Module"})),$O=du({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kO=du({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),UO=Object.freeze(Object.defineProperty({__proto__:null,base58btc:$O,base58flickr:kO},Symbol.toStringTag,{value:"Module"})),LO=dt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),MO=dt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jO=dt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),HO=dt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),zO=Object.freeze(Object.defineProperty({__proto__:null,base64:LO,base64pad:MO,base64url:jO,base64urlpad:HO},Symbol.toStringTag,{value:"Module"})),Tb=Array.from(""),qO=Tb.reduce((r,e,t)=>(r[t]=e,r),[]),VO=Tb.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function GO(r){return r.reduce((e,t)=>(e+=qO[t],e),"")}function KO(r){const e=[];for(const t of r){const n=VO[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const QO=ih({prefix:"",name:"base256emoji",encode:GO,decode:KO}),WO=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:QO},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const hy={...dO,...gO,...mO,...bO,...AO,...TO,...FO,...UO,...zO,...WO};function Rb(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const fy=Rb("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Qh=Rb("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=_b(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Bb={utf8:fy,"utf-8":fy,hex:hy.base16,latin1:Qh,ascii:Qh,binary:Qh,...hy};function yr(r,e="utf8"){const t=Bb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function jt(r,e="utf8"){const t=Bb[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const JO={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},YO=":";function So(r){const[e,t]=r.split(YO);return{namespace:e,reference:t}}function dy(r,e=[]){const t=[];return Object.keys(r).forEach(n=>{if(e.length&&!e.includes(n))return;const s=r[n];t.push(...s.accounts)}),t}function Fb(r,e){return r.includes(":")?[r]:e.chains||[]}var ZO=Object.defineProperty,XO=Object.defineProperties,eS=Object.getOwnPropertyDescriptors,py=Object.getOwnPropertySymbols,tS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,gy=(r,e,t)=>e in r?ZO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,yy=(r,e)=>{for(var t in e||(e={}))tS.call(e,t)&&gy(r,t,e[t]);if(py)for(var t of py(e))rS.call(e,t)&&gy(r,t,e[t]);return r},nS=(r,e)=>XO(r,eS(e));const sS="ReactNative",tr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},iS="js";function xl(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ds(){return!hu()&&!!mp()&&navigator.product===sS}function oS(){return Ds()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function aS(){return Ds()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function pu(){return!xl()&&!!mp()&&!!hu()}function gu(){return Ds()?tr.reactNative:xl()?tr.node:pu()?tr.browser:tr.unknown}function my(){var r;try{return Ds()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function cS(r,e){const t=new URLSearchParams(r);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const s=e[n];s!==void 0&&t.set(n,s)}return t.toString()}function uS(r){var e,t;const n=$b();try{return r!=null&&r.url&&n.url&&r.url!==n.url&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r==null?void 0:r.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(s=>s!=="")),nS(yy(yy({},n),r),{url:(r==null?void 0:r.url)||n.url,name:(r==null?void 0:r.name)||n.name,description:(r==null?void 0:r.description)||n.description,icons:(t=r==null?void 0:r.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),r||n}}function $b(){return j0()||{name:"",description:"",url:"",icons:[""]}}function lS(){if(gu()===tr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:n}=global.Platform;return[t,n].join("-")}const r=OA();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function hS(){var r;const e=gu();return e===tr.browser?[e,((r=M0())==null?void 0:r.host)||"unknown"].join(":"):e}function kb(r,e,t){const n=lS(),s=hS();return[[r,e].join("-"),[iS,t].join("-"),n,s].join("/")}function fS({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=t.split("?"),l=kb(r,e,n),h={auth:s,ua:l,projectId:i,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},f=cS(u[1]||"",h);return u[0]+"?"+f}function Gs(r,e){return r.filter(t=>e.includes(t)).length===r.length}function Zf(r){return Object.fromEntries(r.entries())}function Xf(r){return new Map(Object.entries(r))}function Fs(r=V.FIVE_MINUTES,e){const t=V.toMiliseconds(r||V.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},t),n=a,s=c})}}function As(r,e,t){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await r;n(o)}catch(o){s(o)}clearTimeout(i)})}function Ub(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function dS(r){return Ub("topic",r)}function pS(r){return Ub("id",r)}function Lb(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function Ge(r,e){return V.fromMiliseconds((e||Date.now())+V.toMiliseconds(r))}function rs(r){return Date.now()>=V.toMiliseconds(r)}function me(r,e){return`${r}${e?`:${e}`:""}`}function il(r=[],e=[]){return[...new Set([...r,...e])]}async function gS({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=yS(i,r,e),a=gu();if(a===tr.browser){if(!((n=hu())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}mS(o)}else a===tr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function yS(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const i=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${ES(n,!0)}`}else s=`${s}/wc?${n}`;return s}function mS(r){let e="_self";vS()?e="_top":(bS()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function wS(r,e){let t="";try{if(pu()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function wy(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function by(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function Op(){return typeof process<"u"&&{}.IS_VITEST==="true"}function bS(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function vS(){try{return window.self!==window.top}catch{return!1}}function ES(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function Mb(r){return Buffer.from(r,"base64").toString("utf-8")}function AS(r){return new Promise(e=>setTimeout(e,r))}function Pc(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function IS(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function yu(r,...e){if(!IS(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Sp(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Pc(r.outputLen),Pc(r.blockLen)}function Ea(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function jb(r,e){yu(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const $u=BigInt(2**32-1),vy=BigInt(32);function PS(r,e=!1){return e?{h:Number(r&$u),l:Number(r>>vy&$u)}:{h:Number(r>>vy&$u)|0,l:Number(r&$u)|0}}function xS(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=PS(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const OS=(r,e,t)=>r<<t|e>>>32-t,SS=(r,e,t)=>e<<t|r>>>32-t,DS=(r,e,t)=>e<<t-32|r>>>64-t,CS=(r,e,t)=>r<<t-32|e>>>64-t,zi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function _S(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Wh(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function jr(r,e){return r<<32-e|r>>>e}const Ey=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function NS(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function Ay(r){for(let e=0;e<r.length;e++)r[e]=NS(r[e])}function TS(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Aa(r){return typeof r=="string"&&(r=TS(r)),yu(r),r}function RS(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];yu(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let Dp=class{clone(){return this._cloneInto()}};function Hb(r){const e=n=>r().update(Aa(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Ma(r=32){if(zi&&typeof zi.getRandomValues=="function")return zi.getRandomValues(new Uint8Array(r));if(zi&&typeof zi.randomBytes=="function")return zi.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const zb=[],qb=[],Vb=[],BS=BigInt(0),Ya=BigInt(1),FS=BigInt(2),$S=BigInt(7),kS=BigInt(256),US=BigInt(113);for(let r=0,e=Ya,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],zb.push(2*(5*n+t)),qb.push((r+1)*(r+2)/2%64);let s=BS;for(let i=0;i<7;i++)e=(e<<Ya^(e>>$S)*US)%kS,e&FS&&(s^=Ya<<(Ya<<BigInt(i))-Ya);Vb.push(s)}const[LS,MS]=xS(Vb,!0),Iy=(r,e,t)=>t>32?DS(r,e,t):OS(r,e,t),Py=(r,e,t)=>t>32?CS(r,e,t):SS(r,e,t);function jS(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=t[c],l=t[c+1],h=Iy(u,l,1)^t[a],f=Py(u,l,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=qb[o],c=Iy(s,i,a),u=Py(s,i,a),l=zb[o];s=r[l],i=r[l+1],r[l]=c,r[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=LS[n],r[1]^=MS[n]}t.fill(0)}let HS=class Gb extends Dp{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Pc(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=_S(this.state)}keccak(){Ey||Ay(this.state32),jS(this.state32,this.rounds),Ey||Ay(this.state32),this.posOut=0,this.pos=0}update(e){Ea(this);const{blockLen:t,state:n}=this;e=Aa(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ea(this,!1),yu(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Pc(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(jb(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Gb(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const zS=(r,e,t)=>Hb(()=>new HS(e,r,t)),qS=zS(1,136,256/8),VS="https://rpc.walletconnect.org/v1";function Kb(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Buffer.from(qS(t)).toString("hex")}async function GS(r,e,t,n,s,i){switch(t.t){case"eip191":return await KS(r,e,t.s);case"eip1271":return await QS(r,e,t.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function KS(r,e,t){return(await nI({hash:Kb(e),signature:t})).toLowerCase()===r.toLowerCase()}async function QS(r,e,t,n,s,i){const o=So(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",u="0000000000000000000000000000000000000000000000000000000000000041",l=t.substring(2),h=Kb(e).substring(2),f=a+h+c+u+l,d=await fetch(`${i||VS}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:WS(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:f},"latest"]})}),{result:p}=await d.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function WS(){return Date.now()+Math.floor(Math.random()*1e3)}function JS(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Buffer.from(r,"base64").slice(1,65);return oI.encode(i)}var YS=Object.defineProperty,ZS=Object.defineProperties,XS=Object.getOwnPropertyDescriptors,xy=Object.getOwnPropertySymbols,eD=Object.prototype.hasOwnProperty,tD=Object.prototype.propertyIsEnumerable,Oy=(r,e,t)=>e in r?YS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,rD=(r,e)=>{for(var t in e||(e={}))eD.call(e,t)&&Oy(r,t,e[t]);if(xy)for(var t of xy(e))tD.call(e,t)&&Oy(r,t,e[t]);return r},nD=(r,e)=>ZS(r,XS(e));const sD="did:pkh:",Cp=r=>r==null?void 0:r.split(":"),iD=r=>{const e=r&&Cp(r);if(e)return r.includes(sD)?e[3]:e[1]},ed=r=>{const e=r&&Cp(r);if(e)return e[2]+":"+e[3]},Ol=r=>{const e=r&&Cp(r);if(e)return e.pop()};async function Sy(r){const{cacao:e,projectId:t}=r,{s:n,p:s}=e,i=Qb(s,s.iss),o=Ol(s.iss);return await GS(o,i,n,ed(s.iss),t)}const Qb=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=Ol(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const i=`URI: ${r.aud||r.uri}`,o=`Version: ${r.version}`,a=`Chain ID: ${iD(e)}`,c=`Nonce: ${r.nonce}`,u=`Issued At: ${r.iat}`,l=r.exp?`Expiration Time: ${r.exp}`:void 0,h=r.nbf?`Not Before: ${r.nbf}`:void 0,f=r.requestId?`Request ID: ${r.requestId}`:void 0,d=r.resources?`Resources:${r.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=ol(r.resources);if(p){const g=xc(p);s=pD(s,g)}return[t,n,"",s,"",i,o,a,c,u,l,h,f,d].filter(g=>g!=null).join(`
`)};function oD(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function aD(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function xi(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function cD(r,e,t,n={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[r]:uD(e,t,n)}}}function uD(r,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...n)}function Wb(r){return xi(r),`urn:recap:${oD(r).replace(/=/g,"")}`}function xc(r){const e=aD(r.replace("urn:recap:",""));return xi(e),e}function lD(r,e,t){const n=cD(r,e,t);return Wb(n)}function hD(r){return r&&r.includes("urn:recap:")}function fD(r,e){const t=xc(r),n=xc(e),s=dD(t,n);return Wb(s)}function dD(r,e){xi(r),xi(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=r.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,u;n.att[s]=nD(rD({},n.att[s]),{[a]:((c=r.att[s])==null?void 0:c[a])||((u=e.att[s])==null?void 0:u[a])})})}),n}function pD(r="",e){xi(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,f)=>h.action.localeCompare(f.action));const u={};c.forEach(h=>{u[h.ability]||(u[h.ability]=[]),u[h.ability].push(h.action)});const l=Object.keys(u).map(h=>(s++,`(${s}) '${h}': '${u[h].join("', '")}' for '${a}'.`));n.push(l.join(", ").replace(".,","."))});const i=n.join(" "),o=`${t}${i}`;return`${r?r+" ":""}${o}`}function Dy(r){var e;const t=xc(r);xi(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function Cy(r){const e=xc(r);xi(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function ol(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return hD(e)?e:void 0}function Jh(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function Jb(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function er(r,...e){if(!Jb(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function _y(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function gD(r,e){er(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Ny(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}const Ps=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),yD=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),mD=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!mD)throw new Error("Non little-endian hardware is not supported");function wD(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function td(r){if(typeof r=="string")r=wD(r);else if(Jb(r))r=rd(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function bD(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function vD(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const ED=(r,e)=>{function t(n,...s){if(er(n),r.nonceLength!==void 0){const u=s[0];if(!u)throw new Error("nonce / iv required");r.varSizeNonce?er(u):er(u,r.nonceLength)}const i=r.tagLength;i&&s[1]!==void 0&&er(s[1]);const o=e(n,...s),a=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");er(l)}};let c=!1;return{encrypt(u,l){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,er(u),a(o.encrypt.length,l),o.encrypt(u,l)},decrypt(u,l){if(er(u),i&&u.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,l),o.decrypt(u,l)}}}return Object.assign(t,r),t};function Ty(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!AD(e))throw new Error("invalid output, must be aligned");return e}function Ry(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,u=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+u,a,n)}function AD(r){return r.byteOffset%4===0}function rd(r){return Uint8Array.from(r)}function Ia(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}const Yb=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),ID=Yb("expand 16-byte k"),PD=Yb("expand 32-byte k"),xD=Ps(ID),OD=Ps(PD);function de(r,e){return r<<e|r>>>32-e}function nd(r){return r.byteOffset%4===0}const ku=64,SD=16,Zb=2**32-1,By=new Uint32Array;function DD(r,e,t,n,s,i,o,a){const c=s.length,u=new Uint8Array(ku),l=Ps(u),h=nd(s)&&nd(i),f=h?Ps(s):By,d=h?Ps(i):By;for(let p=0;p<c;o++){if(r(e,t,n,l,o,a),o>=Zb)throw new Error("arx: counter overflow");const g=Math.min(ku,c-p);if(h&&g===ku){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let b=0,E;b<SD;b++)E=m+b,d[E]=f[E]^l[b];p+=ku;continue}for(let m=0,b;m<g;m++)b=p+m,i[b]=s[b]^u[m];p+=g}}function CD(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=bD({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return Jh(s),Jh(o),Ny(i),Ny(t),(a,c,u,l,h=0)=>{er(a),er(c),er(u);const f=u.length;if(l===void 0&&(l=new Uint8Array(f)),er(l),Jh(h),h<0||h>=Zb)throw new Error("arx: counter overflow");if(l.length<f)throw new Error(`arx: output (${l.length}) is shorter than data (${f})`);const d=[];let p=a.length,g,m;if(p===32)d.push(g=rd(a)),m=OD;else if(p===16&&t)g=new Uint8Array(32),g.set(a),g.set(a,16),m=xD,d.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);nd(c)||d.push(c=rd(c));const b=Ps(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,b,Ps(c.subarray(0,16)),b),c=c.subarray(16)}const E=16-s;if(E!==c.length)throw new Error(`arx: nonce must be ${E} or 16 bytes`);if(E!==12){const x=new Uint8Array(12);x.set(c,i?0:12-c.length),c=x,d.push(c)}const A=Ps(c);return DD(r,m,b,A,u,l,h,o),Ia(...d),l}}const st=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class _D{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=td(e),er(e,32);const t=st(e,0),n=st(e,2),s=st(e,4),i=st(e,6),o=st(e,8),a=st(e,10),c=st(e,12),u=st(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=st(e,16+2*l)}process(e,t,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],u=o[2],l=o[3],h=o[4],f=o[5],d=o[6],p=o[7],g=o[8],m=o[9],b=st(e,t+0),E=st(e,t+2),A=st(e,t+4),x=st(e,t+6),D=st(e,t+8),S=st(e,t+10),_=st(e,t+12),N=st(e,t+14);let T=i[0]+(b&8191),z=i[1]+((b>>>13|E<<3)&8191),U=i[2]+((E>>>10|A<<6)&8191),H=i[3]+((A>>>7|x<<9)&8191),W=i[4]+((x>>>4|D<<12)&8191),k=i[5]+(D>>>1&8191),w=i[6]+((D>>>14|S<<2)&8191),v=i[7]+((S>>>11|_<<5)&8191),P=i[8]+((_>>>8|N<<8)&8191),R=i[9]+(N>>>5|s),C=0,$=C+T*a+z*(5*m)+U*(5*g)+H*(5*p)+W*(5*d);C=$>>>13,$&=8191,$+=k*(5*f)+w*(5*h)+v*(5*l)+P*(5*u)+R*(5*c),C+=$>>>13,$&=8191;let q=C+T*c+z*a+U*(5*m)+H*(5*g)+W*(5*p);C=q>>>13,q&=8191,q+=k*(5*d)+w*(5*f)+v*(5*h)+P*(5*l)+R*(5*u),C+=q>>>13,q&=8191;let G=C+T*u+z*c+U*a+H*(5*m)+W*(5*g);C=G>>>13,G&=8191,G+=k*(5*p)+w*(5*d)+v*(5*f)+P*(5*h)+R*(5*l),C+=G>>>13,G&=8191;let Y=C+T*l+z*u+U*c+H*a+W*(5*m);C=Y>>>13,Y&=8191,Y+=k*(5*g)+w*(5*p)+v*(5*d)+P*(5*f)+R*(5*h),C+=Y>>>13,Y&=8191;let Q=C+T*h+z*l+U*u+H*c+W*a;C=Q>>>13,Q&=8191,Q+=k*(5*m)+w*(5*g)+v*(5*p)+P*(5*d)+R*(5*f),C+=Q>>>13,Q&=8191;let ee=C+T*f+z*h+U*l+H*u+W*c;C=ee>>>13,ee&=8191,ee+=k*a+w*(5*m)+v*(5*g)+P*(5*p)+R*(5*d),C+=ee>>>13,ee&=8191;let oe=C+T*d+z*f+U*h+H*l+W*u;C=oe>>>13,oe&=8191,oe+=k*c+w*a+v*(5*m)+P*(5*g)+R*(5*p),C+=oe>>>13,oe&=8191;let ae=C+T*p+z*d+U*f+H*h+W*l;C=ae>>>13,ae&=8191,ae+=k*u+w*c+v*a+P*(5*m)+R*(5*g),C+=ae>>>13,ae&=8191;let fe=C+T*g+z*p+U*d+H*f+W*h;C=fe>>>13,fe&=8191,fe+=k*l+w*u+v*c+P*a+R*(5*m),C+=fe>>>13,fe&=8191;let re=C+T*m+z*g+U*p+H*d+W*f;C=re>>>13,re&=8191,re+=k*h+w*l+v*u+P*c+R*a,C+=re>>>13,re&=8191,C=(C<<2)+C|0,C=C+$|0,$=C&8191,C=C>>>13,q+=C,i[0]=$,i[1]=q,i[2]=G,i[3]=Y,i[4]=Q,i[5]=ee,i[6]=oe,i[7]=ae,i[8]=fe,i[9]=re}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;Ia(n)}update(e){_y(this);const{buffer:t,blockLen:n}=this;e=td(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){Ia(this.h,this.r,this.buffer,this.pad)}digestInto(e){_y(this),gD(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function ND(r){const e=(n,s)=>r(s).update(td(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const TD=ND(r=>new _D(r));function RD(r,e,t,n,s,i=20){let o=r[0],a=r[1],c=r[2],u=r[3],l=e[0],h=e[1],f=e[2],d=e[3],p=e[4],g=e[5],m=e[6],b=e[7],E=s,A=t[0],x=t[1],D=t[2],S=o,_=a,N=c,T=u,z=l,U=h,H=f,W=d,k=p,w=g,v=m,P=b,R=E,C=A,$=x,q=D;for(let Y=0;Y<i;Y+=2)S=S+z|0,R=de(R^S,16),k=k+R|0,z=de(z^k,12),S=S+z|0,R=de(R^S,8),k=k+R|0,z=de(z^k,7),_=_+U|0,C=de(C^_,16),w=w+C|0,U=de(U^w,12),_=_+U|0,C=de(C^_,8),w=w+C|0,U=de(U^w,7),N=N+H|0,$=de($^N,16),v=v+$|0,H=de(H^v,12),N=N+H|0,$=de($^N,8),v=v+$|0,H=de(H^v,7),T=T+W|0,q=de(q^T,16),P=P+q|0,W=de(W^P,12),T=T+W|0,q=de(q^T,8),P=P+q|0,W=de(W^P,7),S=S+U|0,q=de(q^S,16),v=v+q|0,U=de(U^v,12),S=S+U|0,q=de(q^S,8),v=v+q|0,U=de(U^v,7),_=_+H|0,R=de(R^_,16),P=P+R|0,H=de(H^P,12),_=_+H|0,R=de(R^_,8),P=P+R|0,H=de(H^P,7),N=N+W|0,C=de(C^N,16),k=k+C|0,W=de(W^k,12),N=N+W|0,C=de(C^N,8),k=k+C|0,W=de(W^k,7),T=T+z|0,$=de($^T,16),w=w+$|0,z=de(z^w,12),T=T+z|0,$=de($^T,8),w=w+$|0,z=de(z^w,7);let G=0;n[G++]=o+S|0,n[G++]=a+_|0,n[G++]=c+N|0,n[G++]=u+T|0,n[G++]=l+z|0,n[G++]=h+U|0,n[G++]=f+H|0,n[G++]=d+W|0,n[G++]=p+k|0,n[G++]=g+w|0,n[G++]=m+v|0,n[G++]=b+P|0,n[G++]=E+R|0,n[G++]=A+C|0,n[G++]=x+$|0,n[G++]=D+q|0}const BD=CD(RD,{counterRight:!1,counterLength:4,allowShortKeys:!1}),FD=new Uint8Array(16),Fy=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(FD.subarray(t))},$D=new Uint8Array(32);function $y(r,e,t,n,s){const i=r(e,t,$D),o=TD.create(i);s&&Fy(o,s),Fy(o,n);const a=new Uint8Array(16),c=yD(a);Ry(c,0,BigInt(s?s.length:0),!0),Ry(c,8,BigInt(n.length),!0),o.update(a);const u=o.digest();return Ia(i,a),u}const kD=r=>(e,t,n)=>({encrypt(s,i){const o=s.length;i=Ty(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);r(e,t,a,a,1);const c=$y(r,e,t,a,n);return i.set(c,o),Ia(c),i},decrypt(s,i){i=Ty(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=$y(r,e,t,o,n);if(!vD(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),r(e,t,i,i,1),Ia(c),i}}),Xb=ED({blockSize:64,nonceLength:12,tagLength:16},kD(BD));let e1=class extends Dp{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Sp(e);const n=Aa(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Ea(this),this.iHash.update(e),this}digestInto(e){Ea(this),yu(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const oh=(r,e,t)=>new e1(r,e).update(t).digest();oh.create=(r,e)=>new e1(r,e);function UD(r,e,t){return Sp(r),t===void 0&&(t=new Uint8Array(r.outputLen)),oh(r,Aa(t),Aa(e))}const Yh=new Uint8Array([0]),ky=new Uint8Array;function LD(r,e,t,n=32){if(Sp(r),Pc(n),n>255*r.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/r.outputLen);t===void 0&&(t=ky);const i=new Uint8Array(s*r.outputLen),o=oh.create(r,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let u=0;u<s;u++)Yh[0]=u+1,a.update(u===0?ky:c).update(t).update(Yh).digestInto(c),i.set(c,r.outputLen*u),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Yh.fill(0),i.slice(0,n)}const MD=(r,e,t,n,s)=>LD(r,UD(r,e,t),n,s);function jD(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,u=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+u,a,n)}function HD(r,e,t){return r&e^~r&t}function zD(r,e,t){return r&e^r&t^e&t}let qD=class extends Dp{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Wh(this.buffer)}update(e){Ea(this);const{view:t,buffer:n,blockLen:s}=this;e=Aa(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Wh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ea(this),jb(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;jD(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Wh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,l[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const VD=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Wn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Jn=new Uint32Array(64);class GD extends qD{constructor(){super(64,32,8,!1),this.A=Wn[0]|0,this.B=Wn[1]|0,this.C=Wn[2]|0,this.D=Wn[3]|0,this.E=Wn[4]|0,this.F=Wn[5]|0,this.G=Wn[6]|0,this.H=Wn[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Jn[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const f=Jn[h-15],d=Jn[h-2],p=jr(f,7)^jr(f,18)^f>>>3,g=jr(d,17)^jr(d,19)^d>>>10;Jn[h]=g+Jn[h-7]+p+Jn[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let h=0;h<64;h++){const f=jr(a,6)^jr(a,11)^jr(a,25),d=l+f+HD(a,c,u)+VD[h]+Jn[h]|0,p=(jr(n,2)^jr(n,13)^jr(n,22))+zD(n,s,i)|0;l=u,u=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,s,i,o,a,c,u,l)}roundClean(){Jn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const mu=Hb(()=>new GD);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ah=BigInt(0),ch=BigInt(1),KD=BigInt(2);function Oi(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function wu(r){if(!Oi(r))throw new Error("Uint8Array expected")}function Pa(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const QD=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function xa(r){wu(r);let e="";for(let t=0;t<r.length;t++)e+=QD[r[t]];return e}function mo(r){const e=r.toString(16);return e.length&1?"0"+e:e}function _p(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?ah:BigInt("0x"+r)}const pn={_0:48,_9:57,A:65,F:70,a:97,f:102};function Uy(r){if(r>=pn._0&&r<=pn._9)return r-pn._0;if(r>=pn.A&&r<=pn.F)return r-(pn.A-10);if(r>=pn.a&&r<=pn.f)return r-(pn.a-10)}function Oa(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=Uy(r.charCodeAt(i)),a=Uy(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function vi(r){return _p(xa(r))}function Oc(r){return wu(r),_p(xa(Uint8Array.from(r).reverse()))}function Sa(r,e){return Oa(r.toString(16).padStart(e*2,"0"))}function uh(r,e){return Sa(r,e).reverse()}function WD(r){return Oa(mo(r))}function Xt(r,e,t){let n;if(typeof e=="string")try{n=Oa(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Oi(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Sc(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];wu(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}function JD(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function YD(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const Zh=r=>typeof r=="bigint"&&ah<=r;function lh(r,e,t){return Zh(r)&&Zh(e)&&Zh(t)&&e<=r&&r<t}function Mn(r,e,t,n){if(!lh(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function t1(r){let e;for(e=0;r>ah;r>>=ch,e+=1);return e}function ZD(r,e){return r>>BigInt(e)&ch}function XD(r,e,t){return r|(t?ch:ah)<<BigInt(e)}const Np=r=>(KD<<BigInt(r-1))-ch,Xh=r=>new Uint8Array(r),Ly=r=>Uint8Array.from(r);function r1(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Xh(r),s=Xh(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...l)=>t(s,n,...l),c=(l=Xh())=>{s=a(Ly([0]),l),n=a(),l.length!==0&&(s=a(Ly([1]),l),n=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const h=[];for(;l<e;){n=a();const f=n.slice();h.push(f),l+=n.length}return Sc(...h)};return(l,h)=>{o(),c(l);let f;for(;!(f=h(u()));)c();return o(),f}}const eC={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Oi(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function ja(r,e,t={}){const n=(s,i,o)=>{const a=eC[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const tC=()=>{throw new Error("not implemented")};function sd(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}var rC=Object.freeze({__proto__:null,isBytes:Oi,abytes:wu,abool:Pa,bytesToHex:xa,numberToHexUnpadded:mo,hexToNumber:_p,hexToBytes:Oa,bytesToNumberBE:vi,bytesToNumberLE:Oc,numberToBytesBE:Sa,numberToBytesLE:uh,numberToVarBytesBE:WD,ensureBytes:Xt,concatBytes:Sc,equalBytes:JD,utf8ToBytes:YD,inRange:lh,aInRange:Mn,bitLen:t1,bitGet:ZD,bitSet:XD,bitMask:Np,createHmacDrbg:r1,validateObject:ja,notImplemented:tC,memoized:sd});const rt=BigInt(0),ke=BigInt(1),Ls=BigInt(2),nC=BigInt(3),id=BigInt(4),My=BigInt(5),jy=BigInt(8);function Ut(r,e){const t=r%e;return t>=rt?t:e+t}function n1(r,e,t){if(e<rt)throw new Error("invalid exponent, negatives unsupported");if(t<=rt)throw new Error("invalid modulus");if(t===ke)return rt;let n=ke;for(;e>rt;)e&ke&&(n=n*r%t),r=r*r%t,e>>=ke;return n}function Ir(r,e,t){let n=r;for(;e-- >rt;)n*=n,n%=t;return n}function od(r,e){if(r===rt)throw new Error("invert: expected non-zero number");if(e<=rt)throw new Error("invert: expected positive modulus, got "+e);let t=Ut(r,e),n=e,s=rt,i=ke;for(;t!==rt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==ke)throw new Error("invert: does not exist");return Ut(s,e)}function sC(r){const e=(r-ke)/Ls;let t,n,s;for(t=r-ke,n=0;t%Ls===rt;t/=Ls,n++);for(s=Ls;s<r&&n1(s,e,r)!==r-ke;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+ke)/id;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(t+ke)/Ls;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,s),t),l=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let f=1;for(let p=o.sqr(h);f<c&&!o.eql(p,o.ONE);f++)p=o.sqr(p);const d=o.pow(u,ke<<BigInt(c-f-1));u=o.sqr(d),l=o.mul(l,d),h=o.mul(h,u),c=f}return l}}function iC(r){if(r%id===nC){const e=(r+ke)/id;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%jy===My){const e=(r-My)/jy;return function(t,n){const s=t.mul(n,Ls),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,Ls),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return sC(r)}const oC=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function aC(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=oC.reduce((n,s)=>(n[s]="function",n),e);return ja(r,t)}function cC(r,e,t){if(t<rt)throw new Error("invalid exponent, negatives unsupported");if(t===rt)return r.ONE;if(t===ke)return e;let n=r.ONE,s=e;for(;t>rt;)t&ke&&(n=r.mul(n,s)),s=r.sqr(s),t>>=ke;return n}function uC(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function s1(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function i1(r,e,t=!1,n={}){if(r<=rt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=s1(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:Np(s),ZERO:rt,ONE:ke,create:c=>Ut(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return rt<=c&&c<r},is0:c=>c===rt,isOdd:c=>(c&ke)===ke,neg:c=>Ut(-c,r),eql:(c,u)=>c===u,sqr:c=>Ut(c*c,r),add:(c,u)=>Ut(c+u,r),sub:(c,u)=>Ut(c-u,r),mul:(c,u)=>Ut(c*u,r),pow:(c,u)=>cC(a,c,u),div:(c,u)=>Ut(c*od(u,r),r),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>od(c,r),sqrt:n.sqrt||(c=>(o||(o=iC(r)),o(a,c))),invertBatch:c=>uC(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>t?uh(c,i):Sa(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?Oc(c):vi(c)}});return Object.freeze(a)}function o1(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function a1(r){const e=o1(r);return e+Math.ceil(e/2)}function lC(r,e,t=!1){const n=r.length,s=o1(e),i=a1(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?Oc(r):vi(r),a=Ut(o,e-ke)+ke;return t?uh(a,s):Sa(a,s)}const Hy=BigInt(0),Uu=BigInt(1);function ef(r,e){const t=e.negate();return r?t:e}function c1(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function tf(r,e){c1(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function hC(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function fC(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const rf=new WeakMap,u1=new WeakMap;function nf(r){return u1.get(r)||1}function dC(r,e){return{constTimeNegate:ef,hasPrecomputes(t){return nf(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>Hy;)n&Uu&&(s=s.add(i)),i=i.double(),n>>=Uu;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=tf(n,e),o=[];let a=t,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=tf(t,e);let a=r.ZERO,c=r.BASE;const u=BigInt(2**t-1),l=2**t,h=BigInt(t);for(let f=0;f<i;f++){const d=f*o;let p=Number(s&u);s>>=h,p>o&&(p-=l,s+=Uu);const g=d,m=d+Math.abs(p)-1,b=f%2!==0,E=p<0;p===0?c=c.add(ef(b,n[g])):a=a.add(ef(E,n[m]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=tf(t,e),c=BigInt(2**t-1),u=2**t,l=BigInt(t);for(let h=0;h<o;h++){const f=h*a;if(s===Hy)break;let d=Number(s&c);if(s>>=l,d>a&&(d-=u,s+=Uu),d===0)continue;let p=n[f+Math.abs(d)-1];d<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(t,n,s){let i=rf.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&rf.set(n,s(i))),i},wNAFCached(t,n,s){const i=nf(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=nf(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){c1(n,e),u1.set(t,n),rf.delete(t)}}}function pC(r,e,t,n){if(hC(t,r),fC(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=t1(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let h=u;h>=0;h-=o){c.fill(s);for(let d=0;d<n.length;d++){const p=n[d],g=Number(p>>BigInt(h)&BigInt(a));c[g]=c[g].add(t[d])}let f=s;for(let d=c.length-1,p=s;d>0;d--)p=p.add(c[d]),f=f.add(p);if(l=l.add(f),h!==0)for(let d=0;d<o;d++)l=l.double()}return l}function l1(r){return aC(r.Fp),ja(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...s1(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const qi=BigInt(0),sf=BigInt(1);function gC(r){return ja(r,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r})}function yC(r){const e=gC(r),{P:t}=e,n=E=>Ut(E,t),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(E=>E),c=e.powPminus2||(E=>n1(E,t-BigInt(2),t));function u(E,A,x){const D=n(E*(A-x));return A=n(A-D),x=n(x+D),[A,x]}const l=(e.a-BigInt(2))/BigInt(4);function h(E,A){Mn("u",E,qi,t),Mn("scalar",A,qi,t);const x=A,D=E;let S=sf,_=qi,N=E,T=sf,z=qi,U;for(let W=BigInt(s-1);W>=qi;W--){const k=x>>W&sf;z^=k,U=u(z,S,N),S=U[0],N=U[1],U=u(z,_,T),_=U[0],T=U[1],z=k;const w=S+_,v=n(w*w),P=S-_,R=n(P*P),C=v-R,$=N+T,q=N-T,G=n(q*w),Y=n($*P),Q=G+Y,ee=G-Y;N=n(Q*Q),T=n(D*n(ee*ee)),S=n(v*R),_=n(C*(v+n(l*C)))}U=u(z,S,N),S=U[0],N=U[1],U=u(z,_,T),_=U[0],T=U[1];const H=c(_);return n(S*H)}function f(E){return uh(n(E),i)}function d(E){const A=Xt("u coordinate",E,i);return o===32&&(A[31]&=127),Oc(A)}function p(E){const A=Xt("scalar",E),x=A.length;if(x!==i&&x!==o){let D=""+i+" or "+o;throw new Error("invalid scalar, expected "+D+" bytes, got "+x)}return Oc(a(A))}function g(E,A){const x=d(A),D=p(E),S=h(x,D);if(S===qi)throw new Error("invalid private or public key received");return f(S)}const m=f(e.Gu);function b(E){return g(E,m)}return{scalarMult:g,scalarMultBase:b,getSharedSecret:(E,A)=>g(E,A),getPublicKey:E=>b(E),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:m}}const ad=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const mC=BigInt(1),zy=BigInt(2),wC=BigInt(3),bC=BigInt(5);BigInt(8);function vC(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=ad,o=r*r%i*r%i,a=Ir(o,zy,i)*o%i,c=Ir(a,mC,i)*r%i,u=Ir(c,bC,i)*c%i,l=Ir(u,e,i)*u%i,h=Ir(l,t,i)*l%i,f=Ir(h,n,i)*h%i,d=Ir(f,s,i)*f%i,p=Ir(d,s,i)*f%i,g=Ir(p,e,i)*u%i;return{pow_p_5_8:Ir(g,zy,i)*r%i,b2:o}}function EC(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const cd=yC({P:ad,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:r=>{const e=ad,{pow_p_5_8:t,b2:n}=vC(r);return Ut(Ir(t,wC,e)*n,e)},adjustScalarBytes:EC,randomBytes:Ma});function qy(r){r.lowS!==void 0&&Pa("lowS",r.lowS),r.prehash!==void 0&&Pa("prehash",r.prehash)}function AC(r){const e=l1(r);ja(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:IC,hexToBytes:PC}=rC;class xC extends Error{constructor(e=""){super(e)}}const An={Err:xC,_tlv:{encode:(r,e)=>{const{Err:t}=An;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=mo(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?mo(s.length/2|128):"";return mo(r)+i+s+e},decode(r,e){const{Err:t}=An;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const u=e.subarray(n,n+c);if(u.length!==c)throw new t("tlv.decode: length bytes not complete");if(u[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=An;if(r<kn)throw new e("integer: negative integers are not allowed");let t=mo(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=An;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return IC(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=An,s=typeof r=="string"?PC(r):r;wu(s);const{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:u,l}=n.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(u)}},hexFromSig(r){const{_tlv:e,_int:t}=An,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}},kn=BigInt(0),Ze=BigInt(1);BigInt(2);const Vy=BigInt(3);BigInt(4);function OC(r){const e=AC(r),{Fp:t}=e,n=i1(e.n,e.nBitLength),s=e.toBytes||((g,m,b)=>{const E=m.toAffine();return Sc(Uint8Array.from([4]),t.toBytes(E.x),t.toBytes(E.y))}),i=e.fromBytes||(g=>{const m=g.subarray(1),b=t.fromBytes(m.subarray(0,t.BYTES)),E=t.fromBytes(m.subarray(t.BYTES,2*t.BYTES));return{x:b,y:E}});function o(g){const{a:m,b}=e,E=t.sqr(g),A=t.mul(E,g);return t.add(t.add(A,t.mul(g,m)),b)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return lh(g,Ze,e.n)}function c(g){const{allowedPrivateKeyLengths:m,nByteLength:b,wrapPrivateKey:E,n:A}=e;if(m&&typeof g!="bigint"){if(Oi(g)&&(g=xa(g)),typeof g!="string"||!m.includes(g.length))throw new Error("invalid private key");g=g.padStart(b*2,"0")}let x;try{x=typeof g=="bigint"?g:vi(Xt("private key",g,b))}catch{throw new Error("invalid private key, expected hex or "+b+" bytes, got "+typeof g)}return E&&(x=Ut(x,A)),Mn("private key",x,Ze,A),x}function u(g){if(!(g instanceof f))throw new Error("ProjectivePoint expected")}const l=sd((g,m)=>{const{px:b,py:E,pz:A}=g;if(t.eql(A,t.ONE))return{x:b,y:E};const x=g.is0();m==null&&(m=x?t.ONE:t.inv(A));const D=t.mul(b,m),S=t.mul(E,m),_=t.mul(A,m);if(x)return{x:t.ZERO,y:t.ZERO};if(!t.eql(_,t.ONE))throw new Error("invZ was invalid");return{x:D,y:S}}),h=sd(g=>{if(g.is0()){if(e.allowInfinityPoint&&!t.is0(g.py))return;throw new Error("bad point: ZERO")}const{x:m,y:b}=g.toAffine();if(!t.isValid(m)||!t.isValid(b))throw new Error("bad point: x or y not FE");const E=t.sqr(b),A=o(m);if(!t.eql(E,A))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class f{constructor(m,b,E){if(this.px=m,this.py=b,this.pz=E,m==null||!t.isValid(m))throw new Error("x required");if(b==null||!t.isValid(b))throw new Error("y required");if(E==null||!t.isValid(E))throw new Error("z required");Object.freeze(this)}static fromAffine(m){const{x:b,y:E}=m||{};if(!m||!t.isValid(b)||!t.isValid(E))throw new Error("invalid affine point");if(m instanceof f)throw new Error("projective point not allowed");const A=x=>t.eql(x,t.ZERO);return A(b)&&A(E)?f.ZERO:new f(b,E,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const b=t.invertBatch(m.map(E=>E.pz));return m.map((E,A)=>E.toAffine(b[A])).map(f.fromAffine)}static fromHex(m){const b=f.fromAffine(i(Xt("pointHex",m)));return b.assertValidity(),b}static fromPrivateKey(m){return f.BASE.multiply(c(m))}static msm(m,b){return pC(f,n,m,b)}_setWindowSize(m){p.setWindowSize(this,m)}assertValidity(){h(this)}hasEvenY(){const{y:m}=this.toAffine();if(t.isOdd)return!t.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){u(m);const{px:b,py:E,pz:A}=this,{px:x,py:D,pz:S}=m,_=t.eql(t.mul(b,S),t.mul(x,A)),N=t.eql(t.mul(E,S),t.mul(D,A));return _&&N}negate(){return new f(this.px,t.neg(this.py),this.pz)}double(){const{a:m,b}=e,E=t.mul(b,Vy),{px:A,py:x,pz:D}=this;let S=t.ZERO,_=t.ZERO,N=t.ZERO,T=t.mul(A,A),z=t.mul(x,x),U=t.mul(D,D),H=t.mul(A,x);return H=t.add(H,H),N=t.mul(A,D),N=t.add(N,N),S=t.mul(m,N),_=t.mul(E,U),_=t.add(S,_),S=t.sub(z,_),_=t.add(z,_),_=t.mul(S,_),S=t.mul(H,S),N=t.mul(E,N),U=t.mul(m,U),H=t.sub(T,U),H=t.mul(m,H),H=t.add(H,N),N=t.add(T,T),T=t.add(N,T),T=t.add(T,U),T=t.mul(T,H),_=t.add(_,T),U=t.mul(x,D),U=t.add(U,U),T=t.mul(U,H),S=t.sub(S,T),N=t.mul(U,z),N=t.add(N,N),N=t.add(N,N),new f(S,_,N)}add(m){u(m);const{px:b,py:E,pz:A}=this,{px:x,py:D,pz:S}=m;let _=t.ZERO,N=t.ZERO,T=t.ZERO;const z=e.a,U=t.mul(e.b,Vy);let H=t.mul(b,x),W=t.mul(E,D),k=t.mul(A,S),w=t.add(b,E),v=t.add(x,D);w=t.mul(w,v),v=t.add(H,W),w=t.sub(w,v),v=t.add(b,A);let P=t.add(x,S);return v=t.mul(v,P),P=t.add(H,k),v=t.sub(v,P),P=t.add(E,A),_=t.add(D,S),P=t.mul(P,_),_=t.add(W,k),P=t.sub(P,_),T=t.mul(z,v),_=t.mul(U,k),T=t.add(_,T),_=t.sub(W,T),T=t.add(W,T),N=t.mul(_,T),W=t.add(H,H),W=t.add(W,H),k=t.mul(z,k),v=t.mul(U,v),W=t.add(W,k),k=t.sub(H,k),k=t.mul(z,k),v=t.add(v,k),H=t.mul(W,v),N=t.add(N,H),H=t.mul(P,v),_=t.mul(w,_),_=t.sub(_,H),H=t.mul(w,W),T=t.mul(P,T),T=t.add(T,H),new f(_,N,T)}subtract(m){return this.add(m.negate())}is0(){return this.equals(f.ZERO)}wNAF(m){return p.wNAFCached(this,m,f.normalizeZ)}multiplyUnsafe(m){const{endo:b,n:E}=e;Mn("scalar",m,kn,E);const A=f.ZERO;if(m===kn)return A;if(this.is0()||m===Ze)return this;if(!b||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,m,f.normalizeZ);let{k1neg:x,k1:D,k2neg:S,k2:_}=b.splitScalar(m),N=A,T=A,z=this;for(;D>kn||_>kn;)D&Ze&&(N=N.add(z)),_&Ze&&(T=T.add(z)),z=z.double(),D>>=Ze,_>>=Ze;return x&&(N=N.negate()),S&&(T=T.negate()),T=new f(t.mul(T.px,b.beta),T.py,T.pz),N.add(T)}multiply(m){const{endo:b,n:E}=e;Mn("scalar",m,Ze,E);let A,x;if(b){const{k1neg:D,k1:S,k2neg:_,k2:N}=b.splitScalar(m);let{p:T,f:z}=this.wNAF(S),{p:U,f:H}=this.wNAF(N);T=p.constTimeNegate(D,T),U=p.constTimeNegate(_,U),U=new f(t.mul(U.px,b.beta),U.py,U.pz),A=T.add(U),x=z.add(H)}else{const{p:D,f:S}=this.wNAF(m);A=D,x=S}return f.normalizeZ([A,x])[0]}multiplyAndAddUnsafe(m,b,E){const A=f.BASE,x=(S,_)=>_===kn||_===Ze||!S.equals(A)?S.multiplyUnsafe(_):S.multiply(_),D=x(this,b).add(x(m,E));return D.is0()?void 0:D}toAffine(m){return l(this,m)}isTorsionFree(){const{h:m,isTorsionFree:b}=e;if(m===Ze)return!0;if(b)return b(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:b}=e;return m===Ze?this:b?b(f,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return Pa("isCompressed",m),this.assertValidity(),s(f,this,m)}toHex(m=!0){return Pa("isCompressed",m),xa(this.toRawBytes(m))}}f.BASE=new f(e.Gx,e.Gy,t.ONE),f.ZERO=new f(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,p=dC(f,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function SC(r){const e=l1(r);return ja(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function DC(r){const e=SC(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(k){return Ut(k,n)}function a(k){return od(k,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=OC({...e,toBytes(k,w,v){const P=w.toAffine(),R=t.toBytes(P.x),C=Sc;return Pa("isCompressed",v),v?C(Uint8Array.from([w.hasEvenY()?2:3]),R):C(Uint8Array.from([4]),R,t.toBytes(P.y))},fromBytes(k){const w=k.length,v=k[0],P=k.subarray(1);if(w===s&&(v===2||v===3)){const R=vi(P);if(!lh(R,Ze,t.ORDER))throw new Error("Point is not on curve");const C=l(R);let $;try{$=t.sqrt(C)}catch(G){const Y=G instanceof Error?": "+G.message:"";throw new Error("Point is not on curve"+Y)}const q=($&Ze)===Ze;return(v&1)===1!==q&&($=t.neg($)),{x:R,y:$}}else if(w===i&&v===4){const R=t.fromBytes(P.subarray(0,t.BYTES)),C=t.fromBytes(P.subarray(t.BYTES,2*t.BYTES));return{x:R,y:C}}else{const R=s,C=i;throw new Error("invalid Point, expected length of "+R+", or uncompressed "+C+", got "+w)}}}),f=k=>xa(Sa(k,e.nByteLength));function d(k){const w=n>>Ze;return k>w}function p(k){return d(k)?o(-k):k}const g=(k,w,v)=>vi(k.slice(w,v));class m{constructor(w,v,P){this.r=w,this.s=v,this.recovery=P,this.assertValidity()}static fromCompact(w){const v=e.nByteLength;return w=Xt("compactSignature",w,v*2),new m(g(w,0,v),g(w,v,2*v))}static fromDER(w){const{r:v,s:P}=An.toSig(Xt("DER",w));return new m(v,P)}assertValidity(){Mn("r",this.r,Ze,n),Mn("s",this.s,Ze,n)}addRecoveryBit(w){return new m(this.r,this.s,w)}recoverPublicKey(w){const{r:v,s:P,recovery:R}=this,C=S(Xt("msgHash",w));if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");const $=R===2||R===3?v+e.n:v;if($>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const q=R&1?"03":"02",G=c.fromHex(q+f($)),Y=a($),Q=o(-C*Y),ee=o(P*Y),oe=c.BASE.multiplyAndAddUnsafe(G,Q,ee);if(!oe)throw new Error("point at infinify");return oe.assertValidity(),oe}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Oa(this.toDERHex())}toDERHex(){return An.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Oa(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const b={isValidPrivateKey(k){try{return u(k),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const k=a1(e.n);return lC(e.randomBytes(k),e.n)},precompute(k=8,w=c.BASE){return w._setWindowSize(k),w.multiply(BigInt(3)),w}};function E(k,w=!0){return c.fromPrivateKey(k).toRawBytes(w)}function A(k){const w=Oi(k),v=typeof k=="string",P=(w||v)&&k.length;return w?P===s||P===i:v?P===2*s||P===2*i:k instanceof c}function x(k,w,v=!0){if(A(k))throw new Error("first arg must be private key");if(!A(w))throw new Error("second arg must be public key");return c.fromHex(w).multiply(u(k)).toRawBytes(v)}const D=e.bits2int||function(k){if(k.length>8192)throw new Error("input is too large");const w=vi(k),v=k.length*8-e.nBitLength;return v>0?w>>BigInt(v):w},S=e.bits2int_modN||function(k){return o(D(k))},_=Np(e.nBitLength);function N(k){return Mn("num < 2^"+e.nBitLength,k,kn,_),Sa(k,e.nByteLength)}function T(k,w,v=z){if(["recovered","canonical"].some(fe=>fe in v))throw new Error("sign() legacy options not supported");const{hash:P,randomBytes:R}=e;let{lowS:C,prehash:$,extraEntropy:q}=v;C==null&&(C=!0),k=Xt("msgHash",k),qy(v),$&&(k=Xt("prehashed msgHash",P(k)));const G=S(k),Y=u(w),Q=[N(Y),N(G)];if(q!=null&&q!==!1){const fe=q===!0?R(t.BYTES):q;Q.push(Xt("extraEntropy",fe))}const ee=Sc(...Q),oe=G;function ae(fe){const re=D(fe);if(!h(re))return;const _e=a(re),je=c.BASE.multiply(re).toAffine(),Te=o(je.x);if(Te===kn)return;const Ce=o(_e*o(oe+Te*Y));if(Ce===kn)return;let Ve=(je.x===Te?0:2)|Number(je.y&Ze),ln=Ce;return C&&d(Ce)&&(ln=p(Ce),Ve^=1),new m(Te,ln,Ve)}return{seed:ee,k2sig:ae}}const z={lowS:e.lowS,prehash:!1},U={lowS:e.lowS,prehash:!1};function H(k,w,v=z){const{seed:P,k2sig:R}=T(k,w,v),C=e;return r1(C.hash.outputLen,C.nByteLength,C.hmac)(P,R)}c.BASE._setWindowSize(8);function W(k,w,v,P=U){var Ce;const R=k;w=Xt("msgHash",w),v=Xt("publicKey",v);const{lowS:C,prehash:$,format:q}=P;if(qy(P),"strict"in P)throw new Error("options.strict was renamed to lowS");if(q!==void 0&&q!=="compact"&&q!=="der")throw new Error("format must be compact or der");const G=typeof R=="string"||Oi(R),Y=!G&&!q&&typeof R=="object"&&R!==null&&typeof R.r=="bigint"&&typeof R.s=="bigint";if(!G&&!Y)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Q,ee;try{if(Y&&(Q=new m(R.r,R.s)),G){try{q!=="compact"&&(Q=m.fromDER(R))}catch(Ve){if(!(Ve instanceof An.Err))throw Ve}!Q&&q!=="der"&&(Q=m.fromCompact(R))}ee=c.fromHex(v)}catch{return!1}if(!Q||C&&Q.hasHighS())return!1;$&&(w=e.hash(w));const{r:oe,s:ae}=Q,fe=S(w),re=a(ae),_e=o(fe*re),je=o(oe*re),Te=(Ce=c.BASE.multiplyAndAddUnsafe(ee,_e,je))==null?void 0:Ce.toAffine();return Te?o(Te.x)===oe:!1}return{CURVE:e,getPublicKey:E,getSharedSecret:x,sign:H,verify:W,ProjectivePoint:c,Signature:m,utils:b}}function CC(r){return{hash:r,hmac:(e,...t)=>oh(r,e,RS(...t)),randomBytes:Ma}}function _C(r,e){const t=n=>DC({...r,...CC(n)});return{...t(e),create:t}}const h1=i1(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),NC=h1.create(BigInt("-3")),TC=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),RC=_C({a:NC,b:TC,Fp:h1,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},mu),f1="base10",_t="base16",Br="base64pad",ss="base64url",bu="utf8",d1=0,jn=1,vu=2,BC=0,Gy=1,yc=12,Tp=32;function FC(){const r=cd.utils.randomPrivateKey(),e=cd.getPublicKey(r);return{privateKey:jt(r,_t),publicKey:jt(e,_t)}}function ud(){const r=Ma(Tp);return jt(r,_t)}function $C(r,e){const t=cd.getSharedSecret(yr(r,_t),yr(e,_t)),n=MD(mu,t,void 0,void 0,Tp);return jt(n,_t)}function al(r){const e=mu(yr(r,_t));return jt(e,_t)}function nn(r){const e=mu(yr(r,bu));return jt(e,_t)}function p1(r){return yr(`${r}`,f1)}function Si(r){return Number(jt(r,f1))}function g1(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function y1(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function kC(r){const e=p1(typeof r.type<"u"?r.type:d1);if(Si(e)===jn&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?yr(r.senderPublicKey,_t):void 0,n=typeof r.iv<"u"?yr(r.iv,_t):Ma(yc),s=yr(r.symKey,_t),i=Xb(s,n).encrypt(yr(r.message,bu)),o=m1({type:e,sealed:i,iv:n,senderPublicKey:t});return r.encoding===ss?g1(o):o}function UC(r){const e=yr(r.symKey,_t),{sealed:t,iv:n}=Dc({encoded:r.encoded,encoding:r.encoding}),s=Xb(e,n).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return jt(s,bu)}function LC(r,e){const t=p1(vu),n=Ma(yc),s=yr(r,bu),i=m1({type:t,sealed:s,iv:n});return e===ss?g1(i):i}function MC(r,e){const{sealed:t}=Dc({encoded:r,encoding:e});return jt(t,bu)}function m1(r){if(Si(r.type)===vu)return jt(gc([r.type,r.sealed]),Br);if(Si(r.type)===jn){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return jt(gc([r.type,r.senderPublicKey,r.iv,r.sealed]),Br)}return jt(gc([r.type,r.iv,r.sealed]),Br)}function Dc(r){const e=(r.encoding||Br)===ss?y1(r.encoded):r.encoded,t=yr(e,Br),n=t.slice(BC,Gy),s=Gy;if(Si(n)===jn){const c=s+Tp,u=c+yc,l=t.slice(s,c),h=t.slice(c,u),f=t.slice(u);return{type:n,sealed:f,iv:h,senderPublicKey:l}}if(Si(n)===vu){const c=t.slice(s),u=Ma(yc);return{type:n,sealed:c,iv:u}}const i=s+yc,o=t.slice(s,i),a=t.slice(i);return{type:n,sealed:a,iv:o}}function jC(r,e){const t=Dc({encoded:r,encoding:e==null?void 0:e.encoding});return w1({type:Si(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?jt(t.senderPublicKey,_t):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function w1(r){const e=(r==null?void 0:r.type)||d1;if(e===jn){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Ky(r){return r.type===jn&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function Qy(r){return r.type===vu}function HC(r){const e=Buffer.from(r.x,"base64"),t=Buffer.from(r.y,"base64");return gc([new Uint8Array([4]),e,t])}function zC(r,e){const[t,n,s]=r.split("."),i=Buffer.from(y1(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${n}`,u=mu(c),l=HC(e);if(!RC.verify(gc([o,a]),u,l))throw new Error("Invalid signature");return Yf(r).payload}const qC="irn";function Sl(r){return(r==null?void 0:r.relay)||{protocol:qC}}function oc(r){const e=JO[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}function VC(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=r[s];t[i]=o}}),t}function Wy(r){if(!r.includes("wc:")){const u=Mb(r);u!=null&&u.includes("wc:")&&(r=u)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),s=r.substring(e+1,t).split("@"),i=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(i),a={};o.forEach((u,l)=>{a[l]=u});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:GC(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:VC(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function GC(r){return r.startsWith("//")?r.substring(2):r}function KC(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(s=>{const i=s,o=t+e+i;r[i]&&(n[o]=r[i])}),n}function Jy(r){const e=new URLSearchParams,t=KC(r.relay);Object.keys(t).sort().forEach(s=>{e.set(s,t[s])}),e.set("symKey",r.symKey),r.expiryTimestamp&&e.set("expiryTimestamp",r.expiryTimestamp.toString()),r.methods&&e.set("methods",r.methods.join(","));const n=e.toString();return`${r.protocol}:${r.topic}@${r.version}?${n}`}function Lu(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function Ha(r){const e=[];return r.forEach(t=>{const[n,s]=t.split(":");e.push(`${n}:${s}`)}),e}function QC(r){const e=[];return Object.values(r).forEach(t=>{e.push(...Ha(t.accounts))}),e}function WC(r,e){const t=[];return Object.values(r).forEach(n=>{Ha(n.accounts).includes(e)&&t.push(...n.methods)}),t}function JC(r,e){const t=[];return Object.values(r).forEach(n=>{Ha(n.accounts).includes(e)&&t.push(...n.events)}),t}function Rp(r){return r.includes(":")}function ac(r){return Rp(r)?r.split(":")[0]:r}function YC(r){const e={};return r==null||r.forEach(t=>{var n;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function Yy(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=YC(e);for(const[n,s]of Object.entries(t))s.methods?s.methods=il(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}const ZC={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},XC={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function K(r,e){const{message:t,code:n}=XC[r];return{message:e?`${t} ${e}`:t,code:n}}function we(r,e){const{message:t,code:n}=ZC[r];return{message:e?`${t} ${e}`:t,code:n}}function Fr(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function Cc(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function ct(r){return typeof r>"u"}function ze(r,e){return e&&ct(r)?!0:typeof r=="string"&&!!r.trim().length}function Bp(r,e){return e&&ct(r)?!0:typeof r=="number"&&!isNaN(r)}function e_(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),s=Object.keys(t);let i=!0;return Gs(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:u}=r.namespaces[o],l=Ha(a),h=t[o];(!Gs(Fb(o,h),l)||!Gs(h.methods,c)||!Gs(h.events,u))&&(i=!1)}),i):!1}function Dl(r){return ze(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function t_(r){if(ze(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Dl(t)}}return!1}function r_(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(ze(r,!1)){if(e(r))return!0;const t=Mb(r);return e(t)}}catch{}return!1}function n_(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function s_(r){return r==null?void 0:r.topic}function i_(r,e){let t=null;return ze(r==null?void 0:r.publicKey,!1)||(t=K("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Zy(r){let e=!0;return Fr(r)?r.length&&(e=r.every(t=>ze(t,!1))):e=!1,e}function o_(r,e,t){let n=null;return Fr(e)&&e.length?e.forEach(s=>{n||Dl(s)||(n=we("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Dl(r)||(n=we("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function a_(r,e,t){let n=null;return Object.entries(r).forEach(([s,i])=>{if(n)return;const o=o_(s,Fb(s,i),`${e} ${t}`);o&&(n=o)}),n}function c_(r,e){let t=null;return Fr(r)?r.forEach(n=>{t||t_(n)||(t=we("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=we("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function u_(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=c_(n==null?void 0:n.accounts,`${e} namespace`);s&&(t=s)}),t}function l_(r,e){let t=null;return Zy(r==null?void 0:r.methods)?Zy(r==null?void 0:r.events)||(t=we("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=we("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function b1(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=l_(n,`${e}, namespace`);s&&(t=s)}),t}function h_(r,e,t){let n=null;if(r&&Cc(r)){const s=b1(r,e);s&&(n=s);const i=a_(r,e,t);i&&(n=i)}else n=K("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function of(r,e){let t=null;if(r&&Cc(r)){const n=b1(r,e);n&&(t=n);const s=u_(r,e);s&&(t=s)}else t=K("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function v1(r){return ze(r.protocol,!0)}function f_(r,e){let t=!1;return e&&!r?t=!0:r&&Fr(r)&&r.length&&r.forEach(n=>{t=v1(n)}),t}function d_(r){return typeof r=="number"}function Ft(r){return typeof r<"u"&&typeof r!==null}function p_(r){return!(!r||typeof r!="object"||!r.code||!Bp(r.code,!1)||!r.message||!ze(r.message,!1))}function g_(r){return!(ct(r)||!ze(r.method,!1))}function y_(r){return!(ct(r)||ct(r.result)&&ct(r.error)||!Bp(r.id,!1)||!ze(r.jsonrpc,!1))}function m_(r){return!(ct(r)||!ze(r.name,!1))}function Xy(r,e){return!(!Dl(e)||!QC(r).includes(e))}function w_(r,e,t){return ze(t,!1)?WC(r,e).includes(t):!1}function b_(r,e,t){return ze(t,!1)?JC(r,e).includes(t):!1}function em(r,e,t){let n=null;const s=v_(r),i=E_(e),o=Object.keys(s),a=Object.keys(i),c=tm(Object.keys(r)),u=tm(Object.keys(e)),l=c.filter(h=>!u.includes(h));return l.length&&(n=K("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${l.toString()}
      Received: ${Object.keys(e).toString()}`)),Gs(o,a)||(n=K("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||n)return;const f=Ha(e[h].accounts);f.includes(h)||(n=K("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${f.toString()}`))}),o.forEach(h=>{n||(Gs(s[h].methods,i[h].methods)?Gs(s[h].events,i[h].events)||(n=K("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${h}`)):n=K("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${h}`))}),n}function v_(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function tm(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function E_(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=Ha(r[t].accounts);n==null||n.forEach(s=>{e[s]={accounts:r[t].accounts.filter(i=>i.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function A_(r,e){return Bp(r,!1)&&r<=e.max&&r>=e.min}function rm(){const r=gu();return new Promise(e=>{switch(r){case tr.browser:e(I_());break;case tr.reactNative:e(P_());break;case tr.node:e(x_());break;default:e(!0)}})}function I_(){return pu()&&(navigator==null?void 0:navigator.onLine)}async function P_(){if(Ds()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function x_(){return!0}function O_(r){switch(gu()){case tr.browser:S_(r);break;case tr.reactNative:D_(r);break}}function S_(r){!Ds()&&pu()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function D_(r){Ds()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const af={};class Za{static get(e){return af[e]}static set(e,t){af[e]=t}static delete(e){delete af[e]}}class Fi{}let C_=class extends Fi{constructor(e){super()}};const nm=V.FIVE_SECONDS,za={pulse:"heartbeat_pulse"};let __=class E1 extends C_{constructor(e){super(e),this.events=new nr.EventEmitter,this.interval=nm,this.interval=(e==null?void 0:e.interval)||nm}static async init(e){const t=new E1(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),V.toMiliseconds(this.interval))}pulse(){this.events.emit(za.pulse)}};const N_=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,T_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,R_=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function B_(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){F_(r);return}return e}function F_(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function Mu(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!R_.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(N_.test(r)||T_.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,B_)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function $_(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function Je(r,...e){try{return $_(r(...e))}catch(t){return Promise.reject(t)}}function k_(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function U_(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function cl(r){if(k_(r))return String(r);if(U_(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return cl(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const ld="base64:";function L_(r){return typeof r=="string"?r:ld+H_(r)}function M_(r){return typeof r!="string"||!r.startsWith(ld)?r:j_(r.slice(ld.length))}function j_(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function H_(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Bt(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function z_(...r){return Bt(r.join(":"))}function ju(r){return r=Bt(r),r?r+":":""}function q_(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function V_(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const G_="memory",K_=()=>{const r=new Map;return{name:G_,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function Q_(r={}){const e={mounts:{"":r.driver||K_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=u=>{for(const l of e.mountpoints)if(u.startsWith(l))return{base:l,relativeKey:u.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:u,driver:e.mounts[""]}},n=(u,l)=>e.mountpoints.filter(h=>h.startsWith(u)||l&&u.startsWith(h)).map(h=>({relativeBase:u.length>h.length?u.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(u,l)=>{if(e.watching){l=Bt(l);for(const h of e.watchListeners)h(u,l)}},i=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await sm(e.mounts[u],s,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,l,h)=>{const f=new Map,d=p=>{let g=f.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},f.set(p.base,g)),g};for(const p of u){const g=typeof p=="string",m=Bt(g?p:p.key),b=g?void 0:p.value,E=g||!p.options?l:{...l,...p.options},A=t(m);d(A).items.push({key:m,value:b,relativeKey:A.relativeKey,options:E})}return Promise.all([...f.values()].map(p=>h(p))).then(p=>p.flat())},c={hasItem(u,l={}){u=Bt(u);const{relativeKey:h,driver:f}=t(u);return Je(f.hasItem,h,l)},getItem(u,l={}){u=Bt(u);const{relativeKey:h,driver:f}=t(u);return Je(f.getItem,h,l).then(d=>Mu(d))},getItems(u,l={}){return a(u,l,h=>h.driver.getItems?Je(h.driver.getItems,h.items.map(f=>({key:f.relativeKey,options:f.options})),l).then(f=>f.map(d=>({key:z_(h.base,d.key),value:Mu(d.value)}))):Promise.all(h.items.map(f=>Je(h.driver.getItem,f.relativeKey,f.options).then(d=>({key:f.key,value:Mu(d)})))))},getItemRaw(u,l={}){u=Bt(u);const{relativeKey:h,driver:f}=t(u);return f.getItemRaw?Je(f.getItemRaw,h,l):Je(f.getItem,h,l).then(d=>M_(d))},async setItem(u,l,h={}){if(l===void 0)return c.removeItem(u);u=Bt(u);const{relativeKey:f,driver:d}=t(u);d.setItem&&(await Je(d.setItem,f,cl(l),h),d.watch||s("update",u))},async setItems(u,l){await a(u,l,async h=>{if(h.driver.setItems)return Je(h.driver.setItems,h.items.map(f=>({key:f.relativeKey,value:cl(f.value),options:f.options})),l);h.driver.setItem&&await Promise.all(h.items.map(f=>Je(h.driver.setItem,f.relativeKey,cl(f.value),f.options)))})},async setItemRaw(u,l,h={}){if(l===void 0)return c.removeItem(u,h);u=Bt(u);const{relativeKey:f,driver:d}=t(u);if(d.setItemRaw)await Je(d.setItemRaw,f,l,h);else if(d.setItem)await Je(d.setItem,f,L_(l),h);else return;d.watch||s("update",u)},async removeItem(u,l={}){typeof l=="boolean"&&(l={removeMeta:l}),u=Bt(u);const{relativeKey:h,driver:f}=t(u);f.removeItem&&(await Je(f.removeItem,h,l),(l.removeMeta||l.removeMata)&&await Je(f.removeItem,h+"$",l),f.watch||s("remove",u))},async getMeta(u,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),u=Bt(u);const{relativeKey:h,driver:f}=t(u),d=Object.create(null);if(f.getMeta&&Object.assign(d,await Je(f.getMeta,h,l)),!l.nativeOnly){const p=await Je(f.getItem,h+"$",l).then(g=>Mu(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(d,p))}return d},setMeta(u,l,h={}){return this.setItem(u+"$",l,h)},removeMeta(u,l={}){return this.removeItem(u+"$",l)},async getKeys(u,l={}){var m;u=ju(u);const h=n(u,!0);let f=[];const d=[];let p=!0;for(const b of h){(m=b.driver.flags)!=null&&m.maxDepth||(p=!1);const E=await Je(b.driver.getKeys,b.relativeBase,l);for(const A of E){const x=b.mountpoint+Bt(A);f.some(D=>x.startsWith(D))||d.push(x)}f=[b.mountpoint,...f.filter(A=>!A.startsWith(b.mountpoint))]}const g=l.maxDepth!==void 0&&!p;return d.filter(b=>(!g||q_(b,l.maxDepth))&&V_(b,u))},async clear(u,l={}){u=ju(u),await Promise.all(n(u,!1).map(async h=>{if(h.driver.clear)return Je(h.driver.clear,h.relativeBase,l);if(h.driver.removeItem){const f=await h.driver.getKeys(h.relativeBase||"",l);return Promise.all(f.map(d=>h.driver.removeItem(d,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>im(u)))},async watch(u){return await i(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,l){if(u=ju(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((h,f)=>f.length-h.length)),e.mounts[u]=l,e.watching&&Promise.resolve(sm(l,s,u)).then(h=>{e.unwatch[u]=h}).catch(console.error),c},async unmount(u,l=!0){var h,f;u=ju(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&((f=(h=e.unwatch)[u])==null||f.call(h),delete e.unwatch[u]),l&&await im(e.mounts[u]),e.mountpoints=e.mountpoints.filter(d=>d!==u),delete e.mounts[u])},getMount(u=""){u=Bt(u)+":";const l=t(u);return{driver:l.driver,base:l.base}},getMounts(u="",l={}){return u=Bt(u),n(u,l.parents).map(f=>({driver:f.driver,base:f.mountpoint}))},keys:(u,l={})=>c.getKeys(u,l),get:(u,l={})=>c.getItem(u,l),set:(u,l,h={})=>c.setItem(u,l,h),has:(u,l={})=>c.hasItem(u,l),del:(u,l={})=>c.removeItem(u,l),remove:(u,l={})=>c.removeItem(u,l)};return c}function sm(r,e,t){return r.watch?r.watch((n,s)=>e(n,t+s)):()=>{}}async function im(r){typeof r.dispose=="function"&&await Je(r.dispose)}function $i(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function A1(r,e){const t=indexedDB.open(r);t.onupgradeneeded=()=>t.result.createObjectStore(e);const n=$i(t);return(s,i)=>n.then(o=>i(o.transaction(e,s).objectStore(e)))}let cf;function Eu(){return cf||(cf=A1("keyval-store","keyval")),cf}function om(r,e=Eu()){return e("readonly",t=>$i(t.get(r)))}function W_(r,e,t=Eu()){return t("readwrite",n=>(n.put(e,r),$i(n.transaction)))}function J_(r,e=Eu()){return e("readwrite",t=>(t.delete(r),$i(t.transaction)))}function Y_(r=Eu()){return r("readwrite",e=>(e.clear(),$i(e.transaction)))}function Z_(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},$i(r.transaction)}function X_(r=Eu()){return r("readonly",e=>{if(e.getAllKeys)return $i(e.getAllKeys());const t=[];return Z_(e,n=>t.push(n.key)).then(()=>t)})}const e3="idb-keyval";var t3=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let n;return r.dbName&&r.storeName&&(n=A1(r.dbName,r.storeName)),{name:e3,options:r,async hasItem(s){return!(typeof await om(t(s),n)>"u")},async getItem(s){return await om(t(s),n)??null},setItem(s,i){return W_(t(s),i,n)},removeItem(s){return J_(t(s),n)},getKeys(){return X_(n)},clear(){return Y_(n)}}};const r3="WALLET_CONNECT_V2_INDEXED_DB",n3="keyvaluestorage";let s3=class{constructor(){this.indexedDb=Q_({driver:t3({dbName:r3,storeName:n3})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,qn(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var uf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ul={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof uf<"u"&&uf.localStorage?ul.exports=uf.localStorage:typeof window<"u"&&window.localStorage?ul.exports=window.localStorage:ul.exports=new e})();function i3(r){var e;return[r[0],Pi((e=r[1])!=null?e:"")]}let o3=class{constructor(){this.localStorage=ul.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(i3)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Pi(t)}async setItem(e,t){this.localStorage.setItem(e,qn(t))}async removeItem(e){this.localStorage.removeItem(e)}};const a3="wc_storage_version",am=1,c3=async(r,e,t)=>{const n=a3,s=await e.getItem(n);if(s&&s>=am){t(e);return}const i=await r.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await r.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(n,am),t(e),u3(r,o)},u3=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let l3=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new o3;this.storage=e;try{const t=new s3;c3(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function h3(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var f3=d3;function d3(r,e,t){var n=t&&t.stringify||h3,s=1;if(typeof r=="object"&&r!==null){var i=e.length+s;if(i===1)return r;var o=new Array(i);o[0]=n(r);for(var a=1;a<i;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof r!="string")return r;var c=e.length;if(c===0)return r;for(var u="",l=1-s,h=-1,f=r&&r.length||0,d=0;d<f;){if(r.charCodeAt(d)===37&&d+1<f){switch(h=h>-1?h:0,r.charCodeAt(d+1)){case 100:case 102:if(l>=c||e[l]==null)break;h<d&&(u+=r.slice(h,d)),u+=Number(e[l]),h=d+2,d++;break;case 105:if(l>=c||e[l]==null)break;h<d&&(u+=r.slice(h,d)),u+=Math.floor(Number(e[l])),h=d+2,d++;break;case 79:case 111:case 106:if(l>=c||e[l]===void 0)break;h<d&&(u+=r.slice(h,d));var p=typeof e[l];if(p==="string"){u+="'"+e[l]+"'",h=d+2,d++;break}if(p==="function"){u+=e[l].name||"<anonymous>",h=d+2,d++;break}u+=n(e[l]),h=d+2,d++;break;case 115:if(l>=c)break;h<d&&(u+=r.slice(h,d)),u+=String(e[l]),h=d+2,d++;break;case 37:h<d&&(u+=r.slice(h,d)),u+="%",h=d+2,d++,l--;break}++l}++d}return h===-1?r:(h<f&&(u+=r.slice(h)),u)}const cm=f3;var lo=cn;const _c=I3().console||{},p3={mapHttpRequest:Hu,mapHttpResponse:Hu,wrapRequestSerializer:lf,wrapResponseSerializer:lf,wrapErrorSerializer:lf,req:Hu,res:Hu,err:b3};function g3(r,e){return Array.isArray(r)?r.filter(function(n){return n!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function cn(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||_c;r.browser.write&&(r.browser.asObject=!0);const n=r.serializers||{},s=g3(r.browser.serialize,n);let i=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const a=r.level||"info",c=Object.create(t);c.log||(c.log=Nc),Object.defineProperty(c,"levelVal",{get:l}),Object.defineProperty(c,"level",{get:h,set:f});const u={transmit:e,serialize:s,asObject:r.browser.asObject,levels:o,timestamp:v3(r)};c.levels=cn.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=Nc,c.serializers=n,c._serialize=s,c._stdErrSerialize=i,c.child=d,e&&(c._logEvent=hd());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function h(){return this._level}function f(p){if(p!=="silent"&&!this.levels.values[p])throw Error("unknown level "+p);this._level=p,Vi(u,c,"error","log"),Vi(u,c,"fatal","error"),Vi(u,c,"warn","error"),Vi(u,c,"info","log"),Vi(u,c,"debug","log"),Vi(u,c,"trace","log")}function d(p,g){if(!p)throw new Error("missing bindings for child Pino");g=g||{},s&&p.serializers&&(g.serializers=p.serializers);const m=g.serializers;if(s&&m){var b=Object.assign({},n,m),E=r.browser.serialize===!0?Object.keys(b):s;delete p.serializers,hh([p],E,b,this._stdErrSerialize)}function A(x){this._childLevel=(x._childLevel|0)+1,this.error=Gi(x,p,"error"),this.fatal=Gi(x,p,"fatal"),this.warn=Gi(x,p,"warn"),this.info=Gi(x,p,"info"),this.debug=Gi(x,p,"debug"),this.trace=Gi(x,p,"trace"),b&&(this.serializers=b,this._serialize=E),e&&(this._logEvent=hd([].concat(x._logEvent.bindings,p)))}return A.prototype=this,new A(this)}return c}cn.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};cn.stdSerializers=p3;cn.stdTimeFunctions=Object.assign({},{nullTime:I1,epochTime:P1,unixTime:E3,isoTime:A3});function Vi(r,e,t,n){const s=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?Nc:s[t]?s[t]:_c[t]||_c[n]||Nc,y3(r,e,t)}function y3(r,e,t){!r.transmit&&e[t]===Nc||(e[t]=function(n){return function(){const i=r.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===_c?_c:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(r.serialize&&!r.asObject&&hh(o,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?n.call(a,m3(this,t,o,i)):n.apply(a,o),r.transmit){const u=r.transmit.level||e.level,l=cn.levels.values[u],h=cn.levels.values[t];if(h<l)return;w3(this,{ts:i,methodLevel:t,methodValue:h,transmitLevel:u,transmitValue:cn.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},o)}}}(e[t]))}function m3(r,e,t,n){r._serialize&&hh(t,r._serialize,r.serializers,r._stdErrSerialize);const s=t.slice();let i=s[0];const o={};n&&(o.time=n),o.level=cn.levels.values[e];let a=(r._childLevel|0)+1;if(a<1&&(a=1),i!==null&&typeof i=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?cm(s.shift(),s):void 0}else typeof i=="string"&&(i=cm(s.shift(),s));return i!==void 0&&(o.msg=i),o}function hh(r,e,t,n){for(const s in r)if(n&&r[s]instanceof Error)r[s]=cn.stdSerializers.err(r[s]);else if(typeof r[s]=="object"&&!Array.isArray(r[s]))for(const i in r[s])e&&e.indexOf(i)>-1&&i in t&&(r[s][i]=t[i](r[s][i]))}function Gi(r,e,t){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var s=1;s<n.length;s++)n[s]=arguments[s-1];return r[t].apply(this,n)}}function w3(r,e,t){const n=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,a=e.val,c=r._logEvent.bindings;hh(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=s,r._logEvent.messages=t.filter(function(u){return c.indexOf(u)===-1}),r._logEvent.level.label=i,r._logEvent.level.value=o,n(i,r._logEvent,a),r._logEvent=hd(c)}function hd(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function b3(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function v3(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?I1:P1}function Hu(){return{}}function lf(r){return r}function Nc(){}function I1(){return!1}function P1(){return Date.now()}function E3(){return Math.round(Date.now()/1e3)}function A3(){return new Date(Date.now()).toISOString()}function I3(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const Au=pp(lo),P3={level:"info"},Iu="custom_context",Fp=1e3*1024;let x3=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},um=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new x3(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},x1=class{constructor(e,t=Fp){this.level=e??"error",this.levelValue=lo.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new um(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===lo.levels.values.error?console.error(e):t===lo.levels.values.warn?console.warn(e):t===lo.levels.values.debug?console.debug(e):t===lo.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(qn({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new um(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(qn({extraMetadata:e})),new Blob(t,{type:"application/json"})}},O3=class{constructor(e,t=Fp){this.baseChunkLogger=new x1(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},S3=class{constructor(e,t=Fp){this.baseChunkLogger=new x1(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var D3=Object.defineProperty,C3=Object.defineProperties,_3=Object.getOwnPropertyDescriptors,lm=Object.getOwnPropertySymbols,N3=Object.prototype.hasOwnProperty,T3=Object.prototype.propertyIsEnumerable,hm=(r,e,t)=>e in r?D3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Cl=(r,e)=>{for(var t in e||(e={}))N3.call(e,t)&&hm(r,t,e[t]);if(lm)for(var t of lm(e))T3.call(e,t)&&hm(r,t,e[t]);return r},_l=(r,e)=>C3(r,_3(e));function fh(r){return _l(Cl({},r),{level:(r==null?void 0:r.level)||P3.level})}function R3(r,e=Iu){return r[e]||""}function B3(r,e,t=Iu){return r[t]=e,r}function zt(r,e=Iu){let t="";return typeof r.bindings>"u"?t=R3(r,e):t=r.bindings().context||"",t}function F3(r,e,t=Iu){const n=zt(r,t);return n.trim()?`${n}/${e}`:e}function Nt(r,e,t=Iu){const n=F3(r,e,t),s=r.child({context:n});return B3(s,n,t)}function $3(r){var e,t;const n=new O3((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Au(_l(Cl({},r.opts),{level:"trace",browser:_l(Cl({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function k3(r){var e;const t=new S3((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:Au(_l(Cl({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function U3(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?$3(r):k3(r)}var L3=Object.defineProperty,M3=(r,e,t)=>e in r?L3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fm=(r,e,t)=>M3(r,typeof e!="symbol"?e+"":e,t);let j3=class extends Fi{constructor(e){super(),this.opts=e,fm(this,"protocol","wc"),fm(this,"version",2)}};var H3=Object.defineProperty,z3=(r,e,t)=>e in r?H3(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,q3=(r,e,t)=>z3(r,typeof e!="symbol"?e+"":e,t);let V3=class extends Fi{constructor(e,t){super(),this.core=e,this.logger=t,q3(this,"records",new Map)}},G3=class{constructor(e,t){this.logger=e,this.core=t}},K3=class extends Fi{constructor(e,t){super(),this.relayer=e,this.logger=t}},Q3=class extends Fi{constructor(e){super()}},W3=class{constructor(e,t,n,s){this.core=e,this.logger=t,this.name=n}},J3=class extends Fi{constructor(e,t){super(),this.relayer=e,this.logger=t}},Y3=class extends Fi{constructor(e,t){super(),this.core=e,this.logger=t}},Z3=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},X3=class{constructor(e,t){this.projectId=e,this.logger=t}},eN=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}};var tN=Object.defineProperty,rN=(r,e,t)=>e in r?tN(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,dm=(r,e,t)=>rN(r,typeof e!="symbol"?e+"":e,t);let nN=class{constructor(e){this.opts=e,dm(this,"protocol","wc"),dm(this,"version",2)}},sN=class{constructor(e){this.client=e}};const iN="PARSE_ERROR",oN="INVALID_REQUEST",aN="METHOD_NOT_FOUND",cN="INVALID_PARAMS",O1="INTERNAL_ERROR",$p="SERVER_ERROR",uN=[-32700,-32600,-32601,-32602,-32603],mc={[iN]:{code:-32700,message:"Parse error"},[oN]:{code:-32600,message:"Invalid Request"},[aN]:{code:-32601,message:"Method not found"},[cN]:{code:-32602,message:"Invalid params"},[O1]:{code:-32603,message:"Internal error"},[$p]:{code:-32e3,message:"Server error"}},S1=$p;function lN(r){return uN.includes(r)}function pm(r){return Object.keys(mc).includes(r)?mc[r]:mc[S1]}function hN(r){const e=Object.values(mc).find(t=>t.code===r);return e||mc[S1]}function D1(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var C1={},gn={},gm;function fN(){if(gm)return gn;gm=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.isBrowserCryptoAvailable=gn.getSubtleCrypto=gn.getBrowerCrypto=void 0;function r(){return(rn==null?void 0:rn.crypto)||(rn==null?void 0:rn.msCrypto)||{}}gn.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}gn.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return gn.isBrowserCryptoAvailable=t,gn}var yn={},ym;function dN(){if(ym)return yn;ym=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.isBrowser=yn.isNode=yn.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}yn.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}yn.isNode=e;function t(){return!r()&&!e()}return yn.isBrowser=t,yn}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=lu;e.__exportStar(fN(),r),e.__exportStar(dN(),r)})(C1);function Gr(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function Ks(r=6){return BigInt(Gr(r))}function Is(r,e,t){return{id:t||Gr(),jsonrpc:"2.0",method:r,params:e}}function dh(r,e){return{id:r,jsonrpc:"2.0",result:e}}function ph(r,e,t){return{id:r,jsonrpc:"2.0",error:pN(e,t)}}function pN(r,e){return typeof r>"u"?pm(O1):(typeof r=="string"&&(r=Object.assign(Object.assign({},pm($p)),{message:r})),typeof e<"u"&&(r.data=e),lN(r.code)&&(r=hN(r.code)),r)}class gN{}let yN=class extends gN{constructor(){super()}};class mN extends yN{constructor(e){super()}}const wN="^https?:",bN="^wss?:";function vN(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function _1(r,e){const t=vN(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function mm(r){return _1(r,wN)}function wm(r){return _1(r,bN)}function EN(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function N1(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function kp(r){return N1(r)&&"method"in r}function gh(r){return N1(r)&&(Kr(r)||pr(r))}function Kr(r){return"result"in r}function pr(r){return"error"in r}let mr=class extends mN{constructor(e){super(e),this.events=new nr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Is(e.method,e.params||[],e.id||Ks().toString()),t)}async requestStrict(e,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{pr(i)?s(i.error):n(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),gh(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const AN=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),IN=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",bm=r=>r.split("?")[0],vm=10,PN=AN();let xN=class{constructor(e){if(this.url=e,this.events=new nr.EventEmitter,this.registering=!1,!wm(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(qn(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!wm(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const s=C1.isReactNative()?void 0:{rejectUnauthorized:!EN(e)},i=new PN(e,[],s);IN()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Pi(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=ph(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return D1(e,bm(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>vm&&this.events.setMaxListeners(vm)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${bm(this.url)}`));return this.events.emit("register_error",t),t}};const T1="wc",R1=2,Nl="core",un=`${T1}@2:${Nl}:`,ON={name:Nl,logger:"error"},SN={database:":memory:"},DN="crypto",Em="client_ed25519_seed",CN=V.ONE_DAY,_N="keychain",NN="0.3",TN="messages",RN="0.3",Am=V.SIX_HOURS,BN="publisher",B1="irn",FN="error",F1="wss://relay.walletconnect.org",$N="relayer",et={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},kN="_subscription",sr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},UN=.1,fd="2.19.2",Se={link_mode:"link_mode",relay:"relay"},ll={inbound:"inbound",outbound:"outbound"},LN="0.3",MN="WALLETCONNECT_CLIENT_ID",Im="WALLETCONNECT_LINK_MODE_APPS",Kt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},jN="subscription",HN="0.3",zN="pairing",qN="0.3",Xa={wc_pairingDelete:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:V.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:V.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:V.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:V.ONE_DAY,prompt:!1,tag:0},res:{ttl:V.ONE_DAY,prompt:!1,tag:0}}},Ms={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},vr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},VN="history",GN="0.3",KN="expirer",ar={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},QN="0.3",WN="verify-api",JN="https://verify.walletconnect.com",$1="https://verify.walletconnect.org",wc=$1,YN=`${wc}/v3`,ZN=[JN,$1],XN="echo",eT="https://echo.walletconnect.com",Vr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},mn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Er={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Ts={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Rs={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},ec={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},tT=.1,rT="event-client",nT=86400,sT="https://pulse.walletconnect.org/batch";function iT(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,b=0,E=p.length;b!==E&&p[b]===0;)b++,g++;for(var A=(E-b)*l+1>>>0,x=new Uint8Array(A);b!==E;){for(var D=p[b],S=0,_=A-1;(D!==0||S<m)&&_!==-1;_--,S++)D+=256*x[_]>>>0,x[_]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");m=S,b++}for(var N=A-m;N!==A&&x[N]===0;)N++;for(var T=c.repeat(g);N<A;++N)T+=r.charAt(x[N]);return T}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,b=0;p[g]===c;)m++,g++;for(var E=(p.length-g)*u+1>>>0,A=new Uint8Array(E);p[g];){var x=t[p.charCodeAt(g)];if(x===255)return;for(var D=0,S=E-1;(x!==0||D<b)&&S!==-1;S--,D++)x+=a*A[S]>>>0,A[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");b=D,g++}if(p[g]!==" "){for(var _=E-b;_!==E&&A[_]===0;)_++;for(var N=new Uint8Array(m+(E-_)),T=m;_!==E;)N[T++]=A[_++];return N}}}function d(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:d}}var oT=iT,aT=oT;const k1=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},cT=r=>new TextEncoder().encode(r),uT=r=>new TextDecoder().decode(r);class lT{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class hT{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return U1(this,e)}}class fT{constructor(e){this.decoders=e}or(e){return U1(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const U1=(r,e)=>new fT({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class dT{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new lT(e,t,n),this.decoder=new hT(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yh=({name:r,prefix:e,encode:t,decode:n})=>new dT(r,e,t,n),Pu=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=aT(t,e);return yh({prefix:r,name:e,encode:n,decode:i=>k1(s(i))})},pT=(r,e,t,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const h=s[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},gT=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},pt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>yh({prefix:e,name:r,encode(s){return gT(s,n,t)},decode(s){return pT(s,n,t,r)}}),yT=yh({prefix:"\0",name:"identity",encode:r=>uT(r),decode:r=>cT(r)});var mT=Object.freeze({__proto__:null,identity:yT});const wT=pt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var bT=Object.freeze({__proto__:null,base2:wT});const vT=pt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ET=Object.freeze({__proto__:null,base8:vT});const AT=Pu({prefix:"9",name:"base10",alphabet:"0123456789"});var IT=Object.freeze({__proto__:null,base10:AT});const PT=pt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xT=pt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var OT=Object.freeze({__proto__:null,base16:PT,base16upper:xT});const ST=pt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),DT=pt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),CT=pt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_T=pt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),NT=pt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),TT=pt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),RT=pt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),BT=pt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),FT=pt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $T=Object.freeze({__proto__:null,base32:ST,base32upper:DT,base32pad:CT,base32padupper:_T,base32hex:NT,base32hexupper:TT,base32hexpad:RT,base32hexpadupper:BT,base32z:FT});const kT=Pu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),UT=Pu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var LT=Object.freeze({__proto__:null,base36:kT,base36upper:UT});const MT=Pu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jT=Pu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var HT=Object.freeze({__proto__:null,base58btc:MT,base58flickr:jT});const zT=pt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qT=pt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),VT=pt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),GT=pt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var KT=Object.freeze({__proto__:null,base64:zT,base64pad:qT,base64url:VT,base64urlpad:GT});const L1=Array.from(""),QT=L1.reduce((r,e,t)=>(r[t]=e,r),[]),WT=L1.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function JT(r){return r.reduce((e,t)=>(e+=QT[t],e),"")}function YT(r){const e=[];for(const t of r){const n=WT[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const ZT=yh({prefix:"",name:"base256emoji",encode:JT,decode:YT});var XT=Object.freeze({__proto__:null,base256emoji:ZT}),eR=M1,Pm=128,tR=127,rR=~tR,nR=Math.pow(2,31);function M1(r,e,t){e=e||[],t=t||0;for(var n=t;r>=nR;)e[t++]=r&255|Pm,r/=128;for(;r&rR;)e[t++]=r&255|Pm,r>>>=7;return e[t]=r|0,M1.bytes=t-n+1,e}var sR=dd,iR=128,xm=127;function dd(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw dd.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&xm)<<s:(o&xm)*Math.pow(2,s),s+=7}while(o>=iR);return dd.bytes=i-n,t}var oR=Math.pow(2,7),aR=Math.pow(2,14),cR=Math.pow(2,21),uR=Math.pow(2,28),lR=Math.pow(2,35),hR=Math.pow(2,42),fR=Math.pow(2,49),dR=Math.pow(2,56),pR=Math.pow(2,63),gR=function(r){return r<oR?1:r<aR?2:r<cR?3:r<uR?4:r<lR?5:r<hR?6:r<fR?7:r<dR?8:r<pR?9:10},yR={encode:eR,decode:sR,encodingLength:gR},j1=yR;const Om=(r,e,t=0)=>(j1.encode(r,e,t),e),Sm=r=>j1.encodingLength(r),pd=(r,e)=>{const t=e.byteLength,n=Sm(r),s=n+Sm(t),i=new Uint8Array(s+t);return Om(r,i,0),Om(t,i,n),i.set(e,s),new mR(r,t,e,i)};class mR{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const H1=({name:r,code:e,encode:t})=>new wR(r,e,t);class wR{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?pd(this.code,t):t.then(n=>pd(this.code,n))}else throw Error("Unknown type, must be binary type")}}const z1=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),bR=H1({name:"sha2-256",code:18,encode:z1("SHA-256")}),vR=H1({name:"sha2-512",code:19,encode:z1("SHA-512")});var ER=Object.freeze({__proto__:null,sha256:bR,sha512:vR});const q1=0,AR="identity",V1=k1,IR=r=>pd(q1,V1(r)),PR={code:q1,name:AR,encode:V1,digest:IR};var xR=Object.freeze({__proto__:null,identity:PR});new TextEncoder,new TextDecoder;const Dm={...mT,...bT,...ET,...IT,...OT,...$T,...LT,...HT,...KT,...XT};({...ER,...xR});function OR(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function G1(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const Cm=G1("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),hf=G1("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=OR(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),SR={utf8:Cm,"utf-8":Cm,hex:Dm.base16,latin1:hf,ascii:hf,binary:hf,...Dm};function DR(r,e="utf8"){const t=SR[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var CR=Object.defineProperty,_R=(r,e,t)=>e in r?CR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hr=(r,e,t)=>_R(r,typeof e!="symbol"?e+"":e,t);class NR{constructor(e,t){this.core=e,this.logger=t,Hr(this,"keychain",new Map),Hr(this,"name",_N),Hr(this,"version",NN),Hr(this,"initialized",!1),Hr(this,"storagePrefix",un),Hr(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),Hr(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),Hr(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),Hr(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=K("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),Hr(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Nt(t,this.name)}get context(){return zt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Zf(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Xf(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}}var TR=Object.defineProperty,RR=(r,e,t)=>e in r?TR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,it=(r,e,t)=>RR(r,typeof e!="symbol"?e+"":e,t);class BR{constructor(e,t,n){this.core=e,this.logger=t,it(this,"name",DN),it(this,"keychain"),it(this,"randomSessionIdentifier",ud()),it(this,"initialized",!1),it(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),it(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),it(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=ly(s);return Cb(i.publicKey)}),it(this,"generateKeyPair",()=>{this.isInitialized();const s=FC();return this.setPrivateKey(s.publicKey,s.privateKey)}),it(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=ly(i),a=this.randomSessionIdentifier;return await Xx(a,s,CN,o)}),it(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=$C(a,i);return this.setSymKey(c,o)}),it(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||al(s);return await this.keychain.set(o,s),o}),it(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),it(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),it(this,"encode",async(s,i,o)=>{this.isInitialized();const a=w1(o),c=qn(i);if(Qy(a))return LC(c,o==null?void 0:o.encoding);if(Ky(a)){const f=a.senderPublicKey,d=a.receiverPublicKey;s=await this.generateSharedKey(f,d)}const u=this.getSymKey(s),{type:l,senderPublicKey:h}=a;return kC({type:l,symKey:u,message:c,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),it(this,"decode",async(s,i,o)=>{this.isInitialized();const a=jC(i,o);if(Qy(a)){const c=MC(i,o==null?void 0:o.encoding);return Pi(c)}if(Ky(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;s=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(s),u=UC({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return Pi(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),it(this,"getPayloadType",(s,i=Br)=>{const o=Dc({encoded:s,encoding:i});return Si(o.type)}),it(this,"getPayloadSenderPublicKey",(s,i=Br)=>{const o=Dc({encoded:s,encoding:i});return o.senderPublicKey?jt(o.senderPublicKey,_t):void 0}),this.core=e,this.logger=Nt(t,this.name),this.keychain=n||new NR(this.core,this.logger)}get context(){return zt(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Em)}catch{e=ud(),await this.keychain.set(Em,e)}return DR(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}}var FR=Object.defineProperty,$R=Object.defineProperties,kR=Object.getOwnPropertyDescriptors,_m=Object.getOwnPropertySymbols,UR=Object.prototype.hasOwnProperty,LR=Object.prototype.propertyIsEnumerable,gd=(r,e,t)=>e in r?FR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,MR=(r,e)=>{for(var t in e||(e={}))UR.call(e,t)&&gd(r,t,e[t]);if(_m)for(var t of _m(e))LR.call(e,t)&&gd(r,t,e[t]);return r},jR=(r,e)=>$R(r,kR(e)),qt=(r,e,t)=>gd(r,typeof e!="symbol"?e+"":e,t);class HR extends G3{constructor(e,t){super(e,t),this.logger=e,this.core=t,qt(this,"messages",new Map),qt(this,"messagesWithoutClientAck",new Map),qt(this,"name",TN),qt(this,"version",RN),qt(this,"initialized",!1),qt(this,"storagePrefix",un),qt(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),qt(this,"set",async(n,s,i)=>{this.isInitialized();const o=nn(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===ll.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,jR(MR({},c),{[o]:s}))}return await this.persist(),o}),qt(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),qt(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),qt(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=nn(s);return typeof i[o]<"u"}),qt(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=nn(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),qt(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Nt(e,this.name),this.core=t}get context(){return zt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Zf(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Zf(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Xf(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Xf(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}}var zR=Object.defineProperty,qR=Object.defineProperties,VR=Object.getOwnPropertyDescriptors,Nm=Object.getOwnPropertySymbols,GR=Object.prototype.hasOwnProperty,KR=Object.prototype.propertyIsEnumerable,yd=(r,e,t)=>e in r?zR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zu=(r,e)=>{for(var t in e||(e={}))GR.call(e,t)&&yd(r,t,e[t]);if(Nm)for(var t of Nm(e))KR.call(e,t)&&yd(r,t,e[t]);return r},ff=(r,e)=>qR(r,VR(e)),Ar=(r,e,t)=>yd(r,typeof e!="symbol"?e+"":e,t);class QR extends K3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Ar(this,"events",new nr.EventEmitter),Ar(this,"name",BN),Ar(this,"queue",new Map),Ar(this,"publishTimeout",V.toMiliseconds(V.ONE_MINUTE)),Ar(this,"initialPublishTimeout",V.toMiliseconds(V.ONE_SECOND*15)),Ar(this,"needsTransportRestart",!1),Ar(this,"publish",async(n,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||Am,c=Sl(i),u=(i==null?void 0:i.prompt)||!1,l=(i==null?void 0:i.tag)||0,h=(i==null?void 0:i.id)||Ks().toString(),f={topic:n,message:s,opts:{ttl:a,relay:c,prompt:u,tag:l,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},d=`Failed to publish payload, please try again. id:${h} tag:${l}`;try{const p=new Promise(async g=>{const m=({id:E})=>{f.opts.id===E&&(this.removeRequestFromQueue(E),this.relayer.events.removeListener(et.publish,m),g(f))};this.relayer.events.on(et.publish,m);const b=As(new Promise((E,A)=>{this.rpcPublish({topic:n,message:s,ttl:a,prompt:u,tag:l,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(E).catch(x=>{this.logger.warn(x,x==null?void 0:x.message),A(x)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${l}`);try{await b,this.events.removeListener(et.publish,m)}catch(E){this.queue.set(h,ff(zu({},f),{attempt:1})),this.logger.warn(E,E==null?void 0:E.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:n,message:s,opts:i}}),await As(p,this.publishTimeout,d)}catch(p){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(p),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw p}finally{this.queue.delete(h)}}),Ar(this,"on",(n,s)=>{this.events.on(n,s)}),Ar(this,"once",(n,s)=>{this.events.once(n,s)}),Ar(this,"off",(n,s)=>{this.events.off(n,s)}),Ar(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=Nt(t,this.name),this.registerEventListeners()}get context(){return zt(this.logger)}async rpcPublish(e){var t,n,s,i;const{topic:o,message:a,ttl:c=Am,prompt:u,tag:l,id:h,attestation:f,tvf:d}=e,p={method:oc(Sl().protocol).publish,params:zu({topic:o,message:a,ttl:c,prompt:u,tag:l,attestation:f},d),id:h};ct((t=p.params)==null?void 0:t.prompt)&&((n=p.params)==null||delete n.prompt),ct((s=p.params)==null?void 0:s.tag)&&((i=p.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const g=await this.relayer.request(p);return this.relayer.events.emit(et.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const n=e.attempt+1;this.queue.set(t,ff(zu({},e),{attempt:n}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(ff(zu({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(za.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(et.connection_stalled);return}this.checkQueue()}),this.relayer.on(et.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var WR=Object.defineProperty,JR=(r,e,t)=>e in r?WR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ki=(r,e,t)=>JR(r,typeof e!="symbol"?e+"":e,t);class YR{constructor(){Ki(this,"map",new Map),Ki(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),Ki(this,"get",e=>this.map.get(e)||[]),Ki(this,"exists",(e,t)=>this.get(e).includes(t)),Ki(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const s=n.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Ki(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var ZR=Object.defineProperty,XR=Object.defineProperties,eB=Object.getOwnPropertyDescriptors,Tm=Object.getOwnPropertySymbols,tB=Object.prototype.hasOwnProperty,rB=Object.prototype.propertyIsEnumerable,md=(r,e,t)=>e in r?ZR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,tc=(r,e)=>{for(var t in e||(e={}))tB.call(e,t)&&md(r,t,e[t]);if(Tm)for(var t of Tm(e))rB.call(e,t)&&md(r,t,e[t]);return r},df=(r,e)=>XR(r,eB(e)),Ae=(r,e,t)=>md(r,typeof e!="symbol"?e+"":e,t);class nB extends J3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Ae(this,"subscriptions",new Map),Ae(this,"topicMap",new YR),Ae(this,"events",new nr.EventEmitter),Ae(this,"name",jN),Ae(this,"version",HN),Ae(this,"pending",new Map),Ae(this,"cached",[]),Ae(this,"initialized",!1),Ae(this,"storagePrefix",un),Ae(this,"subscribeTimeout",V.toMiliseconds(V.ONE_MINUTE)),Ae(this,"initialSubscribeTimeout",V.toMiliseconds(V.ONE_SECOND*15)),Ae(this,"clientId"),Ae(this,"batchSubscribeTopicsLimit",500),Ae(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Ae(this,"subscribe",async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const i=Sl(s),o={topic:n,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),Ae(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),Ae(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),Ae(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),Ae(this,"on",(n,s)=>{this.events.on(n,s)}),Ae(this,"once",(n,s)=>{this.events.once(n,s)}),Ae(this,"off",(n,s)=>{this.events.off(n,s)}),Ae(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),Ae(this,"start",async()=>{await this.onConnect()}),Ae(this,"stop",async()=>{await this.onDisconnect()}),Ae(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Ae(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),Ae(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(za.pulse,async()=>{await this.checkPending()}),this.events.on(Kt.created,async n=>{const s=Kt.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(Kt.deleted,async n=>{const s=Kt.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=Nt(t,this.name),this.clientId=""}get context(){return zt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const s=Sl(n);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=we("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,n){var s;(!n||(n==null?void 0:n.transportType)===Se.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const i={method:oc(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===Se.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(l=>this.logger.warn(l))},V.toMiliseconds(V.ONE_SECOND)),a;const c=new Promise(async l=>{const h=f=>{f.topic===e&&(this.events.removeListener(Kt.created,h),l(f.id))};this.events.on(Kt.created,h);try{const f=await As(new Promise((d,p)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g==null?void 0:g.message),p(g)}).then(d)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Kt.created,h),l(f)}catch{}}),u=await As(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return u?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(et.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:oc(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await As(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(et.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:oc(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await As(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(et.connection_stalled)}return s}rpcUnsubscribe(e,t,n){const s={method:oc(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,df(tc({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,tc({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,tc({},t)),this.topicMap.set(t.topic,e),this.events.emit(Kt.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=K("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Kt.deleted,df(tc({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Kt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Kt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>df(tc({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await AS(V.toMiliseconds(V.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return nn(e+await this.getClientId())}}var sB=Object.defineProperty,Rm=Object.getOwnPropertySymbols,iB=Object.prototype.hasOwnProperty,oB=Object.prototype.propertyIsEnumerable,wd=(r,e,t)=>e in r?sB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bm=(r,e)=>{for(var t in e||(e={}))iB.call(e,t)&&wd(r,t,e[t]);if(Rm)for(var t of Rm(e))oB.call(e,t)&&wd(r,t,e[t]);return r},pe=(r,e,t)=>wd(r,typeof e!="symbol"?e+"":e,t);class aB extends Q3{constructor(e){super(e),pe(this,"protocol","wc"),pe(this,"version",2),pe(this,"core"),pe(this,"logger"),pe(this,"events",new nr.EventEmitter),pe(this,"provider"),pe(this,"messages"),pe(this,"subscriber"),pe(this,"publisher"),pe(this,"name",$N),pe(this,"transportExplicitlyClosed",!1),pe(this,"initialized",!1),pe(this,"connectionAttemptInProgress",!1),pe(this,"relayUrl"),pe(this,"projectId"),pe(this,"packageName"),pe(this,"bundleId"),pe(this,"hasExperiencedNetworkDisruption",!1),pe(this,"pingTimeout"),pe(this,"heartBeatTimeout",V.toMiliseconds(V.THIRTY_SECONDS+V.FIVE_SECONDS)),pe(this,"reconnectTimeout"),pe(this,"connectPromise"),pe(this,"reconnectInProgress",!1),pe(this,"requestsInFlight",[]),pe(this,"connectTimeout",V.toMiliseconds(V.ONE_SECOND*15)),pe(this,"request",async t=>{var n,s;this.logger.debug("Publishing Request Payload");const i=t.id||Ks().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=t.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),pe(this,"resetPingTimeout",()=>{xl()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),pe(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),pe(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(et.connect)}),pe(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),pe(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(et.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),pe(this,"registerProviderListeners",()=>{this.provider.on(sr.payload,this.onPayloadHandler),this.provider.on(sr.connect,this.onConnectHandler),this.provider.on(sr.disconnect,this.onDisconnectHandler),this.provider.on(sr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Nt(e.logger,this.name):Au(fh({level:e.logger||FN})),this.messages=new HR(this.logger,e.core),this.subscriber=new nB(this,this.logger),this.publisher=new QR(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||F1,this.projectId=e.projectId,oS()?this.packageName=my():aS()&&(this.bundleId=my()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return zt(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:Se.relay},ll.outbound)}async subscribe(e,t){var n,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const u=l=>{l.topic===e&&(this.subscriber.off(Kt.created,u),c())};return await Promise.all([new Promise(l=>{c=l,this.subscriber.on(Kt.created,u)}),new Promise(async(l,h)=>{a=await this.subscriber.subscribe(e,Bm({internal:{throwOnFailedPublish:o}},t)).catch(f=>{o&&h(f)})||a,l()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await As(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await rm())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const s=Ge(V.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(et.message,e),await this.recordMessageEvent(e,ll.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(sr.disconnect,i),await As(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(sr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(sr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(sr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,V.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,s,i;if(xl())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new mr(new xN(fS({sdkVersion:fd,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:s}=e;await this.messages.set(n,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),kp(e)){if(!e.method.endsWith(kN))return;const t=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=t.data,a={topic:n,message:s,publishedAt:i,transportType:Se.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Bm({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else gh(e)&&this.events.emit(et.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,ll.inbound),this.events.emit(et.message,e))}async acknowledgePayload(e){const t=dh(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(sr.payload,this.onPayloadHandler),this.provider.off(sr.connect,this.onConnectHandler),this.provider.off(sr.disconnect,this.onDisconnectHandler),this.provider.off(sr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await rm();O_(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(et.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},V.toMiliseconds(UN)))))}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}function cB(){}function Fm(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function $m(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function km(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const uB="[object RegExp]",lB="[object String]",hB="[object Number]",fB="[object Boolean]",Um="[object Arguments]",dB="[object Symbol]",pB="[object Date]",gB="[object Map]",yB="[object Set]",mB="[object Array]",wB="[object Function]",bB="[object ArrayBuffer]",pf="[object Object]",vB="[object Error]",EB="[object DataView]",AB="[object Uint8Array]",IB="[object Uint8ClampedArray]",PB="[object Uint16Array]",xB="[object Uint32Array]",OB="[object BigUint64Array]",SB="[object Int8Array]",DB="[object Int16Array]",CB="[object Int32Array]",_B="[object BigInt64Array]",NB="[object Float32Array]",TB="[object Float64Array]";function RB(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function BB(r,e,t){return cc(r,e,void 0,void 0,void 0,void 0,t)}function cc(r,e,t,n,s,i,o){const a=o(r,e,t,n,s,i);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return bc(r,e,i,o)}return bc(r,e,i,o)}function bc(r,e,t,n){if(Object.is(r,e))return!0;let s=km(r),i=km(e);if(s===Um&&(s=pf),i===Um&&(i=pf),s!==i)return!1;switch(s){case lB:return r.toString()===e.toString();case hB:{const c=r.valueOf(),u=e.valueOf();return RB(c,u)}case fB:case pB:case dB:return Object.is(r.valueOf(),e.valueOf());case uB:return r.source===e.source&&r.flags===e.flags;case wB:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(s){case gB:{if(r.size!==e.size)return!1;for(const[c,u]of r.entries())if(!e.has(c)||!cc(u,e.get(c),c,r,e,t,n))return!1;return!0}case yB:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),u=Array.from(e.values());for(let l=0;l<c.length;l++){const h=c[l],f=u.findIndex(d=>cc(h,d,void 0,r,e,t,n));if(f===-1)return!1;u.splice(f,1)}return!0}case mB:case AB:case IB:case PB:case xB:case OB:case SB:case DB:case CB:case _B:case NB:case TB:{if(typeof Buffer<"u"&&Buffer.isBuffer(r)!==Buffer.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!cc(r[c],e[c],c,r,e,t,n))return!1;return!0}case bB:return r.byteLength!==e.byteLength?!1:bc(new Uint8Array(r),new Uint8Array(e),t,n);case EB:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:bc(new Uint8Array(r),new Uint8Array(e),t,n);case vB:return r.name===e.name&&r.message===e.message;case pf:{if(!(bc(r.constructor,e.constructor,t,n)||Fm(r)&&Fm(e)))return!1;const c=[...Object.keys(r),...$m(r)],u=[...Object.keys(e),...$m(e)];if(c.length!==u.length)return!1;for(let l=0;l<c.length;l++){const h=c[l],f=r[h];if(!Object.hasOwn(e,h))return!1;const d=e[h];if(!cc(f,d,h,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function FB(r,e){return BB(r,e,cB)}var $B=Object.defineProperty,Lm=Object.getOwnPropertySymbols,kB=Object.prototype.hasOwnProperty,UB=Object.prototype.propertyIsEnumerable,bd=(r,e,t)=>e in r?$B(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mm=(r,e)=>{for(var t in e||(e={}))kB.call(e,t)&&bd(r,t,e[t]);if(Lm)for(var t of Lm(e))UB.call(e,t)&&bd(r,t,e[t]);return r},Rt=(r,e,t)=>bd(r,typeof e!="symbol"?e+"":e,t);class ki extends W3{constructor(e,t,n,s=un,i=void 0){super(e,t,n,s),this.core=e,this.logger=t,this.name=n,Rt(this,"map",new Map),Rt(this,"version",LN),Rt(this,"cached",[]),Rt(this,"initialized",!1),Rt(this,"getKey"),Rt(this,"storagePrefix",un),Rt(this,"recentlyDeleted",[]),Rt(this,"recentlyDeletedLimit",200),Rt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!ct(o)?this.map.set(this.getKey(o),o):n_(o)?this.map.set(o.id,o):s_(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Rt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Rt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Rt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>FB(a[c],o[c]))):this.values)),Rt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Mm(Mm({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Rt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Nt(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return zt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=K("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=K("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}}var LB=Object.defineProperty,MB=(r,e,t)=>e in r?LB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ce=(r,e,t)=>MB(r,typeof e!="symbol"?e+"":e,t);class jB{constructor(e,t){this.core=e,this.logger=t,ce(this,"name",zN),ce(this,"version",qN),ce(this,"events",new yp),ce(this,"pairings"),ce(this,"initialized",!1),ce(this,"storagePrefix",un),ce(this,"ignoredPayloadTypes",[jn]),ce(this,"registeredMethods",[]),ce(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ce(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),ce(this,"create",async n=>{this.isInitialized();const s=ud(),i=await this.core.crypto.setSymKey(s),o=Ge(V.FIVE_MINUTES),a={protocol:B1},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},u=Jy({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(Ms.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType}),{topic:i,uri:u}}),ce(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[Vr.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:u}=Wy(n.uri);s.props.properties.topic=i,s.addTrace(Vr.pairing_uri_validation_success),s.addTrace(Vr.pairing_uri_not_expired);let l;if(this.pairings.keys.includes(i)){if(l=this.pairings.get(i),s.addTrace(Vr.existing_pairing),l.active)throw s.setError(mn.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Vr.pairing_not_expired)}const h=c||Ge(V.FIVE_MINUTES),f={topic:i,relay:a,expiry:h,active:!1,methods:u};this.core.expirer.set(i,h),await this.pairings.set(i,f),s.addTrace(Vr.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(Ms.create,f),s.addTrace(Vr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Vr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(mn.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(d){throw s.setError(mn.subscribe_pairing_topic_failure),d}return s.addTrace(Vr.subscribe_pairing_topic_success),f}),ce(this,"activate",async({topic:n})=>{this.isInitialized();const s=Ge(V.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),ce(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Fs();this.events.once(me("pairing_ping",i),({error:u})=>{u?c(u):a()}),await o()}}),ce(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),ce(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),ce(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ce(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",we("USER_DISCONNECTED")),await this.deletePairing(s))}),ce(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return Jy({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ce(this,"sendRequest",async(n,s,i)=>{const o=Is(s,i),a=await this.core.crypto.encode(n,o),c=Xa[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),ce(this,"sendResult",async(n,s,i)=>{const o=dh(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,u=Xa[c].res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),ce(this,"sendError",async(n,s,i)=>{const o=ph(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,u=Xa[c]?Xa[c].res:Xa.unregistered_method.res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),ce(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,we("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),ce(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>rs(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),ce(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ce(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ce(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(Ms.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ce(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Kr(s)?this.events.emit(me("pairing_ping",i),{}):pr(s)&&this.events.emit(me("pairing_ping",i),{error:s.error})},500)}),ce(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Ms.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),ce(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=we("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),ce(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(we("WC_METHOD_UNSUPPORTED",n))}),ce(this,"isValidPair",(n,s)=>{var i;if(!Ft(n)){const{message:a}=K("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(mn.malformed_pairing_uri),new Error(a)}if(!r_(n.uri)){const{message:a}=K("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(mn.malformed_pairing_uri),new Error(a)}const o=Wy(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=K("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(mn.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=K("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(mn.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&V.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(mn.pairing_expired);const{message:a}=K("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ce(this,"isValidPing",async n=>{if(!Ft(n)){const{message:i}=K("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ce(this,"isValidDisconnect",async n=>{if(!Ft(n)){const{message:i}=K("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),ce(this,"isValidPairingTopic",async n=>{if(!ze(n,!1)){const{message:s}=K("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=K("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(rs(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=K("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=Nt(t,this.name),this.pairings=new ki(this.core,this.logger,this.name,this.storagePrefix)}get context(){return zt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(et.message,async e=>{const{topic:t,message:n,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==Se.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(t,n);kp(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):gh(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(ar.expired,async e=>{const{topic:t}=Lb(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Ms.expire,{topic:t}))})}}var HB=Object.defineProperty,zB=(r,e,t)=>e in r?HB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ot=(r,e,t)=>zB(r,typeof e!="symbol"?e+"":e,t);class qB extends V3{constructor(e,t){super(e,t),this.core=e,this.logger=t,ot(this,"records",new Map),ot(this,"events",new nr.EventEmitter),ot(this,"name",VN),ot(this,"version",GN),ot(this,"cached",[]),ot(this,"initialized",!1),ot(this,"storagePrefix",un),ot(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),ot(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:Ge(V.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(vr.created,o)}),ot(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=pr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(vr.updated,s))}),ot(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),ot(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(vr.deleted,i)}}),this.persist()}),ot(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),ot(this,"on",(n,s)=>{this.events.on(n,s)}),ot(this,"once",(n,s)=>{this.events.once(n,s)}),ot(this,"off",(n,s)=>{this.events.off(n,s)}),ot(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Nt(t,this.name)}get context(){return zt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Is(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=K("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(vr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(vr.created,e=>{const t=vr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(vr.updated,e=>{const t=vr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(vr.deleted,e=>{const t=vr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(za.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{V.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(vr.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}}var VB=Object.defineProperty,GB=(r,e,t)=>e in r?VB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,gt=(r,e,t)=>GB(r,typeof e!="symbol"?e+"":e,t);class KB extends Y3{constructor(e,t){super(e,t),this.core=e,this.logger=t,gt(this,"expirations",new Map),gt(this,"events",new nr.EventEmitter),gt(this,"name",KN),gt(this,"version",QN),gt(this,"cached",[]),gt(this,"initialized",!1),gt(this,"storagePrefix",un),gt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),gt(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),gt(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(ar.created,{target:i,expiration:o})}),gt(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),gt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(ar.deleted,{target:s,expiration:i})}}),gt(this,"on",(n,s)=>{this.events.on(n,s)}),gt(this,"once",(n,s)=>{this.events.once(n,s)}),gt(this,"off",(n,s)=>{this.events.off(n,s)}),gt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Nt(t,this.name)}get context(){return zt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return dS(e);if(typeof e=="number")return pS(e);const{message:t}=K("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ar.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=K("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;V.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(ar.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(za.pulse,()=>this.checkExpirations()),this.events.on(ar.created,e=>{const t=ar.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(ar.expired,e=>{const t=ar.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(ar.deleted,e=>{const t=ar.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}}var QB=Object.defineProperty,WB=(r,e,t)=>e in r?QB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,He=(r,e,t)=>WB(r,typeof e!="symbol"?e+"":e,t);class JB extends Z3{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,He(this,"name",WN),He(this,"abortController"),He(this,"isDevEnv"),He(this,"verifyUrlV3",YN),He(this,"storagePrefix",un),He(this,"version",R1),He(this,"publicKey"),He(this,"fetchPromise"),He(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&V.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),He(this,"register",async s=>{if(!pu()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const u=hu(),l=this.startAbortTimer(V.ONE_SECOND*5),h=await new Promise((f,d)=>{const p=()=>{window.removeEventListener("message",m),u.body.removeChild(g),d("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=u.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=b=>{if(b.data&&typeof b.data=="string")try{const E=JSON.parse(b.data);if(E.type==="verify_attestation"){if(Yf(E.attestation).payload.id!==o)return;clearInterval(l),u.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),f(E.attestation===null?"":E.attestation)}}catch(E){this.logger.warn(E)}};u.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(u){this.logger.warn(u)}return""}),He(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Yf(i).payload.id!==a)return;const u=await this.isValidJwtAttestation(i);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),He(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(V.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),He(this,"getVerifyUrl",s=>{let i=s||wc;return ZN.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${wc}`),i=wc),i}),He(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(V.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),He(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),He(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),He(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),He(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),He(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),He(this,"validateAttestation",(s,i)=>{const o=zC(s,i.publicKey),a={hasExpired:V.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Nt(t,this.name),this.abortController=new AbortController,this.isDevEnv=Op(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return zt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),V.toMiliseconds(e))}}var YB=Object.defineProperty,ZB=(r,e,t)=>e in r?YB(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jm=(r,e,t)=>ZB(r,typeof e!="symbol"?e+"":e,t);class XB extends X3{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,jm(this,"context",XN),jm(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${eT}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Nt(t,this.context)}}var e8=Object.defineProperty,Hm=Object.getOwnPropertySymbols,t8=Object.prototype.hasOwnProperty,r8=Object.prototype.propertyIsEnumerable,vd=(r,e,t)=>e in r?e8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,rc=(r,e)=>{for(var t in e||(e={}))t8.call(e,t)&&vd(r,t,e[t]);if(Hm)for(var t of Hm(e))r8.call(e,t)&&vd(r,t,e[t]);return r},Qe=(r,e,t)=>vd(r,typeof e!="symbol"?e+"":e,t);class n8 extends eN{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,Qe(this,"context",rT),Qe(this,"storagePrefix",un),Qe(this,"storageVersion",tT),Qe(this,"events",new Map),Qe(this,"shouldPersist",!1),Qe(this,"init",async()=>{if(!Op())try{const s={eventId:by(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:kb(this.core.relayer.protocol,this.core.relayer.version,fd)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Qe(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,u=by(),l=this.core.projectId||"",h=Date.now(),f=rc({eventId:u,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:l,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,f),this.shouldPersist=!0),f}),Qe(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return rc(rc({},a),this.setMethods(a.eventId))}),Qe(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Qe(this,"setEventListeners",()=>{this.core.heartbeat.on(za.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{V.fromMiliseconds(Date.now())-V.fromMiliseconds(s.timestamp)>nT&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Qe(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Qe(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Qe(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Qe(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Qe(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,rc(rc({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Qe(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Qe(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${sT}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${fd}${i}`,{method:"POST",body:JSON.stringify(s)})}),Qe(this,"getAppDomain",()=>$b().url),this.logger=Nt(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var s8=Object.defineProperty,zm=Object.getOwnPropertySymbols,i8=Object.prototype.hasOwnProperty,o8=Object.prototype.propertyIsEnumerable,Ed=(r,e,t)=>e in r?s8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qm=(r,e)=>{for(var t in e||(e={}))i8.call(e,t)&&Ed(r,t,e[t]);if(zm)for(var t of zm(e))o8.call(e,t)&&Ed(r,t,e[t]);return r},Pe=(r,e,t)=>Ed(r,typeof e!="symbol"?e+"":e,t);let a8=class K1 extends j3{constructor(e){var t;super(e),Pe(this,"protocol",T1),Pe(this,"version",R1),Pe(this,"name",Nl),Pe(this,"relayUrl"),Pe(this,"projectId"),Pe(this,"customStoragePrefix"),Pe(this,"events",new nr.EventEmitter),Pe(this,"logger"),Pe(this,"heartbeat"),Pe(this,"relayer"),Pe(this,"crypto"),Pe(this,"storage"),Pe(this,"history"),Pe(this,"expirer"),Pe(this,"pairing"),Pe(this,"verify"),Pe(this,"echoClient"),Pe(this,"linkModeSupportedApps"),Pe(this,"eventClient"),Pe(this,"initialized",!1),Pe(this,"logChunkController"),Pe(this,"on",(a,c)=>this.events.on(a,c)),Pe(this,"once",(a,c)=>this.events.once(a,c)),Pe(this,"off",(a,c)=>this.events.off(a,c)),Pe(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Pe(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:u})=>{if(!a||!c)return;const l={topic:a,message:c,publishedAt:Date.now(),transportType:Se.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:u})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||F1,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=fh({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:ON.logger,name:Nl}),{logger:i,chunkLoggerController:o}=U3({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Nt(i,this.name),this.heartbeat=new __,this.crypto=new BR(this,this.logger,e==null?void 0:e.keychain),this.history=new qB(this,this.logger),this.expirer=new KB(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new l3(qm(qm({},SN),e==null?void 0:e.storageOptions)),this.relayer=new aB({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new jB(this,this.logger),this.verify=new JB(this,this.logger,this.storage),this.echoClient=new XB(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new n8(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new K1(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(MN,n),t}get context(){return zt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Im,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Im)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&{}.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const c8=a8,Q1="wc",W1=2,J1="client",Up=`${Q1}@${W1}:${J1}:`,gf={name:J1,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},Vm="WALLETCONNECT_DEEPLINK_CHOICE",u8="proposal",Gm="Proposal expired",l8="session",Qi=V.SEVEN_DAYS,h8="engine",We={wc_sessionPropose:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1104},res:{ttl:V.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1106},res:{ttl:V.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1112},res:{ttl:V.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1114},res:{ttl:V.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:V.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:V.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1119}}},yf={min:V.FIVE_MINUTES,max:V.SEVEN_DAYS},zr={idle:"IDLE",active:"ACTIVE"},Km={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},f8="request",d8=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],p8="wc",g8="auth",y8="authKeys",m8="pairingTopics",w8="requests",mh=`${p8}@${1.5}:${g8}:`,hl=`${mh}:PUB_KEY`;var b8=Object.defineProperty,v8=Object.defineProperties,E8=Object.getOwnPropertyDescriptors,Qm=Object.getOwnPropertySymbols,A8=Object.prototype.hasOwnProperty,I8=Object.prototype.propertyIsEnumerable,Ad=(r,e,t)=>e in r?b8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ie=(r,e)=>{for(var t in e||(e={}))A8.call(e,t)&&Ad(r,t,e[t]);if(Qm)for(var t of Qm(e))I8.call(e,t)&&Ad(r,t,e[t]);return r},vt=(r,e)=>v8(r,E8(e)),M=(r,e,t)=>Ad(r,typeof e!="symbol"?e+"":e,t);class P8 extends sN{constructor(e){super(e),M(this,"name",h8),M(this,"events",new yp),M(this,"initialized",!1),M(this,"requestQueue",{state:zr.idle,queue:[]}),M(this,"sessionRequestQueue",{state:zr.idle,queue:[]}),M(this,"requestQueueDelay",V.ONE_SECOND),M(this,"expectedPairingMethodMap",new Map),M(this,"recentlyDeletedMap",new Map),M(this,"recentlyDeletedLimit",200),M(this,"relayMessageCache",[]),M(this,"pendingSessions",new Map),M(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(We)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},V.toMiliseconds(this.requestQueueDelay)))}),M(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=vt(Ie({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:u}=n;let l=s,h,f=!1;try{if(l){const S=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),f=S.active}}catch(S){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),S}if(!l||!f){const{topic:S,uri:_}=await this.client.core.pairing.create();l=S,h=_}if(!l){const{message:S}=K("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(S)}const d=await this.client.core.crypto.generateKeyPair(),p=We.wc_sessionPropose.req.ttl||V.FIVE_MINUTES,g=Ge(p),m=vt(Ie(Ie({requiredNamespaces:i,optionalNamespaces:o,relays:u??[{protocol:B1}],proposer:{publicKey:d,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:l},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Gr()}),b=me("session_connect",m.id),{reject:E,resolve:A,done:x}=Fs(p,Gm),D=({id:S})=>{S===m.id&&(this.client.events.off("proposal_expire",D),this.pendingSessions.delete(m.id),this.events.emit(b,{error:{message:Gm,code:0}}))};return this.client.events.on("proposal_expire",D),this.events.once(b,({error:S,session:_})=>{this.client.events.off("proposal_expire",D),S?E(S):_&&A(_)}),await this.sendRequest({topic:l,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:h,approval:x}}),M(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),M(this,"approve",async t=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[Er.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(T){throw o.setError(Ts.no_internet_connection),T}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(T){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(Ts.proposal_not_found),T}try{await this.isValidApprove(t)}catch(T){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Ts.session_approve_namespace_validation_failure),T}const{id:a,relayProtocol:c,namespaces:u,sessionProperties:l,scopedProperties:h,sessionConfig:f}=t,d=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:b}=d;let E=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});E||(E=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Er.session_approve_started,properties:{topic:p,trace:[Er.session_approve_started,Er.session_namespaces_validation_success]}}));const A=await this.client.core.crypto.generateKeyPair(),x=g.publicKey,D=await this.client.core.crypto.generateSharedKey(A,x),S=Ie(Ie(Ie({relay:{protocol:c??"irn"},namespaces:u,controller:{publicKey:A,metadata:this.client.metadata},expiry:Ge(Qi)},l&&{sessionProperties:l}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),_=Se.relay;E.addTrace(Er.subscribing_session_topic);try{await this.client.core.relayer.subscribe(D,{transportType:_})}catch(T){throw E.setError(Ts.subscribe_session_topic_failure),T}E.addTrace(Er.subscribe_session_topic_success);const N=vt(Ie({},S),{topic:D,requiredNamespaces:m,optionalNamespaces:b,pairingTopic:p,acknowledged:!1,self:S.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:A,transportType:Se.relay});await this.client.session.set(D,N),E.addTrace(Er.store_session);try{E.addTrace(Er.publishing_session_settle),await this.sendRequest({topic:D,method:"wc_sessionSettle",params:S,throwOnFailedPublish:!0}).catch(T=>{throw E==null||E.setError(Ts.session_settle_publish_failure),T}),E.addTrace(Er.session_settle_publish_success),E.addTrace(Er.publishing_session_approve),await this.sendResult({id:a,topic:p,result:{relay:{protocol:c??"irn"},responderPublicKey:A},throwOnFailedPublish:!0}).catch(T=>{throw E==null||E.setError(Ts.session_approve_publish_failure),T}),E.addTrace(Er.session_approve_publish_success)}catch(T){throw this.client.logger.error(T),this.client.session.delete(D,we("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(D),T}return this.client.core.eventClient.deleteEvent({eventId:E.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.client.proposal.delete(a,we("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(D,Ge(Qi)),{topic:D,acknowledged:()=>Promise.resolve(this.client.session.get(D))}}),M(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=t;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&(await this.sendError({id:n,topic:i,error:s,rpcOpts:We.wc_sessionPropose.reject}),await this.client.proposal.delete(n,we("USER_DISCONNECTED")))}),M(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:n,namespaces:s}=t,{done:i,resolve:o,reject:a}=Fs(),c=Gr(),u=Ks().toString(),l=this.client.session.get(n).namespaces;return this.events.once(me("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:u}).catch(h=>{this.client.logger.error(h),this.client.session.update(n,{namespaces:l}),a(h)}),{acknowledged:i}}),M(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,s=Gr(),{done:i,resolve:o,reject:a}=Fs();return this.events.once(me("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Ge(Qi)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),M(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(b){throw this.client.logger.error("request() -> isValidRequest() failed"),b}const{chainId:n,request:s,topic:i,expiry:o=We.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===Se.relay&&await this.confirmOnlineStateOrThrow();const c=Gr(),u=Ks().toString(),{done:l,resolve:h,reject:f}=Fs(o,"Request expired. Please try again.");this.events.once(me("session_request",c),({error:b,result:E})=>{b?f(b):h(E)});const d="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:i,method:d,params:{request:vt(Ie({},s),{expiryTimestamp:Ge(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(b=>f(b)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await l();const g={request:vt(Ie({},s),{expiryTimestamp:Ge(o)}),chainId:n},m=this.shouldSetTVF(d,g);return await Promise.all([new Promise(async b=>{await this.sendRequest(Ie({clientRpcId:c,relayRpcId:u,topic:i,method:d,params:g,expiry:o,throwOnFailedPublish:!0},m&&{tvf:this.getTVFParams(c,g)})).catch(E=>f(E)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),b()}),new Promise(async b=>{var E;if(!((E=a.sessionConfig)!=null&&E.disableDeepLink)){const A=await wS(this.client.core.storage,Vm);await gS({id:c,topic:i,wcDeepLink:A})}b()}),l()]).then(b=>b[2])}),M(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:i}=s,o=this.client.session.get(n);o.transportType===Se.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Kr(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):pr(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(t)}),M(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=Gr(),i=Ks().toString(),{done:o,resolve:a,reject:c}=Fs();this.events.once(me("session_ping",s),({error:u})=>{u?c(u):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),M(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:s,chainId:i}=t,o=Ks().toString(),a=Gr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),M(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:we("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=K("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),M(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>e_(n,t)))),M(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),M(this,"authenticate",async(t,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Se.link_mode:Se.relay;o===Se.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:u,domain:l,nonce:h,type:f,exp:d,nbf:p,methods:g=[],expiry:m}=t,b=[...t.resources||[]],{topic:E,uri:A}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:E,uri:A}});const x=await this.client.core.crypto.generateKeyPair(),D=al(x);if(await Promise.all([this.client.auth.authKeys.set(hl,{responseTopic:D,publicKey:x}),this.client.auth.pairingTopics.set(D,{topic:D,pairingTopic:E})]),await this.client.core.relayer.subscribe(D,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${E}`),g.length>0){const{namespace:C}=So(a[0]);let $=lD(C,"request",g);ol(b)&&($=fD($,b.pop())),b.push($)}const S=m&&m>We.wc_sessionAuthenticate.req.ttl?m:We.wc_sessionAuthenticate.req.ttl,_={authPayload:{type:f??"caip122",chains:a,statement:c,aud:u,domain:l,version:"1",nonce:h,iat:new Date().toISOString(),exp:d,nbf:p,resources:b},requester:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:Ge(S)},N={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},T={requiredNamespaces:{},optionalNamespaces:N,relays:[{protocol:"irn"}],pairingTopic:E,proposer:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:Ge(We.wc_sessionPropose.req.ttl),id:Gr()},{done:z,resolve:U,reject:H}=Fs(S,"Request expired"),W=Gr(),k=me("session_connect",T.id),w=me("session_request",W),v=async({error:C,session:$})=>{this.events.off(w,P),C?H(C):$&&U({session:$})},P=async C=>{var $,q,G;if(await this.deletePendingAuthRequest(W,{message:"fulfilled",code:0}),C.error){const re=we("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return C.error.code===re.code?void 0:(this.events.off(k,v),H(C.error.message))}await this.deleteProposal(T.id),this.events.off(k,v);const{cacaos:Y,responder:Q}=C.result,ee=[],oe=[];for(const re of Y){await Sy({cacao:re,projectId:this.client.core.projectId})||(this.client.logger.error(re,"Signature verification failed"),H(we("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:_e}=re,je=ol(_e.resources),Te=[ed(_e.iss)],Ce=Ol(_e.iss);if(je){const Ve=Dy(je),ln=Cy(je);ee.push(...Ve),Te.push(...ln)}for(const Ve of Te)oe.push(`${Ve}:${Ce}`)}const ae=await this.client.core.crypto.generateSharedKey(x,Q.publicKey);let fe;ee.length>0&&(fe={topic:ae,acknowledged:!0,self:{publicKey:x,metadata:this.client.metadata},peer:Q,controller:Q.publicKey,expiry:Ge(Qi),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:E,namespaces:Yy([...new Set(ee)],[...new Set(oe)]),transportType:o},await this.client.core.relayer.subscribe(ae,{transportType:o}),await this.client.session.set(ae,fe),E&&await this.client.core.pairing.updateMetadata({topic:E,metadata:Q.metadata}),fe=this.client.session.get(ae)),($=this.client.metadata.redirect)!=null&&$.linkMode&&(q=Q.metadata.redirect)!=null&&q.linkMode&&(G=Q.metadata.redirect)!=null&&G.universal&&n&&(this.client.core.addLinkModeSupportedApp(Q.metadata.redirect.universal),this.client.session.update(ae,{transportType:Se.link_mode})),U({auths:Y,session:fe})};this.events.once(k,v),this.events.once(w,P);let R;try{if(i){const C=Is("wc_sessionAuthenticate",_,W);this.client.core.history.set(E,C);const $=await this.client.core.crypto.encode("",C,{type:vu,encoding:ss});R=Lu(n,E,$)}else await Promise.all([this.sendRequest({topic:E,method:"wc_sessionAuthenticate",params:_,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:W}),this.sendRequest({topic:E,method:"wc_sessionPropose",params:T,expiry:We.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:T.id})])}catch(C){throw this.events.off(k,v),this.events.off(w,P),C}return await this.setProposal(T.id,T),await this.setAuthRequest(W,{request:vt(Ie({},_),{verifyContext:{}}),pairingTopic:E,transportType:o}),{uri:R??A,response:z}}),M(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Rs.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(ec.no_internet_connection),m}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(ec.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||Se.relay;a===Se.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),l=al(c),h={type:jn,receiverPublicKey:c,senderPublicKey:u},f=[],d=[];for(const m of s){if(!await Sy({cacao:m,projectId:this.client.core.projectId})){i.setError(ec.invalid_cacao);const D=we("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:l,error:D,encodeOpts:h}),new Error(D.message)}i.addTrace(Rs.cacaos_verified);const{p:b}=m,E=ol(b.resources),A=[ed(b.iss)],x=Ol(b.iss);if(E){const D=Dy(E),S=Cy(E);f.push(...D),A.push(...S)}for(const D of A)d.push(`${D}:${x}`)}const p=await this.client.core.crypto.generateSharedKey(u,c);i.addTrace(Rs.create_authenticated_session_topic);let g;if((f==null?void 0:f.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Ge(Qi),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Yy([...new Set(f)],[...new Set(d)]),transportType:a},i.addTrace(Rs.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(ec.subscribe_authenticated_session_topic_failure),m}i.addTrace(Rs.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(Rs.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Rs.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:n,result:{cacaos:s,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(ec.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),M(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:s}=t,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===Se.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=al(o),u={type:jn,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:u,rpcOpts:We.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,we("USER_DISCONNECTED"))}),M(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:s}=t;return Qb(n,s)}),M(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),M(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),M(this,"deleteSession",async t=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,we("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Vm).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===s&&this.deletePendingSessionRequest(u.id,we("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=zr.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),M(this,"deleteProposal",async(t,n)=>{if(n)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Ts.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,we("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),M(this,"deletePendingSessionRequest",async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=zr.idle,this.client.events.emit("session_request_expire",{id:t}))}),M(this,"deletePendingAuthRequest",async(t,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])}),M(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),M(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,Ge(We.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),M(this,"setAuthRequest",async(t,n)=>{const{request:s,pairingTopic:i,transportType:o=Se.relay}=n;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),M(this,"setPendingSessionRequest",async t=>{const{id:n,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||Ge(We.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),M(this,"sendRequest",async t=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:u,appLink:l,tvf:h}=t,f=Is(s,i,c);let d;const p=!!l;try{const b=p?ss:Br;d=await this.client.core.crypto.encode(n,f,{encoding:b})}catch(b){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),b}let g;if(d8.includes(s)){const b=nn(JSON.stringify(f)),E=nn(d);g=await this.client.core.verify.register({id:E,decryptedId:b})}const m=We[s].req;if(m.attestation=g,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(n,f),p){const b=Lu(l,n,d);await global.Linking.openURL(b,this.client.name)}else{const b=We[s].req;o&&(b.ttl=o),a&&(b.id=a),b.tvf=vt(Ie({},h),{correlationId:f.id}),u?(b.internal=vt(Ie({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,d,b)):this.client.core.relayer.publish(n,d,b).catch(E=>this.client.logger.error(E))}return f.id}),M(this,"sendResult",async t=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,u=dh(n,i);let l;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=h?ss:Br;l=await this.client.core.crypto.encode(s,u,vt(Ie({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let f,d;try{f=await this.client.core.history.get(s,n);const p=f.request;try{this.shouldSetTVF(p.method,p.params)&&(d=this.getTVFParams(n,p.params,i))}catch(g){this.client.logger.warn("sendResult() -> getTVFParams() failed",g)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),p}if(h){const p=Lu(c,s,l);await global.Linking.openURL(p,this.client.name)}else{const p=f.request.method,g=We[p].res;g.tvf=vt(Ie({},d),{correlationId:n}),o?(g.internal=vt(Ie({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,l,g)):this.client.core.relayer.publish(s,l,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(u)}),M(this,"sendError",async t=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,u=ph(n,i);let l;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const d=h?ss:Br;l=await this.client.core.crypto.encode(s,u,vt(Ie({},o||{}),{encoding:d}))}catch(d){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),d}let f;try{f=await this.client.core.history.get(s,n)}catch(d){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),d}if(h){const d=Lu(c,s,l);await global.Linking.openURL(d,this.client.name)}else{const d=f.request.method,p=a||We[d].res;this.client.core.relayer.publish(s,l,p)}await this.client.core.history.resolve(u)}),M(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;rs(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{rs(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),M(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),M(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),M(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===zr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=zr.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=zr.idle}),M(this,"processRequest",async t=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),M(this,"onRelayEventResponse",async t=>{const{topic:n,payload:s,transportType:i}=t,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),M(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:s}=K("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),M(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),M(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const u=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u==null||u.setError(mn.proposal_listener_not_found)),this.isValidConnect(Ie({},s.params));const l=a.expiryTimestamp||Ge(We.wc_sessionPropose.req.ttl),h=Ie({id:c,pairingTopic:n,expiryTimestamp:l},a);await this.setProposal(c,h);const f=await this.getVerifyContext({attestationId:i,hash:nn(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});u==null||u.addTrace(Vr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:f})}catch(u){await this.sendError({id:c,topic:n,error:u,rpcOpts:We.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),M(this,"onSessionProposeResponse",async(t,n,s)=>{const{id:i}=n;if(Kr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const l=await this.client.core.crypto.generateSharedKey(c,u);this.pendingSessions.set(i,{sessionTopic:l,pairingTopic:t,proposalId:i,publicKey:c});const h=await this.client.core.relayer.subscribe(l,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:t})}else if(pr(n)){await this.client.proposal.delete(i,we("USER_DISCONNECTED"));const o=me("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),M(this,"onSessionSettleRequest",async(t,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:u,sessionProperties:l,scopedProperties:h,sessionConfig:f}=n.params,d=[...this.pendingSessions.values()].find(m=>m.sessionTopic===t);if(!d)return this.client.logger.error(`Pending session not found for topic ${t}`);const p=this.client.proposal.get(d.proposalId),g=vt(Ie(Ie(Ie({topic:t,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:d.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:d.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},l&&{sessionProperties:l}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),{transportType:Se.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:d.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(me("session_connect",d.proposalId),{session:g}),this.pendingSessions.delete(d.proposalId),this.deleteProposal(d.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:n.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),M(this,"onSessionSettleResponse",async(t,n)=>{const{id:s}=n;Kr(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(me("session_approve",s),{})):pr(n)&&(await this.client.session.delete(t,we("USER_DISCONNECTED")),this.events.emit(me("session_approve",s),{error:n.error}))}),M(this,"onSessionUpdateRequest",async(t,n)=>{const{params:s,id:i}=n;try{const o=`${t}_session_update`,a=Za.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:we("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Ie({topic:t},s));try{Za.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0})}catch(c){throw Za.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),M(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),M(this,"onSessionUpdateResponse",(t,n)=>{const{id:s}=n,i=me("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Kr(n)?this.events.emit(me("session_update",s),{}):pr(n)&&this.events.emit(me("session_update",s),{error:n.error})}),M(this,"onSessionExtendRequest",async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Ge(Qi)),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),M(this,"onSessionExtendResponse",(t,n)=>{const{id:s}=n,i=me("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Kr(n)?this.events.emit(me("session_extend",s),{}):pr(n)&&this.events.emit(me("session_extend",s),{error:n.error})}),M(this,"onSessionPingRequest",async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),M(this,"onSessionPingResponse",(t,n)=>{const{id:s}=n,i=me("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Kr(n)?this.events.emit(me("session_ping",s),{}):pr(n)&&this.events.emit(me("session_ping",s),{error:n.error})},500)}),M(this,"onSessionDeleteRequest",async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(et.publish,async()=>{i(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:we("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),M(this,"onSessionRequest",async t=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:u,transportType:l}=t,{id:h,params:f}=a;try{await this.isValidRequest(Ie({topic:o},f));const d=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:nn(JSON.stringify(Is("wc_sessionRequest",f,h))),encryptedId:u,metadata:d.peer.metadata,transportType:l}),g={id:h,topic:o,params:f,verifyContext:p};await this.setPendingSessionRequest(g),l===Se.link_mode&&(n=d.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=d.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(d){await this.sendError({id:h,topic:o,error:d}),this.client.logger.error(d)}}),M(this,"onSessionRequestResponse",(t,n)=>{const{id:s}=n,i=me("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Kr(n)?this.events.emit(me("session_request",s),{result:n.result}):pr(n)&&this.events.emit(me("session_request",s),{error:n.error})}),M(this,"onSessionEventRequest",async(t,n)=>{const{id:s,params:i}=n;try{const o=`${t}_session_event_${i.event.name}`,a=Za.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Ie({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),Za.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),M(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Kr(n)?this.events.emit(me("session_request",s),{result:n.result}):pr(n)&&this.events.emit(me("session_request",s),{error:n.error})}),M(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:u,authPayload:l,expiryTimestamp:h}=i.params,f=await this.getVerifyContext({attestationId:o,hash:nn(JSON.stringify(i)),encryptedId:a,metadata:u.metadata,transportType:c}),d={requester:u,pairingTopic:s,id:i.id,authPayload:l,verifyContext:f,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:d,pairingTopic:s,transportType:c}),c===Se.link_mode&&(n=u.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:f})}catch(u){this.client.logger.error(u);const l=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),f=this.getAppLinkIfEnabled(i.params.requester.metadata,c),d={type:jn,receiverPublicKey:l,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:u,encodeOpts:d,rpcOpts:We.wc_sessionAuthenticate.autoReject,appLink:f})}}),M(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),M(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=zr.idle,this.processSessionRequestQueue()},V.toMiliseconds(this.requestQueueDelay))}),M(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=me("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(me("session_request",i.request.id),{error:n})})}),M(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===zr.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=zr.active,this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),M(this,"emitSessionRequest",t=>{this.client.events.emit("session_request",t)}),M(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:Is("wc_sessionPropose",vt(Ie({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),M(this,"isValidConnect",async t=>{if(!Ft(t)){const{message:u}=K("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(u)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(ct(n)||await this.isValidPairingTopic(n),!f_(c,!0)){const{message:u}=K("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}if(!ct(s)&&Cc(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!ct(i)&&Cc(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),ct(o)||this.validateSessionProps(o,"sessionProperties"),!ct(a)){this.validateSessionProps(a,"scopedProperties");const u=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(l=>u.includes(l)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(u)}`)}}),M(this,"validateNamespaces",(t,n)=>{const s=h_(t,"connect()",n);if(s)throw new Error(s.message)}),M(this,"isValidApprove",async t=>{if(!Ft(t))throw new Error(K("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),u=of(s,"approve()");if(u)throw new Error(u.message);const l=em(c.requiredNamespaces,s,"approve()");if(l)throw new Error(l.message);if(!ze(i,!0)){const{message:h}=K("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(ct(o)||this.validateSessionProps(o,"sessionProperties"),!ct(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(a).every(f=>h.has(f)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),M(this,"isValidReject",async t=>{if(!Ft(t)){const{message:i}=K("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:n,reason:s}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!p_(s)){const{message:i}=K("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),M(this,"isValidSessionSettleRequest",t=>{if(!Ft(t)){const{message:u}=K("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(u)}const{relay:n,controller:s,namespaces:i,expiry:o}=t;if(!v1(n)){const{message:u}=K("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=i_(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=of(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(rs(o)){const{message:u}=K("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),M(this,"isValidUpdate",async t=>{if(!Ft(t)){const{message:c}=K("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:s}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=of(s,"update()");if(o)throw new Error(o.message);const a=em(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),M(this,"isValidExtend",async t=>{if(!Ft(t)){const{message:s}=K("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),M(this,"isValidRequest",async t=>{if(!Ft(t)){const{message:c}=K("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Xy(a,i)){const{message:c}=K("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!g_(s)){const{message:c}=K("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!w_(a,i,s.method)){const{message:c}=K("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!A_(o,yf)){const{message:c}=K("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${yf.min} and ${yf.max}`);throw new Error(c)}}),M(this,"isValidRespond",async t=>{var n;if(!Ft(t)){const{message:o}=K("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(o){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),o}if(!y_(i)){const{message:o}=K("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),M(this,"isValidPing",async t=>{if(!Ft(t)){const{message:s}=K("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),M(this,"isValidEmit",async t=>{if(!Ft(t)){const{message:a}=K("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Xy(o,i)){const{message:a}=K("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!m_(s)){const{message:a}=K("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!b_(o,i,s.name)){const{message:a}=K("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),M(this,"isValidDisconnect",async t=>{if(!Ft(t)){const{message:s}=K("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),M(this,"isValidAuthenticate",t=>{const{chains:n,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!ze(s,!1))throw new Error("uri is required parameter");if(!ze(i,!1))throw new Error("domain is required parameter");if(!ze(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>So(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=So(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),M(this,"getVerifyContext",async t=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||wc,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Se.link_mode){const l=this.getAppLinkIfEnabled(o,a);return c.verified.validation=l&&new URL(l).origin===new URL(o.url).origin?"VALID":"INVALID",c}const u=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});u&&(c.verified.origin=u.origin,c.verified.isScam=u.isScam,c.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),M(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=K("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),M(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),M(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),M(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:s}=K("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(s)}}),M(this,"isLinkModeEnabled",(t,n)=>{var s,i,o,a,c,u,l,h,f;return!t||n!==Se.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:u.universal)!==""&&((l=t==null?void 0:t.redirect)==null?void 0:l.universal)!==void 0&&((h=t==null?void 0:t.redirect)==null?void 0:h.universal)!==""&&((f=t==null?void 0:t.redirect)==null?void 0:f.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),M(this,"getAppLinkIfEnabled",(t,n)=>{var s;return this.isLinkModeEnabled(t,n)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),M(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=wy(t,"topic")||"",s=decodeURIComponent(wy(t,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:Se.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),M(this,"registerLinkModeListeners",async()=>{var t;if(Op()||Ds()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),M(this,"shouldSetTVF",(t,n)=>{if(!n||t!=="wc_sessionRequest")return!1;const{request:s}=n;return Object.keys(Km).includes(s.method)}),M(this,"getTVFParams",(t,n,s)=>{var i,o;try{const a=n.request.method,c=this.extractTxHashesFromResult(a,s);return vt(Ie({correlationId:t,rpcMethods:[a],chainId:n.chainId},this.isValidContractData(n.request.params)&&{contractAddresses:[(o=(i=n.request.params)==null?void 0:i[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),M(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((n=t==null?void 0:t[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),M(this,"extractTxHashesFromResult",(t,n)=>{try{const s=Km[t];if(typeof n=="string")return[n];const i=n[s.key];if(Fr(i))return t==="solana_signAllTransactions"?i.map(o=>JS(o)):i;if(typeof i=="string")return[i]}catch(s){this.client.logger.warn("Error extracting tx hashes from result",s)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=K("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(et.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(hl)?this.client.auth.authKeys.get(hl):{responseTopic:void 0,publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:i===Se.link_mode?ss:Br});kp(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:nn(n)})):gh(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(ar.expired,async e=>{const{topic:t,id:n}=Lb(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,K("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,K("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ms.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Ms.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!ze(e,!1)){const{message:t}=K("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=K("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(rs(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=K("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!ze(e,!1)){const{message:t}=K("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=K("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(rs(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=K("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=K("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(ze(e,!1)){const{message:t}=K("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=K("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!d_(e)){const{message:t}=K("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=K("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(rs(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=K("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class x8 extends ki{constructor(e,t){super(e,t,u8,Up),this.core=e,this.logger=t}}let O8=class extends ki{constructor(e,t){super(e,t,l8,Up),this.core=e,this.logger=t}};class S8 extends ki{constructor(e,t){super(e,t,f8,Up,n=>n.id),this.core=e,this.logger=t}}class D8 extends ki{constructor(e,t){super(e,t,y8,mh,()=>hl),this.core=e,this.logger=t}}class C8 extends ki{constructor(e,t){super(e,t,m8,mh),this.core=e,this.logger=t}}class _8 extends ki{constructor(e,t){super(e,t,w8,mh,n=>n.id),this.core=e,this.logger=t}}var N8=Object.defineProperty,T8=(r,e,t)=>e in r?N8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mf=(r,e,t)=>T8(r,typeof e!="symbol"?e+"":e,t);class R8{constructor(e,t){this.core=e,this.logger=t,mf(this,"authKeys"),mf(this,"pairingTopics"),mf(this,"requests"),this.authKeys=new D8(this.core,this.logger),this.pairingTopics=new C8(this.core,this.logger),this.requests=new _8(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var B8=Object.defineProperty,F8=(r,e,t)=>e in r?B8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ue=(r,e,t)=>F8(r,typeof e!="symbol"?e+"":e,t);let $8=class Y1 extends nN{constructor(e){super(e),ue(this,"protocol",Q1),ue(this,"version",W1),ue(this,"name",gf.name),ue(this,"metadata"),ue(this,"core"),ue(this,"logger"),ue(this,"events",new nr.EventEmitter),ue(this,"engine"),ue(this,"session"),ue(this,"proposal"),ue(this,"pendingRequest"),ue(this,"auth"),ue(this,"signConfig"),ue(this,"on",(n,s)=>this.events.on(n,s)),ue(this,"once",(n,s)=>this.events.once(n,s)),ue(this,"off",(n,s)=>this.events.off(n,s)),ue(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),ue(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),ue(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),ue(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),ue(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),ue(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||gf.name,this.metadata=uS(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Au(fh({level:(e==null?void 0:e.logger)||gf.logger}));this.core=(e==null?void 0:e.core)||new c8(e),this.logger=Nt(t,this.name),this.session=new O8(this.core,this.logger),this.proposal=new x8(this.core,this.logger),this.pendingRequest=new S8(this.core,this.logger),this.engine=new P8(this),this.auth=new R8(this.core,this.logger)}static async init(e){const t=new Y1(e);return await t.initialize(),t}get context(){return zt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},V.toMiliseconds(V.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Id={exports:{}};(function(r,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof rn<"u"&&rn,n=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof rn<"u"&&rn||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(w){return w&&DataView.prototype.isPrototypeOf(w)}if(c.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(w){return w&&l.indexOf(Object.prototype.toString.call(w))>-1};function f(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(w)||w==="")throw new TypeError('Invalid character in header field name: "'+w+'"');return w.toLowerCase()}function d(w){return typeof w!="string"&&(w=String(w)),w}function p(w){var v={next:function(){var P=w.shift();return{done:P===void 0,value:P}}};return c.iterable&&(v[Symbol.iterator]=function(){return v}),v}function g(w){this.map={},w instanceof g?w.forEach(function(v,P){this.append(P,v)},this):Array.isArray(w)?w.forEach(function(v){if(v.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+v.length);this.append(v[0],v[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(v){this.append(v,w[v])},this)}g.prototype.append=function(w,v){w=f(w),v=d(v);var P=this.map[w];this.map[w]=P?P+", "+v:v},g.prototype.delete=function(w){delete this.map[f(w)]},g.prototype.get=function(w){return w=f(w),this.has(w)?this.map[w]:null},g.prototype.has=function(w){return this.map.hasOwnProperty(f(w))},g.prototype.set=function(w,v){this.map[f(w)]=d(v)},g.prototype.forEach=function(w,v){for(var P in this.map)this.map.hasOwnProperty(P)&&w.call(v,this.map[P],P,this)},g.prototype.keys=function(){var w=[];return this.forEach(function(v,P){w.push(P)}),p(w)},g.prototype.values=function(){var w=[];return this.forEach(function(v){w.push(v)}),p(w)},g.prototype.entries=function(){var w=[];return this.forEach(function(v,P){w.push([P,v])}),p(w)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(w){if(!w._noBody){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}}function b(w){return new Promise(function(v,P){w.onload=function(){v(w.result)},w.onerror=function(){P(w.error)}})}function E(w){var v=new FileReader,P=b(v);return v.readAsArrayBuffer(w),P}function A(w){var v=new FileReader,P=b(v),R=/charset=([A-Za-z0-9_-]+)/.exec(w.type),C=R?R[1]:"utf-8";return v.readAsText(w,C),P}function x(w){for(var v=new Uint8Array(w),P=new Array(v.length),R=0;R<v.length;R++)P[R]=String.fromCharCode(v[R]);return P.join("")}function D(w){if(w.slice)return w.slice(0);var v=new Uint8Array(w.byteLength);return v.set(new Uint8Array(w)),v.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(w){this.bodyUsed=this.bodyUsed,this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:c.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:c.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():c.arrayBuffer&&c.blob&&u(w)?(this._bodyArrayBuffer=D(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||h(w))?this._bodyArrayBuffer=D(w):this._bodyText=w=Object.prototype.toString.call(w):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var w=m(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var w=m(this);return w||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(E);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var w=m(this);if(w)return w;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(x(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(z)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function N(w){var v=w.toUpperCase();return _.indexOf(v)>-1?v:w}function T(w,v){if(!(this instanceof T))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');v=v||{};var P=v.body;if(w instanceof T){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,v.headers||(this.headers=new g(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!P&&w._bodyInit!=null&&(P=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=v.credentials||this.credentials||"same-origin",(v.headers||!this.headers)&&(this.headers=new g(v.headers)),this.method=N(v.method||this.method||"GET"),this.mode=v.mode||this.mode||null,this.signal=v.signal||this.signal||function(){if("AbortController"in a){var $=new AbortController;return $.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(P),(this.method==="GET"||this.method==="HEAD")&&(v.cache==="no-store"||v.cache==="no-cache")){var R=/([?&])_=[^&]*/;if(R.test(this.url))this.url=this.url.replace(R,"$1_="+new Date().getTime());else{var C=/\?/;this.url+=(C.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}T.prototype.clone=function(){return new T(this,{body:this._bodyInit})};function z(w){var v=new FormData;return w.trim().split("&").forEach(function(P){if(P){var R=P.split("="),C=R.shift().replace(/\+/g," "),$=R.join("=").replace(/\+/g," ");v.append(decodeURIComponent(C),decodeURIComponent($))}}),v}function U(w){var v=new g,P=w.replace(/\r?\n[\t ]+/g," ");return P.split("\r").map(function(R){return R.indexOf(`
`)===0?R.substr(1,R.length):R}).forEach(function(R){var C=R.split(":"),$=C.shift().trim();if($){var q=C.join(":").trim();try{v.append($,q)}catch(G){console.warn("Response "+G.message)}}}),v}S.call(T.prototype);function H(w,v){if(!(this instanceof H))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(v||(v={}),this.type="default",this.status=v.status===void 0?200:v.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=v.statusText===void 0?"":""+v.statusText,this.headers=new g(v.headers),this.url=v.url||"",this._initBody(w)}S.call(H.prototype),H.prototype.clone=function(){return new H(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},H.error=function(){var w=new H(null,{status:200,statusText:""});return w.ok=!1,w.status=0,w.type="error",w};var W=[301,302,303,307,308];H.redirect=function(w,v){if(W.indexOf(v)===-1)throw new RangeError("Invalid status code");return new H(null,{status:v,headers:{location:w}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(v,P){this.message=v,this.name=P;var R=Error(v);this.stack=R.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function k(w,v){return new Promise(function(P,R){var C=new T(w,v);if(C.signal&&C.signal.aborted)return R(new o.DOMException("Aborted","AbortError"));var $=new XMLHttpRequest;function q(){$.abort()}$.onload=function(){var Q={statusText:$.statusText,headers:U($.getAllResponseHeaders()||"")};C.url.indexOf("file://")===0&&($.status<200||$.status>599)?Q.status=200:Q.status=$.status,Q.url="responseURL"in $?$.responseURL:Q.headers.get("X-Request-URL");var ee="response"in $?$.response:$.responseText;setTimeout(function(){P(new H(ee,Q))},0)},$.onerror=function(){setTimeout(function(){R(new TypeError("Network request failed"))},0)},$.ontimeout=function(){setTimeout(function(){R(new TypeError("Network request timed out"))},0)},$.onabort=function(){setTimeout(function(){R(new o.DOMException("Aborted","AbortError"))},0)};function G(Q){try{return Q===""&&a.location.href?a.location.href:Q}catch{return Q}}if($.open(C.method,G(C.url),!0),C.credentials==="include"?$.withCredentials=!0:C.credentials==="omit"&&($.withCredentials=!1),"responseType"in $&&(c.blob?$.responseType="blob":c.arrayBuffer&&($.responseType="arraybuffer")),v&&typeof v.headers=="object"&&!(v.headers instanceof g||a.Headers&&v.headers instanceof a.Headers)){var Y=[];Object.getOwnPropertyNames(v.headers).forEach(function(Q){Y.push(f(Q)),$.setRequestHeader(Q,d(v.headers[Q]))}),C.headers.forEach(function(Q,ee){Y.indexOf(ee)===-1&&$.setRequestHeader(ee,Q)})}else C.headers.forEach(function(Q,ee){$.setRequestHeader(ee,Q)});C.signal&&(C.signal.addEventListener("abort",q),$.onreadystatechange=function(){$.readyState===4&&C.signal.removeEventListener("abort",q)}),$.send(typeof C._bodyInit>"u"?null:C._bodyInit)})}return k.polyfill=!0,a.fetch||(a.fetch=k,a.Headers=g,a.Request=T,a.Response=H),o.Headers=g,o.Request=T,o.Response=H,o.fetch=k,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=t.fetch?t:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,r.exports=e})(Id,Id.exports);var k8=Id.exports;const Wm=pp(k8);var U8=Object.defineProperty,L8=Object.defineProperties,M8=Object.getOwnPropertyDescriptors,Jm=Object.getOwnPropertySymbols,j8=Object.prototype.hasOwnProperty,H8=Object.prototype.propertyIsEnumerable,Ym=(r,e,t)=>e in r?U8(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zm=(r,e)=>{for(var t in e||(e={}))j8.call(e,t)&&Ym(r,t,e[t]);if(Jm)for(var t of Jm(e))H8.call(e,t)&&Ym(r,t,e[t]);return r},Xm=(r,e)=>L8(r,M8(e));const z8={Accept:"application/json","Content-Type":"application/json"},q8="POST",ew={headers:z8,method:q8},tw=10;class Ur{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new nr.EventEmitter,this.isAvailable=!1,this.registering=!1,!mm(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=qn(e),n=await(await Wm(this.url,Xm(Zm({},ew),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!mm(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=qn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Wm(e,Xm(Zm({},ew),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Pi(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=ph(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return D1(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>tw&&this.events.setMaxListeners(tw)}}const rw="error",V8="wss://relay.walletconnect.org",G8="wc",K8="universal_provider",qu=`${G8}@2:${K8}:`,Z1="https://rpc.walletconnect.org/v1/",ho="generic",Q8=`${Z1}bundler`,wr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function W8(){}function Lp(r){return r==null||typeof r!="object"&&typeof r!="function"}function Mp(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function J8(r){if(Lp(r))return r;if(Array.isArray(r)||Mp(r)||r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);const e=Object.getPrototypeOf(r),t=e.constructor;if(r instanceof Date||r instanceof Map||r instanceof Set)return new t(r);if(r instanceof RegExp){const n=new t(r);return n.lastIndex=r.lastIndex,n}if(r instanceof DataView)return new t(r.buffer.slice(0));if(r instanceof Error){const n=new t(r.message);return n.stack=r.stack,n.name=r.name,n.cause=r.cause,n}if(typeof File<"u"&&r instanceof File)return new t([r],r.name,{type:r.type,lastModified:r.lastModified});if(typeof r=="object"){const n=Object.create(e);return Object.assign(n,r)}return r}function nw(r){return typeof r=="object"&&r!==null}function X1(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function ev(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const Y8="[object RegExp]",tv="[object String]",rv="[object Number]",nv="[object Boolean]",sv="[object Arguments]",Z8="[object Symbol]",X8="[object Date]",eF="[object Map]",tF="[object Set]",rF="[object Array]",nF="[object ArrayBuffer]",sF="[object Object]",iF="[object DataView]",oF="[object Uint8Array]",aF="[object Uint8ClampedArray]",cF="[object Uint16Array]",uF="[object Uint32Array]",lF="[object Int8Array]",hF="[object Int16Array]",fF="[object Int32Array]",dF="[object Float32Array]",pF="[object Float64Array]";function gF(r,e){return wo(r,void 0,r,new Map,e)}function wo(r,e,t,n=new Map,s=void 0){const i=s==null?void 0:s(r,e,t,n);if(i!=null)return i;if(Lp(r))return r;if(n.has(r))return n.get(r);if(Array.isArray(r)){const o=new Array(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=wo(r[a],a,t,n,s);return Object.hasOwn(r,"index")&&(o.index=r.index),Object.hasOwn(r,"input")&&(o.input=r.input),o}if(r instanceof Date)return new Date(r.getTime());if(r instanceof RegExp){const o=new RegExp(r.source,r.flags);return o.lastIndex=r.lastIndex,o}if(r instanceof Map){const o=new Map;n.set(r,o);for(const[a,c]of r)o.set(a,wo(c,a,t,n,s));return o}if(r instanceof Set){const o=new Set;n.set(r,o);for(const a of r)o.add(wo(a,void 0,t,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(r))return r.subarray();if(Mp(r)){const o=new(Object.getPrototypeOf(r)).constructor(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=wo(r[a],a,t,n,s);return o}if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);if(r instanceof DataView){const o=new DataView(r.buffer.slice(0),r.byteOffset,r.byteLength);return n.set(r,o),js(o,r,t,n,s),o}if(typeof File<"u"&&r instanceof File){const o=new File([r],r.name,{type:r.type});return n.set(r,o),js(o,r,t,n,s),o}if(r instanceof Blob){const o=new Blob([r],{type:r.type});return n.set(r,o),js(o,r,t,n,s),o}if(r instanceof Error){const o=new r.constructor;return n.set(r,o),o.message=r.message,o.name=r.name,o.stack=r.stack,o.cause=r.cause,js(o,r,t,n,s),o}if(typeof r=="object"&&yF(r)){const o=Object.create(Object.getPrototypeOf(r));return n.set(r,o),js(o,r,t,n,s),o}return r}function js(r,e,t=r,n,s){const i=[...Object.keys(e),...X1(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(r,a);(c==null||c.writable)&&(r[a]=wo(e[a],a,t,n,s))}}function yF(r){switch(ev(r)){case sv:case rF:case nF:case iF:case nv:case X8:case dF:case pF:case lF:case hF:case fF:case eF:case rv:case sF:case Y8:case tF:case tv:case Z8:case oF:case aF:case cF:case uF:return!0;default:return!1}}function mF(r,e){return gF(r,(t,n,s,i)=>{const o=e==null?void 0:e(t,n,s,i);if(o!=null)return o;if(typeof r=="object")switch(Object.prototype.toString.call(r)){case rv:case tv:case nv:{const a=new r.constructor(r==null?void 0:r.valueOf());return js(a,r),a}case sv:{const a={};return js(a,r),a.length=r.length,a[Symbol.iterator]=r[Symbol.iterator],a}default:return}})}function sw(r){return mF(r)}function iw(r){return r!==null&&typeof r=="object"&&ev(r)==="[object Arguments]"}function wF(r){return Mp(r)}function bF(r){var t;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!((t=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&t.writable)?!1:r.toString()===`[object ${n}]`}let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e}function vF(r,...e){const t=e.slice(0,-1),n=e[e.length-1];let s=r;for(let i=0;i<t.length;i++){const o=t[i];s=Pd(s,o,n,new Map)}return s}function Pd(r,e,t,n){if(Lp(r)&&(r=Object(r)),e==null||typeof e!="object")return r;if(n.has(e))return J8(n.get(e));if(n.set(e,r),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...X1(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=r[o];if(iw(a)&&(a={...a}),iw(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=sw(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const l=[],h=Reflect.ownKeys(c);for(let f=0;f<h.length;f++){const d=h[f];l[d]=c[d]}c=l}else c=[];const u=t(c,a,o,r,e,n);u!=null?r[o]=u:Array.isArray(a)||nw(c)&&nw(a)?r[o]=Pd(c,a,t,n):c==null&&bF(a)?r[o]=Pd({},a,t,n):c==null&&wF(a)?r[o]=sw(a):(c===void 0||a!==void 0)&&(r[o]=a)}return r}function EF(r,...e){return vF(r,...e,W8)}var AF=Object.defineProperty,IF=Object.defineProperties,PF=Object.getOwnPropertyDescriptors,ow=Object.getOwnPropertySymbols,xF=Object.prototype.hasOwnProperty,OF=Object.prototype.propertyIsEnumerable,aw=(r,e,t)=>e in r?AF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vu=(r,e)=>{for(var t in e||(e={}))xF.call(e,t)&&aw(r,t,e[t]);if(ow)for(var t of ow(e))OF.call(e,t)&&aw(r,t,e[t]);return r},SF=(r,e)=>IF(r,PF(e));function rr(r,e,t){var n;const s=So(r);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${Z1}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function Ui(r){return r.includes(":")?r.split(":")[1]:r}function iv(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function DF(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const n=[];return t.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function wf(r={},e={}){const t=cw(r),n=cw(e);return EF(t,n)}function cw(r){var e,t,n,s;const i={};if(!Cc(r))return i;for(const[o,a]of Object.entries(r)){const c=Rp(o)?[o]:a.chains,u=a.methods||[],l=a.events||[],h=a.rpcMap||{},f=ac(o);i[f]=SF(Vu(Vu({},i[f]),a),{chains:il(c,(e=i[f])==null?void 0:e.chains),methods:il(u,(t=i[f])==null?void 0:t.methods),events:il(l,(n=i[f])==null?void 0:n.events),rpcMap:Vu(Vu({},h),(s=i[f])==null?void 0:s.rpcMap)})}return i}function uw(r){return r.includes(":")?r.split(":")[2]:r}function lw(r){const e={};for(const[t,n]of Object.entries(r)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=Rp(t)?[t]:n.chains?n.chains:iv(n.accounts);e[t]={chains:a,methods:s,events:i,accounts:o}}return e}function bf(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const ov={},ye=r=>ov[r],vf=(r,e)=>{ov[r]=e};var CF=Object.defineProperty,_F=(r,e,t)=>e in r?CF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wi=(r,e,t)=>_F(r,typeof e!="symbol"?e+"":e,t);class NF{constructor(e){Wi(this,"name","polkadot"),Wi(this,"client"),Wi(this,"httpProviders"),Wi(this,"events"),Wi(this,"namespace"),Wi(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ui(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}}var TF=Object.defineProperty,RF=Object.defineProperties,BF=Object.getOwnPropertyDescriptors,hw=Object.getOwnPropertySymbols,FF=Object.prototype.hasOwnProperty,$F=Object.prototype.propertyIsEnumerable,xd=(r,e,t)=>e in r?TF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fw=(r,e)=>{for(var t in e||(e={}))FF.call(e,t)&&xd(r,t,e[t]);if(hw)for(var t of hw(e))$F.call(e,t)&&xd(r,t,e[t]);return r},dw=(r,e)=>RF(r,BF(e)),Ji=(r,e,t)=>xd(r,typeof e!="symbol"?e+"":e,t);class kF{constructor(e){Ji(this,"name","eip155"),Ji(this,"client"),Ji(this,"chainId"),Ji(this,"namespace"),Ji(this,"httpProviders"),Ji(this,"events"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||rr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=parseInt(Ui(t));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,s;const i=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0];if(!i)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((s=o==null?void 0:o.sessionProperties)==null?void 0:s.capabilities)||{};if(a!=null&&a[i])return a==null?void 0:a[i];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:dw(fw({},o.sessionProperties||{}),{capabilities:dw(fw({},a||{}),{[i]:c})})})}catch(u){console.warn("Failed to update session with capabilities",u)}return c}async getCallStatus(e){var t,n;const s=this.client.session.get(e.topic),i=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Is("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${Q8}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var UF=Object.defineProperty,LF=(r,e,t)=>e in r?UF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Yi=(r,e,t)=>LF(r,typeof e!="symbol"?e+"":e,t);class MF{constructor(e){Yi(this,"name","solana"),Yi(this,"client"),Yi(this,"httpProviders"),Yi(this,"events"),Yi(this,"namespace"),Yi(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ui(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}}var jF=Object.defineProperty,HF=(r,e,t)=>e in r?jF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zi=(r,e,t)=>HF(r,typeof e!="symbol"?e+"":e,t);class zF{constructor(e){Zi(this,"name","cosmos"),Zi(this,"client"),Zi(this,"httpProviders"),Zi(this,"events"),Zi(this,"namespace"),Zi(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ui(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}}var qF=Object.defineProperty,VF=(r,e,t)=>e in r?qF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Xi=(r,e,t)=>VF(r,typeof e!="symbol"?e+"":e,t);class GF{constructor(e){Xi(this,"name","algorand"),Xi(this,"client"),Xi(this,"httpProviders"),Xi(this,"events"),Xi(this,"namespace"),Xi(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||rr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new mr(new Ur(n,ye("disableProviderPing")))}}var KF=Object.defineProperty,QF=(r,e,t)=>e in r?KF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,eo=(r,e,t)=>QF(r,typeof e!="symbol"?e+"":e,t);class WF{constructor(e){eo(this,"name","cip34"),eo(this,"client"),eo(this,"httpProviders"),eo(this,"events"),eo(this,"namespace"),eo(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),s=Ui(t);e[s]=this.createHttpProvider(s,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}}var JF=Object.defineProperty,YF=(r,e,t)=>e in r?JF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,to=(r,e,t)=>YF(r,typeof e!="symbol"?e+"":e,t);class ZF{constructor(e){to(this,"name","elrond"),to(this,"client"),to(this,"httpProviders"),to(this,"events"),to(this,"namespace"),to(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ui(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}}var XF=Object.defineProperty,e$=(r,e,t)=>e in r?XF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ro=(r,e,t)=>e$(r,typeof e!="symbol"?e+"":e,t);class t${constructor(e){ro(this,"name","multiversx"),ro(this,"client"),ro(this,"httpProviders"),ro(this,"events"),ro(this,"namespace"),ro(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ui(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}}var r$=Object.defineProperty,n$=(r,e,t)=>e in r?r$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,no=(r,e,t)=>n$(r,typeof e!="symbol"?e+"":e,t);class s${constructor(e){no(this,"name","near"),no(this,"client"),no(this,"httpProviders"),no(this,"events"),no(this,"namespace"),no(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||rr(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace);return typeof n>"u"?void 0:new mr(new Ur(n,ye("disableProviderPing")))}}var i$=Object.defineProperty,o$=(r,e,t)=>e in r?i$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,so=(r,e,t)=>o$(r,typeof e!="symbol"?e+"":e,t);class a${constructor(e){so(this,"name","tezos"),so(this,"client"),so(this,"httpProviders"),so(this,"events"),so(this,"namespace"),so(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||rr(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace);return typeof n>"u"?void 0:new mr(new Ur(n))}}var c$=Object.defineProperty,u$=(r,e,t)=>e in r?c$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,io=(r,e,t)=>u$(r,typeof e!="symbol"?e+"":e,t);class l${constructor(e){io(this,"name",ho),io(this,"client"),io(this,"httpProviders"),io(this,"events"),io(this,"namespace"),io(this,"chainId"),this.namespace=e.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(wr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{const i=So(s);n[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||rr(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new mr(new Ur(n,ye("disableProviderPing")))}}var h$=Object.defineProperty,f$=Object.defineProperties,d$=Object.getOwnPropertyDescriptors,pw=Object.getOwnPropertySymbols,p$=Object.prototype.hasOwnProperty,g$=Object.prototype.propertyIsEnumerable,Od=(r,e,t)=>e in r?h$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gu=(r,e)=>{for(var t in e||(e={}))p$.call(e,t)&&Od(r,t,e[t]);if(pw)for(var t of pw(e))g$.call(e,t)&&Od(r,t,e[t]);return r},Ef=(r,e)=>f$(r,d$(e)),ir=(r,e,t)=>Od(r,typeof e!="symbol"?e+"":e,t);let y$=class av{constructor(e){ir(this,"client"),ir(this,"namespaces"),ir(this,"optionalNamespaces"),ir(this,"sessionProperties"),ir(this,"scopedProperties"),ir(this,"events",new yp),ir(this,"rpcProviders",{}),ir(this,"session"),ir(this,"providerOpts"),ir(this,"logger"),ir(this,"uri"),ir(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Au(fh({level:(e==null?void 0:e.logger)||rw})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new av(e);return await t.initialize(),t}async request(e,t,n){const[s,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Gu({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>t(null,dh(i,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:we("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=lw(this.session.namespaces);this.namespaces=wf(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const s=await n();this.session=s;const i=lw(s.namespaces);return this.namespaces=wf(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,s]=this.validateChain(e),i=this.getProvider(n);i.name===ho?i.setDefaultChain(`${n}:${s}`,t):i.setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Fr(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await $8.init({core:this.providerOpts.core,logger:this.providerOpts.logger||rw,relayUrl:this.providerOpts.relayUrl||V8,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>ac(t)))];vf("client",this.client),vf("events",this.events),vf("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=DF(t,this.session),s=iv(n),i=wf(this.namespaces,this.optionalNamespaces),o=Ef(Gu({},i[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new kF({namespace:o});break;case"algorand":this.rpcProviders[t]=new GF({namespace:o});break;case"solana":this.rpcProviders[t]=new MF({namespace:o});break;case"cosmos":this.rpcProviders[t]=new zF({namespace:o});break;case"polkadot":this.rpcProviders[t]=new NF({namespace:o});break;case"cip34":this.rpcProviders[t]=new WF({namespace:o});break;case"elrond":this.rpcProviders[t]=new ZF({namespace:o});break;case"multiversx":this.rpcProviders[t]=new t$({namespace:o});break;case"near":this.rpcProviders[t]=new s$({namespace:o});break;case"tezos":this.rpcProviders[t]=new a$({namespace:o});break;default:this.rpcProviders[ho]?this.rpcProviders[ho].updateNamespace(o):this.rpcProviders[ho]=new l$({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:n}=e;n===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:n,topic:s}=e;if(s!==((t=this.session)==null?void 0:t.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&Fr(o)&&this.events.emit("accountsChanged",o.map(uw))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=ac(o),u=bf(o)!==bf(a)?`${c}:${bf(a)}`:o;this.onChainChanged(u)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=t,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Ef(Gu({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ef(Gu({},we("USER_DISCONNECTED")),{data:e.topic})))}),this.on(wr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[ho]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:s,scopedProperties:i}=e;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[t,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(o=>ac(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=ac(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(n,s),this.events.emit("chainChanged",s);const i=this.getProvider(n).getDefaultChain();t||this.getProvider(n).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:n}){var s,i;try{if(t===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(uw);if(!Fr(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,s={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${qu}/${e}${s}`,t)}async getFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${qu}/${e}${n}`)}async deleteFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${qu}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const n of t)n.startsWith(qu)&&await this.client.core.storage.removeItem(n)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}};const m$=y$,w$="wc",b$="ethereum_provider",v$=`${w$}@2:${b$}:`,E$="https://rpc.walletconnect.org/v1/",Sd=["eth_sendTransaction","personal_sign"],A$=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],Dd=["chainChanged","accountsChanged"],I$=["chainChanged","accountsChanged","message","disconnect","connect"];var P$=Object.defineProperty,x$=Object.defineProperties,O$=Object.getOwnPropertyDescriptors,gw=Object.getOwnPropertySymbols,S$=Object.prototype.hasOwnProperty,D$=Object.prototype.propertyIsEnumerable,Cd=(r,e,t)=>e in r?P$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,fo=(r,e)=>{for(var t in e||(e={}))S$.call(e,t)&&Cd(r,t,e[t]);if(gw)for(var t of gw(e))D$.call(e,t)&&Cd(r,t,e[t]);return r},Af=(r,e)=>x$(r,O$(e)),Vt=(r,e,t)=>Cd(r,typeof e!="symbol"?e+"":e,t);function Tl(r){return Number(r[0].split(":")[1])}function Ku(r){return`0x${r.toString(16)}`}function C$(r){const{chains:e,optionalChains:t,methods:n,optionalMethods:s,events:i,optionalEvents:o,rpcMap:a}=r;if(!Fr(e))throw new Error("Invalid chains");const c={chains:e,methods:n||Sd,events:i||Dd,rpcMap:fo({},e.length?{[Tl(e)]:a[Tl(e)]}:{})},u=i==null?void 0:i.filter(d=>!Dd.includes(d)),l=n==null?void 0:n.filter(d=>!Sd.includes(d));if(!t&&!o&&!s&&!(u!=null&&u.length)&&!(l!=null&&l.length))return{required:e.length?c:void 0};const h=(u==null?void 0:u.length)&&(l==null?void 0:l.length)||!t,f={chains:[...new Set(h?c.chains.concat(t||[]):t)],methods:[...new Set(c.methods.concat(s!=null&&s.length?s:A$))],events:[...new Set(c.events.concat(o!=null&&o.length?o:I$))],rpcMap:a};return{required:e.length?c:void 0,optional:t.length?f:void 0}}class jp{constructor(){Vt(this,"events",new nr.EventEmitter),Vt(this,"namespace","eip155"),Vt(this,"accounts",[]),Vt(this,"signer"),Vt(this,"chainId",1),Vt(this,"modal"),Vt(this,"rpc"),Vt(this,"STORAGE_KEY",v$),Vt(this,"on",(e,t)=>(this.events.on(e,t),this)),Vt(this,"once",(e,t)=>(this.events.once(e,t),this)),Vt(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),Vt(this,"off",(e,t)=>(this.events.off(e,t),this)),Vt(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){const t=new jp;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,n){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),n)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:n}=C$(this.rpc);try{const s=await new Promise(async(o,a)=>{var c;this.rpc.showQrModal&&((c=this.modal)==null||c.subscribeModal(l=>{!l.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))}));const u=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(Af(fo({namespaces:fo({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:e==null?void 0:e.pairingTopic,scopedProperties:u})).then(l=>{o(l)}).catch(l=>{a(new Error(l.message))})});if(!s)return;const i=dy(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:i),this.setAccounts(i),this.events.emit("connect",{chainId:Ku(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const n=await new Promise(async(i,o)=>{var a;this.rpc.showQrModal&&((a=this.modal)==null||a.subscribeModal(c=>{!c.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),o(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Af(fo({},e),{chains:this.rpc.chains}),t).then(c=>{i(c)}).catch(c=>{o(new Error(c.message))})}),s=n.session;if(s){const i=dy(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:i),this.setAccounts(i),this.events.emit("connect",{chainId:Ku(this.chainId)})}return n}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Ku(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Af(fo({},we("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Ku(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,n,s]=e.split(":");return{chainId:`${t}:${n}`,address:s}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,n;const s=(t=e==null?void 0:e.chains)!=null?t:[],i=(n=e==null?void 0:e.optionalChains)!=null?n:[],o=s.concat(i);if(!o.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const a=s.length?(e==null?void 0:e.methods)||Sd:[],c=s.length?(e==null?void 0:e.events)||Dd:[],u=(e==null?void 0:e.optionalMethods)||[],l=(e==null?void 0:e.optionalEvents)||[],h=(e==null?void 0:e.rpcMap)||this.buildRpcMap(o,e.projectId),f=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(d=>this.formatChainId(d)),optionalChains:i.map(d=>this.formatChainId(d)),methods:a,events:c,optionalMethods:u,optionalEvents:l,rpcMap:h,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:f,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const n={};return e.forEach(s=>{n[s]=this.getRpcUrl(s,t)}),n}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Tl(this.rpc.chains):Tl(this.rpc.optionalChains),this.signer=await m$.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await C0(()=>import("./index-4e9777d2.js").then(s=>s.i),[]);t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(fo({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:n,rpcMap:s}=e;t&&Fr(t)&&(this.rpc.chains=t.map(i=>this.formatChainId(i)),t.forEach(i=>{this.rpc.rpcMap[i]=(s==null?void 0:s[i])||this.getRpcUrl(i)})),n&&Fr(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(i=>this.formatChainId(i)),n.forEach(i=>{this.rpc.rpcMap[i]=(s==null?void 0:s[i])||this.getRpcUrl(i)}))}getRpcUrl(e,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[e])||`${E$}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(t=>this.signer.logger.warn(t))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const _$=jp,N$="6.13.5";function T$(r,e,t){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function Pt(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,i)=>(n[e[i]]=s,n),{})}function te(r,e,t){for(let n in e){let s=e[n];const i=t?t[n]:null;i&&T$(s,i,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function bo(r){if(r==null)return"null";if(Array.isArray(r))return"[ "+r.map(bo).join(", ")+" ]";if(r instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let n=0;n<r.length;n++)t+=e[r[n]>>4],t+=e[r[n]&15];return t}if(typeof r=="object"&&typeof r.toJSON=="function")return bo(r.toJSON());switch(typeof r){case"boolean":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"number":return r.toString();case"string":return JSON.stringify(r);case"object":{const e=Object.keys(r);return e.sort(),"{ "+e.map(t=>`${bo(t)}: ${bo(r[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function lt(r,e){return r&&r.code===e}function Hp(r){return lt(r,"CALL_EXCEPTION")}function Re(r,e,t){let n=r;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${bo(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+bo(a))}}i.push(`code=${e}`),i.push(`version=${N$}`),i.length&&(r+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return te(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&te(s,{shortMessage:n}),s}function L(r,e,t,n){if(!r)throw Re(e,t,n)}function O(r,e,t,n){L(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function cv(r,e,t){t==null&&(t=""),t&&(t=": "+t),L(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),L(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}const R$=["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"){const t=String.fromCharCode(233).normalize("NFD"),n=String.fromCharCode(101,769);if(t!==n)throw new Error("broken")}r.push(e)}catch{}return r},[]);function B$(r){L(R$.indexOf(r)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:r}})}function xu(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),L(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function uv(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let i=0;i<n.length;i++)n[i]=parseInt(r.substring(s,s+2),16),s+=2;return n}O(!1,"invalid BytesLike value",e||"value",r)}function he(r,e){return uv(r,e,!1)}function xt(r,e){return uv(r,e,!0)}function Oe(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function zp(r){return Oe(r,!0)||r instanceof Uint8Array}const yw="0123456789abcdef";function Z(r){const e=he(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=yw[(s&240)>>4]+yw[s&15]}return t}function Me(r){return"0x"+r.map(e=>Z(e).substring(2)).join("")}function Do(r){return Oe(r,!0)?(r.length-2)/2:he(r).length}function Be(r,e,t){const n=he(r);return t!=null&&t>n.length&&L(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),Z(n.slice(e??0,t??n.length))}function lv(r,e,t){const n=he(r);L(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),Z(s)}function Di(r,e){return lv(r,e,!0)}function F$(r,e){return lv(r,e,!1)}const wh=BigInt(0),Rr=BigInt(1),vo=9007199254740991;function Rl(r,e){const t=bh(r,"value"),n=BigInt(ie(e,"width"));if(L(t>>n===wh,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-Rr){const s=(Rr<<n)-Rr;return-((~t&s)+Rr)}return t}function hv(r,e){let t=X(r,"value");const n=BigInt(ie(e,"width")),s=Rr<<n-Rr;if(t<wh){t=-t,L(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const i=(Rr<<n)-Rr;return(~t&i)+Rr}else L(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function Qs(r,e){const t=bh(r,"value"),n=BigInt(ie(e,"bits"));return t&(Rr<<n)-Rr}function X(r,e){switch(typeof r){case"bigint":return r;case"number":return O(Number.isInteger(r),"underflow",e||"value",r),O(r>=-vo&&r<=vo,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){O(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}O(!1,"invalid BigNumberish value",e||"value",r)}function bh(r,e){const t=X(r,e);return L(t>=wh,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const mw="0123456789abcdef";function vh(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=mw[t>>4],e+=mw[t&15];return BigInt(e)}return X(r)}function ie(r,e){switch(typeof r){case"bigint":return O(r>=-vo&&r<=vo,"overflow",e||"value",r),Number(r);case"number":return O(Number.isInteger(r),"underflow",e||"value",r),O(r>=-vo&&r<=vo,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return ie(BigInt(r),e)}catch(t){O(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}O(!1,"invalid numeric value",e||"value",r)}function $$(r){return ie(vh(r))}function Os(r,e){let n=bh(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=ie(e,"width");for(L(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function Ot(r){const e=bh(r,"value");if(e===wh)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const i=s*2;n[s]=parseInt(t.substring(i,i+2),16)}return n}function Eo(r){let e=Z(zp(r)?r:Ot(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const ww="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const bw=BigInt(58);function k$(r){const e=he(r);let t=vh(e),n="";for(;t;)n=ww[Number(t%bw)]+n,t/=bw;for(let s=0;s<e.length&&!e[s];s++)n=ww[0]+n;return n}function U$(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return he(e)}function L$(r){const e=he(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var Ro;class fv{constructor(e,t,n){B(this,"filter");B(this,"emitter");F(this,Ro,void 0);I(this,Ro,t),te(this,{emitter:e,filter:n})}async removeListener(){y(this,Ro)!=null&&await this.emitter.off(this.filter,y(this,Ro))}}Ro=new WeakMap;function M$(r,e,t,n,s){O(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function dv(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return r==="OVERRUN"?t.length-e-1:0}function j$(r,e,t,n,s){return r==="OVERLONG"?(O(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),dv(r,e,t))}const H$=Object.freeze({error:M$,ignore:dv,replace:j$});function z$(r,e){e==null&&(e=H$.error);const t=he(r,"bytes"),n=[];let s=0;for(;s<t.length;){const i=t[s++];if(!(i>>7)){n.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let c=i&(1<<8-o-1)-1;for(let u=0;u<o;u++){let l=t[s];if((l&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),c=null;break}c=c<<6|l&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,n,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,n,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,t,n,c);continue}n.push(c)}}return n}function Hn(r,e){O(typeof r=="string","invalid string value","str",r),e!=null&&(B$(e),r=r.normalize(e));let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const i=r.charCodeAt(n);O(n<r.length&&(i&64512)===56320,"invalid surrogate pair","str",r);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function q$(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function Bl(r,e){return q$(z$(r,e))}function pv(r){async function e(t,n){L(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();L(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),L(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=Re("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=Re("request cancelled","CANCELLED"),o.abort()});const c={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal};let u;try{u=await fetch(t.url,c)}catch(d){throw clearTimeout(a),i||d}clearTimeout(a);const l={};u.headers.forEach((d,p)=>{l[p.toLowerCase()]=d});const h=await u.arrayBuffer(),f=h==null?null:new Uint8Array(h);return{statusCode:u.status,statusMessage:u.statusText,headers:l,body:f}}return e}const V$=12,G$=250;let vw=pv();const K$=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Q$=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let If=!1;async function gv(r,e){try{const t=r.match(K$);if(!t)throw new Error("invalid data");return new xs(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?U$(t[3]):J$(t[3]))}catch{return new xs(599,"BAD REQUEST (invalid data: URI)",{},null,new Ss(r))}}function yv(r){async function e(t,n){try{const s=t.match(Q$);if(!s)throw new Error("invalid link");return new Ss(`${r}${s[2]}`)}catch{return new xs(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Ss(t))}}return e}const Qu={data:gv,ipfs:yv("https://gateway.ipfs.io/ipfs/")},mv=new WeakMap;var Zs,is;class W${constructor(e){F(this,Zs,void 0);F(this,is,void 0);I(this,Zs,[]),I(this,is,!1),mv.set(e,()=>{if(!y(this,is)){I(this,is,!0);for(const t of y(this,Zs))setTimeout(()=>{t()},0);I(this,Zs,[])}})}addListener(e){L(!y(this,is),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),y(this,Zs).push(e)}get cancelled(){return y(this,is)}checkSignal(){L(!this.cancelled,"cancelled","CANCELLED",{})}}Zs=new WeakMap,is=new WeakMap;function Wu(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var Bo,Fo,Sr,Pn,$o,ko,Ye,Wt,xn,Xs,ei,ti,Qr,Dr,os,ri,uc;const Gl=class Gl{constructor(e){F(this,ri);F(this,Bo,void 0);F(this,Fo,void 0);F(this,Sr,void 0);F(this,Pn,void 0);F(this,$o,void 0);F(this,ko,void 0);F(this,Ye,void 0);F(this,Wt,void 0);F(this,xn,void 0);F(this,Xs,void 0);F(this,ei,void 0);F(this,ti,void 0);F(this,Qr,void 0);F(this,Dr,void 0);F(this,os,void 0);I(this,ko,String(e)),I(this,Bo,!1),I(this,Fo,!0),I(this,Sr,{}),I(this,Pn,""),I(this,$o,3e5),I(this,Dr,{slotInterval:G$,maxAttempts:V$}),I(this,os,null)}get url(){return y(this,ko)}set url(e){I(this,ko,String(e))}get body(){return y(this,Ye)==null?null:new Uint8Array(y(this,Ye))}set body(e){if(e==null)I(this,Ye,void 0),I(this,Wt,void 0);else if(typeof e=="string")I(this,Ye,Hn(e)),I(this,Wt,"text/plain");else if(e instanceof Uint8Array)I(this,Ye,e),I(this,Wt,"application/octet-stream");else if(typeof e=="object")I(this,Ye,Hn(JSON.stringify(e))),I(this,Wt,"application/json");else throw new Error("invalid body")}hasBody(){return y(this,Ye)!=null}get method(){return y(this,Pn)?y(this,Pn):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),I(this,Pn,String(e).toUpperCase())}get headers(){const e=Object.assign({},y(this,Sr));return y(this,xn)&&(e.authorization=`Basic ${L$(Hn(y(this,xn)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&y(this,Wt)&&(e["content-type"]=y(this,Wt)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){y(this,Sr)[String(e).toLowerCase()]=String(t)}clearHeaders(){I(this,Sr,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return y(this,xn)||null}setCredentials(e,t){O(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),I(this,xn,`${e}:${t}`)}get allowGzip(){return y(this,Fo)}set allowGzip(e){I(this,Fo,!!e)}get allowInsecureAuthentication(){return!!y(this,Bo)}set allowInsecureAuthentication(e){I(this,Bo,!!e)}get timeout(){return y(this,$o)}set timeout(e){O(e>=0,"timeout must be non-zero","timeout",e),I(this,$o,e)}get preflightFunc(){return y(this,Xs)||null}set preflightFunc(e){I(this,Xs,e)}get processFunc(){return y(this,ei)||null}set processFunc(e){I(this,ei,e)}get retryFunc(){return y(this,ti)||null}set retryFunc(e){I(this,ti,e)}get getUrlFunc(){return y(this,os)||vw}set getUrlFunc(e){I(this,os,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${y(this,Ye)?Z(y(this,Ye)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(y(this,Dr).slotInterval=e.slotInterval),e.maxAttempts!=null&&(y(this,Dr).maxAttempts=e.maxAttempts)}send(){return L(y(this,Qr)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),I(this,Qr,new W$(this)),j(this,ri,uc).call(this,0,Ew()+this.timeout,0,this,new xs(0,"",{},null,this))}cancel(){L(y(this,Qr)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=mv.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();L(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Gl(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,I(s,Sr,Object.assign({},y(this,Sr))),y(this,Ye)&&I(s,Ye,new Uint8Array(y(this,Ye))),I(s,Wt,y(this,Wt)),s}clone(){const e=new Gl(this.url);return I(e,Pn,y(this,Pn)),y(this,Ye)&&I(e,Ye,y(this,Ye)),I(e,Wt,y(this,Wt)),I(e,Sr,Object.assign({},y(this,Sr))),I(e,xn,y(this,xn)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),I(e,Xs,y(this,Xs)),I(e,ei,y(this,ei)),I(e,ti,y(this,ti)),I(e,Dr,Object.assign({},y(this,Dr))),I(e,os,y(this,os)),e}static lockConfig(){If=!0}static getGateway(e){return Qu[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(If)throw new Error("gateways locked");Qu[e]=t}static registerGetUrl(e){if(If)throw new Error("gateways locked");vw=e}static createGetUrlFunc(e){return pv()}static createDataGateway(){return gv}static createIpfsGatewayFunc(e){return yv(e)}};Bo=new WeakMap,Fo=new WeakMap,Sr=new WeakMap,Pn=new WeakMap,$o=new WeakMap,ko=new WeakMap,Ye=new WeakMap,Wt=new WeakMap,xn=new WeakMap,Xs=new WeakMap,ei=new WeakMap,ti=new WeakMap,Qr=new WeakMap,Dr=new WeakMap,os=new WeakMap,ri=new WeakSet,uc=async function(e,t,n,s,i){var l,h,f;if(e>=y(this,Dr).maxAttempts)return i.makeServerError("exceeded maximum retry limit");L(Ew()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await Y$(n);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in Qu){const d=await Qu[a](o.url,Wu(y(s,Qr)));if(d instanceof xs){let p=d;if(this.processFunc){Wu(y(s,Qr));try{p=await this.processFunc(o,p)}catch(g){(g.throttle==null||typeof g.stall!="number")&&p.makeServerError("error in post-processing function",g).assertOk()}}return p}o=d}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,Wu(y(s,Qr)));let u=new xs(c.statusCode,c.statusMessage,c.headers,c.body,s);if(u.statusCode===301||u.statusCode===302){try{const d=u.headers.location||"";return j(l=o.redirect(d),ri,uc).call(l,e+1,t,0,s,u)}catch{}return u}else if(u.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,u,e))){const d=u.headers["retry-after"];let p=y(this,Dr).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof d=="string"&&d.match(/^[1-9][0-9]*$/)&&(p=parseInt(d)),j(h=o.clone(),ri,uc).call(h,e+1,t,p,s,u)}if(this.processFunc){Wu(y(s,Qr));try{u=await this.processFunc(o,u)}catch(d){(d.throttle==null||typeof d.stall!="number")&&u.makeServerError("error in post-processing function",d).assertOk();let p=y(this,Dr).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return d.stall>=0&&(p=d.stall),j(f=o.clone(),ri,uc).call(f,e+1,t,p,s,u)}}return u};let Ss=Gl;var Hc,zc,qc,Jt,Uo,ni;const lg=class lg{constructor(e,t,n,s,i){F(this,Hc,void 0);F(this,zc,void 0);F(this,qc,void 0);F(this,Jt,void 0);F(this,Uo,void 0);F(this,ni,void 0);I(this,Hc,e),I(this,zc,t),I(this,qc,Object.keys(n).reduce((o,a)=>(o[a.toLowerCase()]=String(n[a]),o),{})),I(this,Jt,s==null?null:new Uint8Array(s)),I(this,Uo,i||null),I(this,ni,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${y(this,Jt)?Z(y(this,Jt)):"null"}>`}get statusCode(){return y(this,Hc)}get statusMessage(){return y(this,zc)}get headers(){return Object.assign({},y(this,qc))}get body(){return y(this,Jt)==null?null:new Uint8Array(y(this,Jt))}get bodyText(){try{return y(this,Jt)==null?"":Bl(y(this,Jt))}catch{L(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{L(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new lg(599,n,this.headers,this.body,y(this,Uo)||void 0);return I(s,ni,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:O(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw te(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return y(this,Jt)!=null}get request(){return y(this,Uo)}ok(){return y(this,ni).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=y(this,ni);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{y(this,Jt)&&(s=Bl(y(this,Jt)))}catch{}L(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Hc=new WeakMap,zc=new WeakMap,qc=new WeakMap,Jt=new WeakMap,Uo=new WeakMap,ni=new WeakMap;let xs=lg;function Ew(){return new Date().getTime()}function J$(r){return Hn(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function Y$(r){return new Promise(e=>setTimeout(e,r))}const Z$=BigInt(-1),Pr=BigInt(0),Ao=BigInt(1),X$=BigInt(5),oo={};let Co="0000";for(;Co.length<80;)Co+=Co;function Bs(r){let e=Co;for(;e.length<r;)e+=e;return BigInt("1"+e.substring(0,r))}function nc(r,e,t){const n=BigInt(e.width);if(e.signed){const s=Ao<<n-Ao;L(t==null||r>=-s&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r>Pr?r=Rl(Qs(r,n),n):r=-Rl(Qs(-r,n),n)}else{const s=Ao<<n;L(t==null||r>=0&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r=(r%s+s)%s&s-Ao}return r}function Pf(r){typeof r=="number"&&(r=`fixed128x${r}`);let e=!0,t=128,n=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")e=!1;else{const i=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);O(i,"invalid fixed format","format",r),e=i[1]!=="u",t=parseInt(i[2]),n=parseInt(i[3])}}else if(r){const i=r,o=(a,c,u)=>i[a]==null?u:(O(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),n=o("decimals","number",n)}O(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),O(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function ek(r,e){let t="";r<Pr&&(t="-",r*=Z$);let n=r.toString();if(e===0)return t+n;for(;n.length<=e;)n=Co+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var Cr,be,Et,On,$s,_r,wn,Vc,Nd,Gc,Td,Kc,Rd,Qc,Bd;const ns=class ns{constructor(e,t,n){F(this,On);F(this,_r);F(this,Vc);F(this,Gc);F(this,Kc);F(this,Qc);B(this,"format");F(this,Cr,void 0);F(this,be,void 0);F(this,Et,void 0);B(this,"_value");xu(e,oo,"FixedNumber"),I(this,be,t),I(this,Cr,n);const s=ek(t,n.decimals);te(this,{format:n.name,_value:s}),I(this,Et,Bs(n.decimals))}get signed(){return y(this,Cr).signed}get width(){return y(this,Cr).width}get decimals(){return y(this,Cr).decimals}get value(){return y(this,be)}addUnsafe(e){return j(this,Vc,Nd).call(this,e)}add(e){return j(this,Vc,Nd).call(this,e,"add")}subUnsafe(e){return j(this,Gc,Td).call(this,e)}sub(e){return j(this,Gc,Td).call(this,e,"sub")}mulUnsafe(e){return j(this,Kc,Rd).call(this,e)}mul(e){return j(this,Kc,Rd).call(this,e,"mul")}mulSignal(e){j(this,On,$s).call(this,e);const t=y(this,be)*y(e,be);return L(t%y(this,Et)===Pr,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),j(this,_r,wn).call(this,t/y(this,Et),"mulSignal")}divUnsafe(e){return j(this,Qc,Bd).call(this,e)}div(e){return j(this,Qc,Bd).call(this,e,"div")}divSignal(e){L(y(e,be)!==Pr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),j(this,On,$s).call(this,e);const t=y(this,be)*y(this,Et);return L(t%y(e,be)===Pr,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),j(this,_r,wn).call(this,t/y(e,be),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=Bs(s):s<0&&(t*=Bs(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=y(this,be);return y(this,be)<Pr&&(e-=y(this,Et)-Ao),e=y(this,be)/y(this,Et)*y(this,Et),j(this,_r,wn).call(this,e,"floor")}ceiling(){let e=y(this,be);return y(this,be)>Pr&&(e+=y(this,Et)-Ao),e=y(this,be)/y(this,Et)*y(this,Et),j(this,_r,wn).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=X$*Bs(t-1);let s=this.value+n;const i=Bs(t);return s=s/i*i,nc(s,y(this,Cr),"round"),new ns(oo,s,y(this,Cr))}isZero(){return y(this,be)===Pr}isNegative(){return y(this,be)<Pr}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return ns.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:ie(t),i=Pf(n);let o=X(e,"value");const a=s-i.decimals;if(a>0){const c=Bs(a);L(o%c===Pr,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=Bs(-a));return nc(o,i,"fromValue"),new ns(oo,o,i)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);O(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=Pf(t);let i=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=Co;L(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(n[1]+i+o);return nc(a,s,"fromString"),new ns(oo,a,s)}static fromBytes(e,t){let n=vh(he(e,"value"));const s=Pf(t);return s.signed&&(n=Rl(n,s.width)),nc(n,s,"fromBytes"),new ns(oo,n,s)}};Cr=new WeakMap,be=new WeakMap,Et=new WeakMap,On=new WeakSet,$s=function(e){O(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},_r=new WeakSet,wn=function(e,t){return e=nc(e,y(this,Cr),t),new ns(oo,e,y(this,Cr))},Vc=new WeakSet,Nd=function(e,t){return j(this,On,$s).call(this,e),j(this,_r,wn).call(this,y(this,be)+y(e,be),t)},Gc=new WeakSet,Td=function(e,t){return j(this,On,$s).call(this,e),j(this,_r,wn).call(this,y(this,be)-y(e,be),t)},Kc=new WeakSet,Rd=function(e,t){return j(this,On,$s).call(this,e),j(this,_r,wn).call(this,y(this,be)*y(e,be)/y(this,Et),t)},Qc=new WeakSet,Bd=function(e,t){return L(y(e,be)!==Pr,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),j(this,On,$s).call(this,e),j(this,_r,wn).call(this,y(this,be)*y(this,Et)/y(e,be),t)};let _d=ns;function tk(r){let e=r.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function Aw(r,e,t){let n=0;for(let s=0;s<t;s++)n=n*256+r[e+s];return n}function Iw(r,e,t,n){const s=[];for(;t<e+1+n;){const i=wv(r,t);s.push(i.result),t+=i.consumed,L(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:r,length:n,offset:e})}return{consumed:1+n,result:s}}function wv(r,e){L(r.length!==0,"data too short","BUFFER_OVERRUN",{buffer:r,length:0,offset:1});const t=n=>{L(n<=r.length,"data short segment too short","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n})};if(r[e]>=248){const n=r[e]-247;t(e+1+n);const s=Aw(r,e+1,n);return t(e+1+n+s),Iw(r,e,e+1+n,n+s)}else if(r[e]>=192){const n=r[e]-192;return t(e+1+n),Iw(r,e,e+1,n)}else if(r[e]>=184){const n=r[e]-183;t(e+1+n);const s=Aw(r,e+1,n);t(e+1+n+s);const i=Z(r.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:i}}else if(r[e]>=128){const n=r[e]-128;t(e+1+n);const s=Z(r.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:tk(r[e])}}function Eh(r){const e=he(r,"data"),t=wv(e,0);return O(t.consumed===e.length,"unexpected junk after rlp payload","data",r),t.result}function Pw(r){const e=[];for(;r;)e.unshift(r&255),r>>=8;return e}function bv(r){if(Array.isArray(r)){let n=[];if(r.forEach(function(i){n=n.concat(bv(i))}),n.length<=55)return n.unshift(192+n.length),n;const s=Pw(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call(he(r,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=Pw(e.length);return t.unshift(183+t.length),t.concat(e)}const xw="0123456789abcdef";function Ci(r){let e="0x";for(const t of bv(r))e+=xw[t>>4],e+=xw[t&15];return e}const rk=["wei","kwei","mwei","gwei","szabo","finney","ether"];function nk(r,e){O(typeof r=="string","value must be a string","value",r);let t=18;if(typeof e=="string"){const n=rk.indexOf(e);O(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=ie(e,"unit"));return _d.fromString(r,{decimals:t,width:512}).value}function sk(r){return nk(r,18)}const St=32,Fd=new Uint8Array(St),ik=["then"],Ju={},vv=new WeakMap;function Hs(r){return vv.get(r)}function Ow(r,e){vv.set(r,e)}function sc(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function $d(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof Da?$d(Hs(n),n,t):n):r.reduce((n,s,i)=>{let o=e.getValue(s);return s in n||(t&&o instanceof Da&&(o=$d(Hs(o),o,t)),n[s]=o),n},{})}var Lo;const Io=class Io extends Array{constructor(...t){const n=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;n!==Ju&&(s=t,i=[],o=!1);super(s.length);F(this,Lo,void 0);s.forEach((u,l)=>{this[l]=u});const a=i.reduce((u,l)=>(typeof l=="string"&&u.set(l,(u.get(l)||0)+1),u),new Map);if(Ow(this,Object.freeze(s.map((u,l)=>{const h=i[l];return h!=null&&a.get(h)===1?h:null}))),I(this,Lo,[]),y(this,Lo)==null&&y(this,Lo),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(u,l,h)=>{if(typeof l=="string"){if(l.match(/^[0-9]+$/)){const d=ie(l,"%index");if(d<0||d>=this.length)throw new RangeError("out of result range");const p=u[d];return p instanceof Error&&sc(`index ${d}`,p),p}if(ik.indexOf(l)>=0)return Reflect.get(u,l,h);const f=u[l];if(f instanceof Function)return function(...d){return f.apply(this===h?u:this,d)};if(!(l in u))return u.getValue.apply(this===h?u:this,[l])}return Reflect.get(u,l,h)}});return Ow(c,Hs(this)),c}toArray(t){const n=[];return this.forEach((s,i)=>{s instanceof Error&&sc(`index ${i}`,s),t&&s instanceof Io&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=Hs(this);return n.reduce((s,i,o)=>(L(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),$d(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=Hs(this),i=[],o=[];for(let a=t;a<n;a++)i.push(this[a]),o.push(s[a]);return new Io(Ju,i,o)}filter(t,n){const s=Hs(this),i=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&sc(`index ${a}`,c),t.call(n,c,a,this)&&(i.push(c),o.push(s[a]))}return new Io(Ju,i,o)}map(t,n){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&sc(`index ${i}`,o),s.push(t.call(n,o,i,this))}return s}getValue(t){const n=Hs(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&sc(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new Io(Ju,t,n)}};Lo=new WeakMap;let Da=Io;function Sw(r){let e=Ot(r);return L(e.length<=St,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:St,offset:e.length}),e.length!==St&&(e=xt(Me([Fd.slice(e.length%St),e]))),e}class Gn{constructor(e,t,n,s){B(this,"name");B(this,"type");B(this,"localName");B(this,"dynamic");te(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){O(!1,e,this.localName,t)}}var Sn,si,Mo,fl;class kd{constructor(){F(this,Mo);F(this,Sn,void 0);F(this,si,void 0);I(this,Sn,[]),I(this,si,0)}get data(){return Me(y(this,Sn))}get length(){return y(this,si)}appendWriter(e){return j(this,Mo,fl).call(this,xt(e.data))}writeBytes(e){let t=xt(e);const n=t.length%St;return n&&(t=xt(Me([t,Fd.slice(n)]))),j(this,Mo,fl).call(this,t)}writeValue(e){return j(this,Mo,fl).call(this,Sw(e))}writeUpdatableValue(){const e=y(this,Sn).length;return y(this,Sn).push(Fd),I(this,si,y(this,si)+St),t=>{y(this,Sn)[e]=Sw(t)}}}Sn=new WeakMap,si=new WeakMap,Mo=new WeakSet,fl=function(e){return y(this,Sn).push(e),I(this,si,y(this,si)+e.length),e.length};var $t,Yt,ii,oi,as,Wc,Ld,Kl,Ev;const hg=class hg{constructor(e,t,n){F(this,Wc);F(this,Kl);B(this,"allowLoose");F(this,$t,void 0);F(this,Yt,void 0);F(this,ii,void 0);F(this,oi,void 0);F(this,as,void 0);te(this,{allowLoose:!!t}),I(this,$t,xt(e)),I(this,ii,0),I(this,oi,null),I(this,as,n??1024),I(this,Yt,0)}get data(){return Z(y(this,$t))}get dataLength(){return y(this,$t).length}get consumed(){return y(this,Yt)}get bytes(){return new Uint8Array(y(this,$t))}subReader(e){const t=new hg(y(this,$t).slice(y(this,Yt)+e),this.allowLoose,y(this,as));return I(t,oi,this),t}readBytes(e,t){let n=j(this,Kl,Ev).call(this,0,e,!!t);return j(this,Wc,Ld).call(this,e),I(this,Yt,y(this,Yt)+n.length),n.slice(0,e)}readValue(){return vh(this.readBytes(St))}readIndex(){return $$(this.readBytes(St))}};$t=new WeakMap,Yt=new WeakMap,ii=new WeakMap,oi=new WeakMap,as=new WeakMap,Wc=new WeakSet,Ld=function(e){var t;if(y(this,oi))return j(t=y(this,oi),Wc,Ld).call(t,e);I(this,ii,y(this,ii)+e),L(y(this,as)<1||y(this,ii)<=y(this,as)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${y(this,as)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:xt(y(this,$t)),offset:y(this,Yt),length:e,info:{bytesRead:y(this,ii),dataLength:this.dataLength}})},Kl=new WeakSet,Ev=function(e,t,n){let s=Math.ceil(t/St)*St;return y(this,Yt)+s>y(this,$t).length&&(this.allowLoose&&n&&y(this,Yt)+t<=y(this,$t).length?s=t:L(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:xt(y(this,$t)),length:y(this,$t).length,offset:y(this,Yt)+s})),y(this,$t).slice(y(this,Yt),y(this,Yt)+s)};let Ud=hg;function Fl(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function qp(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function ok(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Fl(r.outputLen),Fl(r.blockLen)}function Ca(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Av(r,e){qp(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const xf=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Iv=r=>r instanceof Uint8Array,ak=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),Of=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),qr=(r,e)=>r<<32-e|r>>>e,ck=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ck)throw new Error("Non little-endian hardware is not supported");function uk(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Ah(r){if(typeof r=="string"&&(r=uk(r)),!Iv(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function lk(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!Iv(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class Vp{clone(){return this._cloneInto()}}function Gp(r){const e=n=>r().update(Ah(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function hk(r=32){if(xf&&typeof xf.getRandomValues=="function")return xf.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class Pv extends Vp{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ok(e);const n=Ah(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Ca(this),this.iHash.update(e),this}digestInto(e){Ca(this),qp(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const xv=(r,e,t)=>new Pv(r,e).update(t).digest();xv.create=(r,e)=>new Pv(r,e);function fk(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,u=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+u,a,n)}class Ov extends Vp{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Of(this.buffer)}update(e){Ca(this);const{view:t,buffer:n,blockLen:s}=this;e=Ah(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Of(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ca(this),Av(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;fk(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Of(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,l[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}}const dk=(r,e,t)=>r&e^~r&t,pk=(r,e,t)=>r&e^r&t^e&t,gk=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Yn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Zn=new Uint32Array(64);class yk extends Ov{constructor(){super(64,32,8,!1),this.A=Yn[0]|0,this.B=Yn[1]|0,this.C=Yn[2]|0,this.D=Yn[3]|0,this.E=Yn[4]|0,this.F=Yn[5]|0,this.G=Yn[6]|0,this.H=Yn[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Zn[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const f=Zn[h-15],d=Zn[h-2],p=qr(f,7)^qr(f,18)^f>>>3,g=qr(d,17)^qr(d,19)^d>>>10;Zn[h]=g+Zn[h-7]+p+Zn[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let h=0;h<64;h++){const f=qr(a,6)^qr(a,11)^qr(a,25),d=l+f+dk(a,c,u)+gk[h]+Zn[h]|0,g=(qr(n,2)^qr(n,13)^qr(n,22))+pk(n,s,i)|0;l=u,u=c,c=a,a=o+d|0,o=i,i=s,s=n,n=d+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,s,i,o,a,c,u,l)}roundClean(){Zn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Sv=Gp(()=>new yk),Yu=BigInt(2**32-1),Md=BigInt(32);function Dv(r,e=!1){return e?{h:Number(r&Yu),l:Number(r>>Md&Yu)}:{h:Number(r>>Md&Yu)|0,l:Number(r&Yu)|0}}function Cv(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=Dv(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const mk=(r,e)=>BigInt(r>>>0)<<Md|BigInt(e>>>0),wk=(r,e,t)=>r>>>t,bk=(r,e,t)=>r<<32-t|e>>>t,vk=(r,e,t)=>r>>>t|e<<32-t,Ek=(r,e,t)=>r<<32-t|e>>>t,Ak=(r,e,t)=>r<<64-t|e>>>t-32,Ik=(r,e,t)=>r>>>t-32|e<<64-t,Pk=(r,e)=>e,xk=(r,e)=>r,_v=(r,e,t)=>r<<t|e>>>32-t,Nv=(r,e,t)=>e<<t|r>>>32-t,Tv=(r,e,t)=>e<<t-32|r>>>64-t,Rv=(r,e,t)=>r<<t-32|e>>>64-t;function Ok(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const Sk=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Dk=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,Ck=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),_k=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,Nk=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),Tk=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,Rk={fromBig:Dv,split:Cv,toBig:mk,shrSH:wk,shrSL:bk,rotrSH:vk,rotrSL:Ek,rotrBH:Ak,rotrBL:Ik,rotr32H:Pk,rotr32L:xk,rotlSH:_v,rotlSL:Nv,rotlBH:Tv,rotlBL:Rv,add:Ok,add3L:Sk,add3H:Dk,add4L:Ck,add4H:_k,add5H:Tk,add5L:Nk},se=Rk,[Bk,Fk]=(()=>se.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))))(),Xn=new Uint32Array(80),es=new Uint32Array(80);class $k extends Ov{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:h,Fl:f,Gh:d,Gl:p,Hh:g,Hl:m}=this;return[e,t,n,s,i,o,a,c,u,l,h,f,d,p,g,m]}set(e,t,n,s,i,o,a,c,u,l,h,f,d,p,g,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=h|0,this.Fl=f|0,this.Gh=d|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,t){for(let A=0;A<16;A++,t+=4)Xn[A]=e.getUint32(t),es[A]=e.getUint32(t+=4);for(let A=16;A<80;A++){const x=Xn[A-15]|0,D=es[A-15]|0,S=se.rotrSH(x,D,1)^se.rotrSH(x,D,8)^se.shrSH(x,D,7),_=se.rotrSL(x,D,1)^se.rotrSL(x,D,8)^se.shrSL(x,D,7),N=Xn[A-2]|0,T=es[A-2]|0,z=se.rotrSH(N,T,19)^se.rotrBH(N,T,61)^se.shrSH(N,T,6),U=se.rotrSL(N,T,19)^se.rotrBL(N,T,61)^se.shrSL(N,T,6),H=se.add4L(_,U,es[A-7],es[A-16]),W=se.add4H(H,S,z,Xn[A-7],Xn[A-16]);Xn[A]=W|0,es[A]=H|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:h,El:f,Fh:d,Fl:p,Gh:g,Gl:m,Hh:b,Hl:E}=this;for(let A=0;A<80;A++){const x=se.rotrSH(h,f,14)^se.rotrSH(h,f,18)^se.rotrBH(h,f,41),D=se.rotrSL(h,f,14)^se.rotrSL(h,f,18)^se.rotrBL(h,f,41),S=h&d^~h&g,_=f&p^~f&m,N=se.add5L(E,D,_,Fk[A],es[A]),T=se.add5H(N,b,x,S,Bk[A],Xn[A]),z=N|0,U=se.rotrSH(n,s,28)^se.rotrBH(n,s,34)^se.rotrBH(n,s,39),H=se.rotrSL(n,s,28)^se.rotrBL(n,s,34)^se.rotrBL(n,s,39),W=n&i^n&a^i&a,k=s&o^s&c^o&c;b=g|0,E=m|0,g=d|0,m=p|0,d=h|0,p=f|0,{h,l:f}=se.add(u|0,l|0,T|0,z|0),u=a|0,l=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const w=se.add3L(z,H,k);n=se.add3H(w,T,U,W),s=w|0}({h:n,l:s}=se.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=se.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=se.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=se.add(this.Dh|0,this.Dl|0,u|0,l|0),{h,l:f}=se.add(this.Eh|0,this.El|0,h|0,f|0),{h:d,l:p}=se.add(this.Fh|0,this.Fl|0,d|0,p|0),{h:g,l:m}=se.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:b,l:E}=se.add(this.Hh|0,this.Hl|0,b|0,E|0),this.set(n,s,i,o,a,c,u,l,h,f,d,p,g,m,b,E)}roundClean(){Xn.fill(0),es.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const kk=Gp(()=>new $k);function Uk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const Dw=Uk();Dw.crypto||Dw.msCrypto;function Lk(r){switch(r){case"sha256":return Sv.create();case"sha512":return kk.create()}O(!1,"invalid hashing algorithm name","algorithm",r)}const[Bv,Fv,$v]=[[],[],[]],Mk=BigInt(0),ic=BigInt(1),jk=BigInt(2),Hk=BigInt(7),zk=BigInt(256),qk=BigInt(113);for(let r=0,e=ic,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],Bv.push(2*(5*n+t)),Fv.push((r+1)*(r+2)/2%64);let s=Mk;for(let i=0;i<7;i++)e=(e<<ic^(e>>Hk)*qk)%zk,e&jk&&(s^=ic<<(ic<<BigInt(i))-ic);$v.push(s)}const[Vk,Gk]=Cv($v,!0),Cw=(r,e,t)=>t>32?Tv(r,e,t):_v(r,e,t),_w=(r,e,t)=>t>32?Rv(r,e,t):Nv(r,e,t);function Kk(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=t[c],l=t[c+1],h=Cw(u,l,1)^t[a],f=_w(u,l,1)^t[a+1];for(let d=0;d<50;d+=10)r[o+d]^=h,r[o+d+1]^=f}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=Fv[o],c=Cw(s,i,a),u=_w(s,i,a),l=Bv[o];s=r[l],i=r[l+1],r[l]=c,r[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=Vk[n],r[1]^=Gk[n]}t.fill(0)}class Kp extends Vp{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Fl(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ak(this.state)}keccak(){Kk(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Ca(this);const{blockLen:t,state:n}=this;e=Ah(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ca(this,!1),qp(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Fl(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Av(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Kp(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Qk=(r,e,t)=>Gp(()=>new Kp(e,r,t)),Wk=Qk(1,136,256/8);let kv=!1;const Uv=function(r){return Wk(r)};let Lv=Uv;function qe(r){const e=he(r,"data");return Z(Lv(e))}qe._=Uv;qe.lock=function(){kv=!0};qe.register=function(r){if(kv)throw new TypeError("keccak256 is locked");Lv=r};Object.freeze(qe);const Mv=function(r){return Lk("sha256").update(r).digest()};let jv=Mv,Hv=!1;function qa(r){const e=he(r,"data");return Z(jv(e))}qa._=Mv;qa.lock=function(){Hv=!0};qa.register=function(r){if(Hv)throw new Error("sha256 is locked");jv=r};Object.freeze(qa);Object.freeze(qa);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zv=BigInt(0),Ih=BigInt(1),Jk=BigInt(2),Ph=r=>r instanceof Uint8Array,Yk=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function _a(r){if(!Ph(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=Yk[r[t]];return e}function qv(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function Qp(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Na(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,i=r.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function Ei(r){return Qp(_a(r))}function Wp(r){if(!Ph(r))throw new Error("Uint8Array expected");return Qp(_a(Uint8Array.from(r).reverse()))}function Ta(r,e){return Na(r.toString(16).padStart(e*2,"0"))}function Jp(r,e){return Ta(r,e).reverse()}function Zk(r){return Na(qv(r))}function Or(r,e,t){let n;if(typeof e=="string")try{n=Na(e)}catch(i){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Ph(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function Tc(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!Ph(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function Xk(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function e4(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function t4(r){let e;for(e=0;r>zv;r>>=Ih,e+=1);return e}function r4(r,e){return r>>BigInt(e)&Ih}const n4=(r,e,t)=>r|(t?Ih:zv)<<BigInt(e),Yp=r=>(Jk<<BigInt(r-1))-Ih,Sf=r=>new Uint8Array(r),Nw=r=>Uint8Array.from(r);function Vv(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Sf(r),s=Sf(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...h)=>t(s,n,...h),c=(h=Sf())=>{s=a(Nw([0]),h),n=a(),h.length!==0&&(s=a(Nw([1]),h),n=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){n=a();const d=n.slice();f.push(d),h+=n.length}return Tc(...f)};return(h,f)=>{o(),c(h);let d;for(;!(d=f(u()));)c();return o(),d}}const s4={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Ou(r,e,t={}){const n=(s,i,o)=>{const a=s4[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const i4=Object.freeze(Object.defineProperty({__proto__:null,bitGet:r4,bitLen:t4,bitMask:Yp,bitSet:n4,bytesToHex:_a,bytesToNumberBE:Ei,bytesToNumberLE:Wp,concatBytes:Tc,createHmacDrbg:Vv,ensureBytes:Or,equalBytes:Xk,hexToBytes:Na,hexToNumber:Qp,numberToBytesBE:Ta,numberToBytesLE:Jp,numberToHexUnpadded:qv,numberToVarBytesBE:Zk,utf8ToBytes:e4,validateObject:Ou},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nt=BigInt(0),Ue=BigInt(1),zs=BigInt(2),o4=BigInt(3),jd=BigInt(4),Tw=BigInt(5),Rw=BigInt(8);BigInt(9);BigInt(16);function Lt(r,e){const t=r%e;return t>=nt?t:e+t}function a4(r,e,t){if(t<=nt||e<nt)throw new Error("Expected power/modulo > 0");if(t===Ue)return nt;let n=Ue;for(;e>nt;)e&Ue&&(n=n*r%t),r=r*r%t,e>>=Ue;return n}function or(r,e,t){let n=r;for(;e-- >nt;)n*=n,n%=t;return n}function Hd(r,e){if(r===nt||e<=nt)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=Lt(r,e),n=e,s=nt,i=Ue;for(;t!==nt;){const a=n/t,c=n%t,u=s-i*a;n=t,t=c,s=i,i=u}if(n!==Ue)throw new Error("invert: does not exist");return Lt(s,e)}function c4(r){const e=(r-Ue)/zs;let t,n,s;for(t=r-Ue,n=0;t%zs===nt;t/=zs,n++);for(s=zs;s<r&&a4(s,e,r)!==r-Ue;s++);if(n===1){const o=(r+Ue)/jd;return function(c,u){const l=c.pow(u,o);if(!c.eql(c.sqr(l),u))throw new Error("Cannot find square root");return l}}const i=(t+Ue)/zs;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,l=a.pow(a.mul(a.ONE,s),t),h=a.pow(c,i),f=a.pow(c,t);for(;!a.eql(f,a.ONE);){if(a.eql(f,a.ZERO))return a.ZERO;let d=1;for(let g=a.sqr(f);d<u&&!a.eql(g,a.ONE);d++)g=a.sqr(g);const p=a.pow(l,Ue<<BigInt(u-d-1));l=a.sqr(p),h=a.mul(h,p),f=a.mul(f,l),u=d}return h}}function u4(r){if(r%jd===o4){const e=(r+Ue)/jd;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(r%Rw===Tw){const e=(r-Tw)/Rw;return function(n,s){const i=n.mul(s,zs),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,zs),o),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),s))throw new Error("Cannot find square root");return u}}return c4(r)}const l4=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function h4(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=l4.reduce((n,s)=>(n[s]="function",n),e);return Ou(r,t)}function f4(r,e,t){if(t<nt)throw new Error("Expected power > 0");if(t===nt)return r.ONE;if(t===Ue)return e;let n=r.ONE,s=e;for(;t>nt;)t&Ue&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Ue;return n}function d4(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function Gv(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function p4(r,e,t=!1,n={}){if(r<=nt)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:i}=Gv(r,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=u4(r),a=Object.freeze({ORDER:r,BITS:s,BYTES:i,MASK:Yp(s),ZERO:nt,ONE:Ue,create:c=>Lt(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return nt<=c&&c<r},is0:c=>c===nt,isOdd:c=>(c&Ue)===Ue,neg:c=>Lt(-c,r),eql:(c,u)=>c===u,sqr:c=>Lt(c*c,r),add:(c,u)=>Lt(c+u,r),sub:(c,u)=>Lt(c-u,r),mul:(c,u)=>Lt(c*u,r),pow:(c,u)=>f4(a,c,u),div:(c,u)=>Lt(c*Hd(u,r),r),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Hd(c,r),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>d4(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>t?Jp(c,i):Ta(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return t?Wp(c):Ei(c)}});return Object.freeze(a)}function Kv(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function Qv(r){const e=Kv(r);return e+Math.ceil(e/2)}function g4(r,e,t=!1){const n=r.length,s=Kv(e),i=Qv(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=t?Ei(r):Wp(r),a=Lt(o,e-Ue)+Ue;return t?Jp(a,s):Ta(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const y4=BigInt(0),Df=BigInt(1);function m4(r,e){const t=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=r.ZERO,a=s;for(;i>y4;)i&Df&&(o=o.add(a)),a=a.double(),i>>=Df;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let u=s,l=u;for(let h=0;h<o;h++){l=u,c.push(l);for(let f=1;f<a;f++)l=l.add(u),c.push(l);u=l.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let u=r.ZERO,l=r.BASE;const h=BigInt(2**s-1),f=2**s,d=BigInt(s);for(let p=0;p<a;p++){const g=p*c;let m=Number(o&h);o>>=d,m>c&&(m-=f,o+=Df);const b=g,E=g+Math.abs(m)-1,A=p%2!==0,x=m<0;m===0?l=l.add(t(A,i[b])):u=u.add(t(x,i[E]))}return{p:u,f:l}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let u=i.get(s);return u||(u=this.precomputeWindow(s,c),c!==1&&i.set(s,a(u))),this.wNAF(c,u,o)}}}function Wv(r){return h4(r.Fp),Ou(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Gv(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function w4(r){const e=Wv(r);Ou(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:b4,hexToBytes:v4}=i4,Ws={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=Ws;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:b4(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=Ws,t=typeof r=="string"?v4(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=Ws._parseInt(t.subarray(2)),{d:o,l:a}=Ws._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(r){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,t=u=>{const l=u.toString(16);return l.length&1?`0${l}`:l},n=e(t(r.s)),s=e(t(r.r)),i=n.length/2,o=s.length/2,a=t(i),c=t(o);return`30${t(o+i+4)}02${c}${s}02${a}${n}`}},Un=BigInt(0),gr=BigInt(1);BigInt(2);const Bw=BigInt(3);BigInt(4);function E4(r){const e=w4(r),{Fp:t}=e,n=e.toBytes||((p,g,m)=>{const b=g.toAffine();return Tc(Uint8Array.from([4]),t.toBytes(b.x),t.toBytes(b.y))}),s=e.fromBytes||(p=>{const g=p.subarray(1),m=t.fromBytes(g.subarray(0,t.BYTES)),b=t.fromBytes(g.subarray(t.BYTES,2*t.BYTES));return{x:m,y:b}});function i(p){const{a:g,b:m}=e,b=t.sqr(p),E=t.mul(b,p);return t.add(t.add(E,t.mul(p,g)),m)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Un<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){const{allowedPrivateKeyLengths:g,nByteLength:m,wrapPrivateKey:b,n:E}=e;if(g&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=_a(p)),typeof p!="string"||!g.includes(p.length))throw new Error("Invalid key");p=p.padStart(m*2,"0")}let A;try{A=typeof p=="bigint"?p:Ei(Or("private key",p,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof p}`)}return b&&(A=Lt(A,E)),a(A),A}const u=new Map;function l(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(g,m,b){if(this.px=g,this.py=m,this.pz=b,g==null||!t.isValid(g))throw new Error("x required");if(m==null||!t.isValid(m))throw new Error("y required");if(b==null||!t.isValid(b))throw new Error("z required")}static fromAffine(g){const{x:m,y:b}=g||{};if(!g||!t.isValid(m)||!t.isValid(b))throw new Error("invalid affine point");if(g instanceof h)throw new Error("projective point not allowed");const E=A=>t.eql(A,t.ZERO);return E(m)&&E(b)?h.ZERO:new h(m,b,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const m=t.invertBatch(g.map(b=>b.pz));return g.map((b,E)=>b.toAffine(m[E])).map(h.fromAffine)}static fromHex(g){const m=h.fromAffine(s(Or("pointHex",g)));return m.assertValidity(),m}static fromPrivateKey(g){return h.BASE.multiply(c(g))}_setWindowSize(g){this._WINDOW_SIZE=g,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y:m}=this.toAffine();if(!t.isValid(g)||!t.isValid(m))throw new Error("bad point: x or y not FE");const b=t.sqr(m),E=i(g);if(!t.eql(b,E))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(t.isOdd)return!t.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){l(g);const{px:m,py:b,pz:E}=this,{px:A,py:x,pz:D}=g,S=t.eql(t.mul(m,D),t.mul(A,E)),_=t.eql(t.mul(b,D),t.mul(x,E));return S&&_}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:g,b:m}=e,b=t.mul(m,Bw),{px:E,py:A,pz:x}=this;let D=t.ZERO,S=t.ZERO,_=t.ZERO,N=t.mul(E,E),T=t.mul(A,A),z=t.mul(x,x),U=t.mul(E,A);return U=t.add(U,U),_=t.mul(E,x),_=t.add(_,_),D=t.mul(g,_),S=t.mul(b,z),S=t.add(D,S),D=t.sub(T,S),S=t.add(T,S),S=t.mul(D,S),D=t.mul(U,D),_=t.mul(b,_),z=t.mul(g,z),U=t.sub(N,z),U=t.mul(g,U),U=t.add(U,_),_=t.add(N,N),N=t.add(_,N),N=t.add(N,z),N=t.mul(N,U),S=t.add(S,N),z=t.mul(A,x),z=t.add(z,z),N=t.mul(z,U),D=t.sub(D,N),_=t.mul(z,T),_=t.add(_,_),_=t.add(_,_),new h(D,S,_)}add(g){l(g);const{px:m,py:b,pz:E}=this,{px:A,py:x,pz:D}=g;let S=t.ZERO,_=t.ZERO,N=t.ZERO;const T=e.a,z=t.mul(e.b,Bw);let U=t.mul(m,A),H=t.mul(b,x),W=t.mul(E,D),k=t.add(m,b),w=t.add(A,x);k=t.mul(k,w),w=t.add(U,H),k=t.sub(k,w),w=t.add(m,E);let v=t.add(A,D);return w=t.mul(w,v),v=t.add(U,W),w=t.sub(w,v),v=t.add(b,E),S=t.add(x,D),v=t.mul(v,S),S=t.add(H,W),v=t.sub(v,S),N=t.mul(T,w),S=t.mul(z,W),N=t.add(S,N),S=t.sub(H,N),N=t.add(H,N),_=t.mul(S,N),H=t.add(U,U),H=t.add(H,U),W=t.mul(T,W),w=t.mul(z,w),H=t.add(H,W),W=t.sub(U,W),W=t.mul(T,W),w=t.add(w,W),U=t.mul(H,w),_=t.add(_,U),U=t.mul(v,w),S=t.mul(k,S),S=t.sub(S,U),U=t.mul(k,H),N=t.mul(v,N),N=t.add(N,U),new h(S,_,N)}subtract(g){return this.add(g.negate())}is0(){return this.equals(h.ZERO)}wNAF(g){return d.wNAFCached(this,u,g,m=>{const b=t.invertBatch(m.map(E=>E.pz));return m.map((E,A)=>E.toAffine(b[A])).map(h.fromAffine)})}multiplyUnsafe(g){const m=h.ZERO;if(g===Un)return m;if(a(g),g===gr)return this;const{endo:b}=e;if(!b)return d.unsafeLadder(this,g);let{k1neg:E,k1:A,k2neg:x,k2:D}=b.splitScalar(g),S=m,_=m,N=this;for(;A>Un||D>Un;)A&gr&&(S=S.add(N)),D&gr&&(_=_.add(N)),N=N.double(),A>>=gr,D>>=gr;return E&&(S=S.negate()),x&&(_=_.negate()),_=new h(t.mul(_.px,b.beta),_.py,_.pz),S.add(_)}multiply(g){a(g);let m=g,b,E;const{endo:A}=e;if(A){const{k1neg:x,k1:D,k2neg:S,k2:_}=A.splitScalar(m);let{p:N,f:T}=this.wNAF(D),{p:z,f:U}=this.wNAF(_);N=d.constTimeNegate(x,N),z=d.constTimeNegate(S,z),z=new h(t.mul(z.px,A.beta),z.py,z.pz),b=N.add(z),E=T.add(U)}else{const{p:x,f:D}=this.wNAF(m);b=x,E=D}return h.normalizeZ([b,E])[0]}multiplyAndAddUnsafe(g,m,b){const E=h.BASE,A=(D,S)=>S===Un||S===gr||!D.equals(E)?D.multiplyUnsafe(S):D.multiply(S),x=A(this,m).add(A(g,b));return x.is0()?void 0:x}toAffine(g){const{px:m,py:b,pz:E}=this,A=this.is0();g==null&&(g=A?t.ONE:t.inv(E));const x=t.mul(m,g),D=t.mul(b,g),S=t.mul(E,g);if(A)return{x:t.ZERO,y:t.ZERO};if(!t.eql(S,t.ONE))throw new Error("invZ was invalid");return{x,y:D}}isTorsionFree(){const{h:g,isTorsionFree:m}=e;if(g===gr)return!0;if(m)return m(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:m}=e;return g===gr?this:m?m(h,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),n(h,this,g)}toHex(g=!0){return _a(this.toRawBytes(g))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const f=e.nBitLength,d=m4(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function A4(r){const e=Wv(r);return Ou(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function I4(r){const e=A4(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(w){return Un<w&&w<t.ORDER}function a(w){return Lt(w,n)}function c(w){return Hd(w,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:f}=E4({...e,toBytes(w,v,P){const R=v.toAffine(),C=t.toBytes(R.x),$=Tc;return P?$(Uint8Array.from([v.hasEvenY()?2:3]),C):$(Uint8Array.from([4]),C,t.toBytes(R.y))},fromBytes(w){const v=w.length,P=w[0],R=w.subarray(1);if(v===s&&(P===2||P===3)){const C=Ei(R);if(!o(C))throw new Error("Point is not on curve");const $=h(C);let q=t.sqrt($);const G=(q&gr)===gr;return(P&1)===1!==G&&(q=t.neg(q)),{x:C,y:q}}else if(v===i&&P===4){const C=t.fromBytes(R.subarray(0,t.BYTES)),$=t.fromBytes(R.subarray(t.BYTES,2*t.BYTES));return{x:C,y:$}}else throw new Error(`Point of length ${v} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),d=w=>_a(Ta(w,e.nByteLength));function p(w){const v=n>>gr;return w>v}function g(w){return p(w)?a(-w):w}const m=(w,v,P)=>Ei(w.slice(v,P));class b{constructor(v,P,R){this.r=v,this.s=P,this.recovery=R,this.assertValidity()}static fromCompact(v){const P=e.nByteLength;return v=Or("compactSignature",v,P*2),new b(m(v,0,P),m(v,P,2*P))}static fromDER(v){const{r:P,s:R}=Ws.toSig(Or("DER",v));return new b(P,R)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(v){return new b(this.r,this.s,v)}recoverPublicKey(v){const{r:P,s:R,recovery:C}=this,$=_(Or("msgHash",v));if(C==null||![0,1,2,3].includes(C))throw new Error("recovery id invalid");const q=C===2||C===3?P+e.n:P;if(q>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const G=C&1?"03":"02",Y=u.fromHex(G+d(q)),Q=c(q),ee=a(-$*Q),oe=a(R*Q),ae=u.BASE.multiplyAndAddUnsafe(Y,ee,oe);if(!ae)throw new Error("point at infinify");return ae.assertValidity(),ae}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new b(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Na(this.toDERHex())}toDERHex(){return Ws.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Na(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const E={isValidPrivateKey(w){try{return l(w),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const w=Qv(e.n);return g4(e.randomBytes(w),e.n)},precompute(w=8,v=u.BASE){return v._setWindowSize(w),v.multiply(BigInt(3)),v}};function A(w,v=!0){return u.fromPrivateKey(w).toRawBytes(v)}function x(w){const v=w instanceof Uint8Array,P=typeof w=="string",R=(v||P)&&w.length;return v?R===s||R===i:P?R===2*s||R===2*i:w instanceof u}function D(w,v,P=!0){if(x(w))throw new Error("first arg must be private key");if(!x(v))throw new Error("second arg must be public key");return u.fromHex(v).multiply(l(w)).toRawBytes(P)}const S=e.bits2int||function(w){const v=Ei(w),P=w.length*8-e.nBitLength;return P>0?v>>BigInt(P):v},_=e.bits2int_modN||function(w){return a(S(w))},N=Yp(e.nBitLength);function T(w){if(typeof w!="bigint")throw new Error("bigint expected");if(!(Un<=w&&w<N))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ta(w,e.nByteLength)}function z(w,v,P=U){if(["recovered","canonical"].some(re=>re in P))throw new Error("sign() legacy options not supported");const{hash:R,randomBytes:C}=e;let{lowS:$,prehash:q,extraEntropy:G}=P;$==null&&($=!0),w=Or("msgHash",w),q&&(w=Or("prehashed msgHash",R(w)));const Y=_(w),Q=l(v),ee=[T(Q),T(Y)];if(G!=null){const re=G===!0?C(t.BYTES):G;ee.push(Or("extraEntropy",re))}const oe=Tc(...ee),ae=Y;function fe(re){const _e=S(re);if(!f(_e))return;const je=c(_e),Te=u.BASE.multiply(_e).toAffine(),Ce=a(Te.x);if(Ce===Un)return;const Ve=a(je*a(ae+Ce*Q));if(Ve===Un)return;let ln=(Te.x===Ce?0:2)|Number(Te.y&gr),Nu=Ve;return $&&p(Ve)&&(Nu=g(Ve),ln^=1),new b(Ce,Nu,ln)}return{seed:oe,k2sig:fe}}const U={lowS:e.lowS,prehash:!1},H={lowS:e.lowS,prehash:!1};function W(w,v,P=U){const{seed:R,k2sig:C}=z(w,v,P),$=e;return Vv($.hash.outputLen,$.nByteLength,$.hmac)(R,C)}u.BASE._setWindowSize(8);function k(w,v,P,R=H){var Te;const C=w;if(v=Or("msgHash",v),P=Or("publicKey",P),"strict"in R)throw new Error("options.strict was renamed to lowS");const{lowS:$,prehash:q}=R;let G,Y;try{if(typeof C=="string"||C instanceof Uint8Array)try{G=b.fromDER(C)}catch(Ce){if(!(Ce instanceof Ws.Err))throw Ce;G=b.fromCompact(C)}else if(typeof C=="object"&&typeof C.r=="bigint"&&typeof C.s=="bigint"){const{r:Ce,s:Ve}=C;G=new b(Ce,Ve)}else throw new Error("PARSE");Y=u.fromHex(P)}catch(Ce){if(Ce.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if($&&G.hasHighS())return!1;q&&(v=e.hash(v));const{r:Q,s:ee}=G,oe=_(v),ae=c(ee),fe=a(oe*ae),re=a(Q*ae),_e=(Te=u.BASE.multiplyAndAddUnsafe(Y,fe,re))==null?void 0:Te.toAffine();return _e?a(_e.x)===Q:!1}return{CURVE:e,getPublicKey:A,getSharedSecret:D,sign:W,verify:k,ProjectivePoint:u,Signature:b,utils:E}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function P4(r){return{hash:r,hmac:(e,...t)=>xv(r,e,lk(...t)),randomBytes:hk}}function x4(r,e){const t=n=>I4({...r,...P4(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jv=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Fw=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),O4=BigInt(1),zd=BigInt(2),$w=(r,e)=>(r+e/zd)/e;function S4(r){const e=Jv,t=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=r*r*r%e,l=u*u*r%e,h=or(l,t,e)*l%e,f=or(h,t,e)*l%e,d=or(f,zd,e)*u%e,p=or(d,s,e)*d%e,g=or(p,i,e)*p%e,m=or(g,a,e)*g%e,b=or(m,c,e)*m%e,E=or(b,a,e)*g%e,A=or(E,t,e)*l%e,x=or(A,o,e)*p%e,D=or(x,n,e)*u%e,S=or(D,zd,e);if(!qd.eql(qd.sqr(S),r))throw new Error("Cannot find square root");return S}const qd=p4(Jv,void 0,void 0,{sqrt:S4}),ts=x4({a:BigInt(0),b:BigInt(7),Fp:qd,n:Fw,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=Fw,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-O4*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=$w(i*r,e),c=$w(-n*r,e);let u=Lt(r-a*t-c*s,e),l=Lt(-a*n-c*i,e);const h=u>o,f=l>o;if(h&&(u=e-u),f&&(l=e-l),u>o||l>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:h,k1:u,k2neg:f,k2:l}}}},Sv);BigInt(0);ts.ProjectivePoint;const Rc="0x0000000000000000000000000000000000000000",kw="0x0000000000000000000000000000000000000000000000000000000000000000",Uw=BigInt(0),Lw=BigInt(1),Mw=BigInt(2),jw=BigInt(27),Hw=BigInt(28),Zu=BigInt(35),ao={};function zw(r){return Di(Ot(r),32)}var jo,Ho,zo,ai;const xr=class xr{constructor(e,t,n,s){F(this,jo,void 0);F(this,Ho,void 0);F(this,zo,void 0);F(this,ai,void 0);xu(e,ao,"Signature"),I(this,jo,t),I(this,Ho,n),I(this,zo,s),I(this,ai,null)}get r(){return y(this,jo)}set r(e){O(Do(e)===32,"invalid r","value",e),I(this,jo,Z(e))}get s(){return y(this,Ho)}set s(e){O(Do(e)===32,"invalid s","value",e);const t=Z(e);O(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),I(this,Ho,t)}get v(){return y(this,zo)}set v(e){const t=ie(e,"value");O(t===27||t===28,"invalid v","v",e),I(this,zo,t)}get networkV(){return y(this,ai)}get legacyChainId(){const e=this.networkV;return e==null?null:xr.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=he(this.s);return this.yParity&&(e[0]|=128),Z(e)}get compactSerialized(){return Me([this.r,this.yParityAndS])}get serialized(){return Me([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new xr(ao,this.r,this.s,this.v);return this.networkV&&I(e,ai,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=X(e,"v");return t==jw||t==Hw?Uw:(O(t>=Zu,"invalid EIP-155 v","v",e),(t-Zu)/Mw)}static getChainIdV(e,t){return X(e)*Mw+BigInt(35+t-27)}static getNormalizedV(e){const t=X(e);return t===Uw||t===jw?27:t===Lw||t===Hw?28:(O(t>=Zu,"invalid v","v",e),t&Lw?27:28)}static from(e){function t(u,l){O(u,l,"signature",e)}if(e==null)return new xr(ao,kw,kw,27);if(typeof e=="string"){const u=he(e,"signature");if(u.length===64){const l=Z(u.slice(0,32)),h=u.slice(32,64),f=h[0]&128?28:27;return h[0]&=127,new xr(ao,l,Z(h),f)}if(u.length===65){const l=Z(u.slice(0,32)),h=u.slice(32,64);t((h[0]&128)===0,"non-canonical s");const f=xr.getNormalizedV(u[64]);return new xr(ao,l,Z(h),f)}t(!1,"invalid raw signature length")}if(e instanceof xr)return e.clone();const n=e.r;t(n!=null,"missing r");const s=zw(n),i=function(u,l){if(u!=null)return zw(u);if(l!=null){t(Oe(l,32),"invalid yParityAndS");const h=he(l);return h[0]&=127,Z(h)}t(!1,"missing s")}(e.s,e.yParityAndS);t((he(i)[0]&128)==0,"non-canonical s");const{networkV:o,v:a}=function(u,l,h){if(u!=null){const f=X(u);return{networkV:f>=Zu?f:void 0,v:xr.getNormalizedV(f)}}if(l!=null)return t(Oe(l,32),"invalid yParityAndS"),{v:he(l)[0]&128?28:27};if(h!=null){switch(ie(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new xr(ao,s,i,a);return o&&I(c,ai,o),t(e.yParity==null||ie(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};jo=new WeakMap,Ho=new WeakMap,zo=new WeakMap,ai=new WeakMap;let $r=xr;var Dn;const qs=class qs{constructor(e){F(this,Dn,void 0);O(Do(e)===32,"invalid private key","privateKey","[REDACTED]"),I(this,Dn,Z(e))}get privateKey(){return y(this,Dn)}get publicKey(){return qs.computePublicKey(y(this,Dn))}get compressedPublicKey(){return qs.computePublicKey(y(this,Dn),!0)}sign(e){O(Do(e)===32,"invalid digest length","digest",e);const t=ts.sign(xt(e),xt(y(this,Dn)),{lowS:!0});return $r.from({r:Os(t.r,32),s:Os(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=qs.computePublicKey(e);return Z(ts.getSharedSecret(xt(y(this,Dn)),he(t),!1))}static computePublicKey(e,t){let n=he(e,"key");if(n.length===32){const i=ts.getPublicKey(n,!!t);return Z(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const s=ts.ProjectivePoint.fromHex(n);return Z(s.toRawBytes(t))}static recoverPublicKey(e,t){O(Do(e)===32,"invalid digest length","digest",e);const n=$r.from(t);let s=ts.Signature.fromCompact(xt(Me([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const i=s.recoverPublicKey(xt(e));return O(i!=null,"invalid signautre for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,n){const s=ts.ProjectivePoint.fromHex(qs.computePublicKey(e).substring(2)),i=ts.ProjectivePoint.fromHex(qs.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!n)}};Dn=new WeakMap;let Bc=qs;const D4=BigInt(0),C4=BigInt(36);function qw(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=he(qe(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const Zp={};for(let r=0;r<10;r++)Zp[String(r)]=String(r);for(let r=0;r<26;r++)Zp[String.fromCharCode(65+r)]=String(10+r);const Vw=15;function _4(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>Zp[n]).join("");for(;e.length>=Vw;){let n=e.substring(0,Vw);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const N4=function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r}();function T4(r){r=r.toLowerCase();let e=D4;for(let t=0;t<r.length;t++)e=e*C4+N4[r[t]];return e}function ve(r){if(O(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=qw(r);return O(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){O(r.substring(2,4)===_4(r),"bad icap checksum","address",r);let e=T4(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return qw("0x"+e)}O(!1,"invalid address","address",r)}function R4(r){const e=ve(r.from);let n=X(r.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,ve(Be(qe(Ci([e,n])),12))}function Yv(r){return r&&typeof r.getAddress=="function"}async function Cf(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(L(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),O(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),ve(t)}function Dt(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?ve(r):(L(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Cf(r,e.resolveName(r)));if(Yv(r))return Cf(r,r.getAddress());if(r&&typeof r.then=="function")return Cf(r,r);O(!1,"unsupported addressable value","target",r)}const bn={};function J(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new bt(bn,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function ge(r,e){return new bt(bn,`bytes${e||""}`,r,{size:e})}const Gw=Symbol.for("_ethers_typed");var ci;const vn=class vn{constructor(e,t,n,s){B(this,"type");B(this,"value");F(this,ci,void 0);B(this,"_typedSymbol");s==null&&(s=null),xu(bn,e,"Typed"),te(this,{_typedSymbol:Gw,type:t,value:n}),I(this,ci,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return y(this,ci)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return y(this,ci)===!0?-1:y(this,ci)===!1?this.value.length:null}static from(e,t){return new vn(bn,e,t)}static uint8(e){return J(e,8)}static uint16(e){return J(e,16)}static uint24(e){return J(e,24)}static uint32(e){return J(e,32)}static uint40(e){return J(e,40)}static uint48(e){return J(e,48)}static uint56(e){return J(e,56)}static uint64(e){return J(e,64)}static uint72(e){return J(e,72)}static uint80(e){return J(e,80)}static uint88(e){return J(e,88)}static uint96(e){return J(e,96)}static uint104(e){return J(e,104)}static uint112(e){return J(e,112)}static uint120(e){return J(e,120)}static uint128(e){return J(e,128)}static uint136(e){return J(e,136)}static uint144(e){return J(e,144)}static uint152(e){return J(e,152)}static uint160(e){return J(e,160)}static uint168(e){return J(e,168)}static uint176(e){return J(e,176)}static uint184(e){return J(e,184)}static uint192(e){return J(e,192)}static uint200(e){return J(e,200)}static uint208(e){return J(e,208)}static uint216(e){return J(e,216)}static uint224(e){return J(e,224)}static uint232(e){return J(e,232)}static uint240(e){return J(e,240)}static uint248(e){return J(e,248)}static uint256(e){return J(e,256)}static uint(e){return J(e,256)}static int8(e){return J(e,-8)}static int16(e){return J(e,-16)}static int24(e){return J(e,-24)}static int32(e){return J(e,-32)}static int40(e){return J(e,-40)}static int48(e){return J(e,-48)}static int56(e){return J(e,-56)}static int64(e){return J(e,-64)}static int72(e){return J(e,-72)}static int80(e){return J(e,-80)}static int88(e){return J(e,-88)}static int96(e){return J(e,-96)}static int104(e){return J(e,-104)}static int112(e){return J(e,-112)}static int120(e){return J(e,-120)}static int128(e){return J(e,-128)}static int136(e){return J(e,-136)}static int144(e){return J(e,-144)}static int152(e){return J(e,-152)}static int160(e){return J(e,-160)}static int168(e){return J(e,-168)}static int176(e){return J(e,-176)}static int184(e){return J(e,-184)}static int192(e){return J(e,-192)}static int200(e){return J(e,-200)}static int208(e){return J(e,-208)}static int216(e){return J(e,-216)}static int224(e){return J(e,-224)}static int232(e){return J(e,-232)}static int240(e){return J(e,-240)}static int248(e){return J(e,-248)}static int256(e){return J(e,-256)}static int(e){return J(e,-256)}static bytes1(e){return ge(e,1)}static bytes2(e){return ge(e,2)}static bytes3(e){return ge(e,3)}static bytes4(e){return ge(e,4)}static bytes5(e){return ge(e,5)}static bytes6(e){return ge(e,6)}static bytes7(e){return ge(e,7)}static bytes8(e){return ge(e,8)}static bytes9(e){return ge(e,9)}static bytes10(e){return ge(e,10)}static bytes11(e){return ge(e,11)}static bytes12(e){return ge(e,12)}static bytes13(e){return ge(e,13)}static bytes14(e){return ge(e,14)}static bytes15(e){return ge(e,15)}static bytes16(e){return ge(e,16)}static bytes17(e){return ge(e,17)}static bytes18(e){return ge(e,18)}static bytes19(e){return ge(e,19)}static bytes20(e){return ge(e,20)}static bytes21(e){return ge(e,21)}static bytes22(e){return ge(e,22)}static bytes23(e){return ge(e,23)}static bytes24(e){return ge(e,24)}static bytes25(e){return ge(e,25)}static bytes26(e){return ge(e,26)}static bytes27(e){return ge(e,27)}static bytes28(e){return ge(e,28)}static bytes29(e){return ge(e,29)}static bytes30(e){return ge(e,30)}static bytes31(e){return ge(e,31)}static bytes32(e){return ge(e,32)}static address(e){return new vn(bn,"address",e)}static bool(e){return new vn(bn,"bool",!!e)}static bytes(e){return new vn(bn,"bytes",e)}static string(e){return new vn(bn,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new vn(bn,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Gw}static dereference(e,t){if(vn.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};ci=new WeakMap;let bt=vn;class B4 extends Gn{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=bt.dereference(t,"string");try{n=ve(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return ve(Os(e.readValue(),20))}}class F4 extends Gn{constructor(t){super(t.name,t.type,"_",t.dynamic);B(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function Zv(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(u=>{const l=u.localName;return L(l,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:t}),L(!c[l],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:t}),c[l]=!0,t[l]})}else O(!1,"invalid tuple value","tuple",t);O(e.length===n.length,"types/value length mismatch","tuple",t);let s=new kd,i=new kd,o=[];e.forEach((c,u)=>{let l=n[u];if(c.dynamic){let h=i.length;c.encode(i,l);let f=s.writeUpdatableValue();o.push(d=>{f(d+h)})}else c.encode(s,l)}),o.forEach(c=>{c(s.length)});let a=r.appendWriter(s);return a+=r.appendWriter(i),a}function Xv(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=r.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(u){if(lt(u,"BUFFER_OVERRUN"))throw u;o=u,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(r)}catch(a){if(lt(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),n.push(i.localName||null)}),Da.fromItems(t,n)}class $4 extends Gn{constructor(t,n,s){const i=t.type+"["+(n>=0?n:"")+"]",o=n===-1||t.dynamic;super("array",i,s,o);B(this,"coder");B(this,"length");te(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=bt.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),cv(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return Zv(t,o,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),L(n*St<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*St,length:t.dataLength}));let s=[];for(let i=0;i<n;i++)s.push(new F4(this.coder));return Xv(t,s)}}class k4 extends Gn{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=bt.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class eE extends Gn{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=xt(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class U4 extends eE{constructor(e){super("bytes",e)}decode(e){return Z(super.decode(e))}}class L4 extends Gn{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);B(this,"size");te(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=xt(bt.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return Z(t.readBytes(this.size))}}const M4=new Uint8Array([]);class j4 extends Gn{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(M4)}decode(e){return e.readBytes(0),null}}const H4=BigInt(0),z4=BigInt(1),q4=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class V4 extends Gn{constructor(t,n,s){const i=(n?"int":"uint")+t*8;super(i,i,s,!1);B(this,"size");B(this,"signed");te(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=X(bt.dereference(n,this.type)),i=Qs(q4,St*8);if(this.signed){let o=Qs(i,this.size*8-1);(s>o||s<-(o+z4))&&this._throwError("value out-of-bounds",n),s=hv(s,8*St)}else(s<H4||s>Qs(i,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=Qs(t.readValue(),this.size*8);return this.signed&&(n=Rl(n,this.size*8)),n}}class G4 extends eE{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Hn(bt.dereference(t,"string")))}decode(e){return Bl(super.decode(e))}}class Xu extends Gn{constructor(t,n){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,s);B(this,"coders");te(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,n){const s=bt.dereference(n,"tuple");return Zv(t,this.coders,s)}decode(t){return Xv(t,this.coders)}}function _i(r){return qe(Hn(r))}var K4="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const Kw=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),Qw=4;function Q4(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),s=1,i=[0,1];for(let D=1;D<n;D++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,u=0;function l(){return c==0&&(u=u<<8|r[e++],c=8),u>>--c&1}const h=31,f=2**h,d=f>>>1,p=d>>1,g=f-1;let m=0;for(let D=0;D<h;D++)m=m<<1|l();let b=[],E=0,A=f;for(;;){let D=Math.floor(((m-E+1)*s-1)/A),S=0,_=n;for(;_-S>1;){let z=S+_>>>1;D<i[z]?_=z:S=z}if(S==0)break;b.push(S);let N=E+Math.floor(A*i[S]/s),T=E+Math.floor(A*i[S+1]/s)-1;for(;!((N^T)&d);)m=m<<1&g|l(),N=N<<1&g,T=T<<1&g|1;for(;N&~T&p;)m=m&d|m<<1&g>>>1|l(),N=N<<1^d,T=(T^d)<<1|d|1;E=N,A=1+T-N}let x=n-4;return b.map(D=>{switch(D-x){case 3:return x+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return x+256+(r[a++]<<8|r[a++]);case 1:return x+r[a++];default:return D-1}})}function W4(r){let e=0;return()=>r[e++]}function tE(r){return W4(Q4(J4(r)))}function J4(r){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=r.length,n=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[r.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}function Y4(r){return r&1?~r>>1:r>>1}function Z4(r,e){let t=Array(r);for(let n=0,s=0;n<r;n++)t[n]=s+=Y4(e());return t}function Fc(r,e=0){let t=[];for(;;){let n=r(),s=r();if(!s)break;e+=n;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function rE(r){return $c(()=>{let e=Fc(r);if(e.length)return e})}function nE(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(X4(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(eU(t,r))}return e.flat()}function $c(r){let e=[];for(;;){let t=r(e.length);if(!t)break;e.push(t)}return e}function sE(r,e,t){let n=Array(r).fill().map(()=>[]);for(let s=0;s<e;s++)Z4(r,t).forEach((i,o)=>n[o].push(i));return n}function X4(r,e){let t=1+e(),n=e(),s=$c(e);return sE(s.length,1+r,e).flatMap((o,a)=>{let[c,...u]=o;return Array(s[a]).fill().map((l,h)=>{let f=h*n;return[c+h*t,u.map(d=>d+f)]})})}function eU(r,e){let t=1+e();return sE(t,1+r,e).map(s=>[s[0],s.slice(1)])}function tU(r){let e=[],t=Fc(r);return s(n([]),[]),e;function n(i){let o=r(),a=$c(()=>{let c=Fc(r).map(u=>t[u]);if(c.length)return n(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let u of o)for(let l of u.Q)s(u,[...a,l],c)}}}function rU(r){return r.toString(16).toUpperCase().padStart(2,"0")}function iE(r){return`{${rU(r)}}`}function nU(r){let e=[];for(let t=0,n=r.length;t<n;){let s=r.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function Ra(r){let t=r.length;if(t<4096)return String.fromCodePoint(...r);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...r.slice(s,s+=4096)));return n.join("")}function sU(r,e){let t=r.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=r[s]-e[s];return n}var iU="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const kc=44032,$l=4352,kl=4449,Ul=4519,oE=19,aE=21,Ba=28,Ll=aE*Ba,oU=oE*Ll,aU=kc+oU,cU=$l+oE,uU=kl+aE,lU=Ul+Ba;function lc(r){return r>>24&255}function cE(r){return r&16777215}let Vd,Ww,Gd,dl;function hU(){let r=tE(iU);Vd=new Map(rE(r).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),Ww=new Set(Fc(r)),Gd=new Map,dl=new Map;for(let[e,t]of nE(r)){if(!Ww.has(e)&&t.length==2){let[n,s]=t,i=dl.get(n);i||(i=new Map,dl.set(n,i)),i.set(s,e)}Gd.set(e,t.reverse())}}function uE(r){return r>=kc&&r<aU}function fU(r,e){if(r>=$l&&r<cU&&e>=kl&&e<uU)return kc+(r-$l)*Ll+(e-kl)*Ba;if(uE(r)&&e>Ul&&e<lU&&(r-kc)%Ba==0)return r+(e-Ul);{let t=dl.get(r);return t&&(t=t.get(e),t)?t:-1}}function lE(r){Vd||hU();let e=[],t=[],n=!1;function s(i){let o=Vd.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of r)for(;;){if(i<128)e.push(i);else if(uE(i)){let o=i-kc,a=o/Ll|0,c=o%Ll/Ba|0,u=o%Ba;s($l+a),s(kl+c),u>0&&s(Ul+u)}else{let o=Gd.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(n&&e.length>1){let i=lc(e[0]);for(let o=1;o<e.length;o++){let a=lc(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let u=e[c+1];if(e[c+1]=e[c],e[c]=u,!c||(i=lc(e[--c]),i<=a))break}i=lc(e[o])}}return e}function dU(r){let e=[],t=[],n=-1,s=0;for(let i of r){let o=lc(i),a=cE(i);if(n==-1)o==0?n=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(n,...t),t.length=0,n=a):t.push(a),s=o;else{let c=fU(n,a);c>=0?n=c:s==0&&o==0?(e.push(n),n=a):(t.push(a),s=o)}}return n>=0&&e.push(n,...t),e}function hE(r){return lE(r).map(cE)}function pU(r){return dU(lE(r))}const Jw=45,fE=".",dE=65039,pE=1,Ml=r=>Array.from(r);function Uc(r,e){return r.P.has(e)||r.Q.has(e)}class gU extends Array{get is_emoji(){return!0}}let Kd,gE,Js,Qd,yE,_o,_f,po,ks,Yw,Wd;function Xp(){if(Kd)return;let r=tE(K4);const e=()=>Fc(r),t=()=>new Set(e()),n=(l,h)=>h.forEach(f=>l.add(f));Kd=new Map(nE(r)),gE=t(),Js=e(),Qd=new Set(e().map(l=>Js[l])),Js=new Set(Js),yE=t(),t();let s=rE(r),i=r();const o=()=>{let l=new Set;return e().forEach(h=>n(l,s[h])),n(l,e()),l};_o=$c(l=>{let h=$c(r).map(f=>f+96);if(h.length){let f=l>=i;h[0]-=32,h=Ra(h),f&&(h=`Restricted[${h}]`);let d=o(),p=o(),g=!r();return{N:h,P:d,Q:p,M:g,R:f}}}),_f=t(),po=new Map;let a=e().concat(Ml(_f)).sort((l,h)=>l-h);a.forEach((l,h)=>{let f=r(),d=a[h]=f?a[h-f]:{V:[],M:new Map};d.V.push(l),_f.has(l)||po.set(l,d)});for(let{V:l,M:h}of new Set(po.values())){let f=[];for(let p of l){let g=_o.filter(b=>Uc(b,p)),m=f.find(({G:b})=>g.some(E=>b.has(E)));m||(m={G:new Set,V:[]},f.push(m)),m.V.push(p),n(m.G,g)}let d=f.flatMap(p=>Ml(p.G));for(let{G:p,V:g}of f){let m=new Set(d.filter(b=>!p.has(b)));for(let b of g)h.set(b,m)}}ks=new Set;let c=new Set;const u=l=>ks.has(l)?c.add(l):ks.add(l);for(let l of _o){for(let h of l.P)u(h);for(let h of l.Q)u(h)}for(let l of ks)!po.has(l)&&!c.has(l)&&po.set(l,pE);n(ks,hE(ks)),Yw=tU(r).map(l=>gU.from(l)).sort(sU),Wd=new Map;for(let l of Yw){let h=[Wd];for(let f of l){let d=h.map(p=>{let g=p.get(f);return g||(g=new Map,p.set(f,g)),g});f===dE?h.push(...d):h=d}for(let f of h)f.V=l}}function eg(r){return(mE(r)?"":`${tg(xh([r]))} `)+iE(r)}function tg(r){return`"${r}"`}function yU(r){if(r.length>=4&&r[2]==Jw&&r[3]==Jw)throw new Error(`invalid label extension: "${Ra(r.slice(0,4))}"`)}function mU(r){for(let t=r.lastIndexOf(95);t>0;)if(r[--t]!==95)throw new Error("underscore allowed only at start")}function wU(r){let e=r[0],t=Kw.get(e);if(t)throw vc(`leading ${t}`);let n=r.length,s=-1;for(let i=1;i<n;i++){e=r[i];let o=Kw.get(e);if(o){if(s==i)throw vc(`${t} + ${o}`);s=i+1,t=o}}if(s==n)throw vc(`trailing ${t}`)}function xh(r,e=1/0,t=iE){let n=[];bU(r[0])&&n.push(""),r.length>e&&(e>>=1,r=[...r.slice(0,e),8230,...r.slice(-e)]);let s=0,i=r.length;for(let o=0;o<i;o++){let a=r[o];mE(a)&&(n.push(Ra(r.slice(s,o))),n.push(t(a)),s=o+1)}return n.push(Ra(r.slice(s,i))),n.join("")}function bU(r){return Xp(),Js.has(r)}function mE(r){return Xp(),yE.has(r)}function vU(r){return PU(EU(r,pU,SU))}function EU(r,e,t){if(!r)return[];Xp();let n=0;return r.split(fE).map(s=>{let i=nU(s),o={input:i,offset:n};n+=i.length+1;try{let a=o.tokens=OU(i,e,t),c=a.length,u;if(!c)throw new Error("empty label");let l=o.output=a.flat();if(mU(l),!(o.emoji=c>1||a[0].is_emoji)&&l.every(f=>f<128))yU(l),u="ASCII";else{let f=a.flatMap(d=>d.is_emoji?[]:d);if(!f.length)u="Emoji";else{if(Js.has(l[0]))throw vc("leading combining mark");for(let g=1;g<c;g++){let m=a[g];if(!m.is_emoji&&Js.has(m[0]))throw vc(`emoji + combining mark: "${Ra(a[g-1])} + ${xh([m[0]])}"`)}wU(l);let d=Ml(new Set(f)),[p]=IU(d);xU(p,f),AU(p,d),u=p.N}}o.type=u}catch(a){o.error=a}return o})}function AU(r,e){let t,n=[];for(let s of e){let i=po.get(s);if(i===pE)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):Ml(o),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(i=>Uc(s,i)))throw new Error(`whole-script confusable: ${r.N}/${s.N}`)}}function IU(r){let e=_o;for(let t of r){let n=e.filter(s=>Uc(s,t));if(!n.length)throw _o.some(s=>Uc(s,t))?bE(e[0],t):wE(t);if(e=n,n.length==1)break}return e}function PU(r){return r.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(r.length==1?s:`Invalid label ${tg(xh(e,63))}: ${s}`)}return Ra(n)}).join(fE)}function wE(r){return new Error(`disallowed character: ${eg(r)}`)}function bE(r,e){let t=eg(e),n=_o.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${r.N} + ${t}`)}function vc(r){return new Error(`illegal placement: ${r}`)}function xU(r,e){for(let t of e)if(!Uc(r,t))throw bE(r,t);if(r.M){let t=hE(e);for(let n=1,s=t.length;n<s;n++)if(Qd.has(t[n])){let i=n+1;for(let o;i<s&&Qd.has(o=t[i]);i++)for(let a=n;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${eg(o)}`);if(i-n>Qw)throw new Error(`excessive non-spacing marks: ${tg(xh(t.slice(n-1,i)))} (${i-n}/${Qw})`);n=i}}}function OU(r,e,t){let n=[],s=[];for(r=r.slice().reverse();r.length;){let i=DU(r);if(i)s.length&&(n.push(e(s)),s=[]),n.push(t(i));else{let o=r.pop();if(ks.has(o))s.push(o);else{let a=Kd.get(o);if(a)s.push(...a);else if(!gE.has(o))throw wE(o)}}}return s.length&&n.push(e(s)),n}function SU(r){return r.filter(e=>e!=dE)}function DU(r,e){let t=Wd,n,s=r.length;for(;s&&(t=t.get(r[--s]),!!t);){let{V:i}=t;i&&(n=i,e&&e.push(...r.slice(s).reverse()),r.length=s)}return n}const vE=new Uint8Array(32);vE.fill(0);function Zw(r){return O(r.length!==0,"invalid ENS name; empty component","comp",r),r}function EE(r){const e=Hn(CU(r)),t=[];if(r.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(Zw(e.slice(n,s))),n=s+1);return O(n<e.length,"invalid ENS name; empty component","name",r),t.push(Zw(e.slice(n))),t}function CU(r){try{if(r.length===0)throw new Error("empty label");return vU(r)}catch(e){O(!1,`invalid ENS name (${e.message})`,"name",r)}}function Jd(r){O(typeof r=="string","invalid ENS name; not a string","name",r),O(r.length,"invalid ENS name (empty label)","name",r);let e=vE;const t=EE(r);for(;t.length;)e=qe(Me([e,qe(t.pop())]));return Z(e)}function _U(r,e){const t=e??63;return O(t<=255,"DNS encoded label cannot exceed 255","length",t),Z(Me(EE(r).map(n=>{O(n.length<=t,`label ${JSON.stringify(r)} exceeds ${t} bytes`,"name",r);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}function Nf(r,e){return{address:ve(r),storageKeys:e.map((t,n)=>(O(Oe(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function Li(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(O(t.length===2,"invalid slot set",`value[${n}]`,t),Nf(t[0],t[1])):(O(t!=null&&typeof t=="object","invalid address-slot set","value",r),Nf(t.address,t.storageKeys)));O(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,i)=>(s[i]=!0,s),{});return Nf(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function NU(r){let e;return typeof r=="string"?e=Bc.computePublicKey(r,!1):e=r.publicKey,ve(qe("0x"+e.substring(4)).substring(26))}function TU(r,e){return NU(Bc.recoverPublicKey(r,e))}const Xe=BigInt(0),RU=BigInt(2),BU=BigInt(27),FU=BigInt(28),$U=BigInt(35),kU=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Tf=4096*32;function Xw(r,e){let t=r.toString(16);for(;t.length<2;)t="0"+t;return t+=qa(e).substring(4),"0x"+t}function Oh(r){return r==="0x"?null:ve(r)}function rg(r,e){try{return Li(r)}catch(t){O(!1,t.message,e,r)}}function Su(r,e){return r==="0x"?0:ie(r,e)}function Le(r,e){if(r==="0x")return Xe;const t=X(r,e);return O(t<=kU,"value exceeds uint size",e,t),t}function De(r,e){const t=X(r,"value"),n=Ot(t);return O(n.length<=32,"value too large",`tx.${e}`,t),n}function ng(r){return Li(r).map(e=>[e.address,e.storageKeys])}function UU(r,e){O(Array.isArray(r),`invalid ${e}`,"value",r);for(let t=0;t<r.length;t++)O(Oe(r[t],32),"invalid ${ param } hash",`value[${t}]`,r[t]);return r}function LU(r){const e=Eh(r);O(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",r);const t={type:0,nonce:Su(e[0],"nonce"),gasPrice:Le(e[1],"gasPrice"),gasLimit:Le(e[2],"gasLimit"),to:Oh(e[3]),value:Le(e[4],"value"),data:Z(e[5]),chainId:Xe};if(e.length===6)return t;const n=Le(e[6],"v"),s=Le(e[7],"r"),i=Le(e[8],"s");if(s===Xe&&i===Xe)t.chainId=n;else{let o=(n-$U)/RU;o<Xe&&(o=Xe),t.chainId=o,O(o!==Xe||n===BU||n===FU,"non-canonical legacy v","v",e[6]),t.signature=$r.from({r:Di(e[7],32),s:Di(e[8],32),v:n})}return t}function MU(r,e){const t=[De(r.nonce,"nonce"),De(r.gasPrice||0,"gasPrice"),De(r.gasLimit,"gasLimit"),r.to||"0x",De(r.value,"value"),r.data];let n=Xe;if(r.chainId!=Xe)n=X(r.chainId,"tx.chainId"),O(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(r.signature){const i=r.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==Xe&&(t.push(Ot(n)),t.push("0x"),t.push("0x")),Ci(t);let s=BigInt(27+e.yParity);return n!==Xe?s=$r.getChainIdV(n,e.v):BigInt(e.v)!==s&&O(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(Ot(s)),t.push(Ot(e.r)),t.push(Ot(e.s)),Ci(t)}function sg(r,e){let t;try{if(t=Su(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{O(!1,"invalid yParity","yParity",e[0])}const n=Di(e[1],32),s=Di(e[2],32),i=$r.from({r:n,s,yParity:t});r.signature=i}function jU(r){const e=Eh(he(r).slice(1));O(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Z(r));const t={type:2,chainId:Le(e[0],"chainId"),nonce:Su(e[1],"nonce"),maxPriorityFeePerGas:Le(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Le(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Le(e[4],"gasLimit"),to:Oh(e[5]),value:Le(e[6],"value"),data:Z(e[7]),accessList:rg(e[8],"accessList")};return e.length===9||sg(t,e.slice(9)),t}function HU(r,e){const t=[De(r.chainId,"chainId"),De(r.nonce,"nonce"),De(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),De(r.maxFeePerGas||0,"maxFeePerGas"),De(r.gasLimit,"gasLimit"),r.to||"0x",De(r.value,"value"),r.data,ng(r.accessList||[])];return e&&(t.push(De(e.yParity,"yParity")),t.push(Ot(e.r)),t.push(Ot(e.s))),Me(["0x02",Ci(t)])}function zU(r){const e=Eh(he(r).slice(1));O(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Z(r));const t={type:1,chainId:Le(e[0],"chainId"),nonce:Su(e[1],"nonce"),gasPrice:Le(e[2],"gasPrice"),gasLimit:Le(e[3],"gasLimit"),to:Oh(e[4]),value:Le(e[5],"value"),data:Z(e[6]),accessList:rg(e[7],"accessList")};return e.length===8||sg(t,e.slice(8)),t}function qU(r,e){const t=[De(r.chainId,"chainId"),De(r.nonce,"nonce"),De(r.gasPrice||0,"gasPrice"),De(r.gasLimit,"gasLimit"),r.to||"0x",De(r.value,"value"),r.data,ng(r.accessList||[])];return e&&(t.push(De(e.yParity,"recoveryParam")),t.push(Ot(e.r)),t.push(Ot(e.s))),Me(["0x01",Ci(t)])}function VU(r){let e=Eh(he(r).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];O(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),O(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),O(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),O(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),O(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let c=0;c<e[1].length;c++)n.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}O(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",Z(r));const s={type:3,chainId:Le(e[0],"chainId"),nonce:Su(e[1],"nonce"),maxPriorityFeePerGas:Le(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Le(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Le(e[4],"gasLimit"),to:Oh(e[5]),value:Le(e[6],"value"),data:Z(e[7]),accessList:rg(e[8],"accessList"),maxFeePerBlobGas:Le(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),O(s.to!=null,`invalid address for transaction type: ${t}`,"data",r),O(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",r);for(let i=0;i<s.blobVersionedHashes.length;i++)O(Oe(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",r);return e.length===11||sg(s,e.slice(11)),s}function GU(r,e,t){const n=[De(r.chainId,"chainId"),De(r.nonce,"nonce"),De(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),De(r.maxFeePerGas||0,"maxFeePerGas"),De(r.gasLimit,"gasLimit"),r.to||Rc,De(r.value,"value"),r.data,ng(r.accessList||[]),De(r.maxFeePerBlobGas||0,"maxFeePerBlobGas"),UU(r.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(De(e.yParity,"yParity")),n.push(Ot(e.r)),n.push(Ot(e.s)),t)?Me(["0x03",Ci([n,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):Me(["0x03",Ci(n)])}var Wr,qo,Vo,Go,Ko,Qo,Wo,Jo,Yo,Zo,Xo,ea,ui,cs,Cn,us,ta,pl;const En=class En{constructor(){F(this,ta);F(this,Wr,void 0);F(this,qo,void 0);F(this,Vo,void 0);F(this,Go,void 0);F(this,Ko,void 0);F(this,Qo,void 0);F(this,Wo,void 0);F(this,Jo,void 0);F(this,Yo,void 0);F(this,Zo,void 0);F(this,Xo,void 0);F(this,ea,void 0);F(this,ui,void 0);F(this,cs,void 0);F(this,Cn,void 0);F(this,us,void 0);I(this,Wr,null),I(this,qo,null),I(this,Go,0),I(this,Ko,Xe),I(this,Qo,null),I(this,Wo,null),I(this,Jo,null),I(this,Vo,"0x"),I(this,Yo,Xe),I(this,Zo,Xe),I(this,Xo,null),I(this,ea,null),I(this,ui,null),I(this,cs,null),I(this,us,null),I(this,Cn,null)}get type(){return y(this,Wr)}set type(e){switch(e){case null:I(this,Wr,null);break;case 0:case"legacy":I(this,Wr,0);break;case 1:case"berlin":case"eip-2930":I(this,Wr,1);break;case 2:case"london":case"eip-1559":I(this,Wr,2);break;case 3:case"cancun":case"eip-4844":I(this,Wr,3);break;default:O(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=y(this,qo);return e==null&&this.type===3?Rc:e}set to(e){I(this,qo,e==null?null:ve(e))}get nonce(){return y(this,Go)}set nonce(e){I(this,Go,ie(e,"value"))}get gasLimit(){return y(this,Ko)}set gasLimit(e){I(this,Ko,X(e))}get gasPrice(){const e=y(this,Qo);return e==null&&(this.type===0||this.type===1)?Xe:e}set gasPrice(e){I(this,Qo,e==null?null:X(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=y(this,Wo);return e??(this.type===2||this.type===3?Xe:null)}set maxPriorityFeePerGas(e){I(this,Wo,e==null?null:X(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=y(this,Jo);return e??(this.type===2||this.type===3?Xe:null)}set maxFeePerGas(e){I(this,Jo,e==null?null:X(e,"maxFeePerGas"))}get data(){return y(this,Vo)}set data(e){I(this,Vo,Z(e))}get value(){return y(this,Yo)}set value(e){I(this,Yo,X(e,"value"))}get chainId(){return y(this,Zo)}set chainId(e){I(this,Zo,X(e))}get signature(){return y(this,Xo)||null}set signature(e){I(this,Xo,e==null?null:$r.from(e))}get accessList(){const e=y(this,ea)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){I(this,ea,e==null?null:Li(e))}get maxFeePerBlobGas(){const e=y(this,ui);return e==null&&this.type===3?Xe:e}set maxFeePerBlobGas(e){I(this,ui,e==null?null:X(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=y(this,cs);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){O(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)O(Oe(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}I(this,cs,e)}get blobs(){return y(this,us)==null?null:y(this,us).map(e=>Object.assign({},e))}set blobs(e){if(e==null){I(this,us,null);return}const t=[],n=[];for(let s=0;s<e.length;s++){const i=e[s];if(zp(i)){L(y(this,Cn),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=he(i);if(O(o.length<=Tf,"blob is too large",`blobs[${s}]`,i),o.length!==Tf){const u=new Uint8Array(Tf);u.set(o),o=u}const a=y(this,Cn).blobToKzgCommitment(o),c=Z(y(this,Cn).computeBlobKzgProof(o,a));t.push({data:Z(o),commitment:Z(a),proof:c}),n.push(Xw(1,a))}else{const o=Z(i.commitment);t.push({data:Z(i.data),commitment:o,proof:Z(i.proof)}),n.push(Xw(1,o))}}I(this,us,t),I(this,cs,n)}get kzg(){return y(this,Cn)}set kzg(e){I(this,Cn,e)}get hash(){return this.signature==null?null:qe(j(this,ta,pl).call(this,!0,!1))}get unsignedHash(){return qe(this.unsignedSerialized)}get from(){return this.signature==null?null:TU(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Bc.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return j(this,ta,pl).call(this,!0,!0)}get unsignedSerialized(){return j(this,ta,pl).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=y(this,ui)!=null||y(this,cs);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&L(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),L(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),L(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):t?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return En.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new En;if(typeof e=="string"){const n=he(e);if(n[0]>=127)return En.from(LU(n));switch(n[0]){case 1:return En.from(zU(n));case 2:return En.from(jU(n));case 3:return En.from(VU(n))}L(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new En;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=$r.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(O(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),O(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(O(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),O(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};Wr=new WeakMap,qo=new WeakMap,Vo=new WeakMap,Go=new WeakMap,Ko=new WeakMap,Qo=new WeakMap,Wo=new WeakMap,Jo=new WeakMap,Yo=new WeakMap,Zo=new WeakMap,Xo=new WeakMap,ea=new WeakMap,ui=new WeakMap,cs=new WeakMap,Cn=new WeakMap,us=new WeakMap,ta=new WeakSet,pl=function(e,t){L(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return MU(this,n);case 1:return qU(this,n);case 2:return HU(this,n);case 3:return GU(this,n,t?this.blobs:null)}L(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let jl=En;const AE=new Uint8Array(32);AE.fill(0);const KU=BigInt(-1),IE=BigInt(0),PE=BigInt(1),QU=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function WU(r){const e=he(r),t=e.length%32;return t?Me([e,AE.slice(t)]):Z(e)}const JU=Os(PE,32),YU=Os(IE,32),e0={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},Rf=["name","version","chainId","verifyingContract","salt"];function t0(r){return function(e){return O(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const ZU={name:t0("name"),version:t0("version"),chainId:function(r){const e=X(r,"domain.chainId");return O(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):Eo(e)},verifyingContract:function(r){try{return ve(r).toLowerCase()}catch{}O(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=he(r,"domain.salt");return O(e.length===32,'invalid domain value "salt"',"domain.salt",r),Z(e)}};function Bf(r){{const e=r.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);O(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",r);const s=Qs(QU,t?n-1:n),i=t?(s+PE)*KU:IE;return function(o){const a=X(o,"value");return O(a>=i&&a<=s,`value out-of-bounds for ${r}`,"value",a),Os(t?hv(a,256):a,32)}}}{const e=r.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return O(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",r),function(n){const s=he(n);return O(s.length===t,`invalid length for ${r}`,"value",n),WU(n)}}}switch(r){case"address":return function(e){return Di(ve(e),32)};case"bool":return function(e){return e?JU:YU};case"bytes":return function(e){return qe(e)};case"string":return function(e){return _i(e)}}return null}function r0(r,e){return`${r}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function el(r){const e=r.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:r}}var Jc,_n,ra,Ql,xE;const cr=class cr{constructor(e){F(this,Ql);B(this,"primaryType");F(this,Jc,void 0);F(this,_n,void 0);F(this,ra,void 0);I(this,_n,new Map),I(this,ra,new Map);const t=new Map,n=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:u,type:l})=>{let{base:h,index:f}=el(l);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:u,type:h+(f||"")}}),t.set(c,new Set),n.set(c,[]),s.set(c,new Set)}),I(this,Jc,JSON.stringify(i));for(const c in i){const u=new Set;for(const l of i[c]){O(!u.has(l.name),`duplicate variable name ${JSON.stringify(l.name)} in ${JSON.stringify(c)}`,"types",e),u.add(l.name);const h=el(l.type).base;O(h!==c,`circular type reference to ${JSON.stringify(h)}`,"types",e),!Bf(h)&&(O(n.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),n.get(h).push(c),t.get(c).add(h))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);O(o.length!==0,"missing primary type","types",e),O(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),te(this,{primaryType:o[0]});function a(c,u){O(!u.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),u.add(c);for(const l of t.get(c))if(n.has(l)){a(l,u);for(const h of u)s.get(h).add(l)}u.delete(c)}a(this.primaryType,new Set);for(const[c,u]of s){const l=Array.from(u);l.sort(),y(this,_n).set(c,r0(c,i[c])+l.map(h=>r0(h,i[h])).join(""))}}get types(){return JSON.parse(y(this,Jc))}getEncoder(e){let t=y(this,ra).get(e);return t||(t=j(this,Ql,xE).call(this,e),y(this,ra).set(e,t)),t}encodeType(e){const t=y(this,_n).get(e);return O(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return qe(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(Bf(e))return n(e,t);const s=el(e).array;if(s)return O(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],n),o),{});O(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new cr(e)}static getPrimaryType(e){return cr.from(e).primaryType}static hashStruct(e,t,n){return cr.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const s=e0[n];O(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:s})}return t.sort((n,s)=>Rf.indexOf(n.name)-Rf.indexOf(s.name)),cr.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return Me(["0x1901",cr.hashDomain(e),cr.from(t).hash(n)])}static hash(e,t,n){return qe(cr.encode(e,t,n))}static async resolveNames(e,t,n,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!Oe(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=cr.from(t);o.visit(n,(a,c)=>(a==="address"&&!Oe(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,t,n){cr.hashDomain(e);const s={},i=[];Rf.forEach(c=>{const u=e[c];u!=null&&(s[c]=ZU[c](u),i.push({name:c,type:e0[c]}))});const o=cr.from(t);t=o.types;const a=Object.assign({},t);return O(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(n),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(n,(c,u)=>{if(c.match(/^bytes(\d*)/))return Z(he(u));if(c.match(/^u?int/))return X(u).toString();switch(c){case"address":return u.toLowerCase();case"bool":return!!u;case"string":return O(typeof u=="string","invalid string","value",u),u}O(!1,"unsupported type","type",c)})}}};Jc=new WeakMap,_n=new WeakMap,ra=new WeakMap,Ql=new WeakSet,xE=function(e){{const s=Bf(e);if(s)return s}const t=el(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{O(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return y(this,_n).has(s)&&(a=a.map(qe)),qe(Me(a))}}const n=this.types[e];if(n){const s=_i(y(this,_n).get(e));return i=>{const o=n.map(({name:a,type:c})=>{const u=this.getEncoder(c)(i[a]);return y(this,_n).has(c)?qe(u):u});return o.unshift(s),Me(o)}}O(!1,`unknown type: ${e}`,"type",e)};let Hl=cr;function Ct(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const XU="external public payable override",e6=Ct(XU.split(" ")),OE="constant external internal payable private public pure view override",t6=Ct(OE.split(" ")),SE="constructor error event fallback function receive struct",DE=Ct(SE.split(" ")),CE="calldata memory storage payable indexed",r6=Ct(CE.split(" ")),n6="tuple returns",s6=[SE,CE,n6,OE].join(" "),i6=Ct(s6.split(" ")),o6={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},a6=new RegExp("^(\\s*)"),c6=new RegExp("^([0-9]+)"),u6=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),_E=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),NE=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var at,Nr,Yc,Yd;const Wl=class Wl{constructor(e){F(this,Yc);F(this,at,void 0);F(this,Nr,void 0);I(this,at,0),I(this,Nr,e.slice())}get offset(){return y(this,at)}get length(){return y(this,Nr).length-y(this,at)}clone(){return new Wl(y(this,Nr))}reset(){I(this,at,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=j(this,Yc,Yd).call(this,y(this,at)+1,e.match+1);return I(this,at,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;y(this,at)<e.match-1;){const n=this.peek().linkNext;t.push(j(this,Yc,Yd).call(this,y(this,at)+1,n)),I(this,at,n)}return I(this,at,e.match+1),t}peek(){if(y(this,at)>=y(this,Nr).length)throw new Error("out-of-bounds");return y(this,Nr)[y(this,at)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Va(this,at)._++,e}toString(){const e=[];for(let t=y(this,at);t<y(this,Nr).length;t++){const n=y(this,Nr)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};at=new WeakMap,Nr=new WeakMap,Yc=new WeakSet,Yd=function(e=0,t=0){return new Wl(y(this,Nr).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let kr=Wl;function Cs(r){const e=[],t=o=>{const a=i<r.length?JSON.stringify(r[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let n=[],s=[],i=0;for(;i<r.length;){let o=r.substring(i),a=o.match(a6);a&&(i+=a[1].length,o=r.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let u=o6[o[0]]||"";if(u){if(c.type=u,c.text=o[0],i++,u==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(u=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(u==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(u==="OPEN_BRACKET")c.type="BRACKET";else if(u==="CLOSE_BRACKET"){let l=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;l=h+l,e[e.length-1].value=ie(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=l}continue}if(a=o.match(u6),a){if(c.text=a[1],i+=c.text.length,i6.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(NE)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(c6),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new kr(e.map(o=>Object.freeze(o)))}function n0(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function Sh(r,e){if(e.peekKeyword(DE)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function Vn(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function TE(r){let e=Vn(r,t6);return n0(e,Ct("constant payable nonpayable".split(" "))),n0(e,Ct("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function zn(r,e){return r.popParams().map(t=>ht.from(t,e))}function RE(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return X(r.pop().text);throw new Error("invalid gas")}return null}function Ni(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const l6=new RegExp(/^(.*)\[([0-9]*)\]$/);function s0(r){const e=r.match(NE);if(O(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);O(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);O(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const Ne={},Ht=Symbol.for("_ethers_internal"),i0="_ParamTypeInternal",o0="_ErrorInternal",a0="_EventInternal",c0="_ConstructorInternal",u0="_FallbackInternal",l0="_FunctionInternal",h0="_StructInternal";var na,gl;const ur=class ur{constructor(e,t,n,s,i,o,a,c){F(this,na);B(this,"name");B(this,"type");B(this,"baseType");B(this,"indexed");B(this,"components");B(this,"arrayLength");B(this,"arrayChildren");if(xu(e,Ne,"ParamType"),Object.defineProperty(this,Ht,{value:i0}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");te(this,{name:t,type:n,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,i)=>n.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return j(this,na,gl).call(this,n,e,t,i=>{s[0]=i}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(ur.isParamType(e))return e;if(typeof e=="string")try{return ur.from(Cs(e),t)}catch{O(!1,"invalid param type","obj",e)}else if(e instanceof kr){let a="",c="",u=null;Vn(e,Ct(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",u=e.popParams().map(g=>ur.from(g)),a=`tuple(${u.map(g=>g.format()).join(",")})`):(a=s0(e.popType("TYPE")),c=a);let l=null,h=null;for(;e.length&&e.peekType("BRACKET");){const g=e.pop();l=new ur(Ne,"",a,c,null,u,h,l),h=g.value,a+=g.text,c="array",u=null}let f=null;if(Vn(e,r6).has("indexed")){if(!t)throw new Error("");f=!0}const p=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new ur(Ne,p,a,c,f,u,h,l)}const n=e.name;O(!n||typeof n=="string"&&n.match(_E),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(O(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(l6);if(o){const a=parseInt(o[2]||"-1"),c=ur.from({type:o[1],components:e.components});return new ur(Ne,n||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(u=>ur.from(u)):null;return new ur(Ne,n||"",i,"tuple",s,a,null,null)}return i=s0(e.type),new ur(Ne,n||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[Ht]===i0}};na=new WeakSet,gl=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,u)=>{var l;j(l=o,na,gl).call(l,e,c,n,h=>{a[u]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,u)=>{var l;j(l=o[u],na,gl).call(l,e,c,n,h=>{a[u]=h})}),s(a);return}const i=n(this.type,t);i.then?e.push(async function(){s(await i)}()):s(i)};let ht=ur;class Ti{constructor(e,t,n){B(this,"type");B(this,"inputs");xu(e,Ne,"Fragment"),n=Object.freeze(n.slice()),te(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{Ti.from(JSON.parse(e))}catch{}return Ti.from(Cs(e))}if(e instanceof kr)switch(e.peekKeyword(DE)){case"constructor":return Ln.from(e);case"error":return Mt.from(e);case"event":return sn.from(e);case"fallback":case"receive":return In.from(e);case"function":return on.from(e);case"struct":return Ai.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Ln.from(e);case"error":return Mt.from(e);case"event":return sn.from(e);case"fallback":case"receive":return In.from(e);case"function":return on.from(e);case"struct":return Ai.from(e)}L(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}O(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Ln.isFragment(e)}static isError(e){return Mt.isFragment(e)}static isEvent(e){return sn.isFragment(e)}static isFunction(e){return on.isFragment(e)}static isStruct(e){return Ai.isFragment(e)}}class Dh extends Ti{constructor(t,n,s,i){super(t,n,i);B(this,"name");O(typeof s=="string"&&s.match(_E),"invalid identifier","name",s),i=Object.freeze(i.slice()),te(this,{name:s})}}function Lc(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class Mt extends Dh{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Ht,{value:o0})}get selector(){return _i(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+Lc(e,this.inputs)),t.join(" ")}static from(e){if(Mt.isFragment(e))return e;if(typeof e=="string")return Mt.from(Cs(e));if(e instanceof kr){const t=Sh("error",e),n=zn(e);return Ni(e),new Mt(Ne,t,n)}return new Mt(Ne,e.name,e.inputs?e.inputs.map(ht.from):[])}static isFragment(e){return e&&e[Ht]===o0}}class sn extends Dh{constructor(t,n,s,i){super(t,"event",n,s);B(this,"anonymous");Object.defineProperty(this,Ht,{value:a0}),te(this,{anonymous:i})}get topicHash(){return _i(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+Lc(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(i=>ht.from(i)),new sn(Ne,t,n,!1).topicHash}static from(t){if(sn.isFragment(t))return t;if(typeof t=="string")try{return sn.from(Cs(t))}catch{O(!1,"invalid event fragment","obj",t)}else if(t instanceof kr){const n=Sh("event",t),s=zn(t,!0),i=!!Vn(t,Ct(["anonymous"])).has("anonymous");return Ni(t),new sn(Ne,n,s,i)}return new sn(Ne,t.name,t.inputs?t.inputs.map(n=>ht.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Ht]===a0}}class Ln extends Ti{constructor(t,n,s,i,o){super(t,n,s);B(this,"payable");B(this,"gas");Object.defineProperty(this,Ht,{value:c0}),te(this,{payable:i,gas:o})}format(t){if(L(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${Lc(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Ln.isFragment(t))return t;if(typeof t=="string")try{return Ln.from(Cs(t))}catch{O(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof kr){Vn(t,Ct(["constructor"]));const n=zn(t),s=!!Vn(t,e6).has("payable"),i=RE(t);return Ni(t),new Ln(Ne,"constructor",n,s,i)}return new Ln(Ne,"constructor",t.inputs?t.inputs.map(ht.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ht]===c0}}class In extends Ti{constructor(t,n,s){super(t,"fallback",n);B(this,"payable");Object.defineProperty(this,Ht,{value:u0}),te(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(In.isFragment(t))return t;if(typeof t=="string")try{return In.from(Cs(t))}catch{O(!1,"invalid fallback fragment","obj",t)}else if(t instanceof kr){const n=t.toString(),s=t.peekKeyword(Ct(["fallback","receive"]));if(O(s,"type must be fallback or receive","obj",n),t.popKeyword(Ct(["fallback","receive"]))==="receive"){const c=zn(t);return O(c.length===0,"receive cannot have arguments","obj.inputs",c),Vn(t,Ct(["payable"])),Ni(t),new In(Ne,[],!0)}let o=zn(t);o.length?O(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[ht.from("bytes")];const a=TE(t);if(O(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Vn(t,Ct(["returns"])).has("returns")){const c=zn(t);O(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(u=>u.format("minimal")).join(", "))}return Ni(t),new In(Ne,o,a==="payable")}if(t.type==="receive")return new In(Ne,[],!0);if(t.type==="fallback"){const n=[ht.from("bytes")],s=t.stateMutability==="payable";return new In(Ne,n,s)}O(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Ht]===u0}}class on extends Dh{constructor(t,n,s,i,o,a){super(t,"function",n,i);B(this,"constant");B(this,"outputs");B(this,"stateMutability");B(this,"payable");B(this,"gas");Object.defineProperty(this,Ht,{value:l0}),o=Object.freeze(o.slice()),te(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return _i(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+Lc(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(Lc(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(i=>ht.from(i)),new on(Ne,t,"view",n,[],null).selector}static from(t){if(on.isFragment(t))return t;if(typeof t=="string")try{return on.from(Cs(t))}catch{O(!1,"invalid function fragment","obj",t)}else if(t instanceof kr){const s=Sh("function",t),i=zn(t),o=TE(t);let a=[];Vn(t,Ct(["returns"])).has("returns")&&(a=zn(t));const c=RE(t);return Ni(t),new on(Ne,s,o,i,a,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new on(Ne,t.name,n,t.inputs?t.inputs.map(ht.from):[],t.outputs?t.outputs.map(ht.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ht]===l0}}class Ai extends Dh{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Ht,{value:h0})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Ai.from(Cs(e))}catch{O(!1,"invalid struct fragment","obj",e)}else if(e instanceof kr){const t=Sh("struct",e),n=zn(e);return Ni(e),new Ai(Ne,t,n)}return new Ai(Ne,e.name,e.inputs?e.inputs.map(ht.from):[])}static isFragment(e){return e&&e[Ht]===h0}}const Lr=new Map;Lr.set(0,"GENERIC_PANIC");Lr.set(1,"ASSERT_FALSE");Lr.set(17,"OVERFLOW");Lr.set(18,"DIVIDE_BY_ZERO");Lr.set(33,"ENUM_RANGE_ERROR");Lr.set(34,"BAD_STORAGE_DATA");Lr.set(49,"STACK_UNDERFLOW");Lr.set(50,"ARRAY_RANGE_ERROR");Lr.set(65,"OUT_OF_MEMORY");Lr.set(81,"UNINITIALIZED_FUNCTION_CALL");const h6=new RegExp(/^bytes([0-9]*)$/),f6=new RegExp(/^(u?int)([0-9]*)$/);let Ff=null,f0=1024;function d6(r,e,t,n){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const u=he(t);if(t=Z(t),u.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(u.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(Z(u.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],u.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(Z(u.slice(0,4))==="0x4e487b71")try{const l=Number(n.decode(["uint256"],u.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[l]},i=`Panic due to ${Lr.get(l)||"UNKNOWN"}(${l})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?ve(e.to):null,data:e.data||"0x"};return e.from&&(c.from=ve(e.from)),Re(s,"CALL_EXCEPTION",{action:r,data:t,reason:i,transaction:c,invocation:o,revert:a})}var ls,go;const Jl=class Jl{constructor(){F(this,ls)}getDefaultValue(e){const t=e.map(s=>j(this,ls,go).call(this,ht.from(s)));return new Xu(t,"_").defaultValue()}encode(e,t){cv(t.length,e.length,"types/values length mismatch");const n=e.map(o=>j(this,ls,go).call(this,ht.from(o))),s=new Xu(n,"_"),i=new kd;return s.encode(i,t),i.data}decode(e,t,n){const s=e.map(o=>j(this,ls,go).call(this,ht.from(o)));return new Xu(s,"_").decode(new Ud(t,n,f0))}static _setDefaultMaxInflation(e){O(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),f0=e}static defaultAbiCoder(){return Ff==null&&(Ff=new Jl),Ff}static getBuiltinCallException(e,t,n){return d6(e,t,n,Jl.defaultAbiCoder())}};ls=new WeakSet,go=function(e){if(e.isArray())return new $4(j(this,ls,go).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Xu(e.components.map(n=>j(this,ls,go).call(this,n)),e.name);switch(e.baseType){case"address":return new B4(e.name);case"bool":return new k4(e.name);case"string":return new G4(e.name);case"bytes":return new U4(e.name);case"":return new j4(e.name)}let t=e.type.match(f6);if(t){let n=parseInt(t[2]||"256");return O(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new V4(n/8,t[1]==="int",e.name)}if(t=e.type.match(h6),t){let n=parseInt(t[1]);return O(n!==0&&n<=32,"invalid bytes length","param",e),new L4(n,e.name)}O(!1,"invalid type","type",e.type)};let Mc=Jl;class p6{constructor(e,t,n){B(this,"fragment");B(this,"name");B(this,"signature");B(this,"topic");B(this,"args");const s=e.name,i=e.format();te(this,{fragment:e,name:s,signature:i,topic:t,args:n})}}class g6{constructor(e,t,n,s){B(this,"fragment");B(this,"name");B(this,"args");B(this,"signature");B(this,"selector");B(this,"value");const i=e.name,o=e.format();te(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:s})}}class y6{constructor(e,t,n){B(this,"fragment");B(this,"name");B(this,"args");B(this,"signature");B(this,"selector");const s=e.name,i=e.format();te(this,{fragment:e,name:s,args:n,signature:i,selector:t})}}class d0{constructor(e){B(this,"hash");B(this,"_isIndexed");te(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const p0={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},g0={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&p0[r.toString()]&&(e=p0[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var Jr,Yr,Zr,yt,sa,yl,ia,ml;const Vs=class Vs{constructor(e){F(this,sa);F(this,ia);B(this,"fragments");B(this,"deploy");B(this,"fallback");B(this,"receive");F(this,Jr,void 0);F(this,Yr,void 0);F(this,Zr,void 0);F(this,yt,void 0);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,I(this,Zr,new Map),I(this,Jr,new Map),I(this,Yr,new Map);const n=[];for(const o of t)try{n.push(Ti.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}te(this,{fragments:Object.freeze(n)});let s=null,i=!1;I(this,yt,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}te(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(O(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=y(this,Zr);break;case"event":c=y(this,Yr);break;case"error":c=y(this,Jr);break;default:return}const u=o.format();c.has(u)||c.set(u,o)}),this.deploy||te(this,{deploy:Ln.from("constructor()")}),te(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Mc.defaultAbiCoder()}getFunctionName(e){const t=j(this,sa,yl).call(this,e,null,!1);return O(t,"no matching function","key",e),t.name}hasFunction(e){return!!j(this,sa,yl).call(this,e,null,!1)}getFunction(e,t){return j(this,sa,yl).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(y(this,Zr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Zr).get(s),n)}}getEventName(e){const t=j(this,ia,ml).call(this,e,null,!1);return O(t,"no matching event","key",e),t.name}hasEvent(e){return!!j(this,ia,ml).call(this,e,null,!1)}getEvent(e,t){return j(this,ia,ml).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(y(this,Yr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Yr).get(s),n)}}getError(e,t){if(Oe(e)){const s=e.toLowerCase();if(g0[s])return Mt.from(g0[s].signature);for(const i of y(this,Jr).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of y(this,Jr))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Mt.from("error Error(string)"):e==="Panic"?Mt.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");O(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Mt.from(e).format(),e==="Error(string)")return Mt.from("error Error(string)");if(e==="Panic(uint256)")return Mt.from("error Panic(uint256)");const n=y(this,Jr).get(e);return n||null}forEachError(e){const t=Array.from(y(this,Jr).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Jr).get(s),n)}}_decodeParams(e,t){return y(this,yt).decode(e,t)}_encodeParams(e,t){return y(this,yt).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);O(n,"unknown error","fragment",e),e=n}return O(Be(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Be(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);O(n,"unknown error","fragment",e),e=n}return Me([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);O(n,"unknown function","fragment",e),e=n}return O(Be(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Be(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);O(n,"unknown function","fragment",e),e=n}return Me([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);O(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const s=xt(t);if(s.length%32===0)try{return y(this,yt).decode(e.outputs,s)}catch{n="could not decode result data"}L(!1,n,"BAD_DATA",{value:Z(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=he(e,"data"),s=Mc.getBuiltinCallException("call",t,n),i="execution reverted (unknown custom error)";if(s.message.startsWith(i)){const a=Z(n.slice(0,4)),c=this.getError(a);if(c)try{const u=y(this,yt).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:u},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);O(n,"unknown function","fragment",e),e=n}return Z(y(this,yt).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);O(i,"unknown event","eventFragment",e),e=i}L(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(i,o)=>i.type==="string"?_i(o):i.type==="bytes"?qe(Z(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Os(o):i.type.match(/^bytes/)?o=F$(o,32):i.type==="address"&&y(this,yt).encode(["address"],[o]),Di(Z(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){O(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?O(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?n.push(i.map(c=>s(a,c))):n.push(s(a,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);O(o,"unknown event","eventFragment",e),e=o}const n=[],s=[],i=[];return e.anonymous||n.push(e.topicHash),O(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(_i(c));else if(o.type==="bytes")n.push(qe(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(y(this,yt).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:y(this,yt).encode(s,i),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const d=this.getEvent(e);O(d,"unknown event","eventFragment",e),e=d}if(n!=null&&!e.anonymous){const d=e.topicHash;O(Oe(n[0],32)&&n[0].toLowerCase()===d,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((d,p)=>{d.indexed?d.type==="string"||d.type==="bytes"||d.baseType==="tuple"||d.baseType==="array"?(s.push(ht.from({type:"bytes32",name:d.name})),o.push(!0)):(s.push(d),o.push(!1)):(i.push(d),o.push(!1))});const a=n!=null?y(this,yt).decode(s,Me(n)):null,c=y(this,yt).decode(i,t,!0),u=[],l=[];let h=0,f=0;return e.inputs.forEach((d,p)=>{let g=null;if(d.indexed)if(a==null)g=new d0(null);else if(o[p])g=new d0(a[f++]);else try{g=a[f++]}catch(m){g=m}else try{g=c[h++]}catch(m){g=m}u.push(g),l.push(d.name||null)}),Da.fromItems(u,l)}parseTransaction(e){const t=he(e.data,"tx.data"),n=X(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(Z(t.slice(0,4)));if(!s)return null;const i=y(this,yt).decode(s.inputs,t.slice(4));return new g6(s,s.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new p6(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=Z(e),n=this.getError(Be(t,0,4));if(!n)return null;const s=y(this,yt).decode(n.inputs,Be(t,4));return new y6(n,n.selector,s)}static from(e){return e instanceof Vs?e:typeof e=="string"?new Vs(JSON.parse(e)):typeof e.formatJson=="function"?new Vs(e.formatJson()):typeof e.format=="function"?new Vs(e.format("json")):new Vs(e)}};Jr=new WeakMap,Yr=new WeakMap,Zr=new WeakMap,yt=new WeakMap,sa=new WeakSet,yl=function(e,t,n){if(Oe(e)){const i=e.toLowerCase();for(const o of y(this,Zr).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Zr))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;bt.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let u=i.length-1;u>=0;u--){const l=i[u].inputs.length;l!==a&&(!c||l!==a-1)&&i.splice(u,1)}for(let u=i.length-1;u>=0;u--){const l=i[u].inputs;for(let h=0;h<t.length;h++)if(bt.isTyped(t[h])){if(h>=l.length){if(t[h].type==="overrides")continue;i.splice(u,1);break}if(t[h].type!==l[h].baseType){i.splice(u,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");O(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Zr).get(on.from(e).format());return s||null},ia=new WeakSet,ml=function(e,t,n){if(Oe(e)){const i=e.toLowerCase();for(const o of y(this,Yr).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Yr))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(bt.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");O(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Yr).get(sn.from(e).format());return s||null};let Zd=Vs;const BE=BigInt(0);function No(r){return r??null}function Fe(r){return r==null?null:r.toString()}class y0{constructor(e,t,n){B(this,"gasPrice");B(this,"maxFeePerGas");B(this,"maxPriorityFeePerGas");te(this,{gasPrice:No(e),maxFeePerGas:No(t),maxPriorityFeePerGas:No(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:Fe(e),maxFeePerGas:Fe(t),maxPriorityFeePerGas:Fe(n)}}}function zl(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=Z(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=X(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=ie(r[s],`request.${s}`));return r.accessList&&(e.accessList=Li(r.accessList)),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>zp(s)?Z(s):Object.assign({},s))),e}var Nn;class m6{constructor(e,t){B(this,"provider");B(this,"number");B(this,"hash");B(this,"timestamp");B(this,"parentHash");B(this,"parentBeaconBlockRoot");B(this,"nonce");B(this,"difficulty");B(this,"gasLimit");B(this,"gasUsed");B(this,"stateRoot");B(this,"receiptsRoot");B(this,"blobGasUsed");B(this,"excessBlobGas");B(this,"miner");B(this,"prevRandao");B(this,"extraData");B(this,"baseFeePerGas");F(this,Nn,void 0);I(this,Nn,e.transactions.map(n=>typeof n!="string"?new jc(n,t):n)),te(this,{provider:t,hash:No(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:No(e.prevRandao),extraData:e.extraData,baseFeePerGas:No(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return y(this,Nn).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=y(this,Nn).slice();return e.length===0?[]:(L(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:u,number:l,parentHash:h,parentBeaconBlockRoot:f,stateRoot:d,receiptsRoot:p,timestamp:g,transactions:m}=this;return{_type:"Block",baseFeePerGas:Fe(e),difficulty:Fe(t),extraData:n,gasLimit:Fe(s),gasUsed:Fe(i),blobGasUsed:Fe(this.blobGasUsed),excessBlobGas:Fe(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:u,number:l,parentHash:h,timestamp:g,parentBeaconBlockRoot:f,stateRoot:d,receiptsRoot:p,transactions:m}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return y(this,Nn).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=y(this,Nn)[e];else{const n=e.toLowerCase();for(const s of y(this,Nn))if(typeof s=="string"){if(s!==n)continue;t=s;break}else{if(s.hash!==n)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;O(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return w6(this)}}Nn=new WeakMap;class Du{constructor(e,t){B(this,"provider");B(this,"transactionHash");B(this,"blockHash");B(this,"blockNumber");B(this,"removed");B(this,"address");B(this,"data");B(this,"topics");B(this,"index");B(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());te(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:u}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:u}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return L(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return L(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return L(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return b6(this)}}var Zc;class FE{constructor(e,t){B(this,"provider");B(this,"to");B(this,"from");B(this,"contractAddress");B(this,"hash");B(this,"index");B(this,"blockHash");B(this,"blockNumber");B(this,"logsBloom");B(this,"gasUsed");B(this,"blobGasUsed");B(this,"cumulativeGasUsed");B(this,"gasPrice");B(this,"blobGasPrice");B(this,"type");B(this,"status");B(this,"root");F(this,Zc,void 0);I(this,Zc,Object.freeze(e.logs.map(s=>new Du(s,t))));let n=BE;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),te(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return y(this,Zc)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:u,status:l,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:n,cumulativeGasUsed:Fe(this.cumulativeGasUsed),from:t,gasPrice:Fe(this.gasPrice),blobGasUsed:Fe(this.blobGasUsed),blobGasPrice:Fe(this.blobGasPrice),gasUsed:Fe(this.gasUsed),hash:s,index:i,logs:u,logsBloom:c,root:h,status:l,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return kE(this)}reorderedEvent(e){return L(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),$E(this,e)}}Zc=new WeakMap;var hs;const fg=class fg{constructor(e,t){B(this,"provider");B(this,"blockNumber");B(this,"blockHash");B(this,"index");B(this,"hash");B(this,"type");B(this,"to");B(this,"from");B(this,"nonce");B(this,"gasLimit");B(this,"gasPrice");B(this,"maxPriorityFeePerGas");B(this,"maxFeePerGas");B(this,"maxFeePerBlobGas");B(this,"data");B(this,"value");B(this,"chainId");B(this,"signature");B(this,"accessList");B(this,"blobVersionedHashes");F(this,hs,void 0);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,I(this,hs,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:i,to:o,from:a,nonce:c,data:u,signature:l,accessList:h,blobVersionedHashes:f}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:t,blobVersionedHashes:f,chainId:Fe(this.chainId),data:u,from:a,gasLimit:Fe(this.gasLimit),gasPrice:Fe(this.gasPrice),hash:s,maxFeePerGas:Fe(this.maxFeePerGas),maxPriorityFeePerGas:Fe(this.maxPriorityFeePerGas),maxFeePerBlobGas:Fe(this.maxFeePerBlobGas),nonce:c,signature:l,to:o,index:n,type:i,value:Fe(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await Pt({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let i=y(this,hs),o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:f,nonce:d}=await Pt({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(d<this.nonce){i=f;return}if(a)return null;const p=await this.getTransaction();if(!(p&&p.blockNumber!=null))for(o===-1&&(o=i-3,o<y(this,hs)&&(o=y(this,hs)));o<=f;){if(a)return null;const g=await this.provider.getBlock(o,!0);if(g==null)return;for(const m of g)if(m===this.hash)return;for(let m=0;m<g.length;m++){const b=await g.getTransaction(m);if(b.from===this.from&&b.nonce===this.nonce){if(a)return null;const E=await this.provider.getTransactionReceipt(b.hash);if(E==null||f-E.blockNumber+1<n)return;let A="replaced";b.data===this.data&&b.to===this.to&&b.value===this.value?A="repriced":b.data==="0x"&&b.from===b.to&&b.value===BE&&(A="cancelled"),L(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:A==="replaced"||A==="cancelled",reason:A,replacement:b.replaceableTransaction(i),hash:b.hash,receipt:E})}}o++}},u=f=>{if(f==null||f.status!==0)return f;L(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:f.to,from:f.from,data:""},receipt:f})},l=await this.provider.getTransactionReceipt(this.hash);if(n===0)return u(l);if(l){if(await l.confirmations()>=n)return u(l)}else if(await c(),n===0)return null;return await new Promise((f,d)=>{const p=[],g=()=>{p.forEach(b=>b())};if(p.push(()=>{a=!0}),s>0){const b=setTimeout(()=>{g(),d(Re("wait for transaction timeout","TIMEOUT"))},s);p.push(()=>{clearTimeout(b)})}const m=async b=>{if(await b.confirmations()>=n){g();try{f(u(b))}catch(E){d(E)}}};if(p.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),i>=0){const b=async()=>{try{await c()}catch(E){if(lt(E,"TRANSACTION_REPLACED")){g(),d(E);return}}a||this.provider.once("block",b)};p.push(()=>{this.provider.off("block",b)}),this.provider.once("block",b)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return L(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),kE(this)}reorderedEvent(e){return L(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),L(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),$E(this,e)}replaceableTransaction(e){O(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new fg(this,this.provider);return I(t,hs,e),t}};hs=new WeakMap;let jc=fg;function w6(r){return{orphan:"drop-block",hash:r.hash,number:r.number}}function $E(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function kE(r){return{orphan:"drop-transaction",tx:r}}function b6(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class ig extends Du{constructor(t,n,s){super(t,t.provider);B(this,"interface");B(this,"fragment");B(this,"args");const i=n.decodeEventLog(s,t.data,t.topics);te(this,{args:i,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class UE extends Du{constructor(t,n){super(t,t.provider);B(this,"error");te(this,{error:n})}}var oa;class v6 extends FE{constructor(t,n,s){super(s,n);F(this,oa,void 0);I(this,oa,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?y(this,oa).getEvent(t.topics[0]):null;if(n)try{return new ig(t,y(this,oa),n)}catch(s){return new UE(t,s)}return t})}}oa=new WeakMap;var Xc;class og extends jc{constructor(t,n,s){super(s,n);F(this,Xc,void 0);I(this,Xc,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new v6(y(this,Xc),this.provider,s)}}Xc=new WeakMap;class LE extends fv{constructor(t,n,s,i){super(t,n,s);B(this,"log");te(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class E6 extends LE{constructor(e,t,n,s,i){super(e,t,n,new ig(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);te(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const m0=BigInt(0);function ME(r){return r&&typeof r.call=="function"}function jE(r){return r&&typeof r.estimateGas=="function"}function Ch(r){return r&&typeof r.resolveName=="function"}function HE(r){return r&&typeof r.sendTransaction=="function"}function zE(r){if(r!=null){if(Ch(r))return r;if(r.provider)return r.provider}}var eu;class A6{constructor(e,t,n){F(this,eu,void 0);B(this,"fragment");if(te(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=Ri(e.runner,"resolveName"),i=Ch(s)?s:null;I(this,eu,async function(){const o=await Promise.all(t.inputs.map((a,c)=>n[c]==null?null:a.walkAsync(n[c],(l,h)=>l==="address"?Array.isArray(h)?Promise.all(h.map(f=>Dt(f,i))):Dt(h,i):h)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return y(this,eu)}}eu=new WeakMap;function Ri(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function Ys(r){return r==null?null:r.provider||null}async function qE(r,e){const t=bt.dereference(r,"overrides");O(typeof t=="object","invalid overrides parameter","overrides",r);const n=zl(t);return O(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),O(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function I6(r,e,t){const n=Ri(r,"resolveName"),s=Ch(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=bt.dereference(c,a),a==="address"?Dt(c,s):c))))}function P6(r){const e=async function(o){const a=await qE(o,["data"]);a.to=await r.getAddress(),a.from&&(a.from=await Dt(a.from,zE(r.runner)));const c=r.interface,u=X(a.value||m0,"overrides.value")===m0,l=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!l&&!u&&O(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),O(c.fallback||l,"cannot send data to receive-only contract","overrides.data",a.data);const h=c.receive||c.fallback&&c.fallback.payable;return O(h||u,"cannot send value to non-payable fallback","overrides.value",a.value),O(c.fallback||l,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=Ri(r.runner,"call");L(ME(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(u){throw Hp(u)&&u.data?r.interface.makeError(u.data,c):u}},n=async function(o){const a=r.runner;L(HE(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),u=Ys(r.runner);return new og(r.interface,u,c)},s=async function(o){const a=Ri(r.runner,"estimateGas");return L(jE(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await n(o);return te(i,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),i}function x6(r,e){const t=function(...u){const l=r.interface.getFunction(e,u);return L(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:u}}),l},n=async function(...u){const l=t(...u);let h={};if(l.inputs.length+1===u.length&&(h=await qE(u.pop()),h.from&&(h.from=await Dt(h.from,zE(r.runner)))),l.inputs.length!==u.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const f=await I6(r.runner,l.inputs,u);return Object.assign({},h,await Pt({to:r.getAddress(),data:r.interface.encodeFunctionData(l,f)}))},s=async function(...u){const l=await a(...u);return l.length===1?l[0]:l},i=async function(...u){const l=r.runner;L(HE(l),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await l.sendTransaction(await n(...u)),f=Ys(r.runner);return new og(r.interface,f,h)},o=async function(...u){const l=Ri(r.runner,"estimateGas");return L(jE(l),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await l.estimateGas(await n(...u))},a=async function(...u){const l=Ri(r.runner,"call");L(ME(l),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await n(...u);let f="0x";try{f=await l.call(h)}catch(p){throw Hp(p)&&p.data?r.interface.makeError(p.data,h):p}const d=t(...u);return r.interface.decodeFunctionResult(d,f)},c=async(...u)=>t(...u).constant?await s(...u):await i(...u);return te(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:o,populateTransaction:n,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const u=r.interface.getFunction(e);return L(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),u}}),c}function O6(r,e){const t=function(...s){const i=r.interface.getEvent(e,s);return L(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},n=function(...s){return new A6(r,t(...s),s)};return te(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return L(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const ql=Symbol.for("_ethersInternal_contract"),VE=new WeakMap;function S6(r,e){VE.set(r[ql],e)}function Qt(r){return VE.get(r[ql])}function D6(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function ag(r,e){let t,n=null;if(Array.isArray(e)){const i=function(o){if(Oe(o,32))return o;const a=r.interface.getEvent(o);return O(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?Oe(e,32)?t=[e]:(n=r.interface.getEvent(e),O(n,"unknown fragment","event",e),t=[n.topicHash]):D6(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):O(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:s,topics:t}}async function hc(r,e){const{subs:t}=Qt(r);return t.get((await ag(r,e)).tag)||null}async function w0(r,e,t){const n=Ys(r.runner);L(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await ag(r,t),{addr:a,subs:c}=Qt(r);let u=c.get(i);if(!u){const h={address:a||r,topics:o},f=m=>{let b=s;if(b==null)try{b=r.interface.getEvent(m.topics[0])}catch{}if(b){const E=b,A=s?r.interface.decodeEventLog(s,m.data,m.topics):[];ep(r,t,A,x=>new E6(r,x,t,E,m))}else ep(r,t,[],E=>new LE(r,E,t,m))};let d=[];u={tag:i,listeners:[],start:()=>{d.length||d.push(n.on(h,f))},stop:async()=>{if(d.length==0)return;let m=d;d=[],await Promise.all(m),n.off(h,f)}},c.set(i,u)}return u}let Xd=Promise.resolve();async function C6(r,e,t,n){await Xd;const s=await hc(r,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);n&&c.push(n(a?null:o));try{o.call(r,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),Qt(r).subs.delete(s.tag)),i>0}async function ep(r,e,t,n){try{await Xd}catch{}const s=C6(r,e,t,n);return Xd=s,await s}const tl=["then"];var mL;const Ec=class Ec{constructor(e,t,n,s){B(this,"target");B(this,"interface");B(this,"runner");B(this,"filters");B(this,mL);B(this,"fallback");O(typeof e=="string"||Yv(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=Zd.from(t);te(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,ql,{value:{}});let o,a=null,c=null;if(s){const h=Ys(n);c=new og(this.interface,h,s)}let u=new Map;if(typeof e=="string")if(Oe(e))a=e,o=Promise.resolve(e);else{const h=Ri(n,"resolveName");if(!Ch(h))throw Re("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(f=>{if(f==null)throw Re("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Qt(this).addr=f,f})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Qt(this).addr=h,h});S6(this,{addrPromise:o,addr:a,deployTx:c,subs:u});const l=new Proxy({},{get:(h,f,d)=>{if(typeof f=="symbol"||tl.indexOf(f)>=0)return Reflect.get(h,f,d);try{return this.getEvent(f)}catch(p){if(!lt(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,f)=>tl.indexOf(f)>=0?Reflect.has(h,f):Reflect.has(h,f)||this.interface.hasEvent(String(f))});return te(this,{filters:l}),te(this,{fallback:i.receive||i.fallback?P6(this):null}),new Proxy(this,{get:(h,f,d)=>{if(typeof f=="symbol"||f in h||tl.indexOf(f)>=0)return Reflect.get(h,f,d);try{return h.getFunction(f)}catch(p){if(!lt(p,"INVALID_ARGUMENT")||p.argument!=="key")throw p}},has:(h,f)=>typeof f=="symbol"||f in h||tl.indexOf(f)>=0?Reflect.has(h,f):h.interface.hasFunction(f)})}connect(e){return new Ec(this.target,this.interface,e)}attach(e){return new Ec(e,this.interface,this.runner)}async getAddress(){return await Qt(this).addrPromise}async getDeployedCode(){const e=Ys(this.runner);L(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=Ys(this.runner);return L(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return Qt(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),x6(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),O6(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:i}=Qt(this),o=s||await i,{fragment:a,topics:c}=await ag(this,e),u={address:o,topics:c,fromBlock:t,toBlock:n},l=Ys(this.runner);return L(l,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await l.getLogs(u)).map(h=>{let f=a;if(f==null)try{f=this.interface.getEvent(h.topics[0])}catch{}if(f)try{return new ig(h,this.interface,f)}catch(d){return new UE(h,d)}return new Du(h,l)})}async on(e,t){const n=await w0(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await w0(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await ep(this,e,t,null)}async listenerCount(e){if(e){const s=await hc(this,e);return s?s.listeners.length:0}const{subs:t}=Qt(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await hc(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=Qt(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:i})=>i));return n}async off(e,t){const n=await hc(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),Qt(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await hc(this,e);if(!t)return this;t.stop(),Qt(this).subs.delete(t.tag)}else{const{subs:t}=Qt(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends Ec{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};mL=ql;let tp=Ec;function _6(){return tp}class To extends _6(){}function $f(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):O(!1,"unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}class N6{constructor(e){B(this,"name");te(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const GE=new RegExp("^(ipfs)://(.*)$","i"),b0=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),GE,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var fs,li,ds,yo,Yl,KE;const Po=class Po{constructor(e,t,n){F(this,ds);B(this,"provider");B(this,"address");B(this,"name");F(this,fs,void 0);F(this,li,void 0);te(this,{provider:e,address:t,name:n}),I(this,fs,null),I(this,li,new To(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return y(this,fs)==null&&I(this,fs,(async()=>{try{return await y(this,li).supportsInterface("0x9061b923")}catch(e){if(lt(e,"CALL_EXCEPTION"))return!1;throw I(this,fs,null),e}})()),await y(this,fs)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await j(this,ds,yo).call(this,"addr(bytes32)");return i==null||i===Rc?null:i}catch(i){if(lt(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await j(this,ds,yo).call(this,"addr(bytes32,uint)",[i]);if(Oe(o,20))return ve(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof N6&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const n=await j(this,ds,yo).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;L(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await j(this,ds,yo).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await j(this,ds,yo).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${k$("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;L(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<b0.length;n++){const s=t.match(b0[n]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=$f(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const u=c[1],l=new To(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const g=await l.ownerOf(u);if(a!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(i==="erc1155"){const g=await l.balanceOf(a,u);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let h=await l[o](u);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",Os(u,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=$f(h)),e.push({type:"metadata-url",value:h});let f={};const d=await new Ss(h).send();d.assertOk();try{f=d.bodyJson}catch{try{e.push({type:"!metadata",value:d.bodyText})}catch{const b=d.body;return b&&e.push({type:"!metadata",value:Z(b)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!f)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(f)});let p=f.image;if(typeof p!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(GE)==null)return e.push({type:"!imageUrl-ipfs",value:p}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:p}),p=$f(p)}return e.push({type:"url",value:p}),{linkage:e,url:p}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return L(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const i=await j(s=Po,Yl,KE).call(s,e,n);if(i!=null){const o=new Po(e,i,t);return n!==t&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};fs=new WeakMap,li=new WeakMap,ds=new WeakSet,yo=async function(e,t){t=(t||[]).slice();const n=y(this,li).interface;t.unshift(Jd(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),L(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[_U(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await y(this,li)[e](...t);return s?n.decodeFunctionResult(s,i)[0]:i}catch(i){if(!lt(i,"CALL_EXCEPTION"))throw i}return null},Yl=new WeakSet,KE=async function(e,t){const n=await Po.getEnsAddress(e);try{const i=await new To(n,["function resolver(bytes32) view returns (address)"],e).resolver(Jd(t),{enableCcipRead:!0});return i===Rc?null:i}catch(s){throw s}return null},F(Po,Yl);let Vl=Po;const v0=BigInt(0);function le(r,e){return function(t){return t==null?e:r(t)}}function _h(r,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))}}function Cu(r,e){return t=>{const n={};for(const s in r){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=r[s](t[i]);o!==void 0&&(n[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";L(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return n}}function T6(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}O(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function Fa(r){return O(Oe(r,!0),"invalid data","value",r),r}function ut(r){return O(Oe(r,32),"invalid hash","value",r),r}const R6=Cu({address:ve,blockHash:ut,blockNumber:ie,data:Fa,index:ie,removed:le(T6,!1),topics:_h(ut),transactionHash:ut,transactionIndex:ie},{index:["logIndex"]});function B6(r){return R6(r)}const F6=Cu({hash:le(ut),parentHash:ut,parentBeaconBlockRoot:le(ut,null),number:ie,timestamp:ie,nonce:le(Fa),difficulty:X,gasLimit:X,gasUsed:X,stateRoot:le(ut,null),receiptsRoot:le(ut,null),blobGasUsed:le(X,null),excessBlobGas:le(X,null),miner:le(ve),prevRandao:le(ut,null),extraData:Fa,baseFeePerGas:le(X)},{prevRandao:["mixHash"]});function $6(r){const e=F6(r);return e.transactions=r.transactions.map(t=>typeof t=="string"?t:QE(t)),e}const k6=Cu({transactionIndex:ie,blockNumber:ie,transactionHash:ut,address:ve,topics:_h(ut),data:Fa,index:ie,blockHash:ut},{index:["logIndex"]});function U6(r){return k6(r)}const L6=Cu({to:le(ve,null),from:le(ve,null),contractAddress:le(ve,null),index:ie,root:le(Z),gasUsed:X,blobGasUsed:le(X,null),logsBloom:le(Fa),blockHash:ut,hash:ut,logs:_h(U6),blockNumber:ie,cumulativeGasUsed:X,effectiveGasPrice:le(X),blobGasPrice:le(X,null),status:le(ie),type:le(ie,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function M6(r){return L6(r)}function QE(r){r.to&&X(r.to)===v0&&(r.to="0x0000000000000000000000000000000000000000");const e=Cu({hash:ut,index:le(ie,void 0),type:t=>t==="0x"||t==null?0:ie(t),accessList:le(Li,null),blobVersionedHashes:le(_h(ut,!0),null),blockHash:le(ut,null),blockNumber:le(ie,null),transactionIndex:le(ie,null),from:ve,gasPrice:le(X),maxPriorityFeePerGas:le(X),maxFeePerGas:le(X),maxFeePerBlobGas:le(X,null),gasLimit:X,to:le(ve,null),value:X,nonce:ie,data:Fa,creates:le(ve,null),chainId:le(X,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(r);if(e.to==null&&e.creates==null&&(e.creates=R4(e)),(r.type===1||r.type===2)&&r.accessList==null&&(e.accessList=[]),r.signature?e.signature=$r.from(r.signature):e.signature=$r.from(r),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&X(e.blockHash)===v0&&(e.blockHash=null),e}const j6="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class _u{constructor(e){B(this,"name");te(this,{name:e})}clone(){return new _u(this.name)}}class Nh extends _u{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);B(this,"effectiveBlock");B(this,"txBase");B(this,"txCreate");B(this,"txDataZero");B(this,"txDataNonzero");B(this,"txAccessListStorageKey");B(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(n||{})[o];c==null&&(c=a),O(typeof c=="number",`invalud value for ${o}`,"costs",n),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),te(this,s)}clone(){return new Nh(this.effectiveBlock,this)}}class Th extends _u{constructor(t,n){super("org.ethers.plugins.network.Ens");B(this,"address");B(this,"targetNetwork");te(this,{address:t||j6,targetNetwork:n??1})}clone(){return new Th(this.address,this.targetNetwork)}}var tu,ru;class H6 extends _u{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");F(this,tu,void 0);F(this,ru,void 0);I(this,tu,t),I(this,ru,n)}get url(){return y(this,tu)}get processFunc(){return y(this,ru)}clone(){return this}}tu=new WeakMap,ru=new WeakMap;const kf=new Map;var aa,ca,ps;const xo=class xo{constructor(e,t){F(this,aa,void 0);F(this,ca,void 0);F(this,ps,void 0);I(this,aa,e),I(this,ca,X(t)),I(this,ps,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return y(this,aa)}set name(e){I(this,aa,e)}get chainId(){return y(this,ca)}set chainId(e){I(this,ca,X(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===X(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===X(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===X(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(y(this,ps).values())}attachPlugin(e){if(y(this,ps).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,ps).set(e.name,e.clone()),this}getPlugin(e){return y(this,ps).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new xo(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new Nh;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=Li(e.accessList);for(const i in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return n}static from(e){if(z6(),e==null)return xo.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=kf.get(e);if(t)return t();if(typeof e=="bigint")return new xo("unknown",e);O(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){O(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new xo(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new Th(e.ensAddress,e.ensNetwork)),t}O(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=kf.get(e);n&&O(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),kf.set(e,t)}};aa=new WeakMap,ca=new WeakMap,ps=new WeakMap;let an=xo;function E0(r,e){const t=String(r);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${r}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${r}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function A0(r){return new H6(r,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([n.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:E0(a.maxFee,9),maxPriorityFeePerGas:E0(a.maxPriorityFee,9)}}catch(i){L(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:i})}})}let I0=!1;function z6(){if(I0)return;I0=!0;function r(e,t,n){const s=function(){const i=new an(e,t);return n.ensNetwork!=null&&i.attachPlugin(new Th(null,n.ensNetwork)),i.attachPlugin(new Nh),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};an.register(e,s),an.register(t,s),n.altNames&&n.altNames.forEach(i=>{an.register(i,s)})}r("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),r("ropsten",3,{ensNetwork:3}),r("rinkeby",4,{ensNetwork:4}),r("goerli",5,{ensNetwork:5}),r("kovan",42,{ensNetwork:42}),r("sepolia",11155111,{ensNetwork:11155111}),r("holesky",17e3,{ensNetwork:17e3}),r("classic",61,{}),r("classicKotti",6,{}),r("arbitrum",42161,{ensNetwork:1}),r("arbitrum-goerli",421613,{}),r("arbitrum-sepolia",421614,{}),r("base",8453,{ensNetwork:1}),r("base-goerli",84531,{}),r("base-sepolia",84532,{}),r("bnb",56,{ensNetwork:1}),r("bnbt",97,{}),r("linea",59144,{ensNetwork:1}),r("linea-goerli",59140,{}),r("linea-sepolia",59141,{}),r("matic",137,{ensNetwork:1,plugins:[A0("https://gasstation.polygon.technology/v2")]}),r("matic-amoy",80002,{}),r("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[A0("https://gasstation-testnet.polygon.technology/v2")]}),r("optimism",10,{ensNetwork:1,plugins:[]}),r("optimism-goerli",420,{}),r("optimism-sepolia",11155420,{}),r("xdai",100,{ensNetwork:1})}function rp(r){return JSON.parse(JSON.stringify(r))}var Tn,lr,gs,Xr,ua,wl;class q6{constructor(e){F(this,ua);F(this,Tn,void 0);F(this,lr,void 0);F(this,gs,void 0);F(this,Xr,void 0);I(this,Tn,e),I(this,lr,null),I(this,gs,4e3),I(this,Xr,-2)}get pollingInterval(){return y(this,gs)}set pollingInterval(e){I(this,gs,e)}start(){y(this,lr)||(I(this,lr,y(this,Tn)._setTimeout(j(this,ua,wl).bind(this),y(this,gs))),j(this,ua,wl).call(this))}stop(){y(this,lr)&&(y(this,Tn)._clearTimeout(y(this,lr)),I(this,lr,null))}pause(e){this.stop(),e&&I(this,Xr,-2)}resume(){this.start()}}Tn=new WeakMap,lr=new WeakMap,gs=new WeakMap,Xr=new WeakMap,ua=new WeakSet,wl=async function(){try{const e=await y(this,Tn).getBlockNumber();if(y(this,Xr)===-2){I(this,Xr,e);return}if(e!==y(this,Xr)){for(let t=y(this,Xr)+1;t<=e;t++){if(y(this,lr)==null)return;await y(this,Tn).emit("block",t)}I(this,Xr,e)}}catch{}y(this,lr)!=null&&I(this,lr,y(this,Tn)._setTimeout(j(this,ua,wl).bind(this),y(this,gs)))};var hi,fi,ys;class cg{constructor(e){F(this,hi,void 0);F(this,fi,void 0);F(this,ys,void 0);I(this,hi,e),I(this,ys,!1),I(this,fi,t=>{this._poll(t,y(this,hi))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){y(this,ys)||(I(this,ys,!0),y(this,fi).call(this,-2),y(this,hi).on("block",y(this,fi)))}stop(){y(this,ys)&&(I(this,ys,!1),y(this,hi).off("block",y(this,fi)))}pause(e){this.stop()}resume(){this.start()}}hi=new WeakMap,fi=new WeakMap,ys=new WeakMap;var la,Rn;class V6 extends cg{constructor(t,n){super(t);F(this,la,void 0);F(this,Rn,void 0);I(this,la,n),I(this,Rn,-2)}pause(t){t&&I(this,Rn,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(y(this,la));s!=null&&(y(this,Rn)===-2?I(this,Rn,s.number):s.number>y(this,Rn)&&(n.emit(y(this,la),s.number),I(this,Rn,s.number)))}}la=new WeakMap,Rn=new WeakMap;var Zl;class G6 extends cg{constructor(t,n){super(t);F(this,Zl,void 0);I(this,Zl,rp(n))}async _poll(t,n){throw new Error("@TODO")}}Zl=new WeakMap;var ha;class K6 extends cg{constructor(t,n){super(t);F(this,ha,void 0);I(this,ha,n)}async _poll(t,n){const s=await n.getTransactionReceipt(y(this,ha));s&&n.emit(y(this,ha),s)}}ha=new WeakMap;var Bn,fa,da,ms,hr,Xl,WE;class ug{constructor(e,t){F(this,Xl);F(this,Bn,void 0);F(this,fa,void 0);F(this,da,void 0);F(this,ms,void 0);F(this,hr,void 0);I(this,Bn,e),I(this,fa,rp(t)),I(this,da,j(this,Xl,WE).bind(this)),I(this,ms,!1),I(this,hr,-2)}start(){y(this,ms)||(I(this,ms,!0),y(this,hr)===-2&&y(this,Bn).getBlockNumber().then(e=>{I(this,hr,e)}),y(this,Bn).on("block",y(this,da)))}stop(){y(this,ms)&&(I(this,ms,!1),y(this,Bn).off("block",y(this,da)))}pause(e){this.stop(),e&&I(this,hr,-2)}resume(){this.start()}}Bn=new WeakMap,fa=new WeakMap,da=new WeakMap,ms=new WeakMap,hr=new WeakMap,Xl=new WeakSet,WE=async function(e){if(y(this,hr)===-2)return;const t=rp(y(this,fa));t.fromBlock=y(this,hr)+1,t.toBlock=e;const n=await y(this,Bn).getLogs(t);if(n.length===0){y(this,hr)<e-60&&I(this,hr,e-60);return}for(const s of n)y(this,Bn).emit(y(this,fa),s),I(this,hr,s.blockNumber)};const Q6=BigInt(2),W6=10;function rl(r){return r&&typeof r.then=="function"}function bl(r,e){return r+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class JE{constructor(e){B(this,"name");te(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function J6(r){return JSON.parse(JSON.stringify(r))}function np(r){return r=Array.from(new Set(r).values()),r.sort(),r}async function Uf(r,e){if(r==null)throw new Error("invalid event");if(Array.isArray(r)&&(r={topics:r}),typeof r=="string")switch(r){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:r,tag:r}}if(Oe(r,32)){const t=r.toLowerCase();return{type:"transaction",tag:bl("tx",{hash:t}),hash:t}}if(r.orphan){const t=r;return{type:"orphan",tag:bl("orphan",t),filter:J6(t)}}if(r.address||r.topics){const t=r,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?np(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{Oe(a)?s.push(a):i.push((async()=>{s.push(await Dt(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),n.address=np(s.map(a=>a.toLowerCase()))}return{filter:n,tag:bl("event",n),type:"event"}}O(!1,"unknown ProviderEvent","event",r)}function Lf(){return new Date().getTime()}const Y6={cacheTimeout:250,pollingInterval:4e3};var mt,ws,wt,pa,Zt,di,bs,Fn,nu,fr,ga,ya,At,Gt,su,sp,iu,ip,pi,fc,ou,op,gi,dc,ma,vl;class Z6{constructor(e,t){F(this,At);F(this,su);F(this,iu);F(this,pi);F(this,ou);F(this,gi);F(this,ma);F(this,mt,void 0);F(this,ws,void 0);F(this,wt,void 0);F(this,pa,void 0);F(this,Zt,void 0);F(this,di,void 0);F(this,bs,void 0);F(this,Fn,void 0);F(this,nu,void 0);F(this,fr,void 0);F(this,ga,void 0);F(this,ya,void 0);if(I(this,ya,Object.assign({},Y6,t||{})),e==="any")I(this,di,!0),I(this,Zt,null);else if(e){const n=an.from(e);I(this,di,!1),I(this,Zt,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else I(this,di,!1),I(this,Zt,null);I(this,Fn,-1),I(this,bs,new Map),I(this,mt,new Map),I(this,ws,new Map),I(this,wt,null),I(this,pa,!1),I(this,nu,1),I(this,fr,new Map),I(this,ga,!1)}get pollingInterval(){return y(this,ya).pollingInterval}get provider(){return this}get plugins(){return Array.from(y(this,ws).values())}attachPlugin(e){if(y(this,ws).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,ws).set(e.name,e.connect(this)),this}getPlugin(e){return y(this,ws).get(e)||null}get disableCcipRead(){return y(this,ga)}set disableCcipRead(e){I(this,ga,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],u=c.replace("{sender}",s).replace("{data}",i),l=new Ss(u);c.indexOf("{data}")===-1&&(l.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:l,index:a,urls:n});let h="unknown error",f;try{f=await l.send()}catch(d){o.push(d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:l,result:{error:d}});continue}try{const d=f.bodyJson;if(d.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:l,result:d}),d.data;d.message&&(h=d.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:l,result:d})}catch{}L(f.statusCode<400||f.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:h}}),o.push(h)}L(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new m6($6(e),this)}_wrapLog(e,t){return new Du(B6(e),this)}_wrapTransactionReceipt(e,t){return new FE(M6(e),this)}_wrapTransactionResponse(e,t){return new jc(QE(e),this)}_detectNetwork(){L(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){L(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=ie(await j(this,At,Gt).call(this,{method:"getBlockNumber"}),"%response");return y(this,Fn)>=0&&I(this,Fn,e),e}_getAddress(e){return Dt(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Oe(e))return Oe(e,32)?e:Eo(e);if(typeof e=="bigint"&&(e=ie(e,"blockTag")),typeof e=="number")return e>=0?Eo(e):y(this,Fn)>=0?Eo(y(this,Fn)+e):this.getBlockNumber().then(t=>Eo(t+e));O(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?np(c.map(u=>u.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(c,u,l)=>{let h;switch(c.length){case 0:break;case 1:h=c[0];break;default:c.sort(),h=c}if(n&&(u!=null||l!=null))throw new Error("invalid filter");const f={};return h&&(f.address=h),t.length&&(f.topics=t),u&&(f.fromBlock=u),l&&(f.toBlock=l),n&&(f.blockHash=n),f};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=zl(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=Dt(t[s],this);rl(i)?n.push(async function(){t[s]=await i}()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);rl(s)?n.push(async function(){t.blockTag=await s}()):t.blockTag=s}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(y(this,Zt)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw y(this,Zt)===s&&I(this,Zt,null),i}})();return I(this,Zt,s),(await s).clone()}const e=y(this,Zt),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(y(this,di)?(this.emit("network",n,t),y(this,Zt)===e&&I(this,Zt,Promise.resolve(n))):L(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await Pt({_block:j(this,ou,op).call(this,"latest",!1),gasPrice:(async()=>{try{const l=await j(this,At,Gt).call(this,{method:"getGasPrice"});return X(l,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const l=await j(this,At,Gt).call(this,{method:"getPriorityFee"});return X(l,"%response")}catch{}return null})()});let a=null,c=null;const u=this._wrapBlock(s,e);return u&&u.baseFeePerGas&&(c=o??BigInt("1000000000"),a=u.baseFeePerGas*Q6+c),new y0(i,a,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new Ss(n.url),i=await n.processFunc(t,this,s);return new y0(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return rl(t)&&(t=await t),X(await j(this,At,Gt).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await Pt({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await j(this,iu,ip).call(this,j(this,su,sp).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return X(await j(this,pi,fc).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return ie(await j(this,pi,fc).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return Z(await j(this,pi,fc).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=X(t,"position");return Z(await j(this,pi,fc).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await Pt({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=jl.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await Pt({network:this.getNetwork(),params:j(this,ou,op).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await Pt({network:this.getNetwork(),params:j(this,At,Gt).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await Pt({network:this.getNetwork(),params:j(this,At,Gt).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await j(this,At,Gt).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await Pt({network:this.getNetwork(),result:j(this,At,Gt).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:Z(t)}async getLogs(e){let t=this._getFilter(e);rl(t)&&(t=await t);const{network:n,params:s}=await Pt({network:this.getNetwork(),params:j(this,At,Gt).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,n))}_getProvider(e){L(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Vl.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=ve(e);const t=Jd(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await Vl.getEnsAddress(this),i=await new To(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===Rc)return null;const a=await new To(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(n){if(lt(n,"BAD_DATA")&&n.value==="0x"||lt(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=async u=>{try{const l=await this.getTransactionReceipt(e);if(l!=null&&u-l.blockNumber+1>=s){i(l),a&&(clearTimeout(a),a=null);return}}catch(l){console.log("EEE",l)}this.once("block",c)};n!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(Re("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){L(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=y(this,fr).get(e);t&&(t.timer&&clearTimeout(t.timer),y(this,fr).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=Va(this,nu)._++,s=()=>{y(this,fr).delete(n),e()};if(this.paused)y(this,fr).set(n,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);y(this,fr).set(n,{timer:i,func:s,time:Lf()})}return n}_forEachSubscriber(e){for(const t of y(this,mt).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new JE(e.type);case"block":{const t=new q6(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new V6(this,e.type);case"event":return new ug(this,e.filter);case"transaction":return new K6(this,e.hash);case"orphan":return new G6(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of y(this,mt).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),y(this,wt)!=null&&t.pause(y(this,wt));break}}async on(e,t){const n=await j(this,ma,vl).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,y(this,wt)!=null&&n.subscriber.pause(y(this,wt))),this}async once(e,t){const n=await j(this,ma,vl).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,y(this,wt)!=null&&n.subscriber.pause(y(this,wt))),this}async emit(e,...t){const n=await j(this,gi,dc).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const a=new fv(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),y(this,mt).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await j(this,gi,dc).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of y(this,mt).values())t+=n.length;return t}async listeners(e){if(e){const n=await j(this,gi,dc).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of y(this,mt).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await j(this,gi,dc).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),y(this,mt).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await j(this,ma,vl).call(this,e);n&&s.stop(),y(this,mt).delete(t)}else for(const[t,{started:n,subscriber:s}]of y(this,mt))n&&s.stop(),y(this,mt).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return y(this,pa)}destroy(){this.removeAllListeners();for(const e of y(this,fr).keys())this._clearTimeout(e);I(this,pa,!0)}get paused(){return y(this,wt)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(I(this,Fn,-1),y(this,wt)!=null){if(y(this,wt)==!!e)return;L(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),I(this,wt,!!e);for(const t of y(this,fr).values())t.timer&&clearTimeout(t.timer),t.time=Lf()-t.time}resume(){if(y(this,wt)!=null){this._forEachSubscriber(e=>e.resume()),I(this,wt,null);for(const e of y(this,fr).values()){let t=e.time;t<0&&(t=0),e.time=Lf(),setTimeout(e.func,t)}}}}mt=new WeakMap,ws=new WeakMap,wt=new WeakMap,pa=new WeakMap,Zt=new WeakMap,di=new WeakMap,bs=new WeakMap,Fn=new WeakMap,nu=new WeakMap,fr=new WeakMap,ga=new WeakMap,ya=new WeakMap,At=new WeakSet,Gt=async function(e){const t=y(this,ya).cacheTimeout;if(t<0)return await this._perform(e);const n=bl(e.method,e);let s=y(this,bs).get(n);return s||(s=this._perform(e),y(this,bs).set(n,s),setTimeout(()=>{y(this,bs).get(n)===s&&y(this,bs).delete(n)},t)),await s},su=new WeakSet,sp=async function(e,t,n){L(n<W6,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=zl(e);try{return Z(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&Hp(i)&&i.data&&n>=0&&t==="latest"&&s.to!=null&&Be(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Dt(s.to,this);let c;try{c=nL(Be(i.data,4))}catch(h){L(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}L(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const u=await this.ccipReadFetch(s,c.calldata,c.urls);L(u!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const l={to:a,data:Me([c.selector,rL([u,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:l});try{const h=await j(this,su,sp).call(this,l,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},l),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},l),error:h}),h}}throw i}},iu=new WeakSet,ip=async function(e){const{value:t}=await Pt({network:this.getNetwork(),value:e});return t},pi=new WeakSet,fc=async function(e,t,n){let s=this._getAddress(t),i=this._getBlockTag(n);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await j(this,iu,ip).call(this,j(this,At,Gt).call(this,Object.assign(e,{address:s,blockTag:i})))},ou=new WeakSet,op=async function(e,t){if(Oe(e,32))return await j(this,At,Gt).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await j(this,At,Gt).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},gi=new WeakSet,dc=async function(e,t){let n=await Uf(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await Uf({orphan:"drop-log",log:t[0]},this)),y(this,mt).get(n.tag)||null},ma=new WeakSet,vl=async function(e){const t=await Uf(e,this),n=t.tag;let s=y(this,mt).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},y(this,mt).set(n,s)),s};function X6(r,e){try{const t=ap(r,e);if(t)return Bl(t)}catch{}return null}function ap(r,e){if(r==="0x")return null;try{const t=ie(Be(r,e,e+32)),n=ie(Be(r,t,t+32));return Be(r,t+32,t+32+n)}catch{}return null}function P0(r){const e=Ot(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function eL(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}const tL=new Uint8Array([]);function rL(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(tL),t+=32;for(let n=0;n<r.length;n++){const s=he(r[n]);e[n]=P0(t),e.push(P0(s.length)),e.push(eL(s)),t+=32+Math.ceil(s.length/32)*32}return Me(e)}const x0="0x0000000000000000000000000000000000000000000000000000000000000000";function nL(r){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};L(Do(r)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=Be(r,0,32);L(Be(t,0,12)===Be(x0,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Be(t,12);try{const n=[],s=ie(Be(r,32,64)),i=ie(Be(r,s,s+32)),o=Be(r,s+32);for(let a=0;a<i;a++){const c=X6(o,a*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{L(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=ap(r,64);if(n==null)throw new Error("abort");e.calldata=n}catch{L(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}L(Be(r,100,128)===Be(x0,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Be(r,96,100);try{const n=ap(r,128);if(n==null)throw new Error("abort");e.extraData=n}catch{L(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function co(r,e){if(r.provider)return r.provider;L(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function O0(r,e){let t=zl(e);if(t.to!=null&&(t.to=Dt(t.to,r)),t.from!=null){const n=t.from;t.from=Promise.all([r.getAddress(),Dt(n,r)]).then(([s,i])=>(O(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=r.getAddress();return await Pt(t)}class sL{constructor(e){B(this,"provider");te(this,{provider:e||null})}async getNonce(e){return co(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await O0(this,e)}async populateTransaction(e){const t=co(this,"populateTransaction"),n=await O0(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const o=X(n.chainId);O(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=s.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?O(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&O(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await t.getFeeData();L(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.type=2,n.gasPrice!=null){const a=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=a,n.maxPriorityFeePerGas=a}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(L(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):L(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Pt(n)}async estimateGas(e){return co(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return co(this,"call").call(await this.populateCall(e))}async resolveName(e){return await co(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=co(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const s=jl.from(n);return await t.broadcastTransaction(await this.signTransaction(s))}}function iL(r){return JSON.parse(JSON.stringify(r))}var It,en,yi,vs,mi,wa,au,cp,cu,up;class YE{constructor(e){F(this,au);F(this,cu);F(this,It,void 0);F(this,en,void 0);F(this,yi,void 0);F(this,vs,void 0);F(this,mi,void 0);F(this,wa,void 0);I(this,It,e),I(this,en,null),I(this,yi,j(this,au,cp).bind(this)),I(this,vs,!1),I(this,mi,null),I(this,wa,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){y(this,vs)||(I(this,vs,!0),j(this,au,cp).call(this,-2))}stop(){y(this,vs)&&(I(this,vs,!1),I(this,wa,!0),j(this,cu,up).call(this),y(this,It).off("block",y(this,yi)))}pause(e){e&&j(this,cu,up).call(this),y(this,It).off("block",y(this,yi))}resume(){this.start()}}It=new WeakMap,en=new WeakMap,yi=new WeakMap,vs=new WeakMap,mi=new WeakMap,wa=new WeakMap,au=new WeakSet,cp=async function(e){try{y(this,en)==null&&I(this,en,this._subscribe(y(this,It)));let t=null;try{t=await y(this,en)}catch(i){if(!lt(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){I(this,en,null),y(this,It)._recoverSubscriber(this,this._recover(y(this,It)));return}const n=await y(this,It).getNetwork();if(y(this,mi)||I(this,mi,n),y(this,mi).chainId!==n.chainId)throw new Error("chaid changed");if(y(this,wa))return;const s=await y(this,It).send("eth_getFilterChanges",[t]);await this._emitResults(y(this,It),s)}catch(t){console.log("@TODO",t)}y(this,It).once("block",y(this,yi))},cu=new WeakSet,up=function(){const e=y(this,en);e&&(I(this,en,null),e.then(t=>{y(this,It).destroyed||y(this,It).send("eth_uninstallFilter",[t])}))};var wi;class oL extends YE{constructor(t,n){super(t);F(this,wi,void 0);I(this,wi,iL(n))}_recover(t){return new ug(t,y(this,wi))}async _subscribe(t){return await t.send("eth_newFilter",[y(this,wi)])}async _emitResults(t,n){for(const s of n)t.emit(y(this,wi),t._wrapLog(s,t._network))}}wi=new WeakMap;class aL extends YE{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const cL="bigint,boolean,function,number,string,symbol".split(/,/g);function El(r){if(r==null||cL.indexOf(typeof r)>=0||typeof r.getAddress=="function")return r;if(Array.isArray(r))return r.map(El);if(typeof r=="object")return Object.keys(r).reduce((e,t)=>(e[t]=r[t],e),{});throw new Error(`should not happen: ${r} (${typeof r})`)}function uL(r){return new Promise(e=>{setTimeout(e,r)})}function uo(r){return r&&r.toLowerCase()}function S0(r){return r&&typeof r.pollingInterval=="number"}const ZE={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Mf extends sL{constructor(t,n){super(t);B(this,"address");n=ve(n),te(this,{address:n})}connect(t){L(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=El(t),s=[];if(n.from){const o=n.from;s.push((async()=>{const a=await Dt(o,this.provider);O(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await Dt(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const u=async()=>{try{const l=await this.provider.getTransaction(s);if(l!=null){i(l.replaceableTransaction(n));return}}catch(l){if(lt(l,"CANCELLED")||lt(l,"BAD_DATA")||lt(l,"NETWORK_ERROR")||lt(l,"UNSUPPORTED_OPERATION")){l.info==null&&(l.info={}),l.info.sendTransactionHash=s,o(l);return}if(lt(l,"INVALID_ARGUMENT")&&(c++,l.info==null&&(l.info={}),l.info.sendTransactionHash=s,c>10)){o(l);return}this.provider.emit("error",Re("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:l}))}this.provider._setTimeout(()=>{u()},a.pop()||4e3)};u()})}async signTransaction(t){const n=El(t);if(n.from){const i=await Dt(n.from,this.provider);O(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=i}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?Hn(t):t;return await this.provider.send("personal_sign",[Z(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const i=El(s),o=await Hl.resolveNames(t,n,i,async a=>{const c=await Dt(a);return O(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Hl.getPayload(o.domain,n,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?Hn(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Z(n)])}}var bi,ba,$n,tn,Tr,dr,kt,uu,lp;class lL extends Z6{constructor(t,n){super(t,n);F(this,uu);F(this,bi,void 0);F(this,ba,void 0);F(this,$n,void 0);F(this,tn,void 0);F(this,Tr,void 0);F(this,dr,void 0);F(this,kt,void 0);I(this,ba,1),I(this,bi,Object.assign({},ZE,n||{})),I(this,$n,[]),I(this,tn,null),I(this,dr,null),I(this,kt,null);{let i=null;const o=new Promise(a=>{i=a});I(this,Tr,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(O(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&I(this,dr,an.from(t))):s&&(O(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),I(this,dr,s))}_getOption(t){return y(this,bi)[t]}get _network(){return L(y(this,dr),"network is not available yet","NETWORK_ERROR"),y(this,dr)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&X(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(y(this,dr))return y(this,dr)}else return t;return y(this,kt)?await y(this,kt):this.ready?(I(this,kt,(async()=>{try{const n=an.from(X(await this.send("eth_chainId",[])));return I(this,kt,null),n}catch(n){throw I(this,kt,null),n}})()),await y(this,kt)):(I(this,kt,(async()=>{const n={id:Va(this,ba)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],I(this,kt,null)}catch(i){throw I(this,kt,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return an.from(X(s.result));throw this.getRpcError(n,s)})()),await y(this,kt))}_start(){y(this,Tr)==null||y(this,Tr).resolve==null||(y(this,Tr).resolve(),I(this,Tr,null),(async()=>{for(;y(this,dr)==null&&!this.destroyed;)try{I(this,dr,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Re("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await uL(1e3)}j(this,uu,lp).call(this)})())}async _waitUntilReady(){if(y(this,Tr)!=null)return await y(this,Tr).promise}_getSubscriber(t){return t.type==="pending"?new aL(this):t.type==="event"?this._getOption("polling")?new ug(this,t.filter):new oL(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new JE("orphan"):super._getSubscriber(t)}get ready(){return y(this,Tr)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),n[i]=Eo(X(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=Z(t[s]))}),t.accessList&&(n.accessList=Li(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[uo(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[uo(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[uo(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[uo(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(uo):t.filter.address=uo(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:i}=n;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return Re("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=hp(i),u=Mc.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return u.info={error:i,payload:t},u}const o=JSON.stringify(fL(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Re("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Re("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Re("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Re("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return Re("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?Re("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):Re("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Re("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=Va(this,ba)._++,i=new Promise((o,a)=>{y(this,$n).push({resolve:o,reject:a,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return j(this,uu,lp).call(this),i}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await n;if(t>=i.length)throw new Error("no such account");return new Mf(this,i[t])}const{accounts:s}=await Pt({network:this.getNetwork(),accounts:n});t=ve(t);for(const i of s)if(ve(i)===t)return new Mf(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new Mf(this,n))}destroy(){y(this,tn)&&(clearTimeout(y(this,tn)),I(this,tn,null));for(const{payload:t,reject:n}of y(this,$n))n(Re("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));I(this,$n,[]),super.destroy()}}bi=new WeakMap,ba=new WeakMap,$n=new WeakMap,tn=new WeakMap,Tr=new WeakMap,dr=new WeakMap,kt=new WeakMap,uu=new WeakSet,lp=function(){if(y(this,tn))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");I(this,tn,setTimeout(()=>{I(this,tn,null);const n=y(this,$n);for(I(this,$n,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==y(this,bi).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>y(this,bi).batchMaxSize){n.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:u}of s){if(this.destroyed){c(Re("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:u.method}));continue}const l=o.filter(h=>h.id===u.id)[0];if(l==null){const h=Re("missing response for request","BAD_DATA",{value:o,info:{payload:u}});this.emit("error",h),c(h);continue}if("error"in l){c(this.getRpcError(u,l));continue}a(l.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var Es;class hL extends lL{constructor(t,n){super(t,n);F(this,Es,void 0);let s=this._getOption("pollingInterval");s==null&&(s=ZE.pollingInterval),I(this,Es,s)}_getSubscriber(t){const n=super._getSubscriber(t);return S0(n)&&(n.pollingInterval=y(this,Es)),n}get pollingInterval(){return y(this,Es)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");I(this,Es,t),this._forEachSubscriber(n=>{S0(n)&&(n.pollingInterval=y(this,Es))})}}Es=new WeakMap;function hp(r){if(r==null)return null;if(typeof r.message=="string"&&r.message.match(/revert/i)&&Oe(r.data))return{message:r.message,data:r.data};if(typeof r=="object"){for(const e in r){const t=hp(r[e]);if(t)return t}return null}if(typeof r=="string")try{return hp(JSON.parse(r))}catch{}return null}function fp(r,e){if(r!=null){if(typeof r.message=="string"&&e.push(r.message),typeof r=="object")for(const t in r)fp(r[t],e);if(typeof r=="string")try{return fp(JSON.parse(r),e)}catch{}}}function fL(r){const e=[];return fp(r,e),e}var va;class dL extends hL{constructor(t,n,s){const i=Object.assign({},s??{},{batchMaxCount:1});O(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,i);F(this,va,void 0);I(this,va,async(o,a)=>{const c={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:c});try{const u=await t.request(c);return this.emit("debug",{action:"receiveEip1193Result",result:u}),u}catch(u){const l=new Error(u.message);throw l.code=u.code,l.data=u.data,l.payload=c,this.emit("debug",{action:"receiveEip1193Error",error:l}),l}})}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){O(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await y(this,va).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await y(this,va).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(t)}}va=new WeakMap;let pc,dp=null;const D0={1:"0x7E0A6F03060357828DD41B0e5a49c2A201DC8798",137:"0x57f5e0DDa1ddfdbBa469bCD6b6f90db5dE4ce69A",56:"0x7E0A6F03060357828DD41B0e5a49c2A201DC8798"},pL=[{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"value",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"burnFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"burnReservedTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"buyTokens",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"claimRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"endPresaleManually",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"manageReservedTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"manualActivatePresale",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IUniswapV2Router02",name:"router",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"},{internalType:"uint256",name:"nativeAmount",type:"uint256"}],name:"manualAddLiquidityCustom",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"ownerDisableClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"ownerEnableClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"ownerEndStaking",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"ownerStartStaking",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"pair",type:"address"},{internalType:"bool",name:"value",type:"bool"}],name:"setAutomatedMarketMakerPair",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"stakeTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_teamWallet",type:"address"},{internalType:"address",name:"_uniswapRouter",type:"address"},{internalType:"address",name:"_pancakeswapRouter",type:"address"},{internalType:"address",name:"_quickswapRouter",type:"address"},{internalType:"address",name:"_priceFeedAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"totalCollected",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];async function XE(r="1"){pc=await _$.init({projectId:"67c4292e272ac36fdbc049335adf6b67",chains:[parseInt(r)],optionalChains:[1,56,137],showQrModal:!0,methods:["eth_sendTransaction","eth_sign","personal_sign","eth_signTypedData"],events:["chainChanged","accountsChanged"]}),await pc.connect();const e=await pc.request({method:"eth_accounts"}),t=await pc.request({method:"eth_chainId"});window.connectedChainId=Number(t),alert(`Wallet verbunden:
Adresse: ${e[0]}
Chain-ID: ${t}`),eA()}document.getElementById("connectButton").addEventListener("click",()=>{const r=document.getElementById("chainSelect").value;XE(r)});window.addEventListener("load",()=>{var t;if(new URLSearchParams(window.location.search).get("autoconnect")==="true"){const n=((t=document.getElementById("chainSelect"))==null?void 0:t.value)||"1";XE(n)}});async function gL(r){var t;let e="";if(r===1)e="ethereum";else if(r===137||r===311)e="matic-network";else if(r===56)e="binancecoin";else return null;try{return(t=(await(await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${e}&vs_currencies=usd`)).json())[e])==null?void 0:t.usd}catch(n){return console.error("Fehler beim Preisabruf:",n),null}}async function eA(){const r=document.getElementById("cryptoAmount"),e=document.getElementById("qpepeResult"),t=parseFloat(r.value),n=1e-4;if(!window.connectedChainId){e.innerText="Please connect your wallet first.";return}if(!t||t<=0){e.innerText="";return}dp=await gL(window.connectedChainId);const s=dp;if(console.log("Aktueller Preis:",s),!s){alert("Price fetch failed.");return}const o=t*s/n;e.innerText=`You will receive approximately ${Math.floor(o).toLocaleString()} QPEPE Tokens`}document.getElementById("cryptoAmount").addEventListener("input",eA);async function yL(){const r=document.getElementById("cryptoAmount"),e=parseFloat(r.value);if(!window.connectedChainId){alert("Please connect your wallet first.");return}if(!e||e<=0){alert("Please enter a valid amount.");return}if(!dp){alert("Price fetch failed.");return}const n=new dL(pc).getSigner();console.log("Chain ID:",window.connectedChainId),console.log("Vertrag:",D0[window.connectedChainId]);const s=D0[window.connectedChainId],i=new To(s,pL,await n);try{const o=await i.buyTokens({value:sk(e.toString())});await o.wait(),alert(`Transaction sent! Hash: ${o.hash}`)}catch(o){console.error("Kauf fehlgeschlagen:",o),alert("Transaction failed.")}}window.buyToken=yL;export{M2 as H,C0 as _,Lg as a,_2 as b,vL as c,bL as d,th as e,AL as f,PL as g,EL as r,W0 as t,j2 as w};
